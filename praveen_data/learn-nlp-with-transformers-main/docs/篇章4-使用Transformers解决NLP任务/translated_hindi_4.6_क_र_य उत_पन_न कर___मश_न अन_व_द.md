рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдЬрдкреНрдЯрд░ рдиреЛрдЯрдмреБрдХ [рдЕрдзреНрдпрд╛рдп 4 рдХреЛрдб рдЖрдзрд╛рд░](https://github.com/datawhalechina/learn-nlp-with-transformers/tree/main/docs/%E7%AF%87%E7%AB) рдореЗрдВ рд╣реИ %A04 -%E4%BD%BF%E7%94%A8рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░%E8%A7%A3%E5%86%B3NLP%E4%BB%BB%E5%8A%A1)ред

рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреЛ рд╕реАрдзреЗ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП Google Colab рдиреЛрдЯрдмреБрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрд╢рдВрд╕рд╛ рдХреА рдЬрд╛рддреА рд╣реИ, рддрд╛рдХрд┐ рдЖрдк рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдФрд░ рдореЙрдбрд▓ рдЬрд▓реНрджреА рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХреЗрдВред
рдпрджрд┐ рдЖрдк рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЛ Google рдХреЗ рдХреЛрд▓рд╛рдм рдореЗрдВ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдФрд░ ЁЯдЧрдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдЗрд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЛ рдЕрдирдХрдореНрдореЗрдВрдЯ рдХрд░реЗрдВред


```рдЕрдЬрдЧрд░
! рдкрд┐рдк рдЗрдВрд╕реНрдЯрд╛рд▓ рдбреЗрдЯрд╛рд╕реЗрдЯ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ "рд╕реИрдХреНрд░реЗрдмреНрд▓реВ>=1.4.12,<2.0.0" рд╡рд╛рдХреНрдп рдЯреБрдХрдбрд╝рд╛
```

рдпрджрд┐ рдЖрдк рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдХреГрдкрдпрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдиреЗ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░-рдХреНрд╡рд┐рдХ-рд╕реНрдЯрд╛рд░реНрдЯ-рдЬрд╝реЗрдбрдПрдЪ рдХреА рд░реАрдбрдореА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рднреА рдЖрд╢реНрд░рд┐рдд рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рдзреНрдпрд╛рди рд╕реЗ рдкрдврд╝рд╛ рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рд╣реИред рдЖрдк рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХрд╛ рдорд▓реНрдЯреА-рдЬреАрдкреАрдпреВ рд╡рд┐рддрд░рд┐рдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕рдВрд╕реНрдХрд░рдг [рдпрд╣рд╛рдВ] (https://github.com/huggingface/transformers/tree/master/examples/seq2seq) рдвреВрдВрдвреЗрдВред

# рдЕрдиреБрд╡рд╛рдж рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реЗрдВ

рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдореЗрдВ, рд╣рдо рджрд┐рдЦрд╛рдПрдВрдЧреЗ рдХрд┐ рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕] (https://github.com/huggingface/transformers) рдХреЛрдб рдмреЗрд╕ рдореЗрдВ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВред рд╣рдо [WMT рдбреЗрдЯрд╛рд╕реЗрдЯ](http://www.statmt.org/wmt16/) рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдпрд╣ рдЕрдиреБрд╡рд╛рдж рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред

рдПрдХ рдЙрджрд╛рд╣рд░рдг рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:

![рдЕрдиреБрд╡рд╛рдж рдХрд╛рд░реНрдп рдкрд░ рд╡рд┐рдЬреЗрдЯ рдЕрдиреБрдорд╛рди](https://github.com/huggingface/notebooks/blob/master/examples/images/translation.png?raw=1)

рдЕрдиреБрд╡рд╛рдж рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП, рд╣рдо рджрд┐рдЦрд╛рдПрдВрдЧреЗ рдХрд┐ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд▓реЛрдб рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ, рдЬрдмрдХрд┐ рд╕рдВрдмрдВрдзрд┐рдд рдХреЗ рд▓рд┐рдП рдЯреНрд░рд╛рдВрд╕рдлрд╝реЙрд░реНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░реЗрдВрдЖрд░ рдореЗрдВ рдЯреНрд░реЗрдирд░ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдореЙрдбрд▓ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░рддрд╛ рд╣реИред


```рдЕрдЬрдЧрд░
рдореЙрдбрд▓_рдЪреЗрдХрдкреЙрдЗрдВрдЯ = "рд╣реЗрд▓рд╕рд┐рдВрдХреА-рдПрдирдПрд▓рдкреА/рдУрдкрд╕-рдПрдордЯреА-рдПрди-рдЖрд░рдУ"
# рдПрдХ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдЪреБрдиреЗрдВ
```

рдЬрдм рддрдХ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдореЗрдВ seq2seq рд╕рдВрд░рдЪрдирд╛ рдХреА рдореБрдЦреНрдп рдкрд░рдд рд╣реЛрддреА рд╣реИ, рдпрд╣ рдиреЛрдЯрдмреБрдХ рд╕реИрджреНрдзрд╛рдВрддрд┐рдХ рд░реВрдк рд╕реЗ рдХрд┐рд╕реА рднреА рдЕрдиреБрд╡рд╛рдж рдХрд╛рд░реНрдп рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ [рдореЙрдбрд▓ рдкреИрдирд▓] (https://huggingface.co/models) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рдЕрдиреБрд╡рд╛рдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд [`рд╣реЗрд▓рд╕рд┐рдВрдХреА-рдПрдирдПрд▓рдкреА/рдУрдкрд╕-рдПрдордЯреА-рдПрди-рд░реЛ`](https://huggingface.co/Helsinki-NLP/opus-mt-en-ro) рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдХрд╛рдоред 

## рдбреЗрдЯрд╛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ


рд╣рдо рдбреЗрдЯрд╛ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдореВрд▓реНрдпрд╛рдВрдХрди рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ЁЯдЧ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдбреЗрдЯрд╛ рд▓реЛрдбрд┐рдВрдЧ рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдореЛрдб рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рдФрд░ рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ рдХреЗ рд╕рд░рд▓ рдЙрдкрдпреЛрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рд╣рдо WMT рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдЕрдВрдЧреНрд░реЗрдЬреА/рд░реЛрдорд╛рдирд┐рдпрд╛рдИ рджреНрд╡рд┐рднрд╛рд╖реА рдЕрдиреБрд╡рд╛рдж рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред



```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб рдЖрдпрд╛рдд рдХрд░реЗрдВ_рдбреЗрдЯрд╛рд╕реЗрдЯ, рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ

raw_datasets =load_dataset("wmt16", "ro-en")
рдореАрдЯреНрд░рд┐рдХ = рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ("рд╕реИрдХреНрд░реЗрдмреНрд▓реВ")
```

    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 2.81kB [00:00, 523kB/s]
    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 3.19kB [00:00, 758kB/s]
    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 41.0kB [00:00, 11.0MB/s]


    рдбреЗрдЯрд╛рд╕реЗрдЯ wmt16/ro-en рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдФрд░ рддреИрдпрд╛рд░ рдХрд░рдирд╛ (рдбрд╛рдЙрдирд▓реЛрдб: рдЕрдЬреНрдЮрд╛рдд рдЖрдХрд╛рд░, рдЙрддреНрдкрдиреНрди: рдЕрдЬреНрдЮрд╛рдд рдЖрдХрд╛рд░, рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕реНрдб: рдЕрдЬреНрдЮрд╛рдд рдЖрдХрд╛рд░, рдХреБрд▓: рдЕрдЬреНрдЮрд╛рдд рдЖрдХрд╛рд░) рдХреЛ /Users/niepig/.cache/huggingface/datasets/wmt16/ro-en рдкрд░ред/1.0.0/0d9fb3e814712c785176ad8cdb9f465fbe6479000ee6546725db30ad8a8b5f8a...


    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ| 225M/225M [00:18<00:00, 12.2MB/s]
    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ|23.5M/23.5M [00:16<00:00, 1.44MB/s]
    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ|38.7рдПрдо/38.7рдПрдо [00:03<00:00, 9.82рдПрдордмреА/рд╕реЗрдХрдВрдб]


    рдбреЗрдЯрд╛рд╕реЗрдЯ wmt16 рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рдФрд░ /Users/niepig/.cache/huggingface/datasets/wmt16/ro-en/1.0.0/0d9fb3e814712c785176ad8cdb9f465fbe6479000ee6546725db30ad8a8b5f8a рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛редрдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 5.40kB [00:00, 2.08MB/s]


рдпрд╣ рдбреЗрдЯрд╛рд╕реЗрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реНрд╡рдпрдВ рдПрдХ [`DatasetDict`](https://huggingface.co/docs/datasets/package_reference/main_classes.html#datasetdict) рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рд╣реИ, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ, рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдФрд░ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рд╕рдВрдмрдВрдзрд┐рдд рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреБрдВрдЬреА (рдЯреНрд░реЗрди, рд╕рддреНрдпрд╛рдкрди, рдкрд░реАрдХреНрд╖рдг) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред


```рдЕрдЬрдЧрд░
raw_datasets
```




    рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ({
        рдЯреНрд░реЗрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
            рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдЕрдиреБрд╡рд╛рдж'],
            num_rows: 610320
        })
        рд╕рддреНрдпрд╛рдкрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
            рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдЕрдиреБрд╡рд╛рдж'],
            num_rows: 1999})
        рдкрд░реАрдХреНрд╖рдг: рдбреЗрдЯрд╛рд╕реЗрдЯ({
            рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдЕрдиреБрд╡рд╛рдж'],
            num_rows: 1999
        })
    })



рдбреЗрдЯрд╛ рд╡рд┐рднрд╛рдЬрди рдХреБрдВрдЬреА (рдЯреНрд░реЗрди, рд╕рддреНрдпрд╛рдкрди, рдпрд╛ рдкрд░реАрдХреНрд╖рдг) рдФрд░ рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рджрд┐рдП рдЬрд╛рдиреЗ рдкрд░, рдЖрдк рдбреЗрдЯрд╛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред


```рдЕрдЬрдЧрд░
raw_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"][0]
# рд╣рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдЕрдВрдЧреНрд░реЗрдЬреА рдПрди рд╡рд╛рдХреНрдп рд░реЛрдорд╛рдирд┐рдпрд╛рдИ рднрд╛рд╖рд╛ рдЖрд░рдУ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ
```




    {'рдЕрдиреБрд╡рд╛рдж': {'рдПрди': 'рд╕рдВрд╕рдж рдХреА рд╕рджрд╕реНрдпрддрд╛: рдорд┐рдирдЯ рджреЗрдЦреЗрдВ',
      'ro': 'Componen┼гa Parlamentului: a se vedea procesul-verbal'}}



рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдбреЗрдЯрд╛ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ, рдирд┐рдореНрди рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рд╕реЗрдЯ рд╕реЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдХреБрдЫ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХрд╛ рдЪрдпрди рдХрд░реЗрдЧрд╛ред


```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдкрд╛рдВрдбрд╛ рдХреЛ рдкреАрдбреА рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ
IPython.displa рд╕реЗрдЖрдк рдбрд┐рд╕реНрдкреНрд▓реЗ, HTML рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ

def show_random_elements(рдбреЗрдЯрд╛рд╕реЗрдЯ, num_examples=5):
    assert num_examples <= len(рдбреЗрдЯрд╛рд╕реЗрдЯ), "рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдореМрдЬреВрдж рддрддреНрд╡реЛрдВ рд╕реЗ рдЕрдзрд┐рдХ рддрддреНрд╡ рдирд╣реАрдВ рдЪреБрди рд╕рдХрддреЗред"
    рдЪреБрдирддрд╛ рд╣реИ = []
    рд░реЗрдВрдЬ рдореЗрдВ _ рдХреЗ рд▓рд┐рдП (num_examples):
        рдкрд┐рдХ = рд░реИрдВрдбрдо.рд░реИрдВрдбрд┐рдВрдЯ(0, рд▓реЗрди(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
        рдЪрдпрди рдХрд░рддреЗ рд╕рдордп:
            рдкрд┐рдХ = рд░реИрдВрдбрдо.рд░реИрдВрдбрд┐рдВрдЯ(0, рд▓реЗрди(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
        рдЪреБрдирддрд╛ рд╣реИ.рдЬреЛрдбрд╝реЗрдВ(рдЪреБрдиреЗрдВ)
    
    рдбреАрдПрдл = рдкреАрдбреА.рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо(рдбреЗрдЯрд╛рд╕реЗрдЯ[рдЪреБрдирддрд╛ рд╣реИ])
    рдХреЙрд▓рдо рдХреЗ рд▓рд┐рдП, dataset.features.items() рдЯрд╛рдЗрдк рдХрд░реЗрдВ:
        рдпрджрд┐ isinstance(рдкреНрд░рдХрд╛рд░,рдбреЗрдЯрд╛рд╕реЗрдЯ.рдХреНрд▓рд╛рд╕рд▓реЗрдмрд▓):
            рдбреАрдПрдл[рдХреЙрд▓рдо] = рдбреАрдПрдл[рдХреЙрд▓рдо].рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо(рд▓реИрдореНрдмреНрдбрд╛ рдЖрдИ: рдЯрд╛рдЗрдк.рдирд╛рдо[рдЖрдИ])
    рдкреНрд░рджрд░реНрд╢рди(HTML(df.to_html()))
```


```рдЕрдЬрдЧрд░
show_random_elements(raw_datasets["рдЯреНрд░реЗрди"])
```


<рддрд╛рд▓рд┐рдХрд╛ рд╕реАрдорд╛ = "1" рд╡рд░реНрдЧ = "рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо">
  <рд╕рд┐рд░>
    <tr рд╢реИрд▓реА = "рдкрд╛рда-рд╕рдВрд░реЗрдЦрдг: рджрд╛рдПрдВ;">
      <рде></рде>
      <th>рдЕрдиреБрд╡рд╛рдж</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>{'en': 'рдореБрдЭреЗ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдпрд╣ рд╕рд╣реА рд░рд╛рд╕реНрддрд╛ рд╣реИред', 'ro': 'рдореБрдЭреЗ рдЗрд╕ рдмрд╛рдд рдХрд╛ рдкреВрд░рд╛ рднрд░реЛрд╕рд╛ рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рд╣реИред'}</td></tr>
    <tr>
      <th>1</th>
      <td>{'en': 'рдпреВрд░реЛрдкреАрдп рд░рд╕рд╛рдпрди рдПрдЬреЗрдВрд╕реА рдореЗрдВ рдХреБрд▓ 104 рдирдИ рдиреМрдХрд░рд┐рдпрд╛рдБ рд╕реГрдЬрд┐рдд рд╣реБрдИрдВ, рдЬреЛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд╣рдорд╛рд░реА REACH рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреА рджреЗрдЦрд░реЗрдЦ рдХрд░рддреА рд╣реИред', 'ro': 'рдПрдЬреЗрдВрд╕рд┐рдпрд╛ рдпреВрд░реЛрдкрд┐рдпрди рдкреЗрдВрдЯреНрд░реВ рдкреНрд░реЛрдбреНрдпреВрд╕ рдЪрд┐рдорд┐рд╕ рдореЗрдВ рдХреБрд▓ 104 рдирдИ рдиреМрдХрд░рд┐рдпрд╛рдБ рд╕реГрдЬрд┐рдд рд╣реБрдИрдВред , рджреЗрдЦрднрд╛рд▓, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рд╕реБрдкрд░рд╡реЗрдЧреЗрдЬрд╝ рдкреНрд░реЛрдЗрдХреНрдЯреЗрд▓реЗ рдиреЛрд╕реНрдЯреНрд░реЗ рд░реАрдЪред'}</td>
    </tr>
    <tr>
      <th>2</th>
      <td>{'en': 'рдЙрдкрд░реЛрдХреНрдд рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП, рдХреНрдпрд╛ рдкрд░рд┐рд╖рдж рдпрд╣ рдХрд╣реЗрдЧреА рдХрд┐ рд╕рдВрдпреБрдХреНрдд рдлреНрд░реЛрдВрдЯреЗрдХреНрд╕ рдСрдк рдореЗрдВ рддреБрд░реНрдХреА рдХреА рднрд╛рдЧреАрджрд╛рд░реА рдХреЗ рд▓рд┐рдП рдХрд┐рд╕ рдЪрд░рдг рдХреА рдЪрд░реНрдЪрд╛ рд╣реЛрдЧреА?рдпреБрдЧ рдкрд╣реБрдБрдЪ рдЧрдП рд╣реИрдВ?
    </tr>
    <tr>
      <рде>3</рде>
      <td>{'en': 'рдЕрдм рд╣рдореЗрдВ рдбрд░ рд╣реИ рдХрд┐ рдпрджрд┐ рдЗрд╕ рдирд┐рд░реНрджреЗрд╢ рдХрд╛ рджрд╛рдпрд░рд╛ рдмрдврд╝рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдирд┐рд░реНрджреЗрд╢ рдХрд╛ рд╡рд╣реА рд╣рд╢реНрд░ рд╣реЛрдЧрд╛ рдЬреЛ 'рдореЗрдб рдЗрди' рдореВрд▓ рдЕрдВрдХрди рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рдкрд┐рдЫрд▓реЗ рдкреНрд░рдпрд╛рд╕ рдХрд╛ рд╣реБрдЖ рдерд╛ - рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рдХрд┐ рдпрд╣ рд╣реЛрдЧрд╛ рдПрдХ рдмрд╛рд░ рдлрд┐рд░ рд╕реЗ рдХрд╛рдЙрдВрд╕рд┐рд▓ рджреНрд╡рд╛рд░рд╛ рдмреНрд▓реЙрдХ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛редрд╡реЗ рдЕрдкрдиреЗ рдПрдХреНрд╕рдЯреАрдиреНрд╕ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рдЯреАрдХ рд╕рдлрд▓рддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдВрддрд┐рдо рдЪрд░рдг рдореЗрдВ "рдореЗрдб рдЗрди" рдХреА рдЙрддреНрдкрддреНрддрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рдереЗ, рдЬрдм рддрдХ рдХрд┐ рд╡реЗ рдХрдВрд╕реАрд▓рд░ рдХреЛ рдмреНрд▓реЙрдХ рдирд╣реАрдВ рдХрд░рддреЗред'}</td>
    </tr>
    <tr>
      <рде>4</рде>
      <td>{'en': 'рджреЗрд╢ 6.58 рдХреЗ рд╕реНрдХреЛрд░ рдХреЗ рд╕рд╛рде рдиреМ рдкрд╛рдпрджрд╛рди рдЧрд┐рд░рдХрд░ 85рд╡реЗрдВ рд╕реНрдерд╛рди рдкрд░ рдЖ рдЧрдпрд╛ред', 'ro': 'рд╕рд╛рд░рд╛ рдП рдХреЛрдмреЛрд░рд╛рдЯ рдиреВрдЖ рдкреЛрдЬрд╝реАрд╕реА, рдкреЗ рд▓реЛрдХреБрд▓ 85, рд╕реАрдпреВ рдЕрди рд╕реНрдХреЛрд░ рдбреЗ 6,58ред'} </td>
    </tr>
  </tbody>
</рддрд╛рд▓рд┐рдХрд╛>


рдореАрдЯреНрд░рд┐рдХ рд╣реИ [`datasets.Metric`](https://huggingface.co/docs/datasets/package_reference/main_classes.html#datasets.Metric) рд╡рд░реНрдЧ, рдореАрдЯреНрд░рд┐рдХ рдФрд░ рдЙрдкрдпреЛрдЧ рдХреЗ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ:


```рдЕрдЬрдЧрд░
рдореАрдЯреНрд░рд┐рдХ
```




    рдореАрдЯреНрд░рд┐рдХ(рдирд╛рдо: "рд╕реИрдХреНрд░реЗрдмреНрд▓реВ", рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ: {'рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ': рдорд╛рди(dtype='string', id='рдЕрдиреБрдХреНрд░рдо'), 'рд╕рдВрджрд░реНрдн': рдЕрдиреБрдХреНрд░рдо(рд╕реБрд╡рд┐рдзрд╛=рдорд╛рди(dtype='string', id='рдЕрдиреБрдХреНрд░рдо '), рд▓рдВрдмрд╛рдИ=-1, рдЖрдИрдбреА='рд╕рдВрджрд░реНрдн')}, рдЙрдкрдпреЛрдЧ: """
    рдЕрдкрдиреЗ рдкрд░реНрдпрд╛рдкреНрдд рдЖрдБрдХрдбрд╝реЛрдВ рдХреЗ рд╕рд╛рде BLEU рд╕реНрдХреЛрд░ рддреИрдпрд╛рд░ рдХрд░рддрд╛ рд╣реИ
    рдПрдХ рд╕реНрд░реЛрдд рд╕реЗ рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ рд╕рдВрджрд░реНрднреЛрдВ рдХреЗ рд╡рд┐рд░реБрджреНрдзред
    
    рддрд░реНрдХ:
        рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ: рд╕рд┐рд╕реНрдЯрдо рд╕реНрдЯреНрд░реАрдо (рдЦрдВрдбреЛрдВ рдХрд╛ рдПрдХ рдХреНрд░рдо)
        рд╕рдиреНрджрд░реНрдн: рдП рд▓рд┐рд╕рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ рд╕рдВрджрд░реНрдн рдзрд╛рд░рд╛рдУрдВ рдХрд╛ рдЯреА (рдкреНрд░рддреНрдпреЗрдХ рдЦрдВрдбреЛрдВ рдХрд╛ рдПрдХ рдХреНрд░рдо)
        рд╕реНрдореВрде: рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдореВрдерд┐рдВрдЧ рд╡рд┐рдзрд┐
        рд╕реНрдореВрде_рд╡реИрд▓реНрдпреВ: 'рдлрд░реНрд╢' рд╕реНрдореВрдердирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП, рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдлрд░реНрд╢
        рдмрд▓: рдЙрд╕ рдбреЗрдЯрд╛ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░реЗрдВ рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЯреЛрдХрдирдпреБрдХреНрдд рджрд┐рдЦрддрд╛ рд╣реИ
        рд▓реЛрдЕрд░рдХреЗрд╕: рдбреЗрдЯрд╛ рдХреЛ рд▓реЛрдЕрд░рдХреЗрд╕ рдХрд░реЗрдВ
        рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝: рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░
    рд░рд┐рдЯрд░реНрди:
        'рд╕реНрдХреЛрд░': BLEU рд╕реНрдХреЛрд░,
        'рдЧрд┐рдирддреА': рдЧрд┐рдирддреА,
        'рдХреБрд▓': рдХреБрд▓,
        'рдкрд░рд┐рд╢реБрджреНрдзрддрд╛': рдкрд░рд┐рд╢реБрджреНрдзрддрд╛,
        'рдмреАрдкреА': рд╕рдВрдХреНрд╖рд┐рдкреНрддрддрд╛ рджрдВрдб,
        'sys_len': рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХреА рд▓рдВрдмрд╛рдИ,
        'ref_len': рд╕рдВрджрд░реНрдн рд▓рдВрдмрд╛рдИ,
    рдЙрджрд╛рд╣рд░рдг:
    
        >>> рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ = ["рд╣реИрд▓реЛ рдЬрдирд░рд▓ рдХреЗрдиреЛрдмреА", "рдлреВ рдмрд╛рд░ рдлреВрдмрд╛рд░"]
        >>> рд╕рдВрджрд░реНрдн = [["рд╣реИрд▓реЛ рдЬрдирд░рд▓ рдХреЗрдиреЛрдмреА", "рд╣реИрд▓реЛ рджреЗрдпрд░!"], ["рдлреВ рдмрд╛рд░ рдлреВрдмрд╛рд░", "рдлреВ рдмрд╛рд░ рдлреВрдмрд╛рд░"]]
        >>> sacrebleu = datasets.load_metric("sacrebleu")
        >>> рдкрд░рд┐рдгрд╛рдо = sacrebleu.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд╕рдВрджрд░реНрдн=рд╕рдВрджрд░реНрдн)
        >>> рдкреНрд░рд┐рдВрдЯ(рд╕реВрдЪреА(рдкрд░рд┐рдгрд╛рдо.рдХреБрдВрдЬрд┐рдпрд╛рдБ()))
        ['рд╕реНрдХреЛрд░', 'рдЧрд┐рдирддреА', 'рдХреБрд▓', 'рдкрд░рд┐рд╢реБрджреНрдзрддрд╛', 'рдмреАрдкреА', 'sys_len','рд░реЗрдл_рд▓реЗрди']
        >>> рдкреНрд░рд┐рдВрдЯ(рд░рд╛рдЙрдВрдб(рдкрд░рд┐рдгрд╛рдо["рд╕реНрдХреЛрд░"], 1))
        100.0
    """, рд╕рдВрдЧреНрд░рд╣реАрдд рдЙрджрд╛рд╣рд░рдг: 0)



рд╣рдо рд╕реНрдХреЛрд░ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдиреЛрдВ рдФрд░ рд▓реЗрдмрд▓реЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `рдЧрдгрдирд╛` рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдФрд░ рд▓реЗрдмрд▓ рджреЛрдиреЛрдВ рдХреЛ рдПрдХ рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рд╛рд░реВрдк рдХреЗ рд▓рд┐рдП рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ:


```рдЕрдЬрдЧрд░
рдлреЗрдХ_рдкреНрд░реЗрдбреНрд╕ = ["рд╣реИрд▓реЛ рджреЗрдпрд░", "рдЬрдирд░рд▓ рдХреЗрдиреЛрдмреА"]
рдлреЗрдХ_рд▓реЗрдмрд▓реНрд╕ = [["рд╣реИрд▓реЛ рджреЗрдпрд░"], ["рдЬрдирд░рд▓ рдХреЗрдиреЛрдмреА"]]
metric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рдирдХрд▓реА_рдкреНрд░реЗрдб, рд╕рдВрджрд░реНрдн=рдирдХрд▓реА_рд▓реЗрдмрд▓)
```




    {'рд╕реНрдХреЛрд░': 0.0,
     'рдЧрд┐рдирддреА': [4, 2, 0, 0],
     'рдХреБрд▓': [4, 2, 0, 0],
     'рдкрд░рд┐рд╢реБрджреНрдзрддрд╛': [100.0, 100.0, 0.0, 0.0],
     'рдмреАрдкреА': 1.0,
     'sys_len': 4,
     'рд░реЗрдл_рд▓реЗрди': 4}



## рдбреЗрдЯрд╛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ

рдореЙрдбрд▓ рдореЗрдВ рдбреЗрдЯрд╛ рдлреАрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЯреВрд▓ рдХреЛ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдкрд╣рд▓реЗ рдЗрдирдкреБрдЯ рдХреЛ рдЯреЛрдХрдирд╛рдЗрдЬрд╝ рдХрд░рддрд╛ рд╣реИ, рдлрд┐рд░ рдЯреЛрдХрди рдХреЛ рдкреНрд░реА-рдореЙрдбрд▓ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╕рдВрдмрдВрдзрд┐рдд рдЯреЛрдХрди рдЖрдИрдбреА рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИред

рдбреЗрдЯрд╛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЕрдкрдиреЗ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП AutoTokenizer.from_pretrained рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ:

- рд╣рдореЗрдВ рдПрдХ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдорд┐рд▓рддрд╛ рд╣реИ рдЬреЛ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рд╡рди-рдЯреВ-рд╡рди рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред
- рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рдЕрдиреБрд░реВрдк рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рд╣рдо рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рд╢рдмреНрджрд╛рд╡рд▓реА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рднреА рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ, рд╕рдЯреАрдХ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдЯреЛрдХрди рд╢рдмреНрджрд╛рд╡рд▓реАред


рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЧрдП рдЯреЛрдХрди рд╢рдмреНрджрд╛рд╡рд▓реА рдХреЛ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддрд╛рдХрд┐ рджреЛрдмрд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдкрд░ рдЗрд╕реЗ рджреЛрдмрд╛рд░рд╛ рдбрд╛рдЙрдирд▓реЛрдб рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред


```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ
# `рд╕реЗрдВрдЯреЗрдВрд╕рдкреАрд╕` рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛: рдкрд┐рдк рдЗрдВрд╕реНрдЯреЙрд▓ рд╕реЗрдВрдЯреЗрдирд╕реЗрдкреАрд╕
    
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(model_checkpoint)
```

    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ| 1.13k/1.13k [00:00<00:00, 466kB/s]
    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ|789k/789k [00:00<00:00, 882kB/s]
    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ|817k/817k [00:00<00:00, 902kB/s]
    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ| 1.39M/1.39M [00:01<00:00, 1.24MB/s]
    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ|42.0/42.0 [00:00<00:00, 14.6kB/s]


рдЙрджрд╛рд╣рд░рдг рдХреЗ рддреМрд░ рдкрд░ рд╣рдо рдЬрд┐рд╕ mBART рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЙрд╕реЗ рд▓реЗрддреЗ рд╣реБрдП рд╣рдореЗрдВ рд╕реНрд░реЛрдд рднрд╛рд╖рд╛ рдФрд░ рд▓рдХреНрд╖реНрдп рднрд╛рд╖рд╛ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдк рдЕрдиреНрдп рджреНрд╡рд┐рднрд╛рд╖реА рдХреЙрд░реНрдкреЛрд░рд╛ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдХреГрдкрдпрд╛ [рдпрд╣рд╛рдВ] (https://huggin) рджреЗрдЦреЗрдВgface.co/facebook/mbart-large-cc25)ред рд╣рдо рд╕реНрд░реЛрдд рдФрд░ рд▓рдХреНрд╖реНрдп рднрд╛рд╖рд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреА рдЬрд╛рдБрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:



```рдЕрдЬрдЧрд░
рдпрджрд┐ model_checkpoint рдореЗрдВ "mbart":
    рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░.src_lang = "en-XX"
    рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░.tgt_lang = "ro-RO"
```



рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдпрд╛ рддреЛ рдПрдХ рдЯреЗрдХреНрд╕реНрдЯ рдпрд╛ рдЯреЗрдХреНрд╕реНрдЯ рдХреА рдПрдХ рдЬреЛрдбрд╝реА рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рдж рдкреНрд░рд╛рдкреНрдд рдбреЗрдЯрд╛ рдкреНрд░реА-рдЯреНрд░реЗрдирд┐рдВрдЧ рдореЙрдбрд▓ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рд╕реЗ рдорд┐рд▓рддрд╛ рд╣реИред


```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ ("рд╣реИрд▓реЛ, рдпрд╣ рдПрдХ рд╡рд╛рдХреНрдп!")
```




    {'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [125, 778, 3, 63, 141, 9191, 23, 0], 'рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ': [1, 1, 1, 1, 1, 1, 1, 1]}



рдКрдкрд░ рджреЗрдЦреА рдЧрдИ рдЯреЛрдХрди рдЖрдИрдбреА, рдЬреЛ рдХрд┐ рдЗрдирдкреБрдЯ_рдЖрдИрдбреА рд╣реИрдВ, рдЖрдо рддреМрд░ рдкрд░ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдирд╛рдо рдХреЗ рд╕рд╛рде рдмрджрд▓рддреА рд░рд╣рддреА рд╣реИрдВред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рд╡рд┐рднрд┐рдиреНрди рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдореЙрдбрд▓ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдЕрд▓рдЧ-рдЕрд▓рдЧ рдирд┐рдпрдо рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рдЬрдм рддрдХ рдЯреЛрдХрдирдирд╛рдЗрдЬрд░ рдФрд░ рдореЛрдб рд╣реИрдпрджрд┐ рдПрд▓ рдХреЗ рдирд╛рдо рд╕реБрд╕рдВрдЧрдд рд╣реИрдВ, рддреЛ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рдкреВрд░реНрд╡-рд╕рдВрд╕рд╛рдзрд┐рдд рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рдореЙрдбрд▓ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░реЗрдЧрд╛ред рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдХреГрдкрдпрд╛ [рдпрд╣ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓](https://huggingface.co/transformers/preprocessing.html) рджреЗрдЦреЗрдВ

рдХрд┐рд╕реА рд╡рд╛рдХреНрдп рдХреЛ рдЯреЛрдХрдирд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рд╡рд╛рдХреНрдпреЛрдВ рдХреА рд╕реВрдЪреА рдХреЛ рднреА рдЯреЛрдХрдирд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред


```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░(["рд╣реИрд▓реЛ, рдпрд╣ рдПрдХ рд╡рд╛рдХреНрдп!", "рдпрд╣ рдПрдХ рдФрд░ рд╡рд╛рдХреНрдп рд╣реИред"])
```




    {'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [[125, 778, 3, 63, 141, 9191, 23, 0], [187, 32, 716, 9191, 2, 0]], 'рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ': [[1, 1, 1 , 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1]]}



рдиреЛрдЯ: рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд╡рд╛рджрд┐рдд рд▓рдХреНрд╖реНрдп рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд▓рдХреНрд╖реНрдп рдХреЗ рдЕрдиреБрд░реВрдк рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `as_target_tokenizer` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░.as_ta рдХреЗ рд╕рд╛рдеrget_tokenizer():
    рдкреНрд░рд┐рдВрдЯ (рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ ("рд╣реИрд▓реЛ, рдпрд╣ рдПрдХ рд╡рд╛рдХреНрдп!"))
    рдореЙрдбрд▓_рдЗрдирдкреБрдЯ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ ("рд╣реИрд▓реЛ, рдпрд╣ рдПрдХ рд╡рд╛рдХреНрдп!")
    рдЯреЛрдХрди = рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░.рдХрдиреНрд╡рд░реНрдЯ_рдЖрдИрдбреНрд╕_рдЯреВ_рдЯреЛрдХрдиреНрд╕(рдореЙрдбрд▓_рдЗрдирдкреБрдЯ['рдЗрдирдкреБрдЯ_рдЖрдИрдбреНрд╕'])
    # рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ рдФрд░ рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди рджреЗрдЦреЗрдВ
    рдкреНрд░рд┐рдВрдЯ('рдЯреЛрдХрди: {}'.рдкреНрд░рд╛рд░реВрдк(рдЯреЛрдХрди))
```

    {'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [10334, 1204, 3, 15, 8915, 27, 452, 59, 29579, 581, 23, 0], 'рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
    рдЯреЛрдХрди: ['рд╣реЗрд▓', 'рд▓реЛ', ',', '', 'рджрд┐рд╕', 'рдУ', 'рдиреЗ', 'рд╕реЗ', 'рдПрдирдЯреЗрди', 'рд╕реАрдИ', '!', '</s >']


рдпрджрд┐ рдЖрдк T5 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВрдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓реЛрдВ рдХреЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдХреЛ рд╡рд┐рд╢реЗрд╖ рдЙрдкрд╕рд░реНрдЧреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред T5 рдореЙрдбрд▓ рдХреЛ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдмрддрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рдЙрдкрд╕рд░реНрдЧреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрд╕рд░реНрдЧреЛрдВ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИрдВ:



```рдЕрдЬрдЧрд░
рдпрджрд┐ рдореЙрдбрд▓_рдЪреЗрдХрдкреЙрдЗрдВрдЯ ["t5-small", "t5-base", "t5-larg", "t5-3b", "t5-11b"] рдореЗрдВ:
    рдЙрдкрд╕рд░реНрдЧ = "рдЕрдВрдЧреНрд░реЗрдЬреА рд╕реЗ рд░реЛрдорд╛рдирд┐рдпрд╛рдИ рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░реЗрдВ:"
рдЕрдиреНрдп:
    рдЙрдкрд╕рд░реНрдЧ = ""
```

рдЕрдм рд╣рдо рдЕрдкрдирд╛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд░ рдлрд╝рдВрдХреНрд╢рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдм рдХреБрдЫ рдПрдХ рд╕рд╛рде рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВред рдЬрдм рд╣рдо рдирдореВрдиреЗ рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `truncation=True` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдХрд┐ рд╣рдорд╛рд░реЗ рдЕрддреНрдпрдзрд┐рдХ рд▓рдВрдмреЗ рд╡рд╛рдХреНрдпреЛрдВ рдХреЛ рдЫреЛрдЯрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рд╣рдо рдЫреЛрдЯреЗ рд╡рд╛рдХреНрдпреЛрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкреИрдб рдХрд░ рджреЗрдВрдЧреЗред


```рдЕрдЬрдЧрд░
рдЕрдзрд┐рдХрддрдо_рдЗрдирдкреБрдЯ_рд▓рдВрдмрд╛рдИ = 128
рдЕрдзрд┐рдХрддрдо_рд▓рдХреНрд╖реНрдп_рд▓рдВрдмрд╛рдИ = 128
source_lang = "рдПрди"
рд▓рдХреНрд╖реНрдп_рд▓реИрдВрдЧ = "рдЖрд░рдУ"

рдбреАрдИрдПрдлрд╝ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕_рдлрдВрдХреНрд╢рди(рдЙрджрд╛рд╣рд░рдг):
    рдЗрдирдкреБрдЯреНрд╕ = [рдЙрдкрд╕рд░реНрдЧ + рдкреВрд░реНрд╡[рд╕реНрд░реЛрддe_lang] рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рдкреВрд░реНрд╡ рдХреЗ рд▓рд┐рдП["рдЕрдиреБрд╡рд╛рдж"]]
    рд▓рдХреНрд╖реНрдп = [рдЙрджрд╛[target_lang] рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рдкреВрд░реНрд╡ рдХреЗ рд▓рд┐рдП["рдЕрдиреБрд╡рд╛рдж"]]
    model_inputs = рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ (рдЗрдирдкреБрдЯ, max_length=max_input_length, рдЯреНрд░рдВрдХреЗрд╢рди=True)

    # рд▓рдХреНрд╖реНрдп рдХреЗ рд▓рд┐рдП рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рд╕реЗрдЯрдЕрдк рдХрд░реЗрдВ
    рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░.as_target_tokenizer() рдХреЗ рд╕рд╛рде:
        рд▓реЗрдмрд▓ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ (рд▓рдХреНрд╖реНрдп, рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ = рдЕрдзрд┐рдХрддрдо рд▓рдХреНрд╖реНрдп_ рд▓рдВрдмрд╛рдИ, рдХрд╛рдЯ-рдЫрд╛рдБрдЯ = рд╕рддреНрдп)

    model_inputs["рд▓реЗрдмрд▓"] = рд▓реЗрдмрд▓["input_ids"]
    рдореЙрдбрд▓_рдЗрдирдкреБрдЯ рд▓реМрдЯрд╛рдПрдВ
```

рдЙрдкрд░реЛрдХреНрдд рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдПрдХ рдирдореВрдирд╛ рдпрд╛ рдПрдХрд╛рдзрд┐рдХ рдирдореВрдирд╛ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдХрдИ рдирдореВрдиреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХрдИ рдирдореВрдиреЛрдВ рдХреЗ рдкреВрд░реНрд╡-рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдкрд░рд┐рдгрд╛рдо рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИредрдЕрдиреБрд╕реВрдЪрд┐рдд рдЬрдирдЬрд╛рддрд┐ред


```рдЕрдЬрдЧрд░
рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕_рдлрдВрдХреНрд╢рди(рдХрдЪреНрдЪрд╛_рдбреЗрдЯрд╛рд╕реЗрдЯ['рдЯреНрд░реЗрди'][:2])
```




    {'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [[393, 4462, 14, 1137, 53, 216, 28636, 0], [24385, 14, 28636, 14, 4646, 4622, 53, 216, 28636, 0]], 'рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ' : [[1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]], 'рд▓реЗрдмрд▓': [[42140 , 494, 1750, 53, 8, 59, 903, 3543, 9, 15202, 0], [36199, 6612, 9, 15202, 122, 568, 35788, 21549, 53, 8, 59, 903, 3543, 9 , 15202, 0]]}



рдЗрд╕рдХреЗ рдмрд╛рдж, рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рд╕рднреА рдирдореВрдиреЛрдВ рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░реЗрдВред рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рд╡рд┐рдзрд┐ рдореИрдк рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдФрд░ рд╕рднреА (рдореИрдк) рдкрд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рд┐рдкреЗрдпрд░_рдЯреНрд░реЗрди_рдлреАрдЪрд░реНрд╕ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рд╣реИрдирдореВрдиреЗ рдкрд░.


```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ = raw_datasets.map(рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕_рдлрд╝рдВрдХреНрд╢рди, рдмреИрдЪ = рд╕рд╣реА)
```

    100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ|611/611 [02:32<00:00, 3.99ba/s]
    100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ|2/2 [00:00<00:00, 3.76ba/s]
    100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ| 2/2 [00:00<00:00, 3.89ba/s]


рдЗрд╕рд╕реЗ рднреА рдмреЗрд╣рддрд░, рдЕрдЧрд▓реА рдмрд╛рд░ рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрдиреЗ рдкрд░ рдкреБрдирд░реНрдЧрдгрдирд╛ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд▓реМрдЯрд╛рдП рдЧрдП рдкрд░рд┐рдгрд╛рдо рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХреИрд╢ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ (рд▓реЗрдХрд┐рди рдХреГрдкрдпрд╛ рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЗрдирдкреБрдЯ рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдХреИрд╢ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ!)ред рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдлрд╝рдВрдХреНрд╢рди рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдкрд░рд┐рд╡рд░реНрддрди рд╣реИрдВред рдпрджрд┐ рдХреЛрдИ рдкрд░рд┐рд╡рд░реНрддрди рдирд╣реАрдВ рд╣реИрдВ, рддреЛ рдХреИрд╢реНрдб рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрджрд┐ рдкрд░рд┐рд╡рд░реНрддрди рд╣реИрдВ, рддреЛ рдбреЗрдЯрд╛ рдХреЛ рдкреБрди: рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рд▓реЗрдХрд┐рди рдпрджрд┐ рдЗрдирдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рд░рд╣рддреЗ рд╣реИрдВ рдФрд░ рдЖрдк рдЗрдирдкреБрдЯ рдмрджрд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдХреИрд╢ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░рдирд╛ рдФрд░ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдирд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╣реИред рд╕рд╛рдлрд╝ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ `load_from_cache_file=False` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдКрдкрд░ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ `рдмреИрдЪ = рдЯреНрд░реВ` рдкреИрд░рд╛рдореАрдЯрд░ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреА рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╕рдорд╛рдирд╛рдВрддрд░ рдореЗрдВ рдЗрдирдкреБрдЯ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдереНрд░реЗрдбреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

## рд╕реВрдХреНрд╖реНрдордЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВ

рдЕрдм рдЬрдм рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рд╣реЛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ рдЕрдкрдиреЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдФрд░ рдлрд┐рд░ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдЪреВрдБрдХрд┐ рд╣рдо seq2seq рдХрд╛рд░реНрдп рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рд╣рдореЗрдВ рдПрдХ рдореЙрдбрд▓ рд╡рд░реНрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рдЗрд╕ рдХрд╛рд░реНрдп рдХреЛ рд╣рд▓ рдХрд░ рд╕рдХреЗред рд╣рдо рд╡рд░реНрдЧ `AutoModelForSeq2SeqLM` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЗ рд╕рдорд╛рди, `from_pretrained` рд╡рд┐рдзрд┐ рднреА рд╣рдореЗрдВ рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреА рд╣реИ, рдпрд╣ рдореЙрдбрд▓ рдХреЛ рдХреИрд╢ рднреА рдХрд░реЗрдЧреА рддрд╛рдХрд┐ рдореЙрдбрд▓ рдмрд╛рд░-рдмрд╛рд░ рдбрд╛рдЙрдирд▓реЛрдб рди рд╣реЛред


```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForSeq2SeqLM, DataCollatorForSeq2Seq, Seq2SeqTrainingArguments, Seq2SeqTrainer рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдореЙрдбрд▓ = AutoModelForSeq2SeqLM.from_pretrained(model_checkpoint)
```

    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ|301рдПрдо/301рдПрдо [00:19<00:00, 15.1рдПрдордмреА/рд╕реЗрдХрдВрдб]


рдЪреВрдБрдХрд┐ рд╣рдорд╛рд░рд╛ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд╛рд░реНрдп рдорд╢реАрдиреА рдЕрдиреБрд╡рд╛рдж рд╣реИ, рдФрд░ рд╣рдо рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд seq2seq рдореЙрдбрд▓ рдХреЛ рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ, рдпрд╣ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИрд╣рдореЗрдВ рдмрддрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ рдореЙрдбрд▓ рдХреЛ рд▓реЛрдб рдХрд░рддреЗ рд╕рдордп рдХреБрдЫ рдмреЗрдореЗрд▓ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рднрд╛рд╖рд╛ рдореЙрдбрд▓ рдХреЗ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдореБрдЦ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдорд╢реАрди рдЕрдиреБрд╡рд╛рдж рдХреЗ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдореБрдЦ рдХреЛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдЖрд░рдВрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛)ред


`Seq2SeqTrainer` рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЙрдкрдХрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ 3 рддрддреНрд╡реЛрдВ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрд┐рдВрдЧреНрд╕/рдкреИрд░рд╛рдореАрдЯрд░ [`Seq2SeqTrainingArguments`](https://huggingface.co/transformers/main_classes/trainer.html# рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░.Seq2SeqTrainingArguments)ред рдЗрд╕ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрд┐рдВрдЧ рдореЗрдВ рд╡реЗ рд╕рднреА рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреА рд╣реИрдВ


```рдЕрдЬрдЧрд░
рдмреИрдЪ_рдЖрдХрд╛рд░ = 16
рддрд░реНрдХ = Seq2SeqTrainingArguments(
    "рдкрд░реАрдХреНрд╖рдг-рдЕрдиреБрд╡рд╛рдж",
    рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ = "рдпреБрдЧ",
    рд╕реАрдЦрдиреЗ рдХреА рджрд░=2e-5,
    рдкреНрд░рддрд┐_рдбрд┐рд╡рд╛рдЗрд╕_рдЯреНрд░реЗрди_рдмреИрдЪ_рдЖрдХрд╛рд░=рдмреИрдЪ_рдЖрдХрд╛рд░,
    рдкреНрд░рддрд┐_рдбрд┐рд╡рд╛рдЗрд╕_eval_batch_sрдЖрдХрд╛рд░=рдмреИрдЪ_рдЖрдХрд╛рд░,
    рд╡рдЬрд╝рди_рдХреНрд╖рдп=0.01,
    save_total_limit=3,
    num_train_epochs=1,
    рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА_рд╕рд╛рде_рдЙрддреНрдкрдиреНрди=рд╕рддреНрдп,
    fp16=рдЧрд▓рдд,
)
```

рдЙрдкрд░реЛрдХреНрдд рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ = "рдпреБрдЧ" рдкреИрд░рд╛рдореАрдЯрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЛрдб рдмрддрд╛рддрд╛ рд╣реИ: рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдпреБрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рддреНрдпрд╛рдкрди рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВрдЧреЗред

рдЙрдкрд░реЛрдХреНрдд рдмреИрдЪ_рдЖрдХрд╛рд░ рдЗрд╕ рдиреЛрдЯрдмреБрдХ рд╕реЗ рдкрд╣рд▓реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

рдЪреВрдБрдХрд┐ рд╣рдорд╛рд░рд╛ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдмрдбрд╝рд╛ рд╣реИ рдФрд░ `Seq2SeqTrainer` рдореЙрдбрд▓реЛрдВ рдХреЛ рд╕рд╣реЗрдЬрдирд╛ рдЬрд╛рд░реА рд░рдЦреЗрдЧрд╛, рд╣рдореЗрдВ рдЗрд╕реЗ рдЕрдзрд┐рдХрддрдо `save_total_limit=3` рдореЙрдбрд▓реЛрдВ рдХреЛ рд╕рд╣реЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рдирд╛ рд╣реЛрдЧрд╛ред

рдЕрдВрдд рдореЗрдВ, рд╣рдореЗрдВ рдЕрдкрдиреЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдЗрдирдкреБрдЯ рдХреЛ рдореЙрдбрд▓ рдореЗрдВ рдлреАрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдбреЗрдЯрд╛ рдХреЛрд▓реЗрдЯрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред


```рдЕрдЬрдЧрд░
data_colllator = DataCollatorForSeq2Seq(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░, рдореЙрдбрд▓=рдореЙрдбрд▓)
```

`Seq2SeqTrainer` рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рдмрд╛рдж рдПрдХ рдЖрдЦрд┐рд░реА рдХрд╛рдо рдмрдЪрд╛ рд╣реИ, рд╡рд╣ рдпрд╣ рд╣реИ рдХрд┐ рд╣рдореЗрдВ рдореВрд▓реНрдпрд╛рдВрдХрди рдкрджреНрдзрддрд┐ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд╣рдо рдореВрд▓реНрдпрд╛рдВрдХрди рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `рдореАрдЯреНрд░рд┐рдХ` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдореЙрдбрд▓ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рднреЗрдЬреЗрдВрдореВрд▓реНрдпрд╛рдВрдХрди рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдХреБрдЫ рдбреЗрдЯрд╛ рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рднреА рдХрд░реЗрдВрдЧреЗ:


```рдЕрдЬрдЧрд░
рдПрдирдкреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реБрдиреНрди рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдбреАрдИрдПрдлрд╝ рдкреЛрд╕реНрдЯрдкреНрд░реЛрд╕реЗрд╕_рдЯреЗрдХреНрд╕реНрдЯ(рдкреНрд░реАрдбреНрд╕, рд▓реЗрдмрд▓реНрд╕):
    рдкреНрд░реАрдбреНрд╕ = [рдкреНрд░реАрдбреНрд╕ рдореЗрдВ рдкреНрд░реАрдб рдХреЗ рд▓рд┐рдП рдкреНрд░реАрдб.рд╕реНрдЯреНрд░рд┐рдк()]
    рд▓реЗрдмрд▓ = [[рд▓реЗрдмрд▓.рд╕реНрдЯреНрд░рд┐рдк()] рд▓реЗрдмрд▓ рдореЗрдВ рд▓реЗрдмрд▓ рдХреЗ рд▓рд┐рдП]

    рд░рд┐рдЯрд░реНрди рдкреНрд░реАрдбреНрд╕, рд▓реЗрдмрд▓

рдбреАрдИрдПрдлрд╝ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕(eval_preds):
    рдкреНрд░реАрдбреНрд╕, рд▓реЗрдмрд▓реНрд╕ = eval_preds
    рдпрджрд┐ isinstance(preds, tuple):
        рдкреНрд░реАрдбреНрд╕ = рдкреНрд░реАрдбреНрд╕[0]
    рдбрд┐рдХреЛрдбреЗрдб_рдкреНрд░реЗрдбреНрд╕ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд░.рдмреИрдЪ_рдбреАрдХреЛрдб(рдкреНрд░реАрдбреНрд╕, рд╕реНрдХрд┐рдк_рд╕реНрдкреЗрд╢рд▓_рдЯреЛрдХреЗрдВрд╕=рдЯреНрд░реВ)

    # рд▓реЗрдмрд▓ рдореЗрдВ -100 рдмрджрд▓реЗрдВ рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдЙрдиреНрд╣реЗрдВ рдбрд┐рдХреЛрдб рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред
    рд▓реЗрдмрд▓ = рдПрдирдкреА.рд╡реНрд╣реЗрдпрд░(рд▓реЗрдмрд▓ !=-100, рд▓реЗрдмрд▓, рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░.рдкреИрдб_рдЯреЛрдХрди_рдЖрдИрдбреА)
    рдбрд┐рдХреЛрдбреЗрдб_рд▓реЗрдмрд▓реНрд╕ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд░.рдмреИрдЪ_рдбреАрдХреЛрдб(рд▓реЗрдмрд▓реНрд╕, рд╕реНрдХрд┐рдк_рд╕реНрдкреЗрд╢рд▓_рдЯреЛрдХреЗрдВрд╕=рдЯреНрд░реВ)

    # рдХреБрдЫ рд╕рд░рд▓ рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ
    рдбрд┐рдХреЛрдбреЗрдб_рдкреНрд░реЗрдбреНрд╕, рдбрд┐рдХреЛрдбреЗрдб_рд▓реЗрдмрд▓реНрд╕ = рдкреЛрд╕реНрдЯрдкреНрд░реЛрд╕реЗрд╕_рдЯреЗрдХреНрд╕реНрдЯ(рдбрд┐рдХреЛрдбреЗрдб_рдкреНрд░реЗрдбреНрд╕, рдбрд┐рдХреЛрдбреЗрдб_рд▓реЗрдмрд▓реНрд╕)

    рдкрд░рд┐рдгрд╛рдо = metric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рдбреАрдХреЛрдбреЗрдб_рдкреНрд░реАрдбреНрд╕, рд╕рдВрджрд░реНрдн=рдбреАрдХреЛрдбреЗрдб_рд▓реЗрдмрд▓реНрд╕)
    рдкрд░рд┐рдгрд╛рдо = {"рдмреНрд▓реВ": рдкрд░рд┐рдгрд╛рдо["рд╕реНрдХреЛрд░"]}

    Prediction_lens = [np.count_nonzero(pred != рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░.pad_token_id) for pred in preds]
    рдкрд░рд┐рдгрд╛рдо["gen_len"] = np.mean(prediction_lens)рдкрд░рд┐рдгрд╛рдо = {k: рд░рд╛рдЙрдВрдб(v, 4) for k, v in result.items()}
    рд╡рд╛рдкрд╕реА рдкрд░рд┐рдгрд╛рдо
```

рдЕрдВрдд рдореЗрдВ, рд╕рднреА рдкреИрд░рд╛рдореАрдЯрд░/рдбреЗрдЯрд╛/рдореЙрдбрд▓ рдХреЛ `Seq2SeqTrainer` рдкрд░ рдкрд╛рд╕ рдХрд░реЗрдВ


```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░ = Seq2SeqTrainer(
    рдирдореВрдирд╛,
    рддрд░реНрдХ,
    рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
    eval_dataset=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"],
    рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░=рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░,
    рдЯреЛрдХрдирдирд╛рдЗрдЬрд░=рдЯреЛрдХрдирд╛рдЗрдЬрд░,
    рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ = рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕
)
```

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП `рдЯреНрд░реЗрди` рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВред


```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```

рдЕрдВрдд рдореЗрдВ, рдпрд╣ рджреЗрдЦрдирд╛ рди рднреВрд▓реЗрдВ рдХрд┐ рдореЙрдбрд▓ рдХреИрд╕реЗ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдореЙрдбрд▓ рдХреЛ рдпрд╣рд╛рдВ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ](https://huggingface.co/transformers/model_sharing.htmрдПрд▓) [ЁЯдЧрдореЙрдбрд▓ рд╣рдм](https://huggingface.co/models) рдкрд░ рдЬрд╛рдПрдВред рдлрд┐рд░ рдЖрдк рдореЙрдбрд▓ рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реАрдзреЗ рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдЖрдкрдиреЗ рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдХрд┐рдпрд╛ рдерд╛ред



```рдЕрдЬрдЧрд░

```