рдЗрд╕ рд▓реЗрдЦ рдХреЗ рд▓рд┐рдП рд╕рдВрджрд░реНрдн рд╕рд╛рдордЧреНрд░реА [рд╣рдЧрд┐рдВрдЧ рдлреЗрд╕ рд╣реЛрдордкреЗрдЬ] (https://huggingface.co/) рдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдкрд╛рдареНрдпрдХреНрд░рдо рд╣реИред рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдХреБрдЫ рдЕрдВрд╢ рдЙрджреНрдзреГрдд рдФрд░ рдЯрд┐рдкреНрдкрдгреА рдХреА рдЧрдИ рд╣реИ (рдмреЛрд▓реНрдб рдФрд░ рдЗрдЯреИрд▓рд┐рдХрд╛рдЗрдЬрд╝реНрдб), рдФрд░ рдЯреНрд░реЗрдирд░ рдФрд░ рдЖрд░реНрдЧреНрд╕ рдХреЗ рдореБрдЦреНрдп рдкреИрд░рд╛рдореАрдЯрд░ред рдХрд╛ рднреА рдкрд░рд┐рдЪрдп рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрдЪреНрдЫреБрдХ рдЫрд╛рддреНрд░ [рдореВрд▓ рдкрд╛рда](https://huggingface.co/course/chapter1) рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
****
рдЗрд╕ рдЕрдзреНрдпрд╛рдп рдХреА рдореБрдЦреНрдп рд╕рд╛рдордЧреНрд░реА рдореЗрдВ рджреЛ рднрд╛рдЧ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:
- рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдЯреВрд▓ рдПрдирдПрд▓рдкреА рдХрд╛рд░реНрдп рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ
- рдЯреНрд░реЗрдирд░ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдореЙрдбрд▓ рдмрдирд╛рдПрдВ<br>

рд╡рд┐рд╖рдпрд╕реВрдЪреА
- [1. рдкрд░рд┐рдЪрдп](#1--рдкрд░рд┐рдЪрдп)
  - [рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕](#рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕)
  - [рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдФрд░ рдЪреМрдХрд┐рдпрд╛рдВ](#рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдФрд░ рдЪреМрдХрд┐рдпрд╛рдВ)
  - [рдЕрдиреБрдорд╛рди рдПрдкреАрдЖрдИ](#рдж-рдЕрдиреБрдорд╛рди-рдПрдкреАрдЖрдИ)
- [2. рдПрдирдПрд▓рдкреА рд╕рдорд╕реНрдпрд╛рдУрдВ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ] (#2-рдПрдирдПрд▓рдкреА рд╕рдорд╕реНрдпрд╛рдУрдВ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ)
- [3. рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рдкреАрдЫреЗ](#3-рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рдкреАрдЫреЗ)
  - [рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд░рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ](#рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ)
  - [рдореЙрдбрд▓ рдЪреБрдиреЗрдВ](#рдореЙрдбрд▓ рдЪреБрдиреЗрдВ)
  - [рдореЙрдбрд▓ рдкреНрд░рдореБрдЦ](#рдореЙрдбрд▓-рдкреНрд░рдореБрдЦ)
  - [рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ](#рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ)
- [4. рдмрд┐рд▓реНрдб рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдкреНрд░реА-рдЯреНрд░реЗрдирд┐рдВрдЧ рдореЙрдбрд▓] (#4-рдмрд┐рд▓реНрдб рдЯреНрд░реЗрдирд░-рдПрдкреАрдЖрдИ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдкреНрд░реА-рдЯреНрд░реЗрдирд┐рдВрдЧ рдореЙрдбрд▓)
  - [рд╣рдм рд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ](#рд╣рдм рд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ)
  - [рдбреЗрдЯрд╛рд╕реЗрдЯ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ](#рдбреЗрдЯрд╛рд╕реЗрдЯ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ)
  - [PyTorch рдореЗрдВ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ](#pytorch рдореЗрдВ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ-)
    - [рдкреНрд░рд╢рд┐рдХреНрд╖рдг](#рдкреНрд░рд╢рд┐рдХреНрд╖рдг)
    - [рдореВрд▓реНрдпрд╛рдВрдХрди рд╕рдорд╛рд░реЛрд╣](#рдореВрд▓реНрдпрд╛рдВрдХрди рд╕рдорд╛рд░реЛрд╣)
- [5. рдЕрдиреБрдкреВрд░рдХ рднрд╛рдЧ](#5-рдкреВрд░рдХ рднрд╛рдЧ)
  - [рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреЗ рдЕрдзреНрдпрд╛рдп 4 рдореЗрдВ рдореЙрдбрд▓ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ? ](#рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХрд╛ рдЕрдзреНрдпрд╛рдп 4 рдореЙрдбрд▓ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдХрд░рддрд╛ рд╣реИ)
  - [рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдореБрдЦреНрдп рдкреИрд░рд╛рдореАрдЯрд░](# рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдореБрдЦреНрдп рдкреИрд░рд╛рдореАрдЯрд░)
  - [рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓ рд▓реЛрдбрд┐рдВрдЧ рд╡рд┐рдзрд┐рдпрд╛рдВ](#рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓ рд▓реЛрдбрд┐рдВрдЧ рд╡рд┐рдзрд┐рдпрд╛рдВ)
  - [рдбрд╛рдпрдирд╛рдорд╛рдЗрдХ рдкреИрдбрд┐рдВрдЧтАФтАФрдбрд╛рдпрдирд╛рдорд┐рдХ рдлрд╝рд┐рд▓рд┐рдВрдЧ рддрдХрдиреАрдХ](#рдбрд╛рдпрдирд╛рдорд┐рдХ-рдкреИрдбрд┐рдВрдЧ рдбрд╛рдпрдирд╛рдорд┐рдХ рдлрд╝рд┐рд▓рд┐рдВрдЧ рддрдХрдиреАрдХ)
    
## 1 рдкрд░рд┐рдЪрдп
рдпрд╣ рдЕрдзреНрдпрд╛рдп рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг (рдПрдирдПрд▓рдкреА) рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [рд╣рдЧрд┐рдВрдЧ рдлреЗрд╕ рдЗрдХреЛрд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд▓рд╛рдЗрдмреНрд░реЗрд░реА](https://github.com/huggingface)тАФтАФЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ред
### рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреЗ (рд╕рдВрдХреНрд╖рд┐рдкреНрдд) рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рдХреБрдЫ рд╕рдВрджрд░реНрдн рдмрд┐рдВрджреБ рдпрд╣рд╛рдВ рджрд┐рдП рдЧрдП рд╣реИрдВ:
![рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕_рдХреНрд░реЛрдиреЛ](https://img-blog.csdnimg.cn/3ba51fe4f21d4d528ca7b0f2fd78aee4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA56We5rSb5Y2O,size_ 20,рд░рдВрдЧ_FFFFFF,t_70,g_se,x_16#рддрд╕реНрд╡реАрд░_рдХреЗрдВрджреНрд░)
[рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░](https://arxiv.org/abs/1706.03762) рдЬреВрди 2017 рдХреЛрдорд╛рд╕рд┐рдХ рд░реВрдк рд╕реЗ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛. рдореВрд▓ рдЕрдзреНрдпрдпрди рдЕрдиреБрд╡рд╛рдж рдХрд╛рд░реНрдп рдкрд░ рдХреЗрдВрджреНрд░рд┐рдд рдерд╛ред рдХрдИ рдкреНрд░рднрд╛рд╡рд╢рд╛рд▓реА рдореЙрдбрд▓реЛрдВ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд┐рдпрд╛ рдЧрдпрд╛, рдЬрд┐рдирдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- рдЬреВрди 2018: [рдЬреАрдкреАрдЯреА](https://cdn.openai.com/research-covers/рднрд╛рд╖рд╛-рдЕрдирд╕реБрдкрд░рд╡рд╛рдЗрдЬреНрдб/рднрд╛рд╖рд╛_рдЕрдВрдбрд░рд╕реНрдЯреИрдВрдбрд┐рдВрдЧ_рдкреЗрдкрд░.рдкреАрдбреАрдПрдл), рд╡рд┐рднрд┐рдиреНрди рдПрдирдПрд▓рдкреА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдФрд░ рд░рд╛рдЬреНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓рд╛ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓- рдЕрддреНрдпрд╛рдзреБрдирд┐рдХ рдкрд░рд┐рдгрд╛рдо
- рдЕрдХреНрдЯреВрдмрд░ 2018: [BERT](https://arxiv.org/abs/1810.04805), рдмреЗрд╣рддрд░ рд╡рд╛рдХреНрдп рд╕рд╛рд░рд╛рдВрд╢ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдПрдХ рдФрд░ рдмрдбрд╝рд╛ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ (рдЕрдЧрд▓реЗ рдЕрдзреНрдпрд╛рдп рдореЗрдВ рдЗрд╕ рдкрд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА!)
- рдлрд░рд╡рд░реА 2019: [GPT-2](https://cdn.openai.com/better-рднрд╛рд╖рд╛-рдореЙрдбрд▓/рднрд╛рд╖рд╛_рдореЙрдбрд▓_are_unsupervised_multitask_learners.pdf), GPT рдХрд╛ рдПрдХ рдЙрдиреНрдирдд (рдФрд░ рдмрдбрд╝рд╛) рд╕рдВрд╕реНрдХрд░рдг, рдиреИрддрд┐рдХ рдореБрджреНрджреЛрдВ рдХреЗ рдХрд╛рд░рдг рддреБрд░рдВрдд рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЬрд╛рд░реА рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛
- рдЕрдХреНрдЯреВрдмрд░ 2019: [рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ](https://arxiv.org/abs/1910.01108), рдмреАрдИрдЖрд░рдЯреА рдХрд╛ рдПрдХ рдЖрд╕реБрдд рд╕рдВрд╕реНрдХрд░рдг рдЬреЛ 60% рддреЗрдЬ рдФрд░ рдореЗрдореЛрд░реА рдкрд░ 40% рд╣рд▓реНрдХрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА рдмреАрдИрдЖрд░рдЯреА рдХреЗ 97% рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдмрд░рдХрд░рд╛рд░ рд░рдЦрддрд╛ рд╣реИред
- рдЕрдХреНрдЯреВрдмрд░ 2019: [BART](https://arxiv.org/abs/1910.13461) рдФрд░ [T5](https://arxiv.org/abs/1910.10683), рдореВрд▓ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреЗ рд╕рдорд╛рди рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рджреЛ рдореЙрдбрд▓ рдмрдбрд╝реЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ (рдРрд╕рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкрд╣рд▓реЗ)
- рдордИ 2020, [GPT-3](https://arxiv.org/abs/2005.14165), GPT-2 рдХрд╛ рдПрдХ рдмрдбрд╝рд╛ рд╕рдВрд╕реНрдХрд░рдг рдЬреЛ рдмрд┐рдирд╛ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдкрд░ рдЕрдЪреНрдЫрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддрд╛ рд╣реИ (рдЬрд┐рд╕реЗ рдЬреАрд░реЛ-рд╢реЙрдЯ рд▓рд░реНрдирд┐рдВрдЧ рдЬреАрд░реЛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ) рд╢реЙрдЯ рд╕реАрдЦрдирд╛)

рдпрд╣ рд╕реВрдЪреА рд╕рдВрдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдХреБрдЫ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓реЛрдВ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдирд╛ рд╣реИред рдореЛрдЯреЗ рддреМрд░ рдкрд░ рдЗрдиреНрд╣реЗрдВ рддреАрди рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

- рдЬреАрдкреАрдЯреА рд╡рд░реНрдЧ (рдХреЗрд╡рд▓ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░-рдбрд┐рдХреЛрдбрд░ рднрд╛рдЧ, рдСрдЯреЛрд░реЗрдЧреНрд░реЗрд╕рд┐рд╡ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ)
- BERT рд╡рд░реНрдЧ (рдХреЗрд╡рд▓ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░-рдПрдирдХреЛрдбрд░ рднрд╛рдЧ, рд╕реНрд╡-рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ)
- BART/T5 рд╡рд░реНрдЧ (рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░-рдПрдирдХреЛрдбрд░-рдбрд┐рдХреЛрдбрд░ рдореЙрдбрд▓)
                       
### рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдФрд░ рдЪреМрдХрд┐рдпрд╛рдБ
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреЗ рдЕрдзреНрдпрдпрди рдореЗрдВ, рдХреБрдЫ рд╢рдмреНрдж рд╕рд╛рдордиреЗ рдЖрдПрдВрдЧреЗ: рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░, рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдФрд░ рдореЙрдбрд▓ред рдЗрди рд╢рдмреНрджреЛрдВ рдХреЗ рдЕрд░реНрде рдереЛрдбрд╝реЗ рднрд┐рдиреНрди рд╣реИрдВ:

рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░: рдореЙрдбрд▓ рдХреА рдореВрд▓ рд╕рдВрд░рдЪрдирд╛ рдФрд░ рдмреБрдирд┐рдпрд╛рджреА рд╕рдВрдЪрд╛рд▓рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ

рдЪреЗрдХрдкреЙрдЗрдВрдЯ: рдореЙрдбрд▓ рдХреА рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реНрдерд┐рддрд┐ рдЗрд╕ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдкрд░ рдЗрд╕ рд╕рдордп рд╡рдЬрди рд▓реЛрдб рдХрд░реЗрдЧреАред (рдЖрдк рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдЪреМрдХрд┐рдпреЛрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рд╣реЗрдЬрдирд╛ рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ)

рдореЙрдбрд▓: рдпрд╣ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╢рдмреНрдж рд╣реИ, "рд╡рд╛рд╕реНрддреБрдХрд▓рд╛" рдпрд╛ "рдЪреЗрдХрдкреЙрдЗрдВрдЯ" рдЬрд┐рддрдирд╛ рд╕рдЯреАрдХ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рджреЛрдиреЛрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЬрдм рдЕрд╕реНрдкрд╖реНрдЯрддрд╛ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рддреЛ рдпрд╣ рдкрд╛рдареНрдпрдХреНрд░рдо рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдпрд╛ рдЪреМрдХрд┐рдпреЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдЧрд╛ред <br>
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, BERT рдПрдХ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рд╣реИ, рдФрд░ bert-base-cased (BERT рдХреЗ рдкрд╣рд▓реЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП Google рдЯреАрдо рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рд╡рдЬрди рдХрд╛ рд╕реЗрдЯ) рдПрдХ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдХреЛрдИ "рдмреАрдИрдЖрд░рдЯреА рдореЙрдбрд▓" рдФрд░ "рдмрд░реНрдЯ-рдмреЗрд╕-рдХреЗрд╕реНрдб рдореЙрдбрд▓" рдХрд╣ рд╕рдХрддрд╛ рд╣реИред

***рдмрдбрд╝реЗ рдбреЗрдЯрд╛ рдореЗрдВ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдЕрд╡рдзрд╛рд░рдгрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╣реБрдд рдЪрд░реНрдЪрд╛ рдХреА рдЬрд╛рддреА рд╣реИред рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рдкрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рд╣реЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореЙрдбрд▓ рдХреЛ рдпреБрдЧ рдХреЗ рдПрдХ рджреМрд░ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдЕрджреНрдпрддрди рдХрд┐рдпрд╛, рдФрд░ рдореЙрдбрд▓ рдХреЛ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╕рд╣реЗрдЬрд╛ред )
рдЗрд╕рд▓рд┐рдП, рдкреНрд░рддреНрдпреЗрдХ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдореЙрдбрд▓ рдХреА рд╕реНрдерд┐рддрд┐ рдФрд░ рд╡рдЬрд╝рди рдХреЗ рдПрдХ рд╕реЗрдЯ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред рдмрдбрд╝реЗ рдбреЗрдЯрд╛ рдореЗрдВ, рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдЗрд╡реЗрдВрдЯ рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдХрд╛ рдореВрд▓ рдЕрд░реНрде рдХреНрд░реИрд╢ рд╕рдордп рдХреЛ рдХрдо рдХрд░рдирд╛ рд╣реИред рдХрд╣рдиреЗ рдХрд╛ рддрд╛рддреНрдкрд░реНрдп рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдХрд╛рд░рдг рдбреЗрдЯрд╛рдмреЗрд╕ рдХреНрд░реИрд╢ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рд╕рдордп рдХреЛ рдХрдо рдХрд░ рджреЗрддрд╛ рд╣реИред ***
### рдЕрдиреБрдорд╛рди рдПрдкреАрдЖрдИ
[рдореЙрдбрд▓ рд╣рдм](https://huggingface.co/models) (рдореЙрдбрд▓ рд╣рдм) рдореЗрдВ рдмрд╣реБ-рднрд╛рд╖рд╛ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЖрдк рднрд╛рд╖рд╛ рдЯреИрдм рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдФрд░ рдХрд┐рд╕реА рдЕрдиреНрдп рднрд╛рд╖рд╛ рдореЗрдВ рдкрд╛рда рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдореЙрдбрд▓ рдХрд╛ рдЪрдпрди рдХрд░рдХреЗ рдореЙрдбрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рдЦреЛрдЬ рдХреЛ рдкрд░рд┐рд╖реНрдХреГрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред 

рдПрдХ рдореЙрдбрд▓ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЙрд╕ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдЖрдк рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рд╡рд╣рд╛рдВ рдПрдХ рд╡рд┐рдЬреЗрдЯ рд╣реИ - рдЗрдВрдлрд╝рд░реЗрдВрд╕ рдПрдкреАрдЖрдИ (рдСрдирд▓рд╛рдЗрди рдЯреНрд░рд╛рдпрд▓ рдХреЛ рд╕рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ)ред рдпрд╛рдиреА, рдЖрдк рдЗрд╕ рдкреГрд╖реНрда рдкрд░ рд╕реАрдзреЗ рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдХрд╕реНрдЯрдо рдЯреЗрдХреНрд╕реНрдЯ рджрд░реНрдЬ рдХрд░рдХреЗ, рдЖрдк рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдореЙрдбрд▓ рдХреЗ рдкрд░рд┐рдгрд╛рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рддрд░рд╣ рдЖрдк рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЙрд╕рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рддреНрд╡рд░рд┐рдд рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
![рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ рдмреЗрд╕ рдореЙрдбрд▓ (рдмрд┐рдирд╛ рдЖрд╡рд░рдг рд╡рд╛рд▓рд╛)](https://img-blog.csdnimg.cn/0edebca3ab8248b4b2bac88f88ab79c0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA56We5rSb5Y2O,size_20,рд░рдВрдЧ_FFFFFF,t_70,g_se,x_16#pic_center)
## 2. рдПрдирдПрд▓рдкреА рд╕рдорд╕реНрдпрд╛рдУрдВ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ, рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдкрд╣рд▓реЗ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреНрдпрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: рдкрд╛рдЗрдкрд▓рд╛рдЗрдиред

>ЁЯдЧ[рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА](https://github.com/huggingface/transformers) рд╕рд╛рдЭрд╛ рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред [рдореЙрдбрд▓ рд╣рдм](https://huggingface.co/models) рдореЗрдВ рд╣рдЬрд╛рд░реЛрдВ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдХреЛрдИ рднреА рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЖрдк рд╣рдм рдкрд░ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдореЙрдбрд▓ рднреА рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ!

ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рд╕рдмрд╕реЗ рдмреБрдирд┐рдпрд╛рджреА рд╡рд╕реНрддреБ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рд╣реИред рдпрд╣ рдореЙрдбрд▓ рдХреЛ рдЙрд╕рдХреЗ рдЖрд╡рд╢реНрдпрдХ рдкреВрд░реНрд╡ рдФрд░ рдмрд╛рдж рдХреЗ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдЪрд░рдгреЛрдВ рд╕реЗ рдЬреЛрдбрд╝рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдореЗрдВ рд╕реАрдзреЗ рдХрд┐рд╕реА рднреА рдкрд╛рда рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдФрд░ рд╕рдордЭрдиреЗ рдпреЛрдЧреНрдп рдЙрддреНрддрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВрдЗ

рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░рд┐рдпрд░ = рдкрд╛рдЗрдкрд▓рд╛рдЗрди ("рднрд╛рд╡рдирд╛-рд╡рд┐рд╢реНрд▓реЗрд╖рдг")
рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░рд┐рдпрд░ ("рдореИрдВ рдЕрдкрдиреА рдкреВрд░реА рдЬрд┐рдВрджрдЧреА рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рдХреЛрд░реНрд╕ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░ рд░рд╣рд╛ рд╣реВрдВред")
```
```рдЕрдЬрдЧрд░
[{'рд▓реЗрдмрд▓': 'рд╕рдХрд╛рд░рд╛рддреНрдордХ', 'рд╕реНрдХреЛрд░': 0.9598047137260437}]
```
рд╣рдо рдХреБрдЫ рд╡рд╛рдХреНрдпреЛрдВ рдореЗрдВ рднреА рдЗрд╕реЗ рдкрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ!
```рдЕрдЬрдЧрд░
рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░рд┐рдпрд░([
    "рдореИрдВ рдкреВрд░реА рдЬрд┐рдВрджрдЧреА рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рдХреЛрд░реНрд╕ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддрд╛ рд░рд╣рд╛ рд╣реВрдВред"
    "рдореБрдЭреЗ рдЗрд╕рд╕реЗ рдмрд╣реБрдд рдирдлрд░рдд рд╣реИ!"
])
```
```рдЕрдЬрдЧрд░
[{'рд▓реЗрдмрд▓': 'рд╕рдХрд╛рд░рд╛рддреНрдордХ', 'рд╕реНрдХреЛрд░': 0.9598047137260437},
 {'рд▓реЗрдмрд▓': 'рдирдХрд╛рд░рд╛рддреНрдордХ', 'рд╕реНрдХреЛрд░': 0.9994558095932007}]
 ```
рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХрд╛ рдЪрдпрди рдХрд░рддреА рд╣реИ рдЬрд┐рд╕реЗ рдЕрдВрдЧреНрд░реЗрдЬреА рднрд╛рд╡рдирд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдареАрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рддреЗ рд╕рдордп, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рддрдореЙрдбрд▓ рдХреЛ рд▓реЛрдб рдФрд░ рдХреИрд╢ рдХрд░реЗрдВред рдпрджрд┐ рдЖрдк рдХрдорд╛рдВрдб рдХреЛ рджреЛрдмрд╛рд░рд╛ рдЪрд▓рд╛рддреЗ рд╣реИрдВ, рддреЛ рдХреИрд╢реНрдб рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдореЙрдбрд▓ рдХреЛ рджреЛрдмрд╛рд░рд╛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрдИ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред

рдХрд┐рд╕реА рдкрд╛рда рдХреЛ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдореЗрдВ рдкрд╛рд╕ рдХрд░рддреЗ рд╕рдордп рддреАрди рдореБрдЦреНрдп рдЪрд░рдг рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВ:

1. рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ: рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рдРрд╕реЗ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдореЙрдбрд▓ рд╕рдордЭ рд╕рдХреЗред
2. рдЗрдирдкреБрдЯ рдореЙрдбрд▓: рдореЙрдбрд▓ рдмрдирд╛рдПрдВ рдФрд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕реНрдб рдЗрдирдкреБрдЯ рдХреЛ рдореЙрдбрд▓ рдореЗрдВ рдкрд╛рд╕ рдХрд░реЗрдВред
3. рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ: рдореЙрдбрд▓ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕ рдХреА рдЬрд╛рддреА рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рд╕рдордЭ рд╕рдХреЗрдВред

рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдХреБрдЫ рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЗрдВ рд╣реИрдВ:
- рд╕реБрд╡рд┐рдзрд╛-рдирд┐рд╖реНрдХрд░реНрд╖рдг (рдкрд╛рда рдХрд╛ рд╡реЗрдХреНрдЯрд░ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ)
- рдлрд┐рд▓-рдорд╛рд╕реНрдХ рджрд┐рдП рдЧрдП рдкрд╛рда рдореЗрдВ рд░рд┐рдХреНрдд рд╕реНрдерд╛рди рдХреЛ рднрд░рддрд╛ рд╣реИ (рдХреНрд▓реЛрдЬрд╝)
- рдПрдирдИрдЖрд░ (рдирд╛рдорд┐рдд рдЗрдХрд╛рдИ рдкрд╣рдЪрд╛рди) рдкрд╛рд░реНрдЯ-рдСрдлрд╝-рд╕реНрдкреАрдЪ рдЯреИрдЧрд┐рдВрдЧ
- рдкреНрд░рд╢реНрдиреЛрддреНрддрд░реА рдкреНрд░рд╢реНрдиреЛрддреНрддрд░реА
- рднрд╛рд╡рдирд╛-рд╡рд┐рд╢реНрд▓реЗрд╖рдг рднрд╛рд╡рдирд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг
- рд╕рд╛рд░рд╛рдВрд╢ рд╕рд╛рд░рд╛рдВрд╢ рдкреАрдврд╝реА
- рдкрд╛рда-рдкреАрдврд╝реА рдкрд╛рда-рдкреАрдврд╝реА
- рдЕрдиреБрд╡рд╛рджрдЕрдиреБрд╡рд╛рдж
- рд╢реВрдиреНрдп-рд╢реЙрдЯ-рд╡рд░реНрдЧреАрдХрд░рдгрд╢реВрдиреНрдп-рд╢реЙрдЯ рд╡рд░реНрдЧреАрдХрд░рдг

рдЖрдк рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рд╣рдм рд╕реЗ рдПрдХ рдореЙрдбрд▓-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХрд╛ рдЪрдпрди рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЯреЗрдХреНрд╕реНрдЯ рдЬреЗрдирд░реЗрд╢рдиред [рдореЙрдбрд▓ рд╣рдм](https://huggingface.co/models) рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдмрд╛рдИрдВ рдУрд░ рдЙрдкрдпреБрдХреНрдд рдЯреИрдм рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред рдкреЗрдЬ рдХреЗрд╡рд▓ рдЯреЗрдХреНрд╕реНрдЯ рдЬреЗрдирд░реЗрд╢рди рдХрд╛рд░реНрдп рджрд┐рдЦрд╛рдПрдЧрд╛редрд╕реЗрд╡рд╛ рд╕рдорд░реНрдерди рдореЙрдбрд▓.
(***рдХрд╛рд░реНрдп рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ рдореЙрдбрд▓ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдХрд╛рд░рдХреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдпрд╣ рд╣реИ: рдкреНрд░реА-рдЯреНрд░реЗрдирд┐рдВрдЧ рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдЙрд╕ рдХрд╛рд░реНрдп рдореЗрдВ рдирд┐рд╣рд┐рдд рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреЗ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЙрддрдирд╛ рдХрд░реАрдм рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдкреНрд░рдХреНрд░рд┐рдпрд╛ред рджреЛ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдЬрд┐рддрдиреЗ рдХрд░реАрдм рд╣реЛрдВрдЧреЗ, рдЙрддрдирд╛ рдмреЗрд╣рддрд░ рд╣реЛрдЧрд╛ред

рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдПрдкреАрдЖрдИ рд╡рд┐рднрд┐рдиреНрди рдПрдирдПрд▓рдкреА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓ рд╕рдХрддрд╛ рд╣реИред рдЖрдк рдЬрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрд╛рд░реНрдп рдХреЛ рд╣рд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЙрд╕рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЖрдк рд╕рдВрдкреВрд░реНрдг рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдпрд╛ рдХреЗрд╡рд▓ рдПрдирдХреЛрдбрд░ рдпрд╛ рдбрд┐рдХреЛрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдиреАрдЪреЗ рджреА рдЧрдИ рддрд╛рд▓рд┐рдХрд╛ рдЗрд╕рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреА рд╣реИ:

 рдореЙрдбрд▓ |. рдЙрджрд╛рд╣рд░рдг |
-------- |. ----- |-----
рдПрдирдХреЛрдбрд░ | рдЕрд▓реНрдмрд░реНрдЯ, рдмрд░реНрдЯ, рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ, рдЗрд▓реЗрдХреНрдЯреНрд░рд╛, рд░реЙрдмрд░реНрдЯрд╛ |ред рд╡рд╛рдХреНрдп рд╡рд░реНрдЧреАрдХрд░рдг, рдирд╛рдорд┐рдд рдЗрдХрд╛рдИ рдорд╛рдиреНрдпрддрд╛, рдирд┐рд╖реНрдХрд░реНрд╖рдг рдкреНрд░рд╢реНрди рдЙрддреНрддрд░
рдбрд┐рдХреЛрдбрд░ | CTRL, GPT, GPT-2, рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ XL |
рдПрдирдХреЛрдбрд░-рдбрд┐рдХреЛрдбрд░ | BART, T5, рдореИрд░рд┐рдПрди, mBART |ред рд╕рд╛рд░рд╛рдВрд╢ рдкреАрдврд╝реА, рдЕрдиреБрд╡рд╛рдж, рдЬрдирд░реЗрдЯрд┐рд╡ рдкреНрд░рд╢реНрдиреЛрддреНрддрд░реА

рдКрдкрд░ рджрд┐рдЦрд╛рдИ рдЧрдИ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдкреНрд░рджрд░реНрд╢рди рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реИред рдЙрдиреНрд╣реЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд╡реЗ рдЙрдирд╕реЗ рднрд┐рдиреНрди рдХрд╛рд░реНрдп рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЕрдЧрд▓реЗ рднрд╛рдЧ рдореЗрдВ, рдЖрдк рд╕реАрдЦреЗрдВрдЧреЗ рдХрд┐ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рдЕрдВрджрд░ рдХреНрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдХреИрд╕реЗ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред
> рдЙрдкрд░реЛрдХреНрдд рдкреНрд░рдХрд╛рд░ рдХреА рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдХреЗ рд╕рд░рд▓ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ -тАФ[рд╣рдЧрд┐рдВрдЧ рдлреЗрд╕ рд╣реЛрдордкреЗрдЬ рдХреЛрд░реНрд╕ рдХрд╛ рдкрд╣рд▓рд╛ рд▓реЗрдЦ "рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдореЙрдбрд▓"](https://blog.csdn.net/qq_56591814/article/details/120124306)ред
> рдпрд╛ рдЕрдиреНрдп рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рд╡рд╛рд▓реЗ Google рдХреЛ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП [Colab рдореЗрдВ рдЦреЛрд▓реЗрдВ](https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter1/section3.ipynb) рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ Colab Notebook .
рдпрджрд┐ рдЖрдк рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЪрд▓рд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо [рд╕реЗрдЯрдЕрдк](https://huggingface.co/course/chapter0) рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреЗрддреЗ рд╣реИрдВред
## 3. рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рдкреАрдЫреЗ
>рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдХреЗ рд▓рд┐рдП рдХреЛрдб: [рдХреЛрд▓реИрдм рдореЗрдВ рдЦреЛрд▓реЗрдВ](https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter2/section2_pt.ipynb) (PyTorch)<bрдЖрд░>
>рдпреВрдЯреНрдпреВрдм рд╡реАрдбрд┐рдпреЛ: [рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЕрдВрджрд░ рдХреНрдпрд╛ рд╣реБрдЖ](https://youtu.be/1pedAIvTWXk)

рдЖрдЗрдП рдПрдХ рд╕рдВрдкреВрд░реНрдг рдЙрджрд╛рд╣рд░рдг рд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдЬрдм рд╣рдо рдзрд╛рд░рд╛ 1 рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдкрд░реНрджреЗ рдХреЗ рдкреАрдЫреЗ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ:
```рдЕрдЬрдЧрд░

рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ

рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░рд┐рдпрд░ = рдкрд╛рдЗрдкрд▓рд╛рдЗрди ("рднрд╛рд╡рдирд╛-рд╡рд┐рд╢реНрд▓реЗрд╖рдг")
рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░рд┐рдпрд░([
    "рдореИрдВ рдкреВрд░реА рдЬрд┐рдВрджрдЧреА рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рдХреЛрд░реНрд╕ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддрд╛ рд░рд╣рд╛ рд╣реВрдВред"
    "рдореБрдЭреЗ рдЗрд╕рд╕реЗ рдмрд╣реБрдд рдирдлрд░рдд рд╣реИ!",
])
```
```рдЕрдЬрдЧрд░
[{'рд▓реЗрдмрд▓': 'рд╕рдХрд╛рд░рд╛рддреНрдордХ', 'рд╕реНрдХреЛрд░': 0.9598047137260437},
 {'рд▓реЗрдмрд▓': 'рдирдХрд╛рд░рд╛рддреНрдордХ', 'рд╕реНрдХреЛрд░': 0.9994558095932007}]
```
рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдЕрдзреНрдпрд╛рдп 1 рдореЗрдВ рджреЗрдЦрд╛, рдпрд╣ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рддреАрди рдЪрд░рдгреЛрдВ рдХреЛ рдЬреЛрдбрд╝рддреА рд╣реИ: рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ, рдореЙрдбрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрдирдкреБрдЯ рдкрд╛рд╕ рдХрд░рдирд╛, рдФрд░ рдкреЛрд╕реНрдЯрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ:
![full_nlp_pipeline ](https://img-blog.csdnimg.cn/7f19b775bfe94fa0bb9e35d883567e16.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA56We5rSb 5Y2O, рдЖрдХрд╛рд░_20,рд░рдВрдЧ_FFFFFF,t_70,g_se,x_16#рддрд╕реНрд╡реАрд░_рдХреЗрдВрджреНрд░)

рдЖрдЗрдП рдЗрди рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВред
### рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ
рдЕрдиреНрдп рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рддрд░рд╣, рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рд╕реАрдзреЗ рдХрдЪреНрдЪреЗ рдкрд╛рда рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдорд╛рд░реА рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдореЗрдВ рдкрд╣рд▓рд╛ рдХрджрдо рдкрд╛рда рдЗрдирдкреБрдЯ рдХреЛ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдирд╛ рд╣реИ рдЬрд┐рд╕реЗ рдореЙрдбрд▓ рд╕рдордЭ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдо рдПрдХ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдЗрд╕рдХреЗ рд▓рд┐рдП рдЬрд╝рд┐рдореНрдореЗрджрд╛рд░ рд╣реЛрдЧрд╛:

- рдЗрдирдкреБрдЯ рдХреЛ рд╢рдмреНрджреЛрдВ, рдЙрдкрд╢рдмреНрджреЛрдВ рдпрд╛ рдкреНрд░рддреАрдХреЛрдВ (рдЬреИрд╕реЗ рд╡рд┐рд░рд╛рдо рдЪрд┐рд╣реНрди) рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЯреЛрдХрди рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ
- рдкреНрд░рддреНрдпреЗрдХ рдЯреЛрдХрди рдХреЛ рдПрдХ рдкреВрд░реНрдгрд╛рдВрдХ рдореЗрдВ рдореИрдк рдХрд░реЗрдВ
- рдЕрдиреНрдп рдЗрдирдкреБрдЯ рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ

рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреНрд▓рд╛рд╕ рдФрд░ рдЗрд╕рдХреА from_pretrained рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдХрд┐ рдпрд╣ рд╕рднреА рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдареАрдХ рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИ рдЬреИрд╕реЗ рдореЙрдбрд▓ рдХреЛ рдкреНрд░реАрдЯреНрд░реЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛редрдкреБрд░рд╛ рд╣реЛрдирд╛ред рдореЙрдбрд▓ рдХрд╛ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдирд╛рдо рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдореЙрдбрд▓ рдХреЗ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рд╕реЗ рдЬреБрдбрд╝реЗ рдбреЗрдЯрд╛ рдХреЛ рд▓рд╛рдПрдЧрд╛ рдФрд░ рдЗрд╕реЗ рдХреИрд╢ рдХрд░реЗрдЧрд╛ (рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХреЗрд╡рд▓ рдкрд╣рд▓реА рдмрд╛рд░ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрдм рдЖрдк рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдХреЛрдб рдХреЛ рдЪрд▓рд╛рдПрдВрдЧреЗ)ред

рдЪреВрдБрдХрд┐ рднрд╛рд╡рдирд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЪреЗрдХрдкреЙрдЗрдВрдЯ [distilbert-base-uncased-finetuned-sst-2-english](https://huggingface.co/distilbert-base-uncased-finetuned-sst-2-english) рд╣реИ, рд╣рдо рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЪреЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб-рдлрд╛рдЗрдирдЯреНрдпреВрдиреНрдб-рдПрд╕рдПрд╕рдЯреА-2-рдЗрдВрдЧреНрд▓рд┐рд╢"
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(рдЪреЗрдХрдкреЙрдЗрдВрдЯ)
```
```рдЕрдЬрдЧрд░
raw_inputs = [
    "рдореИрдВ рдкреВрд░реА рдЬрд┐рдВрджрдЧреА рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рдХреЛрд░реНрд╕ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддрд╛ рд░рд╣рд╛ рд╣реВрдВред",
    "рдореБрдЭреЗ рдЗрд╕рд╕реЗ рдмрд╣реБрдд рдирдлрд░рдд рд╣реИ!",
]
рдЗрдирдкреБрдЯреНрд╕ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░(raw_inputs, рдкреИрдбрд┐рдВрдЧ=рд╕рд╣реА, рдЯреНрд░рдВрдХреЗрд╢рди=рд╕рд╣реА, рд░рд┐рдЯрд░реНрди_рдЯреЗрдВрд╕рд░реНрд╕='рдкреАрдЯреА')
#return_tensors='pt' рдХрд╛ рдЕрд░реНрде рд╣реИ рд░рд┐рдЯрд░реНрдирд┐рдВрдЧ рдкрд╛рдЗрдЯреЛрд░рдЪ рдЯреЗрдВрд╕рд░ред рдкрд╛рда рдХреЛ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдореЙрдбрд▓ рдореЗрдВ рдЗрдирдкреБрдЯ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЗрд╕реЗ рдЯреЗрдВрд╕рд░ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
#padding=True рдХрд╛ рдЕрд░реНрде рд╣реИ рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдХреЛ рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдбрд┐рдВрдЧ рдХрд░рдирд╛, truncation=True рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЬреЛ рдЕрдиреБрдХреНрд░рдо рдмрд╣реБрдд рд▓рдВрдмрд╛ рд╣реИ рдЙрд╕реЗ рдЫреЛрдЯрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ

рдкреНрд░рд┐рдВрдЯ(рдЗрдирдкреБрдЯ)
```
рдпрд╣рд╛рдВ PyTorch рдЯреЗрдВрд╕рд░ рдХреЗ рдкрд░рд┐рдгрд╛рдо рджрд┐рдП рдЧрдП рд╣реИрдВ:
```рдЕрдЬрдЧрд░
{
    'input_ids': рдЯреЗрдВрд╕рд░([
        [101, 1045, 1005, 2310, 2042, 3403, 2005, 1037, 17662, 12172, 2607, 2026, 2878, 2166, 1012, 102],
        [101, 1045, 5223, 2023, 2061, 2172, 999, 102,0, 0, 0, 0, 0, 0, 0, 0]
    ]),
    'рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ': рдЯреЗрдВрд╕рд░([
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    ])
}
```
### рдореЙрдбрд▓ рдЪреБрдиреЗрдВ
рд╣рдо рдЕрдкрдиреЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рд╡реИрд╕реЗ рд╣реА рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рд╣рдордиреЗ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдерд╛ред ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдПрдХ рдСрдЯреЛрдореЙрдбрд▓ рдХреНрд▓рд╛рд╕ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ from_pretrained рд╡рд┐рдзрд┐ рднреА рд╣реЛрддреА рд╣реИ:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдореЙрдбрд▓ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЪреЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб-рдлрд╛рдЗрдирдЯреНрдпреВрдиреНрдб-рдПрд╕рдПрд╕рдЯреА-2-рдЗрдВрдЧреНрд▓рд┐рд╢"
рдореЙрдбрд▓ = AutoModel.from_pretrained(рдЪреЗрдХрдкреЙрдЗрдВрдЯ)
```
рдСрдЯреЛрдореЙрдбрд▓ рд╡рд░реНрдЧ рдФрд░ рдЙрд╕рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕рднреА рд╡рд░реНрдЧ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓ рд╣реИрдВредрдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдЖрд╡рд░рдг. рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЖрдкрдХреЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рдореЙрдбрд▓ рд╕реНрдХреАрдорд╛ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЙрд╕ рд╕реНрдХреАрдорд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЙрдбрд▓ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░рддрд╛ рд╣реИред (***рдЕрд░реНрдерд╛рдд, рдСрдЯреЛрдореЙрдбрд▓ рдХреНрд▓рд╛рд╕ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ рдХрд┐рд╕реА рднреА рдореЙрдбрд▓ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдореЙрдбрд▓ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдмреЗрд╣рддрд░ рддрд░реАрдХрд╛ рд╣реИред рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ, рдЬреЛ рд▓реЗрдЦ рдХреЗ рдЕрдВрдд рдореЗрдВ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред** *)

рдЗрд╕ рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ рдореЗрдВ, рд╣рдо рдЙрд╕реА рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рдордиреЗ рдкрд╣рд▓реЗ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдореЗрдВ рдХрд┐рдпрд╛ рдерд╛ (рдЗрд╕реЗ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП) рдФрд░ рдЗрд╕рдХреЗ рд╕рд╛рде рдПрдХ рдореЙрдбрд▓ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░реЗрдВред рд▓реЗрдХрд┐рди рдЗрд╕ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдореЗрдВ рдХреЗрд╡рд▓ рдореВрд▓ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбреНрдпреВрд▓ рд╢рд╛рдорд┐рд▓ рд╣реИ: рдХреБрдЫ рдЗрдирдкреБрдЯ рджрд┐рдП рдЬрд╛рдиреЗ рдкрд░, рдпрд╣ рдЖрдЙрдЯрдкреБрдЯ рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╣рдо рдЫрд┐рдкреА рд╣реБрдИ рд╕реНрдерд┐рддрд┐ рдХрд╣рддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдБрдХрд┐ рдпреЗ рдЫреБрдкреЗ рд╣реБрдП рд░рд╛рдЬреНрдп рдЕрдкрдиреЗ рдЖрдк рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реИрдВ, рд╡реЗ рдЕрдХреНрд╕рд░ рдореЙрдбрд▓ рдХреЗ рджреВрд╕рд░реЗ рднрд╛рдЧ (рдореЙрдбрд▓ рд╣реЗрдб) рдореЗрдВ рдЗрдирдкреБрдЯ рд╣реЛрддреЗ рд╣реИрдВред
### рдореЙрдбрд▓ рдкреНрд░рдореБрдЦ
рд╣рдо рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реА рдореЙрдбрд▓ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдкреНрд░рддреНрдпреЗрдХ рдХрд╛рд░реНрдп рдХреЗ рд╕рд╛рде рдЕрд▓рдЧ-рдЕрд▓рдЧ рдореЙрдбрд▓ рд╣реЗрдб рдЬреБрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВред

рдореЙрдбрд▓ рдкреНрд░рдореБрдЦ: рдЫрд┐рдкреЗ рд╣реБрдП рд░рд╛рдЬреНрдпреЛрдВ рдХреЗ рдЙрдЪреНрдЪ-рдЖрдпрд╛рдореА рд╡реИрдХреНрдЯрд░ (рдпрд╛рдиреА, рд▓реЙрдЧрд┐рдЯреНрд╕ рд╡реИрдХреНрдЯрд░) рдХреЛ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╡рд┐рднрд┐рдиреНрди рдЖрдпрд╛рдореЛрдВ рдореЗрдВ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд░реЗрдВред рдЗрдирдореЗрдВ рдЖрдорддреМрд░ рдкрд░ рдПрдХ рдпрд╛ рдХрдИ рд░реИрдЦрд┐рдХ рдкрд░рддреЗрдВ рд╣реЛрддреА рд╣реИрдВ:
![рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░_рдПрдВрдб_рд╣реЗрдб](https://img-blog.csdnimg.cn/9156c4e09d184e7c88732e60ae59e05e.png?
рдЗрд╕ рдЖрд░реЗрдЦ рдореЗрдВ, рдПрдХ рдореЙрдбрд▓ рдХреЛ рдЙрд╕рдХреА рдПрдореНрдмреЗрдбрд┐рдВрдЧ рдкрд░рдд рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рдХреА рдкрд░рддреЛрдВ рджреНрд╡рд╛рд░рд╛ рджрд░реНрд╢рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдПрдореНрдмреЗрдбрд┐рдВрдЧ рдкрд░рдд рд╕реЗ рд╣реЛрдХрд░ рдЧреБрдЬрд░рддрд╛ рд╣реИ рдФрд░ рд╡рд╛рдХреНрдп рдХреЗ рдЕрдВрддрд┐рдо рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЙрдЧ рд╡реИрдХреНрдЯрд░ рдХреЛ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддрд╛ рд╣реИред

ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдореЗрдВ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдХреБрдЫ рдореЙрдбрд▓ рдкреНрд░рдореБрдЦ рдиреАрдЪреЗ рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВ:
* рдореЙрдбрд▓ (рдЫрд┐рдкреЗ рд╣реБрдП рд░рд╛рдЬреНрдпреЛрдВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ)
*рдлреЙрд░рдХреЙрд╕рд▓рдПрд▓рдПрдо
*рдорд╛рд╕реНрдХрдбрдПрд▓рдПрдо рдХреЗ рд▓рд┐рдП
*рдмрд╣реБрд╡рд┐рдХрд▓реНрдкреА рдХреЗ рд▓рд┐рдП
*рд╕рд╡рд╛рд▓ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП
* рдЕрдиреБрдХреНрд░рдо рд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП
* рдЯреЛрдХрдирд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП
* рдПрд╡рдВ рдЕрдиреНрдп ЁЯдЧ

рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рднрд╛рд╡рдирд╛ рд╡рд░реНрдЧреАрдХрд░рдг рдХреЛ рд▓реЗрддреЗ рд╣реБрдП, рд╣рдореЗрдВ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИрдЕрдиреБрдХреНрд░рдо рд╡рд░реНрдЧреАрдХрд░рдг рд╡рд╛рд▓рд╛ рдПрдХ рдореЙрдбрд▓ рд╣реЗрдб (рд╡рд╛рдХреНрдпреЛрдВ рдХреЛ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдпрд╛ рдирдХрд╛рд░рд╛рддреНрдордХ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо)ред рдЗрд╕рд▓рд┐рдП, рд╣рдо рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ AutoModel рд╡рд░реНрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ, рдмрд▓реНрдХрд┐ рдЗрд╕рдХреЗ рдмрдЬрд╛рдп AutoModelForSequenceClassification рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ:

(*** рдХрд╣рдиреЗ рдХрд╛ рддрд╛рддреНрдкрд░реНрдп рдпрд╣ рд╣реИ рдХрд┐, рдкрд╣рд▓реЗ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдореЙрдбрд▓ = AutoModel.from_pretrained(checkpoint) рднрд╛рд╡рдирд╛ рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдХреЗ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рдХреНрдпреЛрдВрдХрд┐ рдореЙрдбрд▓ рд╣реЗрдб рд▓реЛрдб рдирд╣реАрдВ рд╣реИ***)
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForSequenceClassification рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЪреЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб-рдлрд╛рдЗрдирдЯреНрдпреВрдиреНрдб-рдПрд╕рдПрд╕рдЯреА-2-рдЗрдВрдЧреНрд▓рд┐рд╢"
рдореЙрдбрд▓ = AutoModelForSequenceClassification.from_pretrained(рдЪреЗрдХрдкреЙрдЗрдВрдЯ)
рдЖрдЙрдЯрдкреБрдЯ = рдореЙрдбрд▓(**рдЗрдирдкреБрдЯ)
```
рдореЙрдбрд▓ рд╣реЗрдб рдЙрд╕ рдЙрдЪреНрдЪ-рдЖрдпрд╛рдореА рд╡реЗрдХреНрдЯрд░ рдХреЛ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдкрд╣рд▓реЗ рджреЗрдЦрд╛ рдерд╛ рдФрд░ рдПрдХ рд╡реЗрдХреНрдЯрд░ рдХреЛ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рджреЛ рдорд╛рди рд╣реЛрддреЗ рд╣реИрдВ (рдкреНрд░рддреНрдпреЗрдХ рд▓реЗрдмрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ):
```рдЕрдЬрдЧрд░
рдкреНрд░рд┐рдВрдЯ(рдЖрдЙрдЯрдкuts.logits.shape)
```
```рдЕрдЬрдЧрд░
рдЯреЙрд░реНрдЪ.рдЖрдХрд╛рд░([2,2])
```
рдЪреВрдБрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ рджреЛ рд╡рд╛рдХреНрдп рдФрд░ рджреЛ рд▓реЗрдмрд▓ рд╣реИрдВ, рдореЙрдбрд▓ рд╕реЗ рд╣рдореЗрдВ рдЬреЛ рдкрд░рд┐рдгрд╛рдо рдорд┐рд▓рддрд╛ рд╣реИ рд╡рд╣ рдЖрдХрд╛рд░ 2 x 2 рдХрд╛ рд╣реЛрддрд╛ рд╣реИред
### рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рдж
рдореЙрдбрд▓ рд╕реЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд╣рдореЗрдВ рдЬреЛ рдорд╛рди рдорд┐рд▓рддреЗ рд╣реИрдВ, рдЬрд░реВрд░реА рдирд╣реАрдВ рдХрд┐ рд╡реЗ рдЕрдкрдиреЗ рдЖрдк рдореЗрдВ рд╕рд╛рд░реНрдердХ рд╣реЛрдВред рдЪрд▓реЛ рджреЗрдЦрддреЗ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
рдкреНрд░рд┐рдВрдЯ(рдЖрдЙрдЯрдкреБрдЯ.рд▓реЙрдЧрд┐рдЯреНрд╕)
```
```рдЕрдЬрдЧрд░
рдЯреЗрдВрд╕рд░([[-1.5607, 1.6123],
        [4.1692, -3.3464]], grad_fn=<AddmmBackward>)
```
рд╣рдорд╛рд░реЗ рдореЙрдбрд▓ рдиреЗ рдкрд╣рд▓реЗ рд╡рд╛рдХреНрдп рдХреЗ рдкрд░рд┐рдгрд╛рдо [-1.5607, 1.6123] рдФрд░ рджреВрд╕рд░реЗ рд╡рд╛рдХреНрдп рдХреЗ рдкрд░рд┐рдгрд╛рдо [4.1692, -3.3464] рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреАред рдпреЗ рд╕рдВрднрд╛рд╡реНрдпрддрд╛рдПрдВ рдирд╣реАрдВ рд╣реИрдВ, рдмрд▓реНрдХрд┐ рд▓реЙрдЧрд┐рдЯ рд╣реИрдВ, рдЬреЛ рдореЙрдбрд▓ рдХреА рдЕрдВрддрд┐рдо рдкрд░рдд рджреНрд╡рд╛рд░рд╛ рдХрдЪреНрдЪреЗ рдЕрдорд╛рдирдХреАрдХреГрдд рд╕реНрдХреЛрд░ рдЖрдЙрдЯрдкреБрдЯ рд╣реИрдВред рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрдиреНрд╣реЗрдВ рд╕реЙрдлрд╝реНрдЯрдореИрдХреНрд╕ рдкрд░рдд рд╕реЗ рдЧреБрдЬрд░рдирд╛ рд╣реЛрдЧрд╛ред рд╕рднреА ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдореЙрдбрд▓ рдЖрдЙрдЯрдкреБрдЯ рд▓реЙрдЧ рдХрд░рддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рд╣рд╛рдирд┐ рдлрд╝рдВрдХреНрд╢рди рдЖрдо рддреМрд░ рдкрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХреНрд░реЙрд╕-рдПрдиреНрдЯреНрд░реЙрдкреА рд╣рд╛рдирд┐ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рдЕрдВрддрд┐рдо рд╕рдХреНрд░рд┐рдпрдг рдлрд╝рдВрдХреНрд╢рди (рдЬреИрд╕реЗ рд╕реЙрдлреНрдЯрдореИрдХреНрд╕) рдХреЛ рдлрд╝реНрдпреВрдЬрд╝ рдХрд░рддрд╛ рд╣реИред <br>
(***рдкреВрд░рдХ: рдкрд╛рдЗрдЯреЛрд░рдЪ рдореЗрдВ, рдХреНрд░реЙрд╕-рдПрдиреНрдЯреНрд░реЙрдкреА рд▓реЙрд╕ рд╕реАрдИрд▓реЙрд╕ рдЧрдгрд┐рддреАрдп рдХреНрд░реЙрд╕-рдПрдиреНрдЯреНрд░реЙрдкреА рд▓реЙрд╕ (рдПрдирдПрд▓рдПрд▓рдПрд╕) рдирд╣реАрдВ рд╣реИред рдкрд╛рдЗрдЯреЛрд░рдЪ рдХрд╛ рдХреНрд░реЙрд╕рдПрдВрдЯреНрд░реЙрдкреАрд▓реЙрд╕ рд╕реЙрдлреНрдЯрдореИрдХреНрд╕-рд▓реЙрдЧ-рдПрдирдПрд▓рдПрд▓рд▓реЙрд╕ рдХреЛ рдПрдХ рдЪрд░рдг рдореЗрдВ рдЬреЛрдбрд╝рддрд╛ рд╣реИред рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП, рдХреГрдкрдпрд╛ рдЬрд╝реАрд╣реБ рд▓реЗрдЦ рджреЗрдЦреЗрдВ ["рдПрдирдПрд▓рдПрд▓рдПрд▓реЙрд╕ рдХреЛ рдХреИрд╕реЗ рд╕рдордЭреЗрдВ?"](https://zhuanlan.zhihu.com/p/30187567)***)

```рдЕрдЬрдЧрд░
рдорд╢рд╛рд▓ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = рдорд╢рд╛рд▓.рдПрдирдПрди.рдХрд╛рд░реНрдпрд╛рддреНрдордХ.рд╕реЙрдлреНрдЯрдореИрдХреНрд╕(рдЖрдЙрдЯрдкреБрдЯ.рд▓реЙрдЧрд┐рдЯреНрд╕, рдордВрдж=-1)
рдкреНрд░рд┐рдВрдЯ(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ)
```
```рдЕрдЬрдЧрд░
рдЯреЗрдВрд╕рд░([[4.0195e-02, 9.5980e-01],
        [9.9946e-01, 5.4418e-04]], grad_fn=<рд╕реЙрдлреНрдЯрдореИрдХреНрд╕рдмреИрдХрд╡рд░реНрдб>)
```
рдЗрд╕ рдмрд╛рд░ рдЖрдЙрдЯрдкреБрдЯ рдПрдХ рдкрд╣рдЪрд╛рди рдпреЛрдЧреНрдп рд╕рдВрднрд╛рд╡реНрдпрддрд╛ рд╕реНрдХреЛрд░ рд╣реИред

рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдерд┐рддрд┐ рдХреЗ рдЕрдиреБрд░реВрдк рд▓реЗрдмрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдореЙрдбрд▓ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА id2label рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
model.config.id2label
```
```рдЕрдЬрдЧрд░
{0:'рдирдХрд╛рд░рд╛рддреНрдордХ', 1: 'рд╕рдХрд╛рд░рд╛рддреНрдордХ'}
```
рдЕрдм рд╣рдо рдпрд╣ рдирд┐рд╖реНрдХрд░реНрд╖ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдореЙрдбрд▓ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рддрд╛ рд╣реИ:

рдкрд╣рд▓рд╛ рд╡рд╛рдХреНрдп: рдирдХрд╛рд░рд╛рддреНрдордХ: 0.0402, рд╕рдХрд╛рд░рд╛рддреНрдордХ: 0.9598<br>
рджреВрд╕рд░рд╛ рд╡рд╛рдХреНрдп: рдирдХрд╛рд░рд╛рддреНрдордХ: 0.9995, рд╕рдХрд╛рд░рд╛рддреНрдордХ: 0.0005

## 4. рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдкреНрд░реА-рдЯреНрд░реЗрдирд┐рдВрдЧ рдореЙрдбрд▓ рдмрдирд╛рдПрдВ
>рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдХреЗ рд▓рд┐рдП рдХреЛрдб: [Colab рдореЗрдВ рдЦреЛрд▓реЗрдВ](https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter3/section3.ipynb) (PyTorch), рдЗрд╕рдХреА рдЕрдиреБрд╢рдВрд╕рд╛ рдХреА рдЬрд╛рддреА рд╣реИ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдВ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ. рдХреЛрд▓рд╛рдм рдкрд░ рдбреЗрдЯрд╛ рд╕реЗрдЯ рд▓реЛрдб рдХрд░рдирд╛ рдмрд╣реБрдд рддреЗрдЬрд╝ рд╣реИ, рдФрд░ GPU рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдкреНрд░рд╢рд┐рдХреНрд╖рдг рднреА рддреЗрдЬрд╝ рд╣реИред
>рдЦреЛрд▓рдиреЗ рдХреЗ рдмрд╛рдж, рдКрдкрд░реА рдмрд╛рдПрдБ рдХреЛрдиреЗ рдореЗрдВ "рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ" рдЯреИрдм рдЪреБрдиреЗрдВ, рд▓реИрдкрдЯреЙрдк рд╕реЗрдЯрд┐рдВрдЧреНрд╕-рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдПрдХреНрд╕реЗрд▓реЗрд░реЗрдЯрд░ рдХреЛрдИ рдирд╣реАрдВ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ GPU рдореЗрдВ рдмрджрд▓реЗрдВред

рдзрд╛рд░рд╛ 3 рдореЗрдВ, рд╣рдо рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдФрд░ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рддрд▓рд╛рд╢рддреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╣ рдЕрдзреНрдпрд╛рдп рдЗрд╕реА рдмрд╛рд░реЗ рдореЗрдВ рд╣реИ! рдЖрдкрдХреЛ рд╕реАрдЦрдирд╛ рд╣реЛрдЧрд╛:

- рдореЙрдбрд▓ рд╣рдм рд╕реЗ рдмрдбрд╝реЗ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреИрд╕реЗ рддреИрдпрд╛рд░ рдХрд░реЗрдВ
- рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВрдореЙрдбрд▓ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдкреАрдЖрдИ
- рдХрд╕реНрдЯрдо рдЯреНрд░реЗрдирд┐рдВрдЧ рд▓реВрдк рдХрд╕реНрдЯрдо рдЯреНрд░реЗрдирд┐рдВрдЧ рд▓реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ
- ЁЯдЧрдПрдХреНрд╕реЗрд▓рд░реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рднреА рд╡рд┐рддрд░рд┐рдд рд╕реЗрдЯрдЕрдк рдкрд░ рдЗрд╕ рдХрд╕реНрдЯрдо рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реВрдк рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдХреИрд╕реЗ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдП
### рд╣рдм рд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ
>рдпреВрдЯреНрдпреВрдм рд╡реАрдбрд┐рдпреЛ: [рд╣рдЧрд┐рдВрдЧ рдлреЗрд╕ рдбреЗрдЯрд╛рд╕реЗрдЯреНрд╕ рдЕрд╡рд▓реЛрдХрди](https://youtu.be/_BZearw7f0w) (рдкрд╛рдЗрдЯреЛрд░рдЪ)

рд╣рдм рдореЗрдВ рди рдХреЗрд╡рд▓ рдореЙрдбрд▓ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ; рдЗрд╕рдореЗрдВ рдХрдИ [рдбреЗрдЯрд╛рд╕реЗрдЯ](https://huggingface.co/datasets) рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рдФрд░ рдпреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИрдВред рд╣рдорд╛рд░рд╛ рд╕реБрдЭрд╛рд╡ рд╣реИ рдХрд┐ рдЖрдк рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдПрдХ рдирдпрд╛ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓реЛрдб рдХрд░рдиреЗ рдФрд░ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ ([рд╕рдВрджрд░реНрдн рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг](https://huggingface.co/docs/datasets/loading_datasets.html#from-the-huggingface-hub))ред 

 MRPC рдбреЗрдЯрд╛рд╕реЗрдЯ рдЙрди 10 рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ рдЬреЛ [GLUE рдмреЗрдВрдЪрдорд╛рд░реНрдХ](https://рдЧреНрд▓реВрдмреЗрдВрдЪрдорд╛рд░реНрдХ.com/) рдмрдирд╛рддреЗ рд╣реИрдВред GLUE рдмреЗрдВрдЪрдорд╛рд░реНрдХ рдПрдХ рдЕрдХрд╛рджрдорд┐рдХ рдмреЗрдВрдЪрдорд╛рд░реНрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ 10 рд╡рд┐рднрд┐рдиреНрди рд╕рд╛рд╣рд┐рддреНрдп рдореЗрдВ рдПрдордПрд▓ рдореЙрдбрд▓ рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдорд╛рдкрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИредрдЗрд╕ рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдореЗрдВ рдкреНрд░рджрд░реНрд╢рди.

ЁЯдЧ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╣рдм рдкрд░ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдФрд░ рдХреИрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрд╣реБрдд рд╣реА рд╕рд░рд▓ рдХрдорд╛рдВрдб рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рд╣рдо MRPC рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдХрдЪреНрдЪрд╛_рдбреЗрдЯрд╛рд╕реЗрдЯ = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ ("рдЧреЛрдВрдж", "рдПрдордЖрд░рдкреАрд╕реА")
raw_datasets
```

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ({
    рдЯреНрд░реЗрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
        рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рд▓реЗрдмрд▓', 'idx'],
        рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 3668
    })
    рд╕рддреНрдпрд╛рдкрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
        рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рд▓реЗрдмрд▓', 'idx'],
        рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 408
    })
    рдкрд░реАрдХреНрд╖рдг: рдбреЗрдЯрд╛рд╕реЗрдЯ({
        рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рд▓реЗрдмрд▓', 'idx'],
        рд╕рдВрдЦреНрдпрд╛ рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 1725
    })
})
```
рдЗрд╕рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдПрдХ рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ, рдПрдХ рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдФрд░ рдПрдХ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИред рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ 3,668 рд╡рд╛рдХреНрдп рдЬреЛрдбрд╝реЗ, рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдореЗрдВ 408 рдЬреЛрдбрд╝реЗ рдФрд░ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ 1,725 тАЛтАЛтАЛтАЛрдЬреЛрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рд╡рд╛рдХреНрдп рдпреБрдЧреНрдо рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рдЪрд╛рд░ рдХреЙрд▓рдо рд╣реЛрддреЗ рд╣реИрдВ: 'рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рд▓реЗрдмрд▓' рдФрд░ 'idx'ред

рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рд╡рд┐рдзрд┐, рдЖрдк рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд╛рдиреЛрдВ рд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ<br>
- рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рд╣рдм рд╕реЗ,
- рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рд╕реЗ, рдЬреИрд╕реЗ CSV/JSON/text/pandas рдлрд╝рд╛рдЗрд▓реЗрдВ
- рдЗрди-рдореЗрдореЛрд░реА рдбреЗрдЯрд╛ рдЬреИрд╕реЗ рдкрд╛рдпрдерди рдбрд┐рдХреНрдЯ рдпрд╛ рдкрд╛рдВрдбрд╛ рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо рд╕реЗред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: рдбреЗрдЯрд╛рд╕реЗрдЯ = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ ("рдЯреЗрдХреНрд╕реНрдЯ", рдбреЗрдЯрд╛_рдлрд╝рд╛рдЗрд▓реНрд╕ = {"рдЯреНрд░реЗрди": path_to_train.txt, "рд╕рддреНрдпрд╛рдкрди": path_to_validation.txt} рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП, рдХреГрдкрдпрд╛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рджреЗрдЦреЗрдВ](https://link.zhihu.com/?target=https%3A//huggingface.co/docs/datasets/loading_datasets.html%23from-local-files)

Load_dataset рдХрдорд╛рдВрдб рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рдХреИрд╢ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ ~/.cache/huggingface/dataset рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред рдЖрдк HF_HOME рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рд╕реЗрдЯ рдХрд░рдХреЗ рдХреИрд╢ рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рдХрд╕реНрдЯрдорд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╢рдмреНрджрдХреЛрд╢реЛрдВ рдХреА рддрд░рд╣, raw_datasets рдореЗрдВ рд╡рд╛рдХреНрдп рдЬреЛрдбрд╝реЗ рдХреЛ рдЗрдВрдбреЗрдХреНрд╕ рджреНрд╡рд╛рд░рд╛ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
raw_train_dataset = raw_datasets["рдЯреНрд░реЗрди"]
raw_train_рдбреЗрдЯрд╛рд╕реЗрдЯ[0]
```

```рдЕрдЬрдЧрд░
{'рдЖрдИрдбреАрдПрдХреНрд╕': 0,
 'рд▓реЗрдмрд▓': 1,
 'рд╡рд╛рдХреНрдп 1': 'рдЕрдорд░реЛрдЬрд╝реА рдиреЗ рдЕрдкрдиреЗ рднрд╛рдИ, рдЬрд┐рд╕реЗ рд╡реЗ "рдЧрд╡рд╛рд╣" рдХрд╣рддреЗ рдереЗ, рдкрд░ рдЬрд╛рдирдмреВрдЭрдХрд░ рдЙрдирдХреЗ рд╕рд╛рдХреНрд╖реНрдпреЛрдВ рдХреЛ рд╡рд┐рдХреГрдд рдХрд░рдиреЗ рдХрд╛ рдЖрд░реЛрдк рд▓рдЧрд╛рдпрд╛ред',
 'рд╡рд╛рдХреНрдп 2': 'рдЙрд╕реЗ рдХреЗрд╡рд▓ " рд╡реЗрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рдирд╛рдПрдХ рдЧрд╡рд╛рд╣ ", рдЕрдорд░реЛрдЬреА рдиреЗ рдЕрдкрдиреЗ рднрд╛рдИ рдкрд░ рдЬрд╛рдирдмреВрдЭрдХрд░ рдЙрд╕рдХреЗ рд╕рдмреВрддреЛрдВ рдХреЛ рд╡рд┐рдХреГрдд рдХрд░рдиреЗ рдХрд╛ рдЖрд░реЛрдк рд▓рдЧрд╛рдпрд╛ред'}
```
```рдЕрдЬрдЧрд░
рдкрд╛рдВрдбрд╛ рдХреЛ рдкреАрдбреА рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рд╕рддреНрдпрд╛рдкрди=pd.DataFrame(raw_datasets['рд╕рддреНрдпрд╛рдкрди'])
рдорд╛рдиреНрдпрдХрд░рдг
```
![рд╕рддреНрдпрд╛рдкрди](https://img-blog.csdnimg.cn/df0adbee66ba40dc862e64f5df5e0022.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA56We5rSb5Y2O,size_20 ,рд░рдВрдЧ_FFFFFF,t_70,g_se,x_16#pic_center)
рдпрд╣ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рд▓реЗрдмрд▓ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рдкреВрд░реНрдгрд╛рдВрдХ рд╣реИ рдФрд░ рдЙрд╕реЗ рдХрд┐рд╕реА рдкреВрд░реНрд╡ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рдХреЙрд▓рдо рдХрд╛ рдкреНрд░рдХрд╛рд░ raw_train_dataset рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```рдЕрдЬрдЧрд░
raw_train_dataset.fрд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ
```

```рдЕрдЬрдЧрд░
{'рд╡рд╛рдХреНрдп1': рдорд╛рди(dtype='string', id=None),
 'рд╡рд╛рдХреНрдп2': рдорд╛рди(dtype='string', id=None),
 'рд▓реЗрдмрд▓': рдХреНрд▓рд╛рд╕ рд▓реЗрдмрд▓(num_classes=2, рдирд╛рдо=['not_equivalent', 'рд╕рдорддреБрд▓реНрдп'], name_file=рдХреЛрдИ рдирд╣реАрдВ, id=рдХреЛрдИ рдирд╣реАрдВ),
 'idx': рд╡реИрд▓реНрдпреВ(dtype='int32', id=None)}
```
рд▓реЗрдмрд▓ рдХреНрд▓рд╛рд╕рд▓реЗрдмрд▓ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИ, рд▓реЗрдмрд▓=1 рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡рд╛рдХреНрдпреЛрдВ рдХреА рдЬреЛрдбрд╝реА рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рдкреИрд░рд╛рдлреНрд░реЗрд╢ рд╣реИрдВ, рдФрд░ рд▓реЗрдмрд▓=0 рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡рд╛рдХреНрдпреЛрдВ рдХреЗ рдЕрд╕рдВрдЧрдд рдЕрд░реНрде рд╣реИрдВред

### рдбреЗрдЯрд╛рд╕реЗрдЯ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ
>рдпреВрдЯреНрдпреВрдм рд╡реАрдбрд┐рдпреЛ ["рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рд╡рд╛рдХреНрдп рдЬреЛрдбрд╝реЗ"](https://youtu.be/0u3ioSwev3s)

рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рдЙрди рд╕рдВрдЦреНрдпрд╛рдУрдВ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдореЙрдбрд▓ рд╕рдордЭ рд╕рдХрддрд╛ рд╣реИред

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЪреЗрдХрдкреАрдУрдЗрдВрдЯ = "рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб"
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(рдЪреЗрдХрдкреЙрдЗрдВрдЯ)
```
рдЖрдЗрдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ:
```рдЕрдЬрдЧрд░
рдЗрдирдкреБрдЯреНрд╕ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ ("рдпрд╣ рдкрд╣рд▓рд╛ рд╡рд╛рдХреНрдп рд╣реИред", "рдпрд╣ рджреВрд╕рд░рд╛ рд╣реИред")
рдЖрджрд╛рдиреЛрдВ
```

```рдЕрдЬрдЧрд░
{'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [101, 2023, 2003, 1996, 2034, 6251, 1012, 102, 2023, 2003, 1996, 2117, 2028, 1012, 102],
  'рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА': [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1],
  'рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
```
рдЗрд╕рд▓рд┐рдП, рд╡рд╛рдХреНрдп рдпреБрдЧреНрдореЛрдВ рдХреА рд╕реВрдЪреА рдХреЛ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдореЗрдВ рдкрд╛рд╕ рдХрд░рдХреЗ, рд╕рдВрдкреВрд░реНрдг рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреЛ рдЦрдВрдбрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ:```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд░(
    raw_datasets["рдЯреНрд░реЗрди"]["рд╡рд╛рдХреНрдп1"],
    raw_datasets["рдЯреНрд░реЗрди"]["рд╡рд╛рдХреНрдп2"],
    рдкреИрдбрд┐рдВрдЧ = рд╕рддреНрдп,
    рдХрд╛рдЯ-рдЫрд╛рдБрдЯ = рд╕рддреНрдп,
)
```
рдпрд╣ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╡рд┐рдзрд┐ рдареАрдХ рд╣реИ, рд▓реЗрдХрд┐рди рдиреБрдХрд╕рд╛рди рдпрд╣ рд╣реИ рдХрд┐ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдмрд╛рдж, рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рдЕрдм рдбреЗрдЯрд╛рд╕реЗрдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд▓реМрдЯрд╛рддрд╛ рд╣реИ (рд╣рдорд╛рд░реА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде: рдЗрдирдкреБрдЯ_рдЖрдИрдбреА, рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ рдФрд░ рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА, рд╕рдВрдмрдВрдзрд┐рдд рдХреБрдВрдЬреА-рдореВрд▓реНрдп рдЬреЛрдбрд╝реЗ)ред рдФрд░ рдПрдХ рдмрд╛рд░ рдЬрдм рд╣рдорд╛рд░рд╛ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдореЛрд░реА рдореЗрдВ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдмрдбрд╝рд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЖрдЙрдЯ рдСрдл рдореЗрдореЛрд░реА рдЕрдкрд╡рд╛рдж рдХрд╛ рдХрд╛рд░рдг рдмрдиреЗрдЧрд╛ред (ЁЯдЧ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд┐рд╕реНрдХ рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдЕрдкрд╛рдЪреЗ рдПрд░реЛ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд▓реЛрдб рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдирдореВрдиреЗ рдореЗрдореЛрд░реА рдореЗрдВ рд░рдЦреЗ рдЬрд╛рддреЗ рд╣реИрдВ)ред

рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рдХреЛ рдбреЗрдЯрд╛рд╕реЗрдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЕрдзрд┐рдХ рд▓рдЪреАрд▓реА рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдпрд╣ рд╡рд┐рдзрд┐ рдХреЗрд╡рд▓ рдЯреЛрдХрдирдирд╛рдЗрдЬреЗрд╢рди рд╕реЗ рдЕрдзрд┐рдХ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХрд░ рд╕рдХрддреА рд╣реИред рдорд╛рдирдЪрд┐рддреНрд░ рд╡рд┐рдзрд┐ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддреА рд╣реИрдЙрд╕реА рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рддреЛ рдЪрд▓рд┐рдП рдЗрдирдкреБрдЯ рдХреЛ рдЯреЛрдХрдирд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ:

```рдЕрдЬрдЧрд░
рдбреАрдИрдПрдлрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝_рдлрдВрдХреНрд╢рди(рдЙрджрд╛рд╣рд░рдг):
    рд╡рд╛рдкрд╕реА рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ (рдЙрджрд╛рд╣рд░рдг["рд╡рд╛рдХреНрдп1"], рдЙрджрд╛рд╣рд░рдг["рд╡рд╛рдХреНрдп2"], рдХрд╛рдЯ-рдЫрд╛рдБрдЯ=рд╕рддреНрдп)
```
рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ (рдмрд┐рд▓реНрдХреБрд▓ рд╣рдорд╛рд░реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рдЖрдЗрдЯрдо рдХреА рддрд░рд╣) рдФрд░ рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд▓реМрдЯрд╛рддрд╛ рд╣реИ (рддреАрди рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде: рдЗрдирдкреБрдЯ_рдЖрдИрдбреА, рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ рдФрд░ рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА)ред 

рдкреИрдбрд┐рдВрдЧ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдЯреЛрдХрдирдирд╛рдЗрдЬреЗрд╢рди рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдмреИрдЪ рдореЗрдВ рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдбрд┐рдВрдЧ рдХреА рджрдХреНрд╖рддрд╛ рдкреВрд░реЗ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреА рдЕрдзрд┐рдХрддрдо рдЕрдиреБрдХреНрд░рдо рд▓рдВрдмрд╛рдИ рддрдХ рд╕рднреА рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЛ рдкреИрдбрд┐рдВрдЧ рдХрд░рдиреЗ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛрдЧреАред рдЬрдм рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдХреА рд▓рдВрдмрд╛рдИ рдмрд╣реБрдд рдЕрд╕рдВрдЧрдд рд╣реЛрддреА рд╣реИ рддреЛ рдпрд╣ рдмрд╣реБрдд рд╕рдордп рдФрд░ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╢рдХреНрддрд┐ рдмрдЪрд╛ рд╕рдХрддрд╛ рд╣реИ!

рд╕рдВрдкреВрд░реНрдг рдбреЗрдЯрд╛ рд╕реЗрдЯ рдкрд░ рд▓рд╛рдЧреВ рдЯреЛрдХрдирдирд╛рдЗрдЬреЗрд╢рди рд╡рд┐рдзрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИред рд╣рдордиреЗ рдореИрдк рдХреЙрд▓ рдореЗрдВ рдмреИрдЪ = рдЯреНрд░реВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХреЗ рдмрдЬрд╛рдп рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рддрддреНрд╡реЛрдВ рдХреЗ рдкреВрд░реЗ рдмреИрдЪ рдкрд░ рдПрдХ рд╣реА рдмрд╛рд░ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рддрд░рд╣ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рддреЗрдЬрд╝ рд╣реЛрдЧреА (рдХреНрдпреЛрдВрдХрд┐ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ ЁЯдЧ рдЯреАрдУрдХреЗрдирд╛рдЗрдЬрд╝рд░ рд░рд╕реНрдЯ рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдПрдХ рд╕рд╛рде рдХрдИ рдЗрдирдкреБрдЯ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╕рдордп рдпрд╣ рдмрд╣реБрдд рддреЗрдЬрд╝ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред

```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = raw_рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк(рдЯреЛрдХрдирд╛рдЗрдЬ_рдлрдВрдХреНрд╢рди, рдмреИрдЪ = рд╕рд╣реА)
рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ
```
ЁЯдЧ рдЬрд┐рд╕ рддрд░рд╣ рд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЗрд╕ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ, рд╡рд╣ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдирдП рдлрд╝реАрд▓реНрдб рдЬреЛрдбрд╝рдХрд░ рд╣реЛрддреА рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ({
    рдЯреНрд░реЗрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
        рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ', 'рдЖрдИрдбреАрдПрдХреНрд╕', 'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА', 'рд▓реЗрдмрд▓', 'рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА'],
        рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 3668
    })
    рд╕рддреНрдпрд╛рдкрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
        рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ', 'рдЖрдИрдбреАрдПрдХреНрд╕', 'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА', 'рд▓реЗрдмрд▓', 'рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреАрдПрд╕'],
        рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 408
    })
    рдкрд░реАрдХреНрд╖рдг: рдбреЗрдЯрд╛рд╕реЗрдЯ({
        рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ', 'рдЖрдИрдбреАрдПрдХреНрд╕', 'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА', 'рд▓реЗрдмрд▓', 'рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА'],
        рд╕рдВрдЦреНрдпрд╛ рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 1725
    })
})
```
>рдпрджрд┐ рдЖрдк рдЗрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рддреЗрдЬрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЛ рддреЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд▓реНрдЯреА-рдереНрд░реЗрдб рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддреЗ рд╕рдордп num_proc рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЕрдВрдд рдореЗрдВ, рдЬрдм рд╣рдо рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЛ рдмреИрдЪ-рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рд╕рднреА рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЛ рдмреИрдЪ рдореЗрдВ рд╕рдмрд╕реЗ рд▓рдВрдмреЗ рдЕрдиреБрдХреНрд░рдо рдХреА рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ - рд╣рдо рдЗрд╕ рдЧрддрд┐рд╢реАрд▓ рдкреИрдбрд┐рдВрдЧ рддрдХрдиреАрдХ рдХреЛ рдЧрддрд┐рд╢реАрд▓ рдкреИрдбрд┐рдВрдЧ рдХрд╣рддреЗ рд╣реИрдВ (рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ: рдкреНрд░рддреНрдпреЗрдХ рдмреИрдЪ рдХреЗ рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдХреЛ рднрд░реЗрдВ) рд╕рдорд╛рди рд▓рдВрдмрд╛рдИред рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рд╛рдордЧреНрд░реА рдЕрдВрдд рдореЗрдВ рд░рдЦреА рдЧрдИ рд╣реИ)ред
### рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PyTorch рдореЗрдВ рдлрд╝рд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ
рдЪреВрдВрдХрд┐ PyTorch рдПрдХ рдЗрдирдХреИрдкреНрд╕реБрд▓реЗрдЯреЗрдб рдЯреНрд░реЗрдирд┐рдВрдЧ рд▓реВрдк рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдиреЗ рдПрдХ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕.рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рд▓рд┐рдЦрд╛ рд╣реИ, рдЬреЛ рдПрдХ рд╕рд░рд▓ рд▓реЗрдХрд┐рдирдПрдХ рдкреВрд░реНрдг рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рд╡рд╛рд▓рд╛ PyTorch рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рд▓реВрдк, ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреВрд▓рд┐рдд, рдХрдИ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╡рд┐рдХрд▓реНрдкреЛрдВ рдФрд░ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд╕рд╛рде, рдорд▓реНрдЯреА-рдЬреАрдкреАрдпреВ/рдЯреАрдкреАрдпреВ рд╡рд┐рддрд░рд┐рдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдорд┐рд╢реНрд░рд┐рдд рдкрд░рд┐рд╢реБрджреНрдзрддрд╛ рдХрд╛ рднреА рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред рдпрд╛рдиреА, рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рдПрдХ рдЗрдирдХреИрдкреНрд╕реБрд▓реЗрдЯреЗрдб рдЯреНрд░реЗрдирд░ рд╣реИ (рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдирд┐рд░реНрдорд┐рдд рдПрдХ рдЫреЛрдЯрд╛ рдврд╛рдВрдЪрд╛, рдпрджрд┐ рдпрд╣ рдЯреЗрдиреНрд╕рд░рдлреНрд▓реЛ рд╣реИ, рддреЛ рдпрд╣ рдЯреАрдПрдлрдЯреНрд░реЗрдирд░ рд╣реИ)ред

рд╣рд╛рд▓рд╛рдБрдХрд┐, рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЯреНрд░реЗрдирд░ рдореМрдЬреВрдж рдирд╣реАрдВ рдерд╛ (рд╢реБрд░реБрдЖрддреА рд╕рдВрд╕реНрдХрд░рдг рдирд╣реАрдВ рдереЗ), рдФрд░ рдЪреВрдВрдХрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рд╛рд░реЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдПрдирдПрд▓рдкреА рдХрд╛рд░реНрдп рдореЗрдВ рдХрдИ рд╕рд╛рдорд╛рдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рд╣реЛрддреЗ рд╣реИрдВ, рдЗрдиреНрд╣реЗрдВ рдЯреНрд░реЗрдирд░ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЕрдзрд┐рдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдордЭ рдХреЗ рд▓рд┐рдП, рдЖрдк [рдЯреНрд░реЗрдирд░ рдХреЛрдб](https://github.com/huggingface/transformers/blob/master/examples/pytorch/multiple-choice/run_swag.py) рдХреЗ рдореВрд▓ рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдбреБрдУрдбреБрдУ рджреНрд╡рд╛рд░рд╛. рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╢реБрд░реВ рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдХ рдмрд╕ рдЖрд╡рд╢реНрдпрдХ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдЬреЛрдбрд╝рддрд╛ рд╣реИред

рдбреЗрдЯрд╛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдкреВрд░реА рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдЯреНрд░реЗрдирд░ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдХреБрдЫ рд╕рд░рд▓ рдЪрд░рдгреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдФрд░ рдлрд┐рд░ рдореЙрдбрд▓ рдХреЗ рдмреБрдирд┐рдпрд╛рджреА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЪрдХреНрд░ рдХреЛ рдкреВрд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдЕрдиреНрдпрдерд╛, рдЖрдкрдХреЛ рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдХреНрд░реИрдЪ рд╕реЗ рд▓реЛрдб рдФрд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛) рд╡рд┐рднрд┐рдиреНрди рдкреИрд░рд╛рдореАрдЯрд░, рдФрд░ рдЪрд░рдг рджрд░ рдЪрд░рдг рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓рд┐рдЦреЗрдВ рд▓реВрдкреНрд╕ рдЗрд╕ рдЦрдВрдб рдХреЗ рдЕрдВрдд рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ)редрд╕рдВрднрд╡рддрдГ рдЯреНрд░реЗрдирд░ рдХрд╛ рд╕рдмрд╕реЗ рдХрдард┐рди рд╣рд┐рд╕реНрд╕рд╛ рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рддрд╛рд╡рд░рдг рддреИрдпрд╛рд░ рдХрд░рдирд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕реАрдкреАрдпреВ рдкрд░ рдмрд╣реБрдд рдзреАрдореА рдЧрддрд┐ рд╕реЗ рдЪрд▓рддрд╛ рд╣реИред (рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЬреАрдкреАрдпреВ рд╕реЗрдЯрдЕрдк рдирд╣реАрдВ рд╣реИ, рддреЛ рдЖрдк Google Colab рдкрд░ рдирд┐рдГрд╢реБрд▓реНрдХ рдЬреАрдкреАрдпреВ рдпрд╛ рдЯреАрдкреАрдпреВ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ)

рдкреНрд░рд╢рд┐рдХреНрд╖рдХ рдХреЗ рдореБрдЦреНрдп рдорд╛рдкрджрдВрдбреЛрдВ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:
- рдореЙрдбрд▓: рдкреНрд░рд╢рд┐рдХреНрд╖рдг, рдореВрд▓реНрдпрд╛рдВрдХрди рдпрд╛ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдореЙрдбрд▓
- рддрд░реНрдХ (рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ): рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕рдорд╛рдпреЛрдЬрди рдкреИрд░рд╛рдореАрдЯрд░ред рдпрджрд┐ рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕ рдХреЗ рдЖрдзрд╛рд░ рдЙрджрд╛рд╣рд░рдг рдкрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╣реЛ рдЬрд╛рдПрдЧрд╛
- рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ (рдбреЗрдЯрд╛рдХреЛрд▓реЗрдЯрд░, рд╡реИрдХрд▓реНрдкрд┐рдХ) - рдмреИрдЪ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ рдпрд╛ eval_рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди
- рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ: рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ
- eval_dataset: рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ
- рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕: рдореВрд▓реНрдпрд╛рдВрдХрди рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдлрд╝рдВрдХреНрд╢рдиред EvalPrediction рдХреЛ рдкрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд▓реМрдЯрд╛рдПрдЧрд╛ рдЬрд┐рд╕рдХреЗ рдХреБрдВрдЬреА-рдореВрд▓реНрдп рдЬреЛрдбрд╝реЗ рдореАрдЯреНрд░рд┐рдХ рдФрд░ рдЙрд╕рдХреЗ рдореВрд▓реНрдп рд╣реИрдВред
- рдХреЙрд▓рдмреИрдХ (рдХреЙрд▓рдмреИрдХ рдлрд╝рдВрдХреНрд╢рди, рд╡реИрдХрд▓реНрдкрд┐рдХ): рдХрд╕реНрдЯрдо рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реВрдк рдХреЗ рд▓рд┐рдП рдХреЙрд▓рдмреИрдХ рдХреА рд╕реВрдЪреА (рдЯреНрд░реЗрдирд░рдХреЙрд▓рдмреИрдХ рдХреА рд╕реВрдЪреА)
- рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд░: рдПрдХ рдореЗрдЯрд╛ рдЬрд┐рд╕рдореЗрдВ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд░ рдФрд░ рд╕реАрдЦрдиреЗ рдХреА рджрд░ рд╕рдорд╛рдпреЛрдЬрдХ рд╢рд╛рдорд┐рд▓ рд╣реИрдВрд╕рдореВрд╣, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЕрдиреБрдХреВрд▓рдХ рдПрдбрдордбрдмреНрд▓реНрдпреВ рд╣реИ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реАрдЦрдиреЗ рдХреА рджрд░ рдПрдХ рд░реИрдЦрд┐рдХ рд╕реАрдЦрдиреЗ рдХреА рджрд░ рд╣реИ, 5e-5 рд╕реЗ 0 рддрдХ


рдЙрдкрд░реЛрдХреНрдд рдореБрдЦреНрдп рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ рдкреИрд░рд╛рдореАрдЯрд░ рдФрд░ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рднреА рд╣реИрдВ (рджрд░реНрдЬрдиреЛрдВ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП, рдЖрдк рдЗрд╕ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдВрдкреВрд░реНрдг рдЯреНрд░реЗрдирд░ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ [рдпрд╣рд╛рдВ] (https://huggingface.co/transformers) рдкрд░ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ /main_classes/trainer.html?highlight =trainer#transformers.Trainer))

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рдорд╛рдирддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдиреЗ рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдЙрджрд╛рд╣рд░рдг рдкрд╣рд▓реЗ рд╣реА рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoTokenizer, DataCollatorWithPadding рдЖрдпрд╛рдд рдХрд░реЗрдВ

raw_datasets = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ("рдЧреЛрдВрдж", "mrpc")#MRPC рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рджреЛ рд╡рд╛рдХреНрдп рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рдкреИрд░рд╛рдлреНрд░реЗрд╢ рд╣реИрдВ
рдЪреЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ = "рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб"
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(рдЪреЗрдХрдкреЙрдЗрдВрдЯ)

рдбреАрдИрдПрдлрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝_рдлрд╝рдВрдХреНрд╢рди(рдЙрджрд╛рд╣рд░рдг):
    рд╡рд╛рдкрд╕реА рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ (рдЙрджрд╛рд╣рд░рдг["рд╡рд╛рдХреНрдп1"], рдЙрджрд╛рд╣рд░рдг["рд╡рд╛рдХреНрдп2"], рдХрд╛рдЯ-рдЫрд╛рдБрдЯ=рд╕рддреНрдп)

рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = raw_рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк(рдЯреЛрдХрдирд╛рдЗрдЬ_рдлрдВрдХреНрд╢рди, рдмреИрдЪ = рд╕рд╣реА)
data_collator = DataCollatorWithPadding(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░=рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░)#рдбрд╛рдпрдирд╛рдорд┐рдХ рдлрд┐рд▓рд┐рдВрдЧ, рдпрд╛рдиреА рдкреНрд░рддреНрдпреЗрдХ рдмреИрдЪ рдХреЗ рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдХреЛ рд╕рдорд╛рди рд▓рдВрдмрд╛рдИ рддрдХ рднрд░рдирд╛
```

#### рд░реЗрд▓рдЧрд╛рдбрд╝реА
рдЯреНрд░реЗрдирд░ рдХрд╛ рдкрд╣рд▓рд╛ рдкреИрд░рд╛рдореАрдЯрд░ рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕ рдХреНрд▓рд╛рд╕ рд╣реИ, рдЬреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реВрдк рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдПрдХ рд╕рдмрд╕реЗрдЯ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЯреНрд░реЗрдирд░ рдореЗрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдПрдХрдорд╛рддреНрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдЬреЛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рд╡рд╣ рд╣реИ: рд╡рд╣ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЬрд╣рд╛рдВ рдореЙрдбрд▓ рдпрд╛ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рд╣реИред рдЕрдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ 3 рдпреБрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░рд╢рд┐рдХреНрд╖рдг, рдЖрджрд┐) (рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕ рдореЗрдВ рднреА рджрд░реНрдЬрдиреЛрдВ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВред рд╕рд╛рдорд╛рдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВ) рд▓реЗрдЦ рдХреЗ рдЕрдВрдд рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИред рд╕рдВрдкреВрд░реНрдг рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдКрдкрд░ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдЯреНрд░реЗрдирд░ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╢рд╛рдорд┐рд▓ рд╣реИ)

```рдЕрдЬрдЧрд░
рдкрд░рд┐рд╡рд░реНрддрди рд╕реЗрд╡реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ

рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧреНрд╕ = рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ("рдкрд░реАрдХреНрд╖рдг-рдкреНрд░рд╢рд┐рдХреНрд╖рдХ")
```
рдЪрд░рдг 2: рдореЙрдбрд▓ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ
рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдХреА рддрд░рд╣, рд╣рдо рджреЛ рд▓реЗрдмрд▓ рдХреЗ рд╕рд╛рде AutoModelForSequenceClassification рдХреНрд▓рд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ:
(***рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЖрдк рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдХрд╛рд░реНрдп рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХрд╛рд░реНрдп рдкреНрд░рдореБрдЦ рдЪреБрдирддреЗ рд╣реИрдВ***)
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForSequenceClassification рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдореЙрдбрд▓ = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=2)#рд▓реЗрдмрд▓ рдХреА рд╕рдВрдЦреНрдпрд╛ 2 рд╣реИ, рдЬреЛ рджреЛ рд╢реНрд░реЗрдгрд┐рдпрд╛рдВ рд╣реИрдВ
```
рдЗрд╕ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдПрдХ рдЪреЗрддрд╛рд╡рдиреА рдХреА рд╕реВрдЪрдирд╛ рджреА рдЬрд╛рдПрдЧреАред рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ BERT рдХреЛ рд╡рд╛рдХреНрдп рдпреБрдЧреНрдо рд╡рд░реНрдЧреАрдХрд░рдг рдкрд░ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдкреНрд░рдореБрдЦ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЕрдиреБрдХреНрд░рдо рд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рдПрдХ рдирдпрд╛ рдкреНрд░рдореБрдЦ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╣реИред рдЪреЗрддрд╛рд╡рдиреА рдЗрдВрдЧрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдХреБрдЫ рд╡рдЬрд╝рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЫреЛрдбрд╝реЗ рдЧрдП рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рд╕рд┐рд░ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рдЕрдиреБрд░реВрдк), рдЬрдмрдХрд┐ рдХреБрдЫ рдЕрдиреНрдп рд╡рдЬрд╝рди рдХреЛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ(рдирдпрд╛ рдореБрдЦреНрдп рдЕрдиреБрднрд╛рдЧ), рдФрд░ рдЕрдВрддрддрдГ рдЖрдкрдХреЛ рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрддреНрд╕рд╛рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИред

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдореЙрдбрд▓ рд╣реЛ, рддреЛ рдЖрдк рдПрдХ рдЯреНрд░реЗрдирд░ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдореЙрдбрд▓ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЕрдм рддрдХ рдмрдирд╛рдП рдЧрдП рд╕рднреА рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЛ рдЗрд╕рдореЗрдВ рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрди рд╡рд╕реНрддреБрдУрдВ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ: рдореЙрдбрд▓, рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧ, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рд╕рддреНрдпрд╛рдкрди рдбреЗрдЯрд╛рд╕реЗрдЯ, рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ рдФрд░ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ред (рдпреЗ рд╕рднреА рдЯреНрд░реЗрдирд░ рдХреЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВ):

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдЯреНрд░реЗрдирд░ рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ

рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
    рдирдореВрдирд╛,
    рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧ,
    рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
    eval_dataset=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"],
    рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░=рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░,
    рдЯреЛрдХрдирдирд╛рдЗрдЬрд░=рдЯреЛрдХрдирд╛рдЗрдЬрд░,
)
```
рдЙрдкрд░реЛрдХреНрдд рдХреА рддрд░рд╣ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдкрд╛рд╕ рдХрд░рддреЗ рд╕рдордп, рдкреИрд░рд╛рдореАрдЯрд░ data_colllator рдкрд╣рд▓реЗ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдкреИрдбреЗрдб DataCollatorWithPadding рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕ рдХреЙрд▓ рдореЗрдВ data_colllator=daTa_collater рд▓рд╛рдЗрди рдХреЛ рдЫреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред (рд▓реЗрдХрд┐рди рдЖрдкрдХреЛ рдЕрдиреБрднрд╛рдЧ 2 рдореЗрдВ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдпрд╣ рднрд╛рдЧ рджрд┐рдЦрд╛рдирд╛ рдЕрднреА рднреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рдерд╛!)

рдЕрдкрдиреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░ рдореЙрдбрд▓ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдмрд╕ рдЯреНрд░реЗрдирд░ рдХреА рдЯреНрд░реЗрди рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```
рдлрд╝рд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ (рд▓рдЧрднрдЧ 6 рдорд┐рдирдЯ рдХреЗ рд▓рд┐рдП рдХреЛрд▓рд╛рдм рдкрд░ GPU рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ), рдФрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдмрд╛рдж, рдпрд╣ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрд▓рдо рдореЗрдВ `BertForSequenceClassification.forward` рдореЗрдВ рдХреЛрдИ рд╕рдВрдЧрдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: рд╡рд╛рдХреНрдп 1, рд╡рд╛рдХреНрдп 2, idxред
***** рджреМрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг *****
  рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 3668
  рдпреБрдЧреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 3
  рдкреНрд░рддрд┐ рджрд┐рди рддрд╛рддреНрдХрд╛рд▓рд┐рдХ рдмреИрдЪ рдЖрдХрд╛рд░рдпреБрдХреНрддрд┐=8
  рдХреБрд▓ рдЯреНрд░реЗрди рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ (рд╕рдорд╛рдирд╛рдВрддрд░, рд╡рд┐рддрд░рд┐рдд рдФрд░ рд╕рдВрдЪрдп рд╕рд╣рд┐рдд) = 8
  рдХреНрд░рдорд┐рдХ рд╕рдВрдЪрдп рдЪрд░рдг = 1
  рдХреБрд▓ рдЕрдиреБрдХреВрд▓рди рдЪрд░рдг = 1377
  
рдЪрд░рдг рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐
500 0.544700
1000 0.326500

рдЯреНрд░реЗрдирдЖрдЙрдЯрдкреБрдЯ(рдЧреНрд▓реЛрдмрд▓_рд╕реНрдЯреЗрдк=1377, рдЯреНрд░реЗрдирд┐рдВрдЧ_рд▓реЙрд╕=0.3773723704795865, рдореЗрдЯреНрд░рд┐рдХреНрд╕={'рдЯреНрд░реЗрди_рд░рдирдЯрд╛рдЗрдо': 379.1704, 'рдЯреНрд░реЗрди_рд╕реИрдВрдкрд▓реНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 29.021, 'рдЯреНрд░реЗрди_рд╕реНрдЯреЗрдкреНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 3.632, 'рдЯреЛрдЯрд▓_рдлреНрд▓реЛрд╕': 405470580750720ред 0, 'рдЯреНрд░реЗрди_рд▓реЙрд╕': 0.3773723704795865, 'рдпреБрдЧ': 3.0})
#рдСрдкрд░реЗрд╢рди рдХреЗ рджреМрд░рд╛рди рдХреЗрд╡рд▓ 500 рдЪрд░рдгреЛрдВ рдФрд░ 1000 рдЪрд░рдгреЛрдВ рдХреЗ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ рдЕрдВрддрд┐рдо рдкрд░рд┐рдгрд╛рдо 1377 рдЪрд░рдгреЛрдВ рдХрд╛ рд╣реЛрддрд╛ рд╣реИредs, рдЕрдВрддрд┐рдо рд╣рд╛рдирд┐ 0.377 рд╣реИ
```

рд╣рдо рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдХреА рдкреВрд░реНрд╡-рд╕рдВрд╕рд╛рдзрд┐рдд рд╕рдВрд░рдЪрдирд╛ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"]
```
```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ({
    рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ', 'рдЖрдИрдбреАрдПрдХреНрд╕', 'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА', 'рд▓реЗрдмрд▓', 'рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА'],
    рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 408
})
```
рд╣рдо рдореЙрдбрд▓ рдХреЗ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░.рдкреНрд░реЗрдбрд┐рдХреНрдЯ рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = рдЯреНрд░реЗрдирд░.рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА(рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"])
рдкреНрд░рд┐рдВрдЯ(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ.рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ.рдЖрдХрд╛рд░, рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ.рд▓реЗрдмрд▓_рдЖрдИрдбреА.рдЖрдХрд╛рд░)
```

```рдЕрдЬрдЧрд░
(408, 2) (408,)
```
рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рд╡рд┐рдзрд┐ рддреАрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдЯреБрдкрд▓ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддреА рд╣реИред
- рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ: рдЕрдиреБрдорд╛рдирд┐рдд рдореВрд▓реНрдп, рдЖрдХрд╛рд░: [рдмреАрдПtch_size, num_labels], рд╕реЙрдлреНрдЯрдореИрдХреНрд╕ рдХреЗ рдмрд╛рдж рдкрд░рд┐рдгрд╛рдо рдХреЗ рдмрдЬрд╛рдп рд▓реЙрдЧ рд╣реИрдВ
- рд▓реЗрдмрд▓_рдЖрдИрдбреА: рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЗрдмрд▓ рдЖрдИрдбреА
- рдореЗрдЯреНрд░рд┐рдХреНрд╕: рдореВрд▓реНрдпрд╛рдВрдХрди рдореЗрдЯреНрд░рд┐рдХреНрд╕, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐ рд╣реИ, рдФрд░ рдХреБрдЫ рд╕рдордп рдореЗрдЯреНрд░рд┐рдХреНрд╕ (рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХреБрд▓ рд╕рдордп рдФрд░ рдФрд╕рдд рд╕рдордп)ред рд▓реЗрдХрд┐рди рдПрдХ рдмрд╛рд░ рдЬрдм рд╣рдо рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЯреНрд░реЗрдирд░ рдХреЗ рдкрд╛рд╕ рднреЗрдЬ рджреЗрддреЗ рд╣реИрдВ, рддреЛ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рд░рд┐рдЯрд░реНрди рдорд╛рди рднреА рдЖрдЙрдЯрдкреБрдЯ рд╣реЛрдЧрд╛ред

![рдПрдордЖрд░рдкреАрд╕реА](https://img-blog.csdnimg.cn/7a920b0dddf147cf87b38fb18a0ad0a8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA56We5rSb5Y2O,size_ 20, рд░рдВрдЧ_FFFFFF,t_70,g_se,x_16#pic_center)
```рдЕрдЬрдЧрд░
рдореЗрдЯреНрд░рд┐рдХреНрд╕={'test_los': 0.6269022822380066, 'test_runtime': 4.0653, 'test_samples_рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб': 100.362, 'рдЯреЗрд╕реНрдЯ_рд╕реНрдЯреЗрдкреНрд╕_рдкреНрд░рддрд┐_рд╕реЗрдХрдВрдб': 12.545})
```
рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди 408 x 2 рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде рдПрдХ рджреНрд╡рд┐-рдЖрдпрд╛рдореА рд╕рд░рдгреА рд╣реИ (рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдбреЗрдЯрд╛ рдХреЗ 408 рд╕реЗрдЯ, рджреЛ рд▓реЗрдмрд▓)ред рд▓реЗрдмрд▓ рдХреЗ рд╕рд╛рде рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдХреА рджреВрд╕рд░реА рдзреБрд░реА рдкрд░ рдЕрдзрд┐рдХрддрдо рдореВрд▓реНрдп рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рд▓реЗрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
```рдЕрдЬрдЧрд░
рдПрдирдкреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реБрдиреНрди рдЖрдпрд╛рдд рдХрд░реЗрдВ
preds = np.argmax(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ.рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рдЕрдХреНрд╖=-1)
```
рд╕рд╛рде рд╣реА, рдЬреИрд╕рд╛ рдХрд┐ рдЙрдкрд░реЛрдХреНрдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: рдореЙрдбрд▓ рд╣рд░ 500 рдХрджрдо рдкрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐ рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣ рдЖрдкрдХреЛ рдирд╣реАрдВ рдмрддрд╛рддрд╛ рдХрд┐ рдореЙрдбрд▓ рдХрд┐рддрдирд╛ рдЕрдЪреНрдЫрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╣реИ рдХреНрдпреЛрдВрдХрд┐:
1. рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗрдЯ рдирд╣реАрдВ рд╣реИ, рдЬреЛ рдореЙрдбрд▓ рдХреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдиреБрдХрд╕рд╛рди рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рддрдиреЗ "рдЪрд░рдг" (eval_steps) рдпрд╛ "рдпреБрдЧ"ред
2. рдкреНрд░рд╢рд┐рдХреНрд╖рдХ рдХрд╛ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореВрд▓реНрдпрд╛рдВрдХрди рд╕рдВрдХреЗрддрдХреЛрдВ (рдЬреИрд╕реЗ рдПрд╕реАрд╕реА, рдПрдл1 рд╕реНрдХреЛрд░, рдЖрджрд┐) рдХреЗ рдореВрд▓реНрдпреЛрдВ рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рд╕реЗрдЯ рдХрд┐рдП рдмрд┐рдирд╛, рдХреЗрд╡рд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддреА рд╣реИ, рдЬреЛ рдПрдХ рд╕рд╣рдЬ рд╕рдВрдЦреНрдпрд╛ рдирд╣реАрдВ рд╣реИред

рдФрд░ рдЕрдЧрд░ рд╣рдо рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдХрд░реЗрдВрдЧреЗрдлрд╝рдВрдХреНрд╢рди рд▓рд┐рдЦреЗ рдЬрд╛рдиреЗ рдФрд░ рдЯреНрд░реЗрдирд░ рдХреЛ рджрд┐рдП рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдлрд╝реАрд▓реНрдб рдореЗрдВ compute_metrics рджреНрд╡рд╛рд░рд╛ рд▓реМрдЯрд╛рдпрд╛ рдЧрдпрд╛ рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдорд╛рди рднреА рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧрд╛ред
#### рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд╛рд░реНрдп
рдЕрдм рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХреИрд╕реЗ рдХрд░реЗрдВред рдпрд╣ рдлрд╝рдВрдХреНрд╢рди:
- EvalPrediction рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдкрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред EvalPrediction рдПрдХ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдлрд╝реАрд▓реНрдб рдФрд░ рдПрдХ label_ids рдлрд╝реАрд▓реНрдб рд╡рд╛рд▓рд╛ рдПрдХ рдЯрдкрд▓ рд╣реИред
- рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд▓реМрдЯрд╛рддрд╛ рд╣реИ, рдХреБрдВрдЬреА-рдореВрд▓реНрдп рдЬреЛрдбрд╝реА рдХреБрдВрдЬреА рд╣реИ: рдореАрдЯреНрд░рд┐рдХ рдирд╛рдо (рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкреНрд░рдХрд╛рд░), рдорд╛рди: рдореАрдЯреНрд░рд┐рдХ рдорд╛рди (рдлреНрд▓реЛрдЯ рдкреНрд░рдХрд╛рд░)ред

***рд╡рд╣ рд╣реИ [рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ 4.1](https://datawhalechina.github.io/learn-nlp-with-transformers/#/./%E7%AF%87%E7%AB%A04-%E4%BD% BF%E7%94%A8рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░%E8%A7%A3%E5%86%B3NLP%E4%BB%BB%E5%8A%A1/4.1-%E6%96%87%E6%9C%AC%E5%88 %86%E7%B1%BB) рдиреЗ рдХрд╣рд╛: рд╕реАрдзреЗ рдореАрдЯреНрд░рд┐рдХ рдХреА рдЧрдгрдирд╛ рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ рдФрд░ рд▓реЗрдмрд▓ рдФрд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ рдкрд╛рд╕ рдХрд░реЗрдВредрдЖрдк рдореАрдЯреНрд░рд┐рдХ рдХрд╛ рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ. рдРрд╕рд╛ рдХрд░рдиреЗ рд╕реЗ рд╣реА рдЖрдк рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдПрд╕реАрд╕реА, рдПрдл1 рдФрд░ рдЕрдиреНрдп рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдВрдХреЗрддрдХ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ)***

рдЕрдкрдиреЗ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реЗ рдореАрдЯреНрд░рд┐рдХ рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░реЗрдВрдЧреЗред рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рд╣рдо рдПрдордЖрд░рдкреАрд╕реА рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдЬреБрдбрд╝реЗ рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд╕рдорд╛рди рдЖрд╕рд╛рдиреА рд╕реЗ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд▓реМрдЯрд╛рдИ рдЧрдИ рд╡рд╕реНрддреБ рдореЗрдВ рдПрдХ рдЧрдгрдирд╛ рд╡рд┐рдзрд┐ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рдо рдореАрдЯреНрд░рд┐рдХ рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдореАрдЯреНрд░рд┐рдХ = рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ ("рдЧреЛрдВрдж", "рдПрдордЖрд░рдкреАрд╕реА")
metric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди, рд╕рдВрджрд░реНрдн=рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ.рд▓реЗрдмрд▓_рдЖрдИрдбреА)
```

```рдЕрдЬрдЧрд░
{'рд╕рдЯреАрдХрддрд╛': 0.8578431372549019, 'рдПрдл1': 0.8996539792387542}#рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдкрд░ рдореЙрдбрд▓ рдХреА рд╕рдЯреАрдХрддрд╛ 85.78% рд╣реИ, рдФрд░ рдПрдл1 рд╕реНрдХреЛрд░ 89.9 рд╣реИ7
```
рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдореЙрдбрд▓ рд╣реЗрдб рдХрд╛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЖрд░рдВрднреАрдХрд░рдг рдЕрдВрддрд┐рдо рдореАрдЯреНрд░рд┐рдХ рдорд╛рди рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдВ рдЕрдВрддрд┐рдо рдкрд░рд┐рдгрд╛рдо рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдП рдЧрдП рдкрд░рд┐рдгрд╛рдореЛрдВ рд╕реЗ рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдПрд╕реАрд╕реА рдФрд░ рдПрдл1 рджреЛ рдореЗрдЯреНрд░рд┐рдХреНрд╕ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ GLUE рдмреЗрдВрдЪрдорд╛рд░реНрдХ рдХреЗ MRPC рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдмреАрдИрдЖрд░рдЯреА рдкреЗрдкрд░ рдХреА рддрд╛рд▓рд┐рдХрд╛ рдмреЗрд╕ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП 88.9 рдХреЗ рдПрдл1 рд╕реНрдХреЛрд░ рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рддреА рд╣реИред рд╡рд╣ рдЕрди-рдХреЗрд╕реНрдб рдореЙрдбрд▓ рдерд╛, рдЬрдмрдХрд┐ рд╣рдо рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдХреЗрд╕реНрдб рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЬреЛ рдмреЗрд╣рддрд░ рдкрд░рд┐рдгрд╛рдо рдмрддрд╛рддрд╛ рд╣реИред (рдХреЗрд╕реНрдб рдХрд╛ рдорддрд▓рдм рдЕрдВрдЧреНрд░реЗрдЬреА рдореЗрдВ рдЕрдкрд░ рдФрд░ рд▓реЛрдЕрд░ рдХреЗрд╕ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рдирд╛ рд╣реИ)

рдЙрдкрд░реЛрдХреНрдд рдХреЛ рдПрдХ рд╕рд╛рде рд░рдЦрдиреЗ рдкрд░, рд╣рдореЗрдВ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдлрд╝рдВрдХреНрд╢рди рдорд┐рд▓рддрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдбреАрдИрдПрдлрд╝ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕(eval_preds):
    рдореАрдЯреНрд░рд┐рдХ = рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ ("рдЧреЛрдВрдж", "рдПрдордЖрд░рдкреАрд╕реА")
    рд▓реЙрдЧрд┐рдЯ, рд▓реЗрдмрд▓ = eval_preds
    рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = np.argmax(рд▓реЙрдЧрд┐рдЯреНрд╕, рдЕрдХреНрд╖=-1)
    рд╡рд╛рдкрд╕реА metric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд╕рдВрджрд░реНрдн=рд▓реЗрдмрд▓)
```
рдлрд┐рд░ рдЗрд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдпреБрдЧ рдореЗрдВ рд╕рддреНрдпрд╛рдкрди рдореВрд▓реНрдпрд╛рдВрдХрди рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд░реЗрдВред рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ рдХрд┐ рд╣рдо рдХрдВрдкреНрдпреВрдЯрд░ рдХреИрд╕реЗ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВte_metrics рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдмрд╛рдж рдЯреНрд░реЗрдирд░:

```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧреНрд╕ = рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ('рдкрд░реАрдХреНрд╖рдг-рдкреНрд░рд╢рд┐рдХреНрд╖рдХ', рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐='рдпреБрдЧ'')
рдореЙрдбрд▓ = AutoModelForSequenceClassification.from_pretrained(рдЪреЗрдХрдкреЙрдЗрдВрдЯ, num_labels=2)
```
```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
    рдирдореВрдирд╛,
    рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧ,
    рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
    eval_dataset=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"],
    рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░=рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░,
    рдЯреЛрдХрдирдирд╛рдЗрдЬрд░=рдЯреЛрдХрдирд╛рдЗрдЬрд░,
    рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ = рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕
)
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдордиреЗ рдПрдХ рдирдпрд╛ рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕ рдмрдирд╛рдпрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВion_strategy рдХреЛ "рдпреБрдЧ" рдФрд░ рдПрдХ рдирдП рдореЙрдбрд▓ рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ - рдЕрдиреНрдпрдерд╛, рд╣рдо рдХреЗрд╡рд▓ рдЙрд╕ рдореЙрдбрд▓ рдХрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЬрд╛рд░реА рд░рдЦреЗрдВрдЧреЗ рдЬрд┐рд╕реЗ рд╣рдо рдкрд╣рд▓реЗ рд╣реА рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░ рдЪреБрдХреЗ рд╣реИрдВред рдПрдХ рдирдпрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд░рди рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```
рдЕрдВрддрд┐рдо рдкреНрд░рд╢рд┐рдХреНрд╖рдг 6 рдорд┐рдирдЯ рдФрд░ 33 рд╕реЗрдХрдВрдб рддрдХ рдЪрд▓рд╛, рдЬреЛ рдкрд┐рдЫрд▓реА рдмрд╛рд░ рд╕реЗ рдереЛрдбрд╝рд╛ рд▓рдВрдмрд╛ рдерд╛ред рдЕрдВрддрд┐рдо рдЪрд▓ рд░рд╣рд╛ рдкрд░рд┐рдгрд╛рдо рд╣реИ:
```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрд▓рдо рдореЗрдВ `BertForSequenceClassification.forward` рдореЗрдВ рдХреЛрдИ рд╕рдВрдЧрдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: рд╡рд╛рдХреНрдп 1, рд╡рд╛рдХреНрдп 2, idxред
***** рджреМрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг *****
  рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 3668
  рдпреБрдЧреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 3
  рдкреНрд░рддрд┐ рдЙрдкрдХрд░рдг рддрд╛рддреНрдХрд╛рд▓рд┐рдХ рдмреИрдЪ рдЖрдХрд╛рд░ = 8
  рдХреБрд▓ рдЯреНрд░реЗрди рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ (рд╕рдорд╛рдирд╛рдВрддрд░, рд╡рд┐рддрд░рд┐рдд рдФрд░ рд╕рдВрдЪрдп рд╕рд╣рд┐рдд) = 8
  рдЧреНрд░рд╛рд╕рд╣рд╛рдпрдХ рд╕рдВрдЪрдп рдЪрд░рдг = 1
  рдХреБрд▓ рдЕрдиреБрдХреВрд▓рди рдЪрд░рдг = 1377
  
рдпреБрдЧ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐ рд╕рддреНрдпрд╛рдкрди рд╣рд╛рдирд┐ рд╕рдЯреАрдХрддрд╛ F1
1 рдХреЛрдИ рд▓реЙрдЧ рдирд╣реАрдВ 0.557327 0.806373 0.872375
2 0.552700 0.458040 0.862745 0.903448
3 0.333900 0.560826 0.867647 0.907850
рдЯреНрд░реЗрдирдЖрдЙрдЯрдкреБрдЯ(рдЧреНрд▓реЛрдмрд▓_рд╕реНрдЯреЗрдк=1377, рдЯреНрд░реЗрдирд┐рдВрдЧ_рд▓реЙрд╕=0.37862846690325436, рдореЗрдЯреНрд░рд┐рдХреНрд╕={'рдЯреНрд░реЗрди_рд░рдирдЯрд╛рдЗрдо': 393.5652, 'рдЯреНрд░реЗрди_рд╕реИрдВрдкрд▓реНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 27.96, 'рдЯреНрд░реЗрди_рд╕реНрдЯреЗрдкреНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 3.499, 'рдЯреЛрдЯрд▓_рдлреНрд▓реЛрд╕': 405470580750720ред 0, 'рдЯреНрд░реЗрди_рд▓реЙрд╕': 0.37862846690325436, 'рдпреБрдЧ': 3.0})
```
рдЗрд╕ рдмрд╛рд░, рдЬрдм рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рддреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкреНрд░рддреНрдпреЗрдХ рдпреБрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рд╕рддреНрдпрд╛рдкрди рд╣рд╛рдирд┐ рдФрд░ рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдХреА рднреА рд╕реВрдЪрдирд╛ рджреА рдЬрд╛рдПрдЧреАред рдлрд┐рд░, рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХреА рдЧрдИ рд╕рдЯреАрдХ рд╕рдЯреАрдХрддрд╛/F1 рд╕реНрдХреЛрд░ рдореЙрдбрд▓ рдХреЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдХрд╛рд░реНрдп рд╢реАрд░реНрд╖ рдЖрд░рдВрднреАрдХрд░рдг рдХреЗ рдХрд╛рд░рдг рд╣рдореЗрдВ рдЬреЛ рдорд┐рд▓рд╛ рдЙрд╕рд╕реЗ рдереЛрдбрд╝рд╛ рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдЙрд╕реА рд╕реАрдорд╛ рдореЗрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
  
рдЯреНрд░реЗрдирд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдПрдХрд╛рдзрд┐рдХ рдЬреАрдкреАрдпреВ/рдЯреАрдкреАрдпреВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдорд┐рд╢реНрд░рд┐рдд рдкрд░рд┐рд╢реБрджреНрдзрддрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХрд╛ рднреА рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред рдЖрдк рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕ рдореЗрдВ fp16 = True рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
  
рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмрд╣реБрдд рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ, рд▓реЗрдХрд┐рди рдЙрдиреНрдирдд рдЗрдирдХреИрдкреНрд╕реБрд▓реЗрдЯреЗрдб рдПрдкреАрдЖрдИ рдХреА рдЕрдкрдиреА рдХрдорд┐рдпрд╛рдВ рднреА рд╣реИрдВ, рдпрд╛рдиреА рдпрд╣ рдХрдИ рдЕрдиреБрдХреВрд▓рд┐рдд рдСрдкрд░реЗрд╢рди рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП рд╣рдо рдкрд╛рд░рдВрдкрд░рд┐рдХ рдкрд╛рдЗрдЯреЛрд░рдЪ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЪрдХреНрд░ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рд╡рд┐рддрд░рд┐рдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕реЗрд▓реЗрд░реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рднреА рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ (рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рд╕рднреА рдПрдХрд▓ рдЬреАрдкреАрдпреВ/рд╕реАрдкреАрдпреВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛)ред рд╕рд╛рдордЧреНрд░реА рдХреЗ рдЗрд╕ рднрд╛рдЧ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред рдпрджрд┐ рдЖрдк рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдореВрд▓ рдкрд╛рда ["рдПрдХ рдкреВрд░реНрдг рдкреНрд░рд╢рд┐рдХреНрд╖рдг"](https://huggingface.co/course/chapter3/4?fw=pt) рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред рдЕрдиреБрд╡рд╛рдж ["рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдореЙрдбрд▓ рдХреЛ рдареАрдХ рдХрд░рдирд╛"] (https://blog.csdn.net/qq_56591814/article/details/120147114)ред
  
##5.рдкреВрд░рдХ рднрд╛рдЧ
### рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреЗ рдЕрдзреНрдпрд╛рдп 4 рдореЗрдВ рдореЙрдбрд▓ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ?

рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рджреЛ рдЙрдкрдпреЛрдЧ рд╣реИрдВ:
- рдлрд╝реАрдЪрд░ рдирд┐рд╖реНрдХрд░реНрд╖рдг (рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдмрд╛рдж рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗ рдирд╣реАрдВ рдЧреБрдЬрд░рддрд╛ рд╣реИ рдФрд░ рд╡рдЬрд╝рди рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ)
- рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ (рдбрд╛рдЙрдирд╕реНрдЯреНрд░реАрдо рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреБрдЫ рдпреБрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рд░рд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рд╡рдЬрди рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдирд╛)

рдмреАрдИрдЖрд░рдЯреА рдкреЗрдкрд░ (рдкреНрд░рдпреЛрдЧреЛрдВ) рдХреЗ рдкрд╛рдВрдЪрд╡реЗрдВ рднрд╛рдЧ рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдПрдирдПрд▓рдкреА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреАрдИрдЖрд░рдЯреА рдХреЗ рдкрд╛рд╕ рджреЛ рддрд░реАрдХреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдП рдмрд┐рдирд╛ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рд╕реАрдзреЗ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрд╢рдВрд╕рд╛ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИред рдФрд░ рд╣рдЧрд┐рдВрдЧ рдлреЗрд╕ рдХреЗ рд▓реЗрдЦрдХ рднреА рдЕрдиреБрд╢рдВрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рдлрд╝рд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд╛ рдкреНрд░рднрд╛рд╡ рдлрд╝реАрдЪрд░ рдирд┐рд╖реНрдХрд░реНрд╖рдг рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдХрд╛рдлреА рдмреЗрд╣рддрд░ рд╣реЛрдЧрд╛ (рдЬрдм рддрдХ рдХрд┐ рдЖрдк рдЬрд┐рджреНрджреА рди рд╣реЛрдВ, рдлрд╝реАрдЪрд░ рдирд┐рд╖реНрдХрд░реНрд╖рдг рдПрдХ рдмрд╣реБрдд рд╣реА рдЬрдЯрд┐рд▓ рдореЙрдбрд▓ рдХреЗ рдмрд╛рдж рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)ред

рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрд╣рд▓реЗ рдХрд╣рд╛ рдЬрд╛ рдЪреБрдХрд╛ рд╣реИ: рдЯреНрд░реЗрдирд░ рдПрдХ PyTorch рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рд▓реВрдк рдПрдкреАрдЖрдИ рд╣реИ рдЬреЛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдХреЗ рд▓рд┐рдП рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рд╕рд░рд▓ рд╣реИред рдЕрдиреНрдпрдерд╛, рдЖрдкрдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реВрдк рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред

рдпрд╣ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЕрдиреБрдЪреНрдЫреЗрдж рдореЗрд░реА рд╕рдордЭ рд╕реЗ рд╣реИ рдФрд░ рдПрдЪрдПрдл рдореБрдЦрдкреГрд╖реНрда рдкрд╛рдареНрдпрдХреНрд░рдо рдореЗрдВ рдирд╣реАрдВ рд╣реИред

### рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдХреЗ рдореБрдЦреНрдп рдкреИрд░рд╛рдореАрдЯрд░
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдзреНрдпрд╛рдпреЛрдВ рдореЗрдВ рджрд░реНрдЬрдиреЛрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╣реИрдВ:
- рдЖрдЙрдЯрдкреБрдЯ_рдбреАрдЖрдИрдЖрд░ (рдПрд╕рдЯреАрдЖрд░): рд╡рд╣ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЬрд╣рд╛рдВ рдореЙрдбрд▓ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдФрд░ рдЪреМрдХрд┐рдпрд╛рдВ рд╕рд╣реЗрдЬреА рдЬрд╛рддреА рд╣реИрдВред рд╕рд╣реЗрдЬреЗ рдЧрдП рдореЙрдбрд▓ рдХреЛ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрдЧрд▓реА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП, ["рд╡рди-рд╕реНрдЯреЙрдк рдмреАрдИрдЖрд░рдЯреА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛"] (https://zhuanlan.zhihu.com/p/344767513) рджреЗрдЦреЗрдВред ?utm_source= wechat_session&utm_medium=social&utm_oi=1400823417357139968&utm_campaign=shareopn)
- рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐: рддреАрди рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ
  - "рдирд╣реАрдВ": рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдХреЛрдИ рдореВрд▓реНрдпрд╛рдВрдХрди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ
  - "рдЪрд░рдг": рдкреНрд░рддреНрдпреЗрдХ eval_steps рдХреЗ рд▓рд┐рдП рдореВрд▓реНрдпрд╛рдВрдХрди рдкреВрд░рд╛ рд╣реБрдЖ (рдФрд░ рд▓реЙрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛)ред
  - "рдпреБрдЧ": рдкреНрд░рддреНрдпреЗрдХ рдпреБрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд┐рдпрд╛ рдЧрдпрд╛ред
- рд▓рд░реНрдирд┐рдВрдЧ_рд░реЗрдЯ (рдлреНрд▓реЛрдЯ, рд╡реИрдХрд▓реНрдкрд┐рдХ) - рдПрдбрдордбрдмреНрд▓реВ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд░ рд▓рд░реНрдирд┐рдВрдЧ рд░реЗрдЯ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ 5e-5
- рд╡рдЬрд╝рди_рдХреНрд╖рдп (рдлреНрд▓реЛрдЯ, рд╡реИрдХрд▓реНрдкрд┐рдХ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ 0): рдпрджрд┐ 0 рдирд╣реАрдВ рд╣реИ, рддреЛ рдпрд╣ рдПрдбрдордбрдмреНрд▓реНрдпреВ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд░ рдореЗрдВ рд╕рднреА рдкреВрд░реНрд╡рд╛рдЧреНрд░рд╣реЛрдВ рдФрд░ рд▓реЗрдпрд░рдиреЙрд░реНрдо рд╡рдЬрд╝рди рдХреЛ рдЫреЛрдбрд╝рдХрд░, рд╕рднреА рдкрд░рддреЛрдВ рдкрд░ рд▓рд╛рдЧреВ рд╡рдЬрди рдХреНрд╖рдп рд╣реИред рд╣рдорд╛рд░реЗ рдмрд╛рд░реЗ рдореЗрдВрд╣рд▓реНрдХреЗ рдХреНрд╖рдп рдХреЗ рд▓рд┐рдП, рдХреГрдкрдпрд╛ рдЬрд╝реАрд╣реБ рд▓реЗрдЦ рджреЗрдЦреЗрдВ [рдпрд╣ 9102 рд╕рд╛рд▓ рдкрд╣рд▓реЗ рдХреА рдмрд╛рдд рд╣реИ, рдЕрдм рдПрдбрдо + рдПрд▓2 рдирд┐рдпрдорд┐рддреАрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ] (https://zhuanlan.zhihu.com/p/63982470)ред
- save_strategy (str рдпрд╛ IntervalStrategy, рд╡реИрдХрд▓реНрдкрд┐рдХ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ "рдЪрд░рдг"): рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдЕрдкрдирд╛рдИ рдЧрдИ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдмрдЪрдд рд░рдгрдиреАрддрд┐ред рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рди рд╣реИрдВ:
  - "рдирд╣реАрдВ": рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдмрдЪрдд рди рдХрд░реЗрдВ
  - "рдпреБрдЧ": рдкреНрд░рддреНрдпреЗрдХ рдпреБрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ
  - "рдЪрд░рдг": рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдПрдХ рдмрд╛рд░ рд╕рд╣реЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред
- рдПрдлрдкреА16 (рдмреВрд▓, рд╡реИрдХрд▓реНрдкрд┐рдХ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧрд▓рдд) - 32-рдмрд┐рдЯ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдмрдЬрд╛рдп 16-рдмрд┐рдЯ (рдорд┐рд╢реНрд░рд┐рдд) рд╕рдЯреАрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред
- metric_for_best_model (str, рд╡реИрдХрд▓реНрдкрд┐рдХ): рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдореЙрдбрд▓реЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдореАрдЯреНрд░рд┐рдХ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПload_best_model_at_end рдХреЗ рд╕рд╛рде рд╕рдВрдпреЛрдЬрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрдкрд╕рд░реНрдЧ "eval_" рдХреЗ рд╕рд╛рде рдпрд╛ рдЙрд╕рдХреЗ рдмрд┐рдирд╛, рдореВрд▓реНрдпрд╛рдВрдХрди рджреНрд╡рд╛рд░рд╛ рд▓реМрдЯрд╛рдП рдЧрдП рдореАрдЯреНрд░рд┐рдХ рдХрд╛ рдирд╛рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
- num_train_epochs (рдлреНрд▓реЛрдЯ, рд╡реИрдХрд▓реНрдкрд┐рдХ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ 3 рд╣реИ) - рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпреБрдЧреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛
- рд▓реЛрдб_рдмреЗрд╕реНрдЯ_рдореЙрдбрд▓_рдПрдЯ_рдПрдВрдб (рдмреАool, рд╡реИрдХрд▓реНрдкрд┐рдХ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗ рдЧрд▓рдд): рдХреНрдпрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдорд┐рд▓реЗ рд╕рд░реНрд╡реЛрддреНрддрдо рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдЕрдВрдд рдореЗрдВ рд▓реЛрдб рдХрд░рдирд╛ рд╣реИред


### рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓ рд▓реЛрдбрд┐рдВрдЧ рд╡рд┐рдзрд┐рдпрд╛рдВ
рдСрдЯреЛрдореЙрдбрд▓ рд╡рд░реНрдЧ рдФрд░ рдЙрд╕рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕рднреА рд╡рд░реНрдЧ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рд░рд▓ рд░реИрдкрд░ рд╣реИрдВред рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЖрдкрдХреЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рдореЙрдбрд▓ рд╕реНрдХреАрдорд╛ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЙрд╕ рд╕реНрдХреАрдорд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЙрдбрд▓ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░рддрд╛ рд╣реИред

рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╕реАрдзреЗ рдЙрд╕ рд╡рд░реНрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЗрд╕рдХреА рд╕реНрдХреАрдорд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдпрд╣ BERT рдореЙрдбрд▓ рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред

BERT рдореЙрдбрд▓ рдХреЛ рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ BertConfig, BertModel рдЖрдпрд╛рдд рдХрд░реЗрдВ

# рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдирд┐рд░реНрдорд╛рдг
рдХреЙрдиреНрдлрд┐рдЧ = BertConfig()

#рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реЗ рдореЙрдбрд▓ рдмрдирд╛рдирд╛
рдореЙрдбрд▓ = рдмрд░реНрдЯрдореЙрдбрд▓(рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди)
```
рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдХрдИ рдЧреБрдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
рдкреНрд░рд┐рдВрдЯ(рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди)
```
```рдЕрдЬрдЧрд░
рдмрд░реНрдЯрдХреЙрдиреНрдлрд┐рдЧ {
  [...]
  "hidden_size": 768, #hidden_states рд╡реЗрдХреНрдЯрд░ рдЖрдХрд╛рд░
  "рдордзреНрдпрд╡рд░реНрддреА_рдЖрдХрд╛рд░": 3072, #рдПрдлрдПрдлрдПрди рдХреА рдкрд╣рд▓реА рдкрд░рдд рдореЗрдВ рдиреНрдпреВрд░реЙрдиреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛, рдпрд╛рдиреА, рдкрд╣рд▓реА рдкрд░рдд рдореЗрдВ рдзреНрдпрд╛рди рдкрд░рдд рдХрд╛ рдкреВрд░рд╛ рдХрдиреЗрдХреНрд╢рди рдЖрдпрд╛рдо рдХреЛ 4 рдЧреБрдирд╛ рдмрдврд╝рд╛ рджреЗрдЧрд╛
  "max_position_embeddings": 512,#рдЕрдзрд┐рдХрддрдо рдЕрдиреБрдХреНрд░рдо рд▓рдВрдмрд╛рдИ 512
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  [...]
}
```
hidden_size:hidden_states рд╡реЗрдХреНрдЯрд░ рдХрд╛ рдЖрдХрд╛рд░<br>
num_hidden_layers: рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреА рдкрд░рддреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реЗ рдПрдХ рдореЙрдбрд▓ рдмрдирд╛рдирд╛ рдЗрд╕реЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рд░рдВрдн рдХрд░рддрд╛ рд╣реИ:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ BertConfig, BertModel рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдХреЙрдиреНрдлрд┐рдЧ = BertConfig()
рдореЙрдбрд▓ = рдмрд░реНрдЯрдореЙрдбрд▓(рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди)

# рдореЙрдбрд▓ рдХреЛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ
```
рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╡рд┐рдХреГрдд рдХреЛрдб рдЖрдЙрдЯрдкреБрдЯ рдХрд░реЗрдЧрд╛; рдЗрд╕реЗ рдкрд╣рд▓реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд╣рдо рд╣рд╛рде рдореЗрдВ рдореМрдЬреВрдж рдХрд╛рд░реНрдп рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдореЙрдбрд▓ рдХреЛ рд╢реБрд░реВ рд╕реЗ рд╣реА рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдХрд╛рдлреА рд╕рдордп рд▓рдЧреЗрдЧрд╛рдмрдбрд╝реА рдорд╛рддреНрд░рд╛ рдореЗрдВ рдбреЗрдЯрд╛.

рдкрд╣рд▓реЗ рд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП from_pretrained рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ BertModel рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдореЙрдбрд▓ = BertModel.from_pretrained("bert-base-cased")
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдкрдиреЗ рдкрд╣рд▓реЗ рджреЗрдЦрд╛, рд╣рдо рдмрд░реНрдЯрдореЙрдбрд▓ рдХреЛ рдСрдЯреЛрдореЙрдбрд▓ рдХреНрд▓рд╛рд╕ рд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рднрд╛рд╡ рд╡рд╣реА рд╣реЛрдЧрд╛ред рд╣рдо рдмрд╛рдж рдореЗрдВ рдСрдЯреЛрдореЙрдбрд▓ рдХреНрд▓рд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ, рдЗрд╕рдХрд╛ рдлрд╛рдпрджрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдореЙрдбрд▓ рд╕рдВрд░рдЪрдирд╛ рд╕реЗрдЯ рдХрд░рдиреЗ рд╕реЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХрд╛ рдХреЛрдб рдПрдХ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рджреВрд╕рд░реЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд╛рдо рдХрд░реЗрдЧрд╛ред рднрд▓реЗ рд╣реА рдореЙрдбрд▓ рд╕рдВрд░рдЪрдирд╛ рднрд┐рдиреНрди рд╣реЛ, рдпрд╣ рддрдм рддрдХ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рддрдХ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рд╕рдорд╛рди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

***рдСрдЯреЛрдореЙрдбрд▓ рдХреНрд▓рд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рдХреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдореЗрдВ рдкрд╛рд╕ рдХрд░рдХреЗ, рдЖрдк рдХрд╛рд░реНрдп рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬрдм рддрдХ рдЗрд╕ рдореЙрдбрд▓ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рдЗрд╕ рдХрд╛рд░реНрдп рдХреЛ рд╕рдВрднрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ)ред рдпрджрд┐ рдЖрдк рдмрд░реНрдЯрдореЙрдбрд▓ рдЪреБрдирддреЗ рд╣реИрдВ, рддреЛ рдореЙрдбрд▓ рд╕рдВрд░рдЪрдирд╛ рддрдп рд╣реЛ рдЬрд╛рдПрдЧреАред ***

рдЙрдкрд░реЛрдХреНрдд рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдо BertConfig рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ (BertConfig рдмрд┐рдирд╛ рдХрд┐рд╕реА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдПрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдореЙрдбрд▓ рд╣реИ), рдмрд▓реНрдХрд┐ рдЗрд╕рдХреЗ рдмрдЬрд╛рдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдХреЛ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ "bert-base-cased" рдПрдХ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХрд╛ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╕реНрд╡рдпрдВ BERT рдХреЗ рд▓реЗрдЦрдХ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЖрдк рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдЗрд╕рдХреЗ [рдореЙрдбрд▓ рдХрд╛рд░реНрдб](https://huggingface.co/bert-base) рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ -рдХреЗрд╕реНрдб) рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реАред

рдореЙрдбрд▓ рдХреЛ рдЕрдм рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рд╕рднреА рднрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реАрдзреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд╛рд░реНрдпреЛрдВ рдкрд░ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдпрд╛ рдирдП рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рд╡реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдХреИрд╢ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдХреИрд╢ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ (рддрд╛рдХрд┐ рднрд╡рд┐рд╖реНрдп рдореЗрдВ from_pretrained рдкрджреНрдзрддрд┐ рдкрд░ рдХреЙрд▓ рдЙрдиреНрд╣реЗрдВ рджреЛрдмрд╛рд░рд╛ рдбрд╛рдЙрдирд▓реЛрдб рди рдХрд░реЗрдВ), рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ ~/.cache/huggingface/transformers рд╣реЛрддрд╛ рд╣реИред рдЖрдк HF_HOME рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рд╕реЗрдЯ рдХрд░рдХреЗ рдХреИрд╢ рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рдХрд╕реНрдЯрдорд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдореЙрдбрд▓ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдореЙрдбрд▓ рд╣рдм рдкрд░ рдХрд┐рд╕реА рднреА рдореЙрдбрд▓ рдХрд╛ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬрдм рддрдХ рдХрд┐ рдпрд╣ BERT рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рд╣реИред BERT рдЪреМрдХрд┐рдпреЛрдВ рдХреА рдкреВрд░реА рд╕реВрдЪреА [рдпрд╣рд╛рдВ] (https://huggingface.co/models?filter=bert) рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИред
### рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧтАФтАФрдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ рддрдХрдиреАрдХ
>рдпреВрдЯреНрдпреВрдм рд╡реАрдбрд┐рдпреЛ: ["рдбрд╛рдпрди рдХреНрдпрд╛ рд╣реИрдПрдорд┐рдХ рдкреИрдбрд┐рдВрдЧуАЛ](https://youtu.be/7q5NyFT8REg)
    
PyTorch рдореЗрдВ, DataLoader рдХрд╛ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ - рдХреЛрд▓реЗрдЯ рдлрд╝рдВрдХреНрд╢рдиред рдпрд╣ рдирдореВрдиреЛрдВ рдХреЗ рдПрдХ рдмреИрдЪ рдХреЛ рдПрдХ рд╕рд╛рде рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рд╕реЙрд░реНрдЯрд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдЖрдкрдХреЗ рдирдореВрдиреЛрдВ рдХреЛ рд╕рдВрдпреЛрдЬрди рдХреЗ рд▓рд┐рдП PyTorch рдЯреЗрдВрд╕рд░ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ (рдкреБрдирд░рд╛рд╡рд░реНрддреА рд░реВрдк рд╕реЗ рдпрджрд┐ рдЖрдкрдХреЗ рддрддреНрд╡ рд╕реВрдЪрд┐рдпрд╛рдБ, рдЯреБрдкрд▓реНрд╕ рдпрд╛ рд╢рдмреНрджрдХреЛрд╢ рд╣реИрдВ)ред

рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдореМрдЬреВрдж рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓рдВрдмрд╛рдИ рдХреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЛ рдкреИрдбреЗрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдореЙрдбрд▓ рдХреЗ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ, рдПрдХ рд╣реА рдмреИрдЪ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЯреЗрдВрд╕рд░ рдХреА рд▓рдВрдмрд╛рдИ рд╕рдорд╛рди рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП)ред рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдмреИрдЪ рдореЗрдВ рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдбрд┐рдВрдЧ рдХреА рджрдХреНрд╖рддрд╛ рдкреВрд░реЗ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреА рдЕрдзрд┐рдХрддрдо рдЕрдиреБрдХреНрд░рдо рд▓рдВрдмрд╛рдИ рддрдХ рд╕рднреА рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЛ рдкреИрдбрд┐рдВрдЧ рдХрд░рдиреЗ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛрдЧреАред
рдиреЛрдЯ: рдпрджрд┐ рдЖрдк рдЯреАрдкреАрдпреВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рднреА рдЖрдкрдХреЛ рдЗрд╕реЗ рдореЙрдбрд▓ рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдЯреАрдкреАрдпреВ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реИред
рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ рдХреЛрд▓реЗрдЯ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬреЛ рдмреИрдЪ рдбреЗрдЯрд╛ рдкрд░ рд╕рд╣реА рдорд╛рддреНрд░рд╛ рдореЗрдВ рдкреИрдбрд┐рдВрдЧ рд▓рд╛рдЧреВ рдХрд░реЗрдЧрд╛ред (рдЕрд▓рдЧ-рдЕрд▓рдЧ рдмреИрдЪ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП, рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓рдВрдмрд╛рдИ рдХреА рдкреИрдбрд┐рдВрдЧ рдХреА рдЬрд╛рддреА рд╣реИред) рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╣рдореЗрдВ DataCollatorWithPadding рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдРрд╕рд╛ рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рдЬрдм рдЖрдк рдЗрд╕реЗ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕реЗ рдПрдХ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИрдкреИрдбрд┐рдВрдЧ рдЯреЛрдХрди, рдФрд░ рдХреНрдпрд╛ рдореЙрдбрд▓ рдкреИрдбрд┐рдВрдЧ рдХреЛ рдЗрдирдкреБрдЯ рдХреЗ рдмрд╛рдИрдВ рдпрд╛ рджрд╛рдИрдВ рдУрд░ рдЪрд╛рд╣рддрд╛ рд╣реИ), рдФрд░ рд╡рд╣ рд╕рдм рдХреБрдЫ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдЪрд╛рд╣рд┐рдП:

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ DataCollatorWithPadding рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ = рдбреЗрдЯрд╛рдХреЛрд▓реЗрдЯрд░рд╡рд┐рдердкреИрдбрд┐рдВрдЧ(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░=рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░)
```
рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП, рд╣рдо рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рд╕реЗ рдирдореВрдиреЗ рдЪреБрдирддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдо рдПрдХ рд╕рд╛рде рдмреИрдЪ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред рдпрд╣рд╛рдВ idx, рд╡рд╛рдХреНрдп 1 рдФрд░ рд╡рд╛рдХреНрдп 2 рдХреЙрд▓рдо рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрди рдХреЙрд▓рдо рдХреА рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрдирдореЗрдВ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рд╣реИрдВ (рдЯреЗрдВрд╕рд░ рдирд╣реАрдВ рдмрдирд╛ рд╕рдХрддреЗ)ред рдмреИрдЪ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЗрдирдкреБрдЯ рдХреА рд▓рдВрдмрд╛рдИ рдЬрд╛рдВрдЪреЗрдВ:

```рдЕрдЬрдЧрд░
рдирдореВрдиреЗ = рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"][:8]
рдирдореВрдиреЗ = {
    k: k рдХреЗ рд▓рд┐рдП v, рдирдореВрдиреЗ.рдЖрдЗрдЯрдо() рдореЗрдВ v рдпрджрд┐ k ["idx", "sentence1", "sentence2"] рдореЗрдВ рдирд╣реАрдВ рд╣реИ
}
[рдирдореВрдиреЛрдВ рдореЗрдВ x рдХреЗ рд▓рд┐рдП len(x)["input_ids"]]
```

```рдЕрдЬрдЧрд░
[50, 59, 47, 67, 59, 50,62, 32]
```
рд╣рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓рдВрдмрд╛рдИ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдорд┐рд▓рддреЗ рд╣реИрдВред рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдмреИрдЪ рдореЗрдВ рд╕рднреА рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЛ 67 рдХреА рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдб рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ рдХреЗ рдмрд┐рдирд╛, рд╕рднреА рдирдореВрдиреЛрдВ рдХреЛ рд╕рдВрдкреВрд░реНрдг рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рддрдХ, рдпрд╛ рдЙрд╕ рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдб рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕реЗ рдореЙрдбрд▓ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рд╕рдХреЗред рдЖрдЗрдП рджреЛрдмрд╛рд░рд╛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рд╣рдорд╛рд░рд╛ рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ рдмреИрдЪ рдХреЛ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рднрд░ рд░рд╣рд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдмреИрдЪ = рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░(рдирдореВрдиреЗ)
{k: k рдХреЗ рд▓рд┐рдП v.shape, рдмреИрдЪ.рдЖрдЗрдЯрдо рдореЗрдВ v()}
```

```рдЕрдЬрдЧрд░
{'рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ': рдЯреЙрд░реНрдЪ.рдЖрдХрд╛рд░([8, 67]),
 'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': рдЯреЙрд░реНрдЪ.рдЖрдХрд╛рд░([8, 67]),
 'рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА': рдЯреЙрд░реНрдЪ.рдЖрдХрд╛рд░([8, 67]),
 'рд▓реЗрдмрд▓': рдЯреЙрд░реНрдЪ.рдЖрдХрд╛рд░([8])}
```

рдпреБрдХреНрддрд┐рдпрд╛рдБ: рдЙрдкрд░реЛрдХреНрдд рдмреЛрд▓реНрдб рдФрд░ рдЗрдЯреИрд▓рд┐рдХ рд╢рдмреНрдж рд▓реЗрдЦрдХ рдХреА рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдБ рд╣реИрдВ рдФрд░ рдореВрд▓ рдкрд╛рда рдХреЗ рднрд╛рдЧ рдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЛ рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рдЖрддреА рд╣реИ, рддреЛ рдХреГрдкрдпрд╛ рд╣рдореЗрдВ рд╕рдордп рдкрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдВ, рдзрдиреНрдпрд╡рд╛рджред