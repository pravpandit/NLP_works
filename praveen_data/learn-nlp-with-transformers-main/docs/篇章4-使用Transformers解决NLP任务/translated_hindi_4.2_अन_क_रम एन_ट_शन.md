рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдЬрдкреНрдЯрд░ рдиреЛрдЯрдмреБрдХ [рдЕрдзреНрдпрд╛рдп 4 рдХреЛрдб рдЖрдзрд╛рд░](https://github.com/datawhalechina/learn-nlp-with-transformers/tree/main/docs/%E7%AF%87%E7%AB) рдореЗрдВ рд╣реИ %A04 -%E4%BD%BF%E7%94%A8рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░%E8%A7%A3%E5%86%B3NLP%E4%BB%BB%E5%8A%A1)ред

рдпрджрд┐ рдЖрдк рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЛ Google рдХреЗ рдХреЛрд▓рд╛рдм рдореЗрдВ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдФрд░ ЁЯдЧрдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдЗрд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЛ рдЕрдирдХрдореНрдореЗрдВрдЯ рдХрд░реЗрдВред


```рдЕрдЬрдЧрд░
!рдкрд┐рдк рдЗрдВрд╕реНрдЯрд╛рд▓ рдбреЗрдЯрд╛рд╕реЗрдЯ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рд╕реАрдХреНрд╡реЗрд╡рд▓
```

рдпрджрд┐ рдЖрдк рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдиреЗ рдЙрдкрд░реЛрдХреНрдд рдирд┐рд░реНрднрд░рддрд╛ рдкреИрдХреЗрдЬ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдП рд╣реИрдВред рдЖрдк рдпрд╣рд╛рдВ рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХрд╛ рдорд▓реНрдЯреА-рдЬреАрдкреАрдпреВ рд╡рд┐рддрд░рд┐рдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕рдВрд╕реНрдХрд░рдг рднреА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣ рдЕрдиреБрднрд╛рдЧрдЗрд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдореЙрдбрд▓ рд╕рдВрд░рдЪрдирд╛ рдореВрд▓ рд░реВрдк рд╕реЗ рдкрд┐рдЫрд▓реЗ рдЕрдзреНрдпрд╛рдп рдореЗрдВ BERT рдХреЗ рд╕рдорд╛рди рд╣реИред рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рд╡рд┐рдзрд┐рдпреЛрдВ рдФрд░ рдореЙрдбрд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рд░реВрдк рд╕реЗ рд╕реАрдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

# *рдЕрдиреБрдХреНрд░рдо рд▓реЗрдмрд▓рд┐рдВрдЧ (рдЯреЛрдХрди-рд╕реНрддрд░реАрдп рд╡рд░реНрдЧреАрдХрд░рдг рд╕рдорд╕реНрдпрд╛)*

рдЕрдиреБрдХреНрд░рдо рд▓реЗрдмрд▓рд┐рдВрдЧ рдХреЛ рдЖрдорддреМрд░ рдкрд░ рдЯреЛрдХрди-рд╕реНрддрд░реАрдп рд╡рд░реНрдЧреАрдХрд░рдг рд╕рдорд╕реНрдпрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: рдкреНрд░рддреНрдпреЗрдХ рдЯреЛрдХрди рдХреЛ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░реЗрдВред рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдореЗрдВ, рд╣рдо рджрд┐рдЦрд╛рдПрдВрдЧреЗ рдХрд┐ рдЯреЛрдХрди-рд╕реНрддрд░реАрдп рд╡рд░реНрдЧреАрдХрд░рдг рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕] (https://github.com/huggingface/transformers) рдореЗрдВ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВред рдЯреЛрдХрди-рд╕реНрддрд░реАрдп рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдЖрдорддреМрд░ рдкрд░ рдкрд╛рда рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП рдПрдХ рд▓реЗрдмрд▓ рдкрд░рд┐рдгрд╛рдо рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░рддреЗ рд╣реИрдВред рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЪрд┐рддреНрд░ рдПрдирдИрдЖрд░ рдЗрдХрд╛рдИ рд╕рдВрдЬреНрдЮрд╛ рдкрд╣рдЪрд╛рди рдХрд╛рд░реНрдп рджрд┐рдЦрд╛рддрд╛ рд╣реИред

![рдПрдирдИрдЖрд░ рдХрд╛рд░реНрдп рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╡рд┐рдЬреЗрдЯ рдЕрдиреБрдорд╛рди](https://github.com/huggingface/notebooks/blob/master/examples/images/token_classification.png?raw=1)

рд╕рдмрд╕реЗ рдЖрдо рдЯреЛрдХрди-рд╕реНрддрд░реАрдп рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп:

- рдПрдирдИрдЖрд░ (рдирд╛рдорд╛рдВрдХрд┐рдд-рдЗрдХрд╛рдИ рдкрд╣рдЪрд╛рди рд╕рдВрдЬреНрдЮрд╛-рдЗрдХрд╛рдИ рдкрд╣рдЪрд╛рди) рд╕рдВрдХрд▓реНрдкрдкрд╛рда рдореЗрдВ рд╕рдВрдЬреНрдЮрд╛рдПрдВ рдФрд░ рдЗрдХрд╛рдЗрдпрд╛рдВ рдирд┐рдХрд╛рд▓реЗрдВ (рд╡реНрдпрдХреНрддрд┐ рдХрд╛ рдирд╛рдо, рд╕рдВрдЧрдарди рдХрд╛ рдирд╛рдо, рд╕реНрдерд╛рди рдХрд╛ рдирд╛рдо...)ред
- рдкреАрдУрдПрд╕ (рдкрд╛рд░реНрдЯ-рдСрдл-рд╕реНрдкреАрдЪ рдЯреИрдЧрд┐рдВрдЧ) рд╡реНрдпрд╛рдХрд░рдг рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЯреЛрдХрди рдЯреИрдЧ рдХрд░рддрд╛ рд╣реИ (рд╕рдВрдЬреНрдЮрд╛, рдХреНрд░рд┐рдпрд╛, рд╡рд┐рд╢реЗрд╖рдг...)
- рдЪрдВрдХ (рдЪрдВрдХрд┐рдВрдЧ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдЪрдВрдХрд┐рдВрдЧ) рдПрдХ рд╣реА рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдХреЗ рдЯреЛрдХрди рдХреЗ рдЯреБрдХрдбрд╝реЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рд░рдЦрддрд╛ рд╣реИред

рдЙрдкрд░реЛрдХреНрдд рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП, рд╣рдо рджрд┐рдЦрд╛рдПрдВрдЧреЗ рдХрд┐ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд░рд▓ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ, рдФрд░ рд╕рд╛рде рд╣реА рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЗрдВ `рдЯреНрд░реЗрдирд░` рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

рдЬрдм рддрдХ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреА рд╕рдмрд╕реЗ рдКрдкрд░реА рдкрд░рдд рдореЗрдВ рдЯреЛрдХрди рд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рдд рд╣реЛрддреА рд╣реИ (рдЬреИрд╕реЗ рдХрд┐ рдкрд┐рдЫрд▓реЗ рдЕрдзреНрдпрд╛рдп рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд 'рдмрд░реНрдЯрдлреЙрд░рдЯреЛрдХрдирдХреНрд▓рд╛рд╕рд┐рдлрд┐рдХреЗрд╢рди') (рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА рдирдИ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рдХрд╛рд░рдг, рд╕рдВрдмрдВрдзрд┐рдд рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдПрдХ рддреЗрдЬрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП, [рдЗрд╕ рддрд╛рд▓рд┐рдХрд╛] (https://huggingface.co/transformers/index.html#bigtable)) рдХреЛ рджреЗрдЦреЗрдВ, рдлрд┐рд░ рдпрд╣ рдиреЛрдЯрдмреБрдХ рд╕реИрджреНрдзрд╛рдВрддрд┐рдХ рд░реВрдк рд╕реЗ рд╡рд┐рднрд┐рдиреНрди рдЯреНрд░рд╛рдВрд╕рдлрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреА рд╣реИрдкреВрд░реНрд╡ рдореЙрдбрд▓ ([рдореЙрдбрд▓ рдкреИрдирд▓](https://huggingface.co/models)), рдХрд┐рд╕реА рднреА рдЯреЛрдХрди-рд╕реНрддрд░реАрдп рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдк рдЬрд┐рди рдХрд╛рд░реНрдпреЛрдВ рд╕реЗ рдирд┐рдкрдЯ рд░рд╣реЗ рд╣реИрдВ рд╡реЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╣реИрдВ, рддреЛ рдЖрдк рдХреЗрд╡рд▓ рдорд╛рдореВрд▓реА рдмрджрд▓рд╛рд╡реЛрдВ рдХреЗ рд╕рд╛рде рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗред рд╕рд╛рде рд╣реА, рдЖрдкрдХреЛ рдореЗрдореЛрд░реА рдУрд╡рд░рдлрд╝реНрд▓реЛ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА GPU рдореЗрдореЛрд░реА рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдлрд╝рд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ btach рдЖрдХрд╛рд░ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред



```рдЕрдЬрдЧрд░
рдХрд╛рд░реНрдп = "рдиреЗрд░" # "рдиреЗрд░", "рдкреЙрдЬрд╝" рдпрд╛ "рдЪрдВрдХ" рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ
рдореЙрдбрд▓_рдЪреЗрдХрдкреЙрдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб"
рдмреИрдЪ_рдЖрдХрд╛рд░ = 16
```

## рдбреЗрдЯрд╛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ


рд╣рдо рдбреЗрдЯрд╛ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдореВрд▓реНрдпрд╛рдВрдХрди рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [ЁЯдЧ рдбреЗрдЯрд╛рд╕реЗрдЯ](https://github.com/huggingface/datasets) рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдбреЗрдЯрд╛ рд▓реЛрдбрд┐рдВрдЧ рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдореЛрдб рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ `load_dataset` рдФрд░ `load_metric` рдХреЗ рд╕рд░рд▓ рдЙрдкрдпреЛрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред


```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ, рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ
```

рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдореЗрдВ рдЙрджрд╛рд╣рд░рдг [CONLL 2 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ003 рдбреЗрдЯрд╛рд╕реЗрдЯ](https://www.aclweb.org/anthology/W03-0419.pdf) рдбреЗрдЯрд╛рд╕реЗрдЯред рдпрд╣ рдиреЛрдЯрдмреБрдХ ЁЯдЧрдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдХрд┐рд╕реА рднреА рдЯреЛрдХрди рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рдХрд╕реНрдЯрдо json/csv рдлрд╝рд╛рдЗрд▓ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рд▓реЛрдб рдХреИрд╕реЗ рдХрд░реЗрдВ рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ [рдбреЗрдЯрд╛рд╕реЗрдЯ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://huggingface.co/docs/datasets/loading_datasets.html#from-local-files) рдХреЛ рджреЗрдЦрдирд╛ рд╣реЛрдЧрд╛ред рдХрд╕реНрдЯрдо рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рд╡рд┐рд╢реЗрд╖рддрд╛ рдирд╛рдореЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рдХреБрдЫ рд╕рдорд╛рдпреЛрдЬрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред


```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ ("conll2003")
```

`рдбреЗрдЯрд╛рд╕реЗрдЯ` рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реНрд╡рдпрдВ рдПрдХ [`рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ`](https://huggingface.co/docs/datasets/package_reference/main_classes.html#datasetdict) рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рд╣реИ, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ, рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдФрд░ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП, рдмрд╕ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдмрдВрдзрд┐рдд рдХреБрдВрдЬреА (рдЯреНрд░реЗрди, рд╕рддреНрдпрд╛рдкрди, рдкрд░реАрдХреНрд╖рдг)ред


```рдкрд╛рдпрдердкрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ
```




    рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ({
        рдЯреНрд░реЗрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
            рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдЖрдИрдбреА', 'рдЯреЛрдХрди', 'pos_tags', 'chunk_tags', 'ner_tags'],
            num_rows: 14041
        })
        рд╕рддреНрдпрд╛рдкрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
            рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдЖрдИрдбреА', 'рдЯреЛрдХрди', 'pos_tags', 'chunk_tags', 'ner_tags'],
            рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 3250
        })
        рдкрд░реАрдХреНрд╖рдг: рдбреЗрдЯрд╛рд╕реЗрдЯ({
            рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдЖрдИрдбреА', 'рдЯреЛрдХрди', 'pos_tags', 'chunk_tags', 'ner_tags'],
            num_rows: 3453
        })
    })



рдЪрд╛рд╣реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ, рд╕рддреНрдпрд╛рдкрди рдорд╢реАрди рдореЗрдВ рдпрд╛ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ, рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВts рдореЗрдВ рдЯреЛрдХрди рдирд╛рдордХ рдПрдХ рдХреЙрд▓рдо рд╣реЛрддрд╛ рд╣реИ (рдЖрдо рддреМрд░ рдкрд░ рдмреЛрд▓рддреЗ рд╣реБрдП, рдкрд╛рда рдХреЛ рдХрдИ рд╢рдмреНрджреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ), рдФрд░ рд▓реЗрдмрд▓ рдирд╛рдордХ рдПрдХ рдХреЙрд▓рдо рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдЯреЛрдХрди рдХреЗ рд▓реЗрдмрд▓ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред

рдбреЗрдЯрд╛ рд╡рд┐рднрд╛рдЬрди рдХреБрдВрдЬреА (рдЯреНрд░реЗрди, рд╕рддреНрдпрд╛рдкрди, рдпрд╛ рдкрд░реАрдХреНрд╖рдг) рдФрд░ рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рджрд┐рдП рдЬрд╛рдиреЗ рдкрд░, рдЖрдк рдбреЗрдЯрд╛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред


```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"][0]
```




    {'рдЪрдВрдХ_рдЯреИрдЧреНрд╕': [11, 21, 11, 12, 21, 22, 11, 12, 0],
     'рдЖрдИрдбреА': '0',
     'ner_tags': [3, 0, 7, 0, 0, 0, 7, 0, 0],
     'pos_tags': [22, 42, 16, 21, 35, 37, 16, 21, 7],
     'рдЯреЛрдХрди': ['рдИрдпреВ',
      'рдЕрд╕реНрд╡реАрдХрд╛рд░',
      'рдЬрд░реНрдорди',
      'рдкреБрдХрд╛рд░рдирд╛',
      'рдХреЛ',
      'рдмрд╣рд┐рд╖реНрдХрд╛рд░',
      'рдмреНрд░реАрдЯреИрди рдХрд╛',
      'рднреЗрдбрд╝ рдХрд╛ рдмрдЪреНрдЪрд╛',
      '.']}



рд╕рднреА рдбреЗрдЯрд╛ рд▓реЗрдмрд▓ рд▓реЗрдмрд▓ рдХреЛ рдкреВрд░реНрдгрд╛рдВрдХ рдореЗрдВ рдПрдиреНрдХреЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд╕реАрдзреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИрдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрди рдкреВрд░реНрдгрд╛рдВрдХреЛрдВ рдХреА рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╢реНрд░реЗрдгрд┐рдпрд╛рдВ `рдлреАрдЪрд░реНрд╕` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛рддреА рд╣реИрдВред


```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"].рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ[f"ner_tags"]
```




    рдЕрдиреБрдХреНрд░рдо(рдлрд╝реАрдЪрд░=рдХреНрд▓рд╛рд╕рд▓реЗрдмрд▓(num_classes=9, рдирд╛рдо=['рдУ', 'рдмреА-рдкреАрдИрдЖрд░', 'рдЖрдИ-рдкреАрдИрдЖрд░', 'рдмреА-рдУрдЖрд░рдЬреА', 'рдЖрдИ-рдУрдЖрд░рдЬреА', 'рдмреА-рдПрд▓рдУрд╕реА', 'рдЖрдИ- LOC', 'B-MISC', 'I-MISC'], name_file=рдХреЛрдИ рдирд╣реАрдВ, id=рдХреЛрдИ рдирд╣реАрдВ), рд▓рдВрдмрд╛рдИ=-1, id=рдХреЛрдИ рдирд╣реАрдВ)



рдЗрд╕рд▓рд┐рдП рдПрдирдИрдЖрд░ рдХреЛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрддреЗ рд╣реБрдП, 0 рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд▓реЗрдмрд▓ рд╢реНрд░реЗрдгреА "рдУ" рд╣реИ, 1 "рдмреА-рдкреАрдИрдЖрд░" рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИ рдФрд░ рдЗрд╕реА рддрд░рд╣ред "рдУ" рдХрд╛ рдЕрд░реНрде рдХреЛрдИ рд╡рд┐рд╢реЗрд╖ рдЗрдХрд╛рдИ рдирд╣реАрдВ рд╣реИред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ 4 рдЗрдХрд╛рдИ рд╢реНрд░реЗрдгрд┐рдпрд╛рдВ (PER, ORG, LOC, MISC) рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рдЗрдХрд╛рдИ рд╢реНрд░реЗрдгреА рдореЗрдВ рдПрдХ B- (рдЗрдХрд╛рдИ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЯреЛрдХрди) рдЙрдкрд╕рд░реНрдЧ рдФрд░ I- (рдЗрдХрд╛рдИ рдХреЗ рдмреАрдЪ рдореЗрдВ рдЯреЛрдХрди) рдЙрдкрд╕рд░реНрдЧ рд╣реЛрддрд╛ рд╣реИред

- рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд▓рд┐рдП 'рдкреНрд░рддрд┐'
- рд╕рдВрдЧрдарди рдХреЗ рд▓рд┐рдП 'рдУрдЖрд░рдЬреА'
- 'рдПрд▓рдУрд╕реА' рдХреЗ рд▓рд┐рдПрдЬрдЧрд╣
- рд╡рд┐рд╡рд┐рдз рдХреЗ рд▓рд┐рдП 'MISC'


```рдЕрдЬрдЧрд░
рд▓реЗрдмрд▓_рд╕реВрдЪреА = рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"].рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ[f"{рдХрд╛рд░реНрдп}_рдЯреИрдЧ"].feature.names
рд▓реЗрдмрд▓_рд╕реВрдЪреА
```




    ['рдУ', 'рдмреА-рдкреЗрд░', 'рдЖрдИ-рдкреЗрд░', 'рдмреА-рдУрдЖрд░рдЬреА', 'рдЖрдИ-рдУрдЖрд░рдЬреА', 'рдмреА-рдПрд▓рдУрд╕реА', 'рдЖрдИ-рдПрд▓рдУрд╕реА', 'рдмреА-рдПрдордЖрдИрдПрд╕рд╕реА', 'рдЖрдИ- рд╡рд┐рд╡рд┐рдз']



рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдбреЗрдЯрд╛ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ, рдирд┐рдореНрди рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рд╕реЗрдЯ рд╕реЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдХреБрдЫ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХрд╛ рдЪрдпрди рдХрд░реЗрдЧрд╛ред


```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдХреНрд▓рд╛рд╕ рд▓реЗрдмрд▓, рдЕрдиреБрдХреНрд░рдо рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдкрд╛рдВрдбрд╛ рдХреЛ рдкреАрдбреА рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ
IPython.display рд╕реЗ рдЖрдпрд╛рдд рдбрд┐рд╕реНрдкреНрд▓реЗ, HTML

def show_random_elements(рдбреЗрдЯрд╛рд╕реЗрдЯ, num_examples=10):
    assert num_examples <= len(dataset), "рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ pрдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдореМрдЬреВрдж рддрддреНрд╡реЛрдВ рд╕реЗ рдЕрдзрд┐рдХ рддрддреНрд╡реЛрдВ рдХреЛ рд╣рдЯрд╛ рджреЗрдВред"
    рдЪреБрдирддрд╛ рд╣реИ = []
    рд░реЗрдВрдЬ рдореЗрдВ _ рдХреЗ рд▓рд┐рдП (num_examples):
        рдкрд┐рдХ = рд░реИрдВрдбрдо.рд░реИрдВрдбрд┐рдВрдЯ(0, рд▓реЗрди(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
        рдЪрдпрди рдХрд░рддреЗ рд╕рдордп:
            рдкрд┐рдХ = рд░реИрдВрдбрдо.рд░реИрдВрдбрд┐рдВрдЯ(0, рд▓реЗрди(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
        рдЪреБрдирддрд╛ рд╣реИ.рдЬреЛрдбрд╝реЗрдВ(рдЪреБрдиреЗрдВ)
    
    рдбреАрдПрдл = рдкреАрдбреА.рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо(рдбреЗрдЯрд╛рд╕реЗрдЯ[рдЪреБрдирддрд╛ рд╣реИ])
    рдХреЙрд▓рдо рдХреЗ рд▓рд┐рдП, dataset.features.items() рдЯрд╛рдЗрдк рдХрд░реЗрдВ:
        рдпрджрд┐ isinstance(рдкреНрд░рдХрд╛рд░, рдХреНрд▓рд╛рд╕рд▓реЗрдмрд▓):
            рдбреАрдПрдл[рдХреЙрд▓рдо] = рдбреАрдПрдл[рдХреЙрд▓рдо].рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо(рд▓реИрдореНрдмреНрдбрд╛ рдЖрдИ: рдЯрд╛рдЗрдк.рдирд╛рдо[рдЖрдИ])
        elif isinstance(type, Sequence) and isinstance(typ.feature, ClassLabel):
            рдбреАрдПрдл[рдХреЙрд▓рдо] = рдбреАрдПрдл[рдХреЙрд▓рдо].рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо(рд▓реИрдореНрдмреНрдбрд╛ рдПрдХреНрд╕: [рдЯрд╛рдЗрдк.рдлреАрдЪрд░.рдирд╛рдо[рдЖрдИ] рдлреЙрд░ рдЖрдИ рдЗрди рдПрдХреНрд╕])
    рдкреНрд░рджрд░реНрд╢рди(HTML(df.to_html()))
```


```рдЕрдЬрдЧрд░
show_random_elements(рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"])
```


<рддрд╛рд▓рд┐рдХрд╛ рд╕реАрдорд╛ = "1" рд╡рд░реНрдЧ = "рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо">
  <рд╕рд┐рд░>
    <tr рд╢реИрд▓реА = "рдкрд╛рда-рд╕рдВрд░реЗрдЦрдг: рджрд╛рдПрдВ;">
      <рде></рде>
      <th>рдЖрдИрдбреА</th>
      <th>рдЯреЛрдХрди</th>
      <th>pos_tags</th>
      <th>chunk_tags</th>
      <th>ner_tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th><td>2227</td>
      <td>[рдкрд░рд┐рдгрд╛рдо, рдХрд╛, рдП, рдлрд╝реНрд░реЗрдВрдЪ, рдкреНрд░рдердо, рдбрд┐рд╡реАрдЬрд╝рди, рдореИрдЪ, рд╢реБрдХреНрд░рд╡рд╛рд░, .]</td>
      <td>[рдПрдирдПрди, рдЖрдИрдПрди, рдбреАрдЯреА, рдЬреЗрдЬреЗ, рдЬреЗрдЬреЗ, рдПрдирдПрди, рдПрдирдПрди, рдЖрдИрдПрди, рдПрдирдПрдирдкреА, .]</td>
      <td>[рдмреА-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдУ]</td>
      <td>[O, O, O, B-MISC, O, O, O, O, O, O]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2615</td>
      <td>[рдордзреНрдп рд╕реНрддрд░реАрдп, рд╕реНрд╡рд░реНрдг, рдКрдкрд░, рдЕрдВрджрд░, рднрд╛рд░реА, рд╡реНрдпрд╛рдкрд╛рд░, .]</td>
      <td>[рдПрдирдПрди, рдПрдирдПрдирдПрд╕, рдЖрдИрдПрди, рдЖрдИрдПрди, рдЬреЗрдЬреЗ, рдПрдирдПрди, .]</td>
      <td>[рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдУ]</td>
      <td>[рдУ,рдУ, рдУ, рдУ, рдУ, рдУ, рдУ]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10256</td>
      <td>[рдиреАрдЧрд▓, (, 14-6, ), рдмреАрдЯ, рдж, рдмреНрд░реЗрд╡реНрд╕, рдлреЙрд░, рдж, рдерд░реНрдб, рдЯрд╛рдЗрдо, рджрд┐рд╕, рд╕реАрдЬрд╝рди, ,, рдЕрдиреБрдорддрд┐, рджреЛ, рд░рди, рдФрд░, рдЫрд╣, рд╣рд┐рдЯ, рдЗрди, рдЖрда, рдкрд╛рд░реА, .]</td>
      <td>[рдПрдирдПрдирдкреА, (, рд╕реАрдбреА, ), рд╡реАрдмреА, рдбреАрдЯреА, рдПрдирдПрдирдкреАрдПрд╕, рдЖрдИрдПрди, рдбреАрдЯреА, рдЬреЗрдЬреЗ, рдПрдирдПрди, рдбреАрдЯреА, рдПрдирдПрди,, рд╡реАрдмреАрдЬреА, рд╕реАрдбреА, рдПрдирдПрдирдПрд╕, рд╕реАрд╕реА, рд╕реАрдбреА, рдПрдирдПрдирдПрд╕, рдЖрдИрдПрди, рд╕реАрдбреА, рдПрдирдПрди, .]</td>
      <td>[рдмреА-рдПрдирдкреА, рдУ, рдмреА-рдПрдирдкреА, рдУ, рдмреА-рд╡реАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ- рдПрдирдкреА, рдУ, рдмреА-рд╡реАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдУ, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдУ]</td><td>[рдмреА-рдкрд░, рдУ, рдУ, рдУ, рдУ, рдУ, рдмреА-рдУрдЖрд░рдЬреА, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ]</td>
    </tr>
    <tr>
      <рде>3</рде>
      <td>10720</td>
      <td>[рд╣рдВрд╕рд╛, рд░реЛрд╕реНрдЯреЙрдХ, 4, 1, 2, 1, 5, 4, 5]</td>
      <td>[рдПрдирдПрдирдкреА, рдПрдирдПрдирдкреА, рд╕реАрдбреА, рд╕реАрдбреА, рд╕реАрдбреА, рд╕реАрдбреА, рд╕реАрдбреА, рд╕реАрдбреА, рд╕реАрдбреА]</td>
      <td>[рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА]</td>
      <td>[рдмреА-рдУрдЖрд░рдЬреА, рдЖрдИ-рдУрдЖрд░рдЬреА, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ]</td>
    </tr>
    <tr>
      <рде>4</рде>
      <td>7125</td>
      <td>[рдореЙрдиреНрдЯреНрд░рд┐рдпрд▓, 70, 59, .543, 11]</td>
      <td>[рдПрдирдПрдирдкреА, рд╕реАрдбреА, рд╕реАрдбреА,рд╕реАрдбреА, рд╕реАрдбреА]</td>
      <td>[рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА]</td>
      <td>[рдмреА-рдУрдЖрд░рдЬреА, рдУ, рдУ, рдУ, рдУ]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3316</td>
      <td>[рд╕реЙрдлреНрдЯрдмреИрдВрдХ, рдХреЙрд░реНрдк, рдиреЗ рдХрд╣рд╛, рд╢реБрдХреНрд░рд╡рд╛рд░ рдХреЛ, рд╡рд╣, рдЦрд░реАрджреЗрдЧрд╛, $, 900, рдорд┐рд▓рд┐рдпрди, рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рд╡рд┐рджреЗрд╢реА, рд╡рд┐рдирд┐рдордп, рдмрд╛рдЬрд╛рд░, рджреНрд╡рд╛рд░рд╛, рд╕рд┐рддрдВрдмрд░, 5, рдХреЗ рд░реВрдк рдореЗрдВ, рднрд╛рдЧ, рдХрд╛, рдЗрд╕рдХрд╛, рдЕрдзрд┐рдЧреНрд░рд╣рдг, рдХрд╛, рдпреВ.рдПрд╕., рдлрд░реНрдо, ,, рдХрд┐рдВрдЧреНрд╕реНрдЯрди, рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА, рдХрдВрдкрдиреА,ред]</td>
      <td>[рдПрдирдПрдирдкреА, рдПрдирдПрдирдкреА, рд╡реАрдмреАрдбреА, рдЖрдИрдПрди, рдПрдирдПрдирдкреА, рдЖрдИрдПрди, рдкреАрдЖрд░рдкреА, рдПрдордбреА, рдПрдирдПрди, $, рд╕реАрдбреА, рд╕реАрдбреА, рдЖрдИрдПрди, рдбреАрдЯреА, рдЬреЗрдЬреЗ, рдПрдирдПрди, рдПрдирдПрди, рдЖрдИрдПрди, рдПрдирдПрдирдкреА, рд╕реАрдбреА, рдЖрдИрдПрди, рдПрдирдПрди, рдЖрдИрдПрди, рдкреАрдЖрд░рдкреА$, рдПрдирдПрди,рдЖрдИрдПрди, рдПрдирдПрдирдкреА, рдПрдирдПрди, ,, рдПрдирдПрдирдкреА, рдПрдирдПрдирдкреА, рдПрдирдПрдирдкреА, ред]</td>
      <td>[рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рд╡реАрдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдмреА-рдПрд╕рдмреАрдПрдЖрд░, рдмреА-рдПрдирдкреА, рдмреА-рд╡реАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ- рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдУ, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдУ]</td>
      <td>[рдмреА-рдУрдЖрд░рдЬреА, рдЖрдИ-рдУрдЖрд░рдЬреА, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдмреА-рдПрд▓рдУрд╕реА, рдУ, рдУ, рдмреА-рдУрдЖрд░рдЬреА, рдЖрдИ-рдУрдЖрд░рдЬреА, рдЖрдИ-рдУрдЖрд░рдЬреА, рдУ]</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3923</td>
      <td>[рдЧреЗрдиреНрдЯ, 3, рдЖрд▓реНрд╕реНрдЯ, 2]</td>
      <td>[рдПрдирдПрди, рд╕реАрдбреА, рдПрдирдПрдирдкреА, рд╕реАрдбреА]</td>
      <td>[рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА]</td>
      <td>[рдмреА-рдУрдЖрд░рдЬреА, рдУ, рдмреА-рдУрдЖрд░рдЬреА, рдУ]</td>
    </tr>
    <tr>
      <рде>7</рде>
      <td>2776</td>
      <td>[рдЕрд▓рдЧрд╛рд╡рд╡рд╛рджреА, ,, рдЬреЛ, рдЧреНрд░реЛрдЬрд╝реНрдиреА рдореЗрдВ, рдЕрдЧрд╕реНрдд, 6, рдХреЛ, рдмрд╣ рдЧрдП, рдЕрднреА рднреА, рдирд┐рдпрдВрддреНрд░рдг, рдмрдбрд╝реЗ, рдХреНрд╖реЗрддреНрд░, рдХрд╛, рдХреЗрдВрджреНрд░, рдХрд╛, рд╢рд╣рд░, ,, рдФрд░, рд░реВрд╕реА, рд╕реИрдирд┐рдХ, рд╣реИрдВ, рдЖрдзрд╛рд░рд┐рдд, рдкрд░, рдЪреМрдХрд┐рдпреЛрдВ рдкрд░, рдкрд░, рдкрд╣реБрдВрдЪ, рд╕рдбрд╝рдХреЗрдВ, ред]</td>
      <td>[рдбреАрдЯреА, рдПрдирдПрдирдПрд╕, ,, рдбрдмреНрд▓реНрдпреВрдкреА, рд╡реАрдмреАрдбреА, рдЖрдИрдПрди, рдПрдирдПрдирдкреА, рдЖрдИрдПрди, рдПрдирдПрдирдкреА, рд╕реАрдбреА, ,, рдЖрд░рдмреА, рд╡реАрдмреАрдкреА, рдЬреЗрдЬреЗ, рдПрдирдПрдирдПрд╕, рдЖрдИрдПрди, рдбреАрдЯреА, рдПрдирдПрди, рдЖрдИрдПрди, рдПрдирдПрди, ,, рд╕реАрд╕реА, рдЬреЗрдЬреЗ, рдПрдирдПрдирдПрд╕, рд╡реАрдмреАрдкреА, рд╡реАрдмреАрдПрди, рдЖрдИрдПрди, рдПрдирдПрдирдПрд╕, рдЖрдИрдПрди, рдбреАрдЯреА, рдПрдирдПрди, рдПрдирдПрдирдПрд╕, .]</td>
      <td>[рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдУ, рдмреА-рдПрдирдкреА, рдмреА-рд╡реАрдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдУ, рдмреА-рдПрдбреАрд╡реАрдкреА, рдмреА- рд╡реАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдУ, рдУ, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рд╡реАрдкреА, рдЖрдИ-рд╡реАрдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдУ]</td>
      <td>[рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдмреА-рдПрд▓рдУрд╕реА, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдмреА-рдПрдордЖрдИрдПрд╕рд╕реА, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ]</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1178</td>
      <td>[рдбреЙрдХреНрдЯрд░, рдореИрд╕реЗрд░рд┐рдЧреНрдиреЗ, рдПрдирдбрд┐рдпрд╛рдпреЗ, рдиреЗ рдХрд╣рд╛, рдЪрд┐рдХрд┐рддреНрд╕рд╛, рдХрд░реНрдордЪрд╛рд░реА, рдХрд╛рдо рд╕реЗ рдЕрднрд┐рднреВрдд, рдЕрднрд┐рднреВрдд рдереЗред, "]</td>
      <td>[рдПрдирдПрдирдкреА, рдПрдирдПрдирдкреА, рдПрдирдПрдирдкреА, рд╡реАрдмреАрдбреА, рдЬреЗрдЬреЗ, рдПрдирдПрди, рд╡реАрдмреАрдбреА, рд╡реАрдмреАрдПрди, рдЖрдИрдПрди, рдПрдирдПрди, ., "]</td>
      <td>[рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рд╡реАрдкреА, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдмреА-рд╡реАрдкреА, рдЖрдИ-рд╡реАрдкреА, рдмреА-рдкреАрдкреА, рдмреА-рдПрдирдкреА, рдУ, рдУ]</ рдЯреАрдбреА>
      <td>[O, B-PER, I-PER, O, O, O, O, O, O, O, O, O]</td>
    </tr>
    <tr>
      <рде>9</рде>
      <td>10988</td>
      <td>[рд░реЙрдпрдЯрд░реНрд╕, рдРрддрд┐рд╣рд╛рд╕рд┐рдХ, рдХреИрд▓реЗрдВрдбрд░, -, рд╕рд┐рддрдВрдмрд░, 4, .]</td>
      <td>[рдПрдирдПрдирдкреА, рдЬреЗрдЬреЗ, рдПрдирдПрди, :, рдПрдирдПрдирдкреА, рд╕реАрдбреА, .]</td>
      <td>[рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдУ, рдмреА-рдПрдирдкреА, рдЖрдИ-рдПрдирдкреА, рдУ]</td>
      <td>[рдмреА-рдУрдЖрд░рдЬреА, рдУ, рдУ, рдУ, рдУ, рдУ, рдУ]</td>
    </tr>
  </tbody>
</рдЯреЗрдмрд▓>


## рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдбреЗрдЯрд╛

рдореЙрдбрд▓ рдореЗрдВ рдбреЗрдЯрд╛ рдлреАрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЯреВрд▓ рдХреЛ 'рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░' рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред `рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░` рдкрд╣рд▓реЗ рдЗрдирдкреБрдЯ рдХреЛ рдЯреЛрдХрдирд╛рдЗрдЬрд╝ рдХрд░рддрд╛ рд╣реИ, рдлрд┐рд░ рдЯреЛрдХрди рдХреЛ рдкреНрд░реА-рдореЙрдбрд▓ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╕рдВрдмрдВрдзрд┐рдд рдЯреЛрдХрди рдЖрдИрдбреА рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИред

рдбреЗрдЯрд╛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЕрдкрдиреЗ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `AutoTokenizer.from_pretrained` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ:

- рд╣рдореЗрдВ рдПрдХ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдорд┐рд▓рддрд╛ рд╣реИ рдЬреЛ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рд╡рди-рдЯреВ-рд╡рди рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред
- рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рдЕрдиреБрд░реВрдк рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рд╣рдо рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рд╢рдмреНрджрд╛рд╡рд▓реА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рднреА рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ, рд╕рдЯреАрдХ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдЯреЛрдХрди рд╢рдмреНрджрд╛рд╡рд▓реАред

рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЧрдП рдЯреЛрдХрди рд╢рдмреНрджрд╛рд╡рд▓реА рдХреЛ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддрд╛рдХрд┐ рджреЛрдмрд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдкрд░ рдЗрд╕реЗ рджреЛрдмрд╛рд░рд╛ рдбрд╛рдЙрдирд▓реЛрдб рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред


```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ
    
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(model_checkpoint)
```

рдиреЛрдЯ: рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдбрдХреЛрдб рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░.PreTrainedTokenizerFast рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди рдлрд╛рд╕реНрдЯ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреА рдХреБрдЫ рд╡рд┐рд╢реЗрд╖ рд╕реБрд╡рд┐рдзрд╛рдУрдВ (рдЬреИрд╕реЗ рдорд▓реНрдЯреА-рдереНрд░реЗрдбреЗрдб рдлрд╛рд╕реНрдЯ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

рдореЙрдбрд▓реЛрдВ рдХреЗ рдЕрдиреБрд░реВрдк рд▓рдЧрднрдЧ рд╕рднреА рдЯреЛрдХрдирдирд╛рдЗрдЬрд░реЛрдВ рдореЗрдВ рд╕рдВрдЧрдд рддреЗрдЬ рдЯреЛрдХрдирдирд╛рдЗрдЬрд░ рд╣реЛрддреЗ рд╣реИрдВред рд╣рдо [рдореЙрдбрд▓ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреЙрд░реЗрд╕реНрдкреЛрдВрдбреЗрдВрд╕ рдЯреЗрдмрд▓] (https://huggingface.co/transformers/index.html#bigtable) рдореЗрдВ рд╕рднреА рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓реЛрдВ рдХреЗ рдЕрдиреБрд░реВрдк рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред


```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдЬрд╝реЛрд░ isinstance(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░, рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░.PreTrainedTokenizerFast)
```

рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдореЙрдбрд▓ рдореЗрдВ рддреЗрдЬрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рд╣реИ, [рдпрд╣рд╛рдВ рдореЙрдбрд▓ рдХреА рдмрдбрд╝реА рддрд╛рд▓рд┐рдХрд╛] (https://huggingface.co/transformers/index.html#bigtable) рджреЗрдЦреЗрдВред

рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдПрдХрд▓ рдкрд╛рда рдФрд░ рдкрд╛рдареЛрдВ рдХреА рдПрдХ рдЬреЛрдбрд╝реА рджреЛрдиреЛрдВ рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИредрдкреНрд░рд╕рдВрд╕реНрдХрд░рдг, рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рдж рдкреНрд░рд╛рдкреНрдд рдбреЗрдЯрд╛ рдкреНрд░реА-рдЯреНрд░реЗрдирд┐рдВрдЧ рдореЙрдбрд▓ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рд╕реЗ рдорд┐рд▓рддрд╛ рд╣реИ


```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ ("рд╣реИрд▓реЛ, рдпрд╣ рдПрдХ рд╡рд╛рдХреНрдп рд╣реИ!")
```




    {'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [101, 7592, 1010, 2023, 2003, 2028, 6251, 999, 102], 'рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ': [1, 1, 1, 1, 1, 1, 1, 1, 1]}






```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ (["рд╣реИрд▓реЛ", ","", "рдпрд╣", "рд╣реИ", "рдПрдХ", "рд╡рд╛рдХреНрдп", "рд╡рд┐рднрд╛рдЬрд┐рдд", "рдореЗрдВ", "рд╢рдмреНрдж", "ред"], is_split_into_words=True)
```




    {'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [101, 7592, 1010, 2023, 2003, 2028, 6251, 3975, 2046, 2616, 1012, 102], 'рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдкреНрд░реА-рдЯреНрд░реЗрдирд┐рдВрдЧ рдореЙрдбрд▓ рдЖрдорддреМрд░ рдкрд░ рдкреНрд░реА-рдЯреНрд░реЗрдирд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди рд╕рдмрд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рд╣рдорд╛рд░реЗ рдЯреЗрдХреНрд╕реНрдЯ рдЗрдирдкреБрдЯ рдХреЛ рд╢рдмреНрджреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпреЗ рд╢рдмреНрдж рд╣рдорд╛рд░реЗ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рдЦрдВрдбрд┐рдд рд╣реЛрддреЗ рд░рд╣реЗрдВрдЧреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:



```рдЕрдЬрдЧрд░
рдЙрджрд╛рд╣рд░рдг = рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"][4]
рдкреНрд░рд┐рдВрдЯ(рдЙрджрд╛рд╣рд░рдг["рдЯреЛрдХрди"])
```

    ['рдЬрд░реНрдордиреА', ''рдПрд╕'', 'рдкреНрд░рддрд┐рдирд┐рдзрд┐', 'рдЯреВ', 'рдж', 'рдпреВрд░реЛрдкреАрдп', 'рд╕рдВрдШ', ''рдПрд╕'', 'рдкрд╢реБ рдЪрд┐рдХрд┐рддреНрд╕рд╛', 'рд╕рдорд┐рддрд┐', 'рд╡рд░реНрдирд░', 'рдЬрд╝реНрд╡рд┐рдВрдЧрдореИрди' , 'рдХрд╣рд╛', 'рдкрд░', 'рдмреБрдзрд╡рд╛рд░', 'рдЙрдкрднреЛрдХреНрддрд╛', 'рдЪрд╛рд╣рд┐рдП', 'рдЦрд░реАрджреЗрдВ', 'рднреЗрдбрд╝ рдХрд╛ рдорд╛рдВрд╕', 'рд╕реЗ', 'рджреЗрд╢', 'рдЕрдиреНрдп', 'рд╕реЗ', 'рдмреНрд░рд┐рдЯреЗрди', ' рдЬрдм рддрдХ', 'рдж', 'рд╡реИрдЬреНрдЮрд╛рдирд┐рдХ', 'рд╕рд▓рд╛рд╣', 'рдерд╛', 'рд╕реНрдкрд╖реНрдЯ', 'ред']



```рдЕрдЬрдЧрд░
рдЯреЛрдХрдиized_input = рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░(рдЙрджрд╛рд╣рд░рдг["рдЯреЛрдХрди"], is_split_into_words=True)
рдЯреЛрдХрди = рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░.рдХрдиреНрд╡рд░реНрдЯ_рдЖрдИрдбреА_рдЯреВ_рдЯреЛрдХрди(рдЯреЛрдХрдирдпреБрдХреНрдд_рдЗрдирдкреБрдЯ["рдЗрдирдкреБрдЯ_рдЖрдИрдбреА"])
рдкреНрд░рд┐рдВрдЯ(рдЯреЛрдХрди)
```

    ['[рд╕реАрдПрд▓рдПрд╕]', 'рдЬрд░реНрдордиреА', "'", 'рдПрд╕', 'рдкреНрд░рддрд┐рдирд┐рдзрд┐', 'рд╕реЗ', 'рдж', 'рдпреВрд░реЛрдкреАрдп', 'рд╕рдВрдШ', "'", 'рдПрд╕', 'рдкрд╢реБ рдЪрд┐рдХрд┐рддреНрд╕рд╛' , 'рд╕рдорд┐рддрд┐', 'рд╡рд░реНрдирд░', 'рдЬреЗрдб', '##рд╡рд┐рдВрдЧ', '##рдореИрди', 'рдХрд╣рд╛', 'рдкрд░', 'рдмреБрдзрд╡рд╛рд░', 'рдЙрдкрднреЛрдХреНрддрд╛', 'рдЪрд╛рд╣рд┐рдП', 'рдЦрд░реАрджреЗрдВ', ' рднреЗрдбрд╝', '##рдореИрдВ', '##рдкрд░', 'рд╕реЗ', 'рджреЗрд╢', 'рдЕрдиреНрдп', 'рд╕реЗ', 'рдмреНрд░рд┐рдЯреЗрди', 'рдЬрдм рддрдХ', 'рдж', 'рд╡реИрдЬреНрдЮрд╛рдирд┐рдХ', 'рд╕рд▓рд╛рд╣' , 'рдерд╛', 'рдХреНрд▓реА'rer', '.', '[SEP]']


рд╢рдмреНрдж "рдЬрд╝реНрд╡рд┐рдВрдЧрдореИрди" рдФрд░ "рд╢реАрдкрдореАрдЯ" рдХреЛ 3 рдЙрдкрд╕рдВрдХреЗрддреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЬрд╛рд░реА рд╣реИред

рдЪреВрдВрдХрд┐ рдПрдиреЛрдЯреЗрдЯ рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рдЖрдорддреМрд░ рдкрд░ рд╢рдмреНрдж рд╕реНрддрд░ рдкрд░ рдПрдиреЛрдЯреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╢рдмреНрдж рдХреЛ рдЙрдкрдЯреЛрдХрди рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдореЗрдВ рдПрдиреЛрдЯреЗрдЯ рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЗ рдЙрдкрдЯреЛрдХрди рдХреЛ рднреА рд╕рдВрд░реЗрдЦрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд╕рд╛рде рд╣реА, рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдореЙрдбрд▓ рдХреЗ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рдХрд╛рд░рдг, рдЕрдХреНрд╕рд░ рдХреБрдЫ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рддреАрдХреЛрдВ рдХреЛ рдЬреЛрдбрд╝рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддрд╛ рд╣реИ рдЬреИрд╕реЗ: `[рд╕реАрдПрд▓рдПрд╕]` рдФрд░ `[рдПрд╕рдИрдкреА]`ред


```рдЕрдЬрдЧрд░
рд▓реЗрди(рдЙрджрд╛рд╣рд░рдг[f"{рдХрд╛рд░реНрдп}_рдЯреИрдЧ"]), рд▓реЗрди(рдЯреЛрдХрдирдпреБрдХреНрдд_рдЗрдирдкреБрдЯ["рдЗрдирдкреБрдЯ_рдЖрдИрдбреА"])
```




    (31,39)



рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдореЗрдВ рдПрдХ `word_ids` рд╡рд┐рдзрд┐ рд╣реИ рдЬреЛ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдореЗрдВ рд╣рдорд╛рд░реА рд╕рд╣рд╛рдпрддрд╛ рдХрд░ рд╕рдХрддреА рд╣реИред


```рдЕрдЬрдЧрд░
рдкреНрд░рд┐рдВрдЯ(рдЯреЛрдХрдирдпреБрдХреНрдд_рдЗрдирдкреБрдЯ.рд╡рд░реНрдб_рдЖрдИрдбреА())
```

    [рдХреЛрдИ рдирд╣реАрдВ, 0, 1, 1, 2, 3, 4, 5, 6, 7, 7, 8, 9, 10, 11, 11, 11, 12, 13, 14, 15, 16, 17, 18, 18 , 18, 19, 20, 21,22, 23, 24, 25, 26, 27, 28, 29, 30, рдХреЛрдИ рдирд╣реАрдВ]



рд╣рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ Word_ids рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдЯреЛрдХрди рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рд╢рдмреНрдж рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкрд╣рд▓реА рд╕реНрдерд┐рддрд┐ 0рд╡реЗрдВ рд╢рдмреНрдж рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИ, рдФрд░ рдлрд┐рд░ рджреВрд╕рд░реА рдФрд░ рддреАрд╕рд░реА рд╕реНрдерд┐рддрд┐ рдкрд╣рд▓реЗ рд╢рдмреНрдж рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИред рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдг рдХрд┐рд╕реА рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддреЗред рдЗрд╕ рд╕реВрдЪреА рдХреЗ рд╕рд╛рде, рд╣рдо рдЙрдкрдЯреЛрдХрди рдХреЛ рд╢рдмреНрджреЛрдВ рдФрд░ рдПрдиреЛрдЯреЗрдЯреЗрдб рд▓реЗрдмрд▓ рдХреЗ рд╕рд╛рде рд╕рдВрд░реЗрдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред


```рдЕрдЬрдЧрд░
рд╡рд░реНрдб_рдЖрдИрдбреА = рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдЗрдирдкреБрдЯ.рд╡рд░реНрдб_рдЖрдИрдбреА()
рд╕рдВрд░реЗрдЦрд┐рдд_рд▓реЗрдмрд▓ = [-100 рдпрджрд┐ рдореИрдВ рдХреЛрдИ рдФрд░ рдирд╣реАрдВ рдЙрджрд╛рд╣рд░рдг [f"{task}_tags"][i] Word_ids рдореЗрдВ i рдХреЗ рд▓рд┐рдП]
рдкреНрд░рд┐рдВрдЯ (рд▓реЗрди (рд╕рдВрд░реЗрдЦрд┐рдд_рд▓реЗрдмрд▓реНрд╕), рд▓реЗрди (рдЯреЛрдХрдирдХреГрдд_рдЗрдирдкреБрдЯ ["рдЗрдирдкреБрдЯ_рдЖрдИрдбреА"]))
```

    39 39


рд╣рдо рдЖрдорддреМрд░ рдкрд░ рдореЙрдбрд▓ рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдгреЛрдВ рдХрд╛ рд▓реЗрдмрд▓ -100 рдкрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, -100 рдХреЛ рдЖрдорддреМрд░ рдкрд░ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдиреБрдХрд╕рд╛рди рдХреА рдЧрдгрдирд╛ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИред

рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд▓реЗрдмрд▓ рд╕рдВрд░реЗрдЦрд┐рдд рдХрд░рдиреЗ рдХреЗ рджреЛ рддрд░реАрдХреЗ рд╣реИрдВ:
- рдПрдХрд╛рдзрд┐рдХ рдЙрдкрдЯреЛрдХрди рдПрдХ рд╢рдмреНрдж рдФрд░ рдПрдХ рд▓реЗрдмрд▓ рд╕реЗ рд╕рдВрд░реЗрдЦрд┐рдд рд╣реЛрддреЗ рд╣реИрдВ
- рдПрдХрд╛рдзрд┐рдХрд╕рдмрдЯреЛрдХрди рдХрд╛ рдкрд╣рд▓рд╛ рд╕рдмрдЯреЛрдХрди рд╢рдмреНрдж рдФрд░ рдПрдХ рд▓реЗрдмрд▓ рдХреЗ рд╕рд╛рде рд╕рдВрд░реЗрдЦрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдЕрдиреНрдп рд╕рдмрдЯреЛрдХрди рдХреЛ рд╕реАрдзреЗ -100 рд╕реМрдВрдкрд╛ рдЬрд╛рддрд╛ рд╣реИред

рд╣рдо `label_all_tokens = True` рджреНрд╡рд╛рд░рд╛ рдЯреЙрдЧрд▓ рдХрд░рдХреЗ рджреЛрдиреЛрдВ рд╡рд┐рдзрд┐рдпрд╛рдБ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред



```рдЕрдЬрдЧрд░
рд▓реЗрдмрд▓_рдСрд▓_рдЯреЛрдХреЗрдВрд╕ = рд╕рддреНрдп
```


рдЕрдВрддрддрдГ рд╣рдо рд╣рд░ рдЪреАрдЬрд╝ рдХреЛ рдЕрдкрдиреЗ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд░рддреЗ рд╣реИрдВред `is_split_into_words=True` рдКрдкрд░ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛ рд╣реИред


```рдЕрдЬрдЧрд░
def рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝_рдПрдВрдб_рдПрд▓рд╛рдЗрди_рд▓реЗрдмрд▓реНрд╕(рдЙрджрд╛рд╣рд░рдг):
    рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдЗрдирдкреБрдЯ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд░(рдЙрджрд╛рд╣рд░рдг["рдЯреЛрдХрди"], рдХрд╛рдЯ-рдЫрд╛рдВрдЯ=рд╕рд╣реА, is_split_into_words=рд╕рдЪреНрдЪрд╛)

    рд▓реЗрдмрд▓ = []
    i рдХреЗ рд▓рд┐рдП, enumerate рдореЗрдВ рд▓реЗрдмрд▓ рдХрд░реЗрдВ (рдЙрджрд╛рд╣рд░рдг[f"{task}_tags"]):
        рд╡рд░реНрдб_рдЖрдИрдбреА = рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдЗрдирдкреБрдЯ.рд╡рд░реНрдб_рдЖрдИрдбреА(рдмреИрдЪ_рдЗрдВрдбреЗрдХреНрд╕=рдЖрдИ)
        рдкреНрд░реАрд╡рд┐рдУus_word_idx = рдХреЛрдИ рдирд╣реАрдВ
        рд▓реЗрдмрд▓_рдЖрдИрдбреА = []
        Word_idx рдореЗрдВ Word_idx рдХреЗ рд▓рд┐рдП:
            # рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди рдореЗрдВ рдПрдХ рд╢рдмреНрдж рдЖрдИрдбреА рд╣реЛрддреА рд╣реИ рдЬреЛ рдХрд┐ рдХреЛрдИ рдирд╣реАрдВ рд╣реИ, рд╣рдо рд▓реЗрдмрд▓ рдХреЛ -100 рдкрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╣реЛрдВ
            # рд╣рд╛рдирд┐ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдЕрдирджреЗрдЦрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ред
            рдпрджрд┐ Word_idx рдХреЛрдИ рдирд╣реАрдВ рд╣реИ:
                рд▓реЗрдмрд▓_рдЖрдИрдбреА.рдЬреЛрдбрд╝реЗрдВ(-100)
            # рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рд╢рдмреНрдж рдХреЗ рдкрд╣рд▓реЗ рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП рд▓реЗрдмрд▓ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВред
            рдПрд▓рд┐рдл рд╡рд░реНрдб_рдЖрдИрдбреАрдПрдХреНрд╕ != рдкрд┐рдЫрд▓рд╛_рд╡рд░реНрдб_рдЖрдИрдбреАрдПрдХреНрд╕:
                label_ids.append(рд▓реЗрдмрд▓[word_idx])
            # рдЕрдиреНрдп рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП iрдПрдХ рд╢рдмреНрдж рдореЗрдВ, рд╣рдо рд▓реЗрдмрд▓ рдХреЛ рдпрд╛ рддреЛ рд╡рд░реНрддрдорд╛рди рд▓реЗрдмрд▓ рдкрд░ рдпрд╛ -100 рдкрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ
            # рд▓реЗрдмрд▓_рдСрд▓_рдЯреЛрдХрди рдзреНрд╡рдЬред
            рдЕрдиреНрдп:
                label_ids.append(рд▓реЗрдмрд▓[word_idx] рдпрджрд┐ рд▓реЗрдмрд▓_all_tokens рдЕрдиреНрдпрдерд╛ -100)
            рдкрд┐рдЫрд▓рд╛_рд╡рд░реНрдб_рдЖрдИрдбреАрдПрдХреНрд╕ = рд╡рд░реНрдб_рдЖрдИрдбреАрдПрдХреНрд╕

        рд▓реЗрдмрд▓.рдЬреЛрдбрд╝реЗрдВ(рд▓реЗрдмрд▓_рдЖрдИрдбреА)

    рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдЗрдирдкреБрдЯреНрд╕["рд▓реЗрдмрд▓реНрд╕"] = рд▓реЗрдмрд▓реНрд╕
    рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдЗрдирдкреБрдЯ рд▓реМрдЯрд╛рдПрдВ
```

рдЙрдкрд░реЛрдХреНрдд рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдПрдХ рдирдореВрдирд╛ рдпрд╛ рдПрдХрд╛рдзрд┐рдХ рдирдореВрдирд╛ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдХрдИ рдирдореВрдиреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХрдИ рдирдореВрдиреЛрдВ рдХреЛ рдкреВрд░реНрд╡-рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рд╡рд╛рдкрд╕ рдХрд░ рджреА рдЬрд╛рддреА рд╣реИред


```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝_рдПрдВрдб_рдПрд▓рд╛рдЗрди_рд▓реЗрдмрд▓реНрд╕(рдбреЗрдЯрд╛рд╕реЗрдЯ['рдЯреНрд░реЗрди'][:5])
```{'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [[101, 7327, 19164, 2446, 2655, 2000, 17757, 2329, 12559, 1012, 102], [101, 2848, 13934, 102], [101, 9371, 2727, 1011 , 5511 , 1011, 2570, 102], [101, 1996, 2647, 3222, 2056, 2006, 9432, 2009, 18335, 2007, 2446, 6040, 2000, 10390, 2000, 18454, 2078 , 2329, 12559, 2127, 6529 , 5646, 3251, 5506, 11190, 4295, 2064, 2022, 11860, 2000, 8351, 1012, 102], [101, 2762, 1005, 1055, 4387, 2000, 1996, 2586, 1005, 1055, 15651 , 2837, 14121, 1062, 9328, 5804, 2056, 2006, 9317, 10390, 2323, 4965, 8351, 4168, 4017, 2013, 3032, 2060, 2084, 3725, 2127, 1996, 4045, 6040, 2001, 24509, 1012, 102]], 'рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ': [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]], 'рд▓реЗрдмрд▓': [[ -100, 3, 0, 7, 0, 0, 0, 7, 0, 0, -100], [-100, 1, 2, -100], [-100,5, 0, 0, 0, 0, 0, -100], [-100, 0, 3, 4, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -100], [-100, 5, 0, 0, 0, 0, 0, 3, 4, 0, 0, 0, 0, 1, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, -100]]}



рдЗрд╕рдХреЗ рдмрд╛рдж, рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рд╕рднреА рдирдореВрдиреЗ рдкреВрд░реНрд╡-рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреА рд╡рд┐рдзрд┐ рдореИрдк рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдФрд░ рд╕рднреА рдирдореВрдиреЛрдВ рдкрд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рддреИрдпрд╛рд░_рдЯреНрд░реЗрди_рдлреАрдЪрд░реНрд╕ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рд╣реИред




```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк(рдЯреЛрдХрдирд╛рдЗрдЬ_рдПрдВрдб_рдПрд▓рд╛рдЗрди_рд▓реЗрдмрд▓реНрд╕, рдмреИрдЪ = рд╕рд╣реА)
```

рдЗрд╕рд╕реЗ рднреА рдмреЗрд╣рддрд░, рдЕрдЧрд▓реА рдмрд╛рд░ рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрдиреЗ рдкрд░ рдкреБрдирд░реНрдЧрдгрдирд╛ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд▓реМрдЯрд╛рдП рдЧрдП рдкрд░рд┐рдгрд╛рдо рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХреИрд╢ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ (рд▓реЗрдХрд┐рди рдХреГрдкрдпрд╛ рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЗрдирдкреБрдЯ рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдХреИрд╢ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ!)ред рджрд╛рдЯреИрд╕реЗрдЯреНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдлрд╝рдВрдХреНрд╢рди рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдкрд░рд┐рд╡рд░реНрддрди рд╣реИрдВред рдпрджрд┐ рдХреЛрдИ рдкрд░рд┐рд╡рд░реНрддрди рдирд╣реАрдВ рд╣реИрдВ, рддреЛ рдХреИрд╢реНрдб рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рд▓реЗрдХрд┐рди рдпрджрд┐ рдЗрдирдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рд░рд╣рддреЗ рд╣реИрдВ рдФрд░ рдЖрдк рдЗрдирдкреБрдЯ рдмрджрд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдХреИрд╢ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░рдирд╛ рдФрд░ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдирд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╣реИред рд╕рд╛рдлрд╝ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ `load_from_cache_file=False` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдКрдкрд░ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ `рдмреИрдЪ = рдЯреНрд░реВ` рдкреИрд░рд╛рдореАрдЯрд░ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреА рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╕рдорд╛рдирд╛рдВрддрд░ рдореЗрдВ рдЗрдирдкреБрдЯ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдереНрд░реЗрдбреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

## рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реЗрдВ


рдЕрдм рдЬрдм рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рд╣реЛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ рдЕрдкрдиреЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдФрд░ рдлрд┐рд░ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдЪреВрдБрдХрд┐ рд╣рдо seq2seq рдХрд╛рд░реНрдп рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рд╣рдореЗрдВ рдПрдХ рдореЙрдбрд▓ рд╡рд░реНрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рдЗрд╕ рдХрд╛рд░реНрдп рдХреЛ рд╣рд▓ рдХрд░ рд╕рдХреЗред рд╣рдо рд╡рд░реНрдЧ `AutoModelForTokenClassification` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЗ рд╕рдорд╛рди, `from_pretrained` рд╡рд┐рдзрд┐ рднреА рд╣рдореЗрдВ рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреА рд╣реИ, рдпрд╣ рдореЙрдбрд▓ рдХреЛ рдХреИрд╢ рднреА рдХрд░реЗрдЧреА рддрд╛рдХрд┐ рдореЙрдбрд▓ рдмрд╛рд░-рдмрд╛рд░ рдбрд╛рдЙрдирд▓реЛрдб рди рд╣реЛред


```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForTokenClassification, рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕, рдЯреНрд░реЗрдирд░ рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ

рдореЙрдбрд▓=рдСрдЯреЛрдореЙрдбрд▓рдлреЙрд░рдЯреЛрдХрдирдХреНрд▓рд╛рд╕рд┐рдлрд┐рдХреЗрд╢рди.from_pretrained(model_checkpoint, num_labels=len(label_list))
```


    рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 0%| | 0.00/268рдПрдо [00:00<?, ?рдмреА/рдПрд╕]


    DistilBertForTokenClassification рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░рддреЗ рд╕рдордп рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб рдкрд░ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рдХреБрдЫ рд╡рдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛: ['vocab_transform.weight', 'vocab_layer_norm.bias', 'vocab_projector.bias', 'vocab_projector.weight', 'vocab_transform.bias', 'vocab_layer_norm.weight']
    - рдпрджрд┐ рдЖрдк DistilBe рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддреЛ рдпрд╣ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╣реИрдХрд┐рд╕реА рдЕрдиреНрдп рдХрд╛рд░реНрдп рдкрд░ рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЗ рд╕рд╛рде рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ rtForTokenClassification (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП BertForPreTraining рдореЙрдбрд▓ рд╕реЗ BertForSequenceClassification рдореЙрдбрд▓ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдирд╛)ред
    - рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдРрд╕реЗ рдореЙрдбрд▓ рдХреЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ DistilBertForTokenClassification рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЬрд┐рд╕рдХреЗ рдмрд┐рд▓реНрдХреБрд▓ рд╕рдорд╛рди рд╣реЛрдиреЗ рдХреА рдЖрдк рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддреЗ рд╣реИрдВ (BertForSequenceClassification рдореЙрдбрд▓ рд╕реЗ BertForSequenceClassification рдореЙрдбрд▓ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдирд╛) рддреЛ рдпрд╣ рдЕрдкреЗрдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИред
    DistilBertForTokenClassifica рдХреЗ рдХреБрдЫ рд╡рдЬрдирдЗрдиреНрд╣реЗрдВ рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб рдкрд░ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ рдЖрд░рдВрдн рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдЗрдиреНрд╣реЗрдВ рдирдП рд╕рд┐рд░реЗ рд╕реЗ рдЖрд░рдВрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: ['classifier.bias', 'classifier.weight']
    рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдФрд░ рдЕрдиреБрдорд╛рди рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд╕рдВрднрд╡рддрдГ рдЗрд╕ рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрди-рд╕реНрдЯреНрд░реАрдо рдХрд╛рд░реНрдп рдкрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред


рдЪреВрдБрдХрд┐ рд╣рдорд╛рд░рд╛ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд╛рд░реНрдп рдПрдХ рдЯреЛрдХрди рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рд╣реИ, рдФрд░ рд╣рдо рдПрдХ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рднрд╛рд╖рд╛ рдореЙрдбрд▓ рд▓реЛрдб рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдореЙрдбрд▓ рд▓реЛрдб рдХрд░рддреЗ рд╕рдордп рд╣рдореЗрдВ рдХреБрдЫ рдмреЗрдореЗрд▓ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: рдкреВрд░реНрд╡ рдХрд╛ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдореБрдЦ) -рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рднрд╛рд╖рд╛ рдореЙрдбрд▓ рдХреЛ рдлреЗрдВрдХ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдЯреЛрдХрди рд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдореБрдЦ рдХреЛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛)ред



`рдЯреНрд░реЗрдирд░` рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЙрдкрдХрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ 3 рддрддреНрд╡реЛрдВ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрд┐рдВрдЧреНрд╕/рдкреИрд░рд╛рдореАрдЯрд░ [`рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреВрдореЗрдВрдЯреНрд╕`](https://huggingface.co/transformers/main_classes/trainer.html#transformers.TrainingArguments). рдЗрд╕ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрд┐рдВрдЧ рдореЗрдВ рд╡реЗ рд╕рднреА рдЧреБрдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВред


```рдЕрдЬрдЧрд░
рддрд░реНрдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ(
    f"рдкрд░реАрдХреНрд╖рдг-{рдХрд╛рд░реНрдп}",
    рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ = "рдпреБрдЧ",
    рд╕реАрдЦрдиреЗ рдХреА рджрд░=2e-5,
    рдкреНрд░рддрд┐_рдбрд┐рд╡рд╛рдЗрд╕_рдЯреНрд░реЗрди_рдмреИрдЪ_рдЖрдХрд╛рд░=рдмреИрдЪ_рдЖрдХрд╛рд░,
    per_device_eval_batch_size=рдмреИрдЪ_рдЖрдХрд╛рд░,
    num_train_epochs=3,
    рд╡рдЬрд╝рди_рдХреНрд╖рдп=0.01,
)
```

рдЙрдкрд░реЛрдХреНрдд рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ = "рдпреБрдЧ" рдкреИрд░рд╛рдореАрдЯрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЛрдб рдмрддрд╛рддрд╛ рд╣реИ: рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдпреБрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рддреНрдпрд╛рдкрди рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВрдЧреЗред

рдЙрдкрд░реЛрдХреНрдд рдмреИрдЪ_рдЖрдХрд╛рд░ рдЗрд╕ рдиреЛрдЯрдмреБрдХ рд╕реЗ рдкрд╣рд▓реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

рдЕрдВрдд рдореЗрдВ, рд╣рдореЗрдВ рдЕрдкрдиреЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдЗрдирдкреБрдЯ рдХреЛ рдореЙрдбрд▓ рдореЗрдВ рдлреАрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдбреЗрдЯрд╛ рдХреЛрд▓реЗрдЯрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред


```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдЖрдпрд╛рдд рд╕реЗрдбреЗрдЯрд╛рдХреЛрд▓реЗрдЯрд░рдлреЙрд░рдЯреЛрдХрдирдХреНрд▓рд╛рд╕рд┐рдлрд┐рдХреЗрд╢рди

рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ = рдбреЗрдЯрд╛рдХреЛрд▓реЗрдЯрд░рдлреЙрд░рдЯреЛрдХрдирдХреНрд▓рд╛рд╕рд┐рдлрд┐рдХреЗрд╢рди(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░)
```


`рдЯреНрд░реЗрдирд░` рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рдмрд╛рдж рдПрдХ рдЖрдЦрд┐рд░реА рдХрд╛рдо рдмрдЪрд╛ рд╣реИ, рд╡рд╣ рдпрд╣ рд╣реИ рдХрд┐ рд╣рдореЗрдВ рдореВрд▓реНрдпрд╛рдВрдХрди рдкрджреНрдзрддрд┐ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд╣рдо рдореВрд▓реНрдпрд╛рдВрдХрди рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [`seqeval`](https://github.com/chalki-works/seqeval) рдореАрдЯреНрд░рд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдореВрд▓реНрдпрд╛рдВрдХрди рдореЗрдВ рдореЙрдбрд▓ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдиреЛрдВ рдХреЛ рдлреАрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдХреБрдЫ рдбреЗрдЯрд╛ рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рднреА рдХрд░реЗрдВрдЧреЗ:



```рдЕрдЬрдЧрд░
рдореАрдЯреНрд░рд┐рдХ = рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ("рдЕрдиреБрдХреНрд░рдорд┐рдХ")
```

рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд╛ рдЗрдирдкреБрдЯ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдиреЛрдВ рдФрд░ рд▓реЗрдмрд▓реЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рд╣реИ


```рдЕрдЬрдЧрд░
рд▓реЗрдмрд▓ = [рд▓реЗрдмрд▓_рд╕реВрдЪреА[i] рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдореЗрд░реЗ рд▓рд┐рдП[f"{task}_tags"]]
metric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=[рд▓реЗрдмрд▓], рд╕рдВрджрд░реНрдн=[рд▓реЗрдмрд▓])
```




    {'LOC': {'f1': 1.0, 'рд╕рдВрдЦреНрдпрд╛': 2, 'рд╕рдЯреАрдХрддрд╛': 1.0, 'reрдХреЙрд▓': 1.0},
     'рдУрдЖрд░рдЬреА': {'рдПрдл1': 1.0, 'рд╕рдВрдЦреНрдпрд╛': 1, 'рдкрд░рд┐рд╢реБрджреНрдзрддрд╛': 1.0, 'рд░рд┐рдХреЙрд▓': 1.0},
     'рдкреНрд░рддрд┐': {'рдПрдл1': 1.0, 'рд╕рдВрдЦреНрдпрд╛': 1, 'рд╕рдЯреАрдХрддрд╛': 1.0, 'рд░рд┐рдХреЙрд▓': 1.0},
     'рд╕рдордЧреНрд░_рд╕рдЯреАрдХрддрд╛': 1.0,
     'рд╕рдордЧреНрд░_f1': 1.0,
     'рд╕рдордЧреНрд░_рдкрд░рд┐рд╢реБрджреНрдзрддрд╛': 1.0,
     'рд╕рдордЧреНрд░_рд░рд┐рдХреЙрд▓': 1.0}



рдореЙрдбрд▓ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдкрд░рд┐рдгрд╛рдореЛрдВ рдкрд░ рдХреБрдЫ рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХрд░реЗрдВ:
- рд╡рд░реНрдЧреАрдХрд░рдг рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреА рдЙрдЪреНрдЪрддрдо рд╕рдВрднрд╛рд╡рдирд╛ рд╡рд╛рд▓реЗ рд╕реВрдЪрдХрд╛рдВрдХ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ
- рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд▓реЗрдмрд▓ рдореЗрдВ рдмрджрд▓реЗрдВ
- -100 рдХреЗ рд╕реНрдерд╛рди рдкрд░ рдзреНрдпрд╛рди рди рджреЗрдВ

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝рдВрдХреНрд╢рди рдЙрдкрд░реЛрдХреНрдд рдЪрд░рдгреЛрдВ рдХреЛ рдЬреЛрдбрд╝рддрд╛ рд╣реИред


```рдЕрдЬрдЧрд░
рдПрдирдкреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реБрдиреНрди рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдбреАрдИрдПрдлрд╝ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕(рдкреА):
    рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ, рд▓реЗрдмрд▓ = рдкреА
    рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = np.argmax(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ, рдЕрдХреНрд╖=2)

    #рд╣рдЯрд╛рдиреЗрд╡рд╛рд▓рд╛рдПрдб рдЗрдВрдбреЗрдХреНрд╕ (рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди)
    true_predictions = [
        [рд▓реЗрдмрд▓_рд╕реВрдЪреА[рдкреА] рдЬрд╝рд┐рдк рдореЗрдВ (рдкреА, рдПрд▓) рдХреЗ рд▓рд┐рдП (рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА, рд▓реЗрдмрд▓) рдпрджрд┐ рдПрд▓ != -100]
        рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП, рдЬрд╝рд┐рдк рдореЗрдВ рд▓реЗрдмрд▓(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд▓реЗрдмрд▓)
    ]
    true_labels = [
        [label_list[l] рдЬрд╝рд┐рдк рдореЗрдВ (p, l) рдХреЗ рд▓рд┐рдП (рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА, рд▓реЗрдмрд▓) рдпрджрд┐ l != -100]
        рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП, рдЬрд╝рд┐рдк рдореЗрдВ рд▓реЗрдмрд▓(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд▓реЗрдмрд▓)
    ]

    рдкрд░рд┐рдгрд╛рдо = metric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рд╕рддреНрдп_рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд╕рдВрджрд░реНрдн=рд╕рддреНрдп_рд▓реЗрдмрд▓)
    рд╡рд╛рдкрд╕ рдХрд░рдирд╛ {
        "рдкрд░рд┐рд╢реБрджреНрдзрддрд╛": рдкрд░рд┐рдгрд╛рдо["рд╕рдордЧреНрд░_рд╕рдЯреАрдХрддрд╛"],"рд░рд┐рдХреЙрд▓": рдкрд░рд┐рдгрд╛рдо["рдУрд╡рд░рдСрд▓_рд░рд┐рдХреЙрд▓"],
        "f1": рдкрд░рд┐рдгрд╛рдо["рд╕рдордЧреНрд░_f1"],
        "рд╕рдЯреАрдХрддрд╛": рдкрд░рд┐рдгрд╛рдо["рд╕рдордЧреНрд░_рд╕рдЯреАрдХрддрд╛"],
    }
```

рд╣рдо рд╕рднреА рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдХреА рдХреБрд▓ рдкрд░рд┐рд╢реБрджреНрдзрддрд╛/рд░рд┐рдХреЙрд▓/рдПрдл1 рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдПрдХ рд╢реНрд░реЗрдгреА рдХреА рдкрд░рд┐рд╢реБрджреНрдзрддрд╛/рд░рд┐рдХреЙрд▓/рдПрдл1 рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ

рдмрд╕ рдбреЗрдЯрд╛/рдореЙрдбрд▓/рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ `рдЯреНрд░реЗрдирд░` рдореЗрдВ рдкрд╛рд╕ рдХрд░реЗрдВ



```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
    рдирдореВрдирд╛,
    рддрд░реНрдХ,
    рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
    eval_dataset=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"],
    рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░=рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░,
    рдЯреЛрдХрдирдирд╛рдЗрдЬрд░=рдЯреЛрдХрдирд╛рдЗрдЬрд░,
    рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ = рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕
)
```

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `рдЯреНрд░реЗрди` рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ


```рдЕрдЬрдЧрд░рдПрди
рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```



    <div>
        <рд╢реИрд▓реА>
            /* рдХреБрдЫ рд╕реНрдЯрд╛рдЗрд▓рд┐рдВрдЧ рдмрдВрдж рдХрд░ рджреЗрддрд╛ рд╣реИ */
            рдкреНрд░рдЧрддрд┐ {
                /* рдлрд╝рд╛рдпрд░рдлрд╝реЙрдХреНрд╕ рдФрд░ рдУрдкреЗрд░рд╛ рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдмреЙрд░реНрдбрд░ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдорд┐рд▓рддрд╛ рд╣реИ */
                рд╕реАрдорд╛: рдХреЛрдИ рдирд╣реАрдВ;
                /* рд╕рдлрд╝рд╛рд░реА рдкреЙрд▓реАрдлрд╝рд┐рд▓ рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдВ рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рддрд╛рдХрд┐ рдкреГрд╖реНрдарднреВрдорд┐ рдЫрд╡рд┐рдпрд╛рдВ рдЕрдкреЗрдХреНрд╖рд╛ рдХреЗ рдЕрдиреБрд░реВрдк рдХрд╛рдо рдХрд░реЗрдВред
                рдкреГрд╖реНрдарднреВрдорд┐-рдЖрдХрд╛рд░: рдСрдЯреЛ;
            }
        </рд╢реИрд▓реА>

      <рдкреНрд░рдЧрддрд┐ рдорд╛рди='2634' рдЕрдзрд┐рдХрддрдо='2634' рд╢реИрд▓реА='рдЪреМрдбрд╝рд╛рдИ:300рдкреАрдПрдХреНрд╕; рдКрдВрдЪрд╛рдИ:20рдкреАрдПрдХреНрд╕; рд▓рдВрдмрд╡рдд-рд╕рдВрд░реЗрдЦрдг: рдордзреНрдп;'></рдкреНрд░рдЧрддрд┐>[2634/2634 01:45, рдпреБрдЧ 3/3]
    </div>
    <рддрд╛рд▓рд┐рдХрд╛ рд╕реАрдорд╛ = "1" рд╡рд░реНрдЧ = "рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо">
  <рд╕рд┐рд░>
    <tr рд╢реИрд▓реА = "рдкрд╛рда-рд╕рдВрд░реЗрдЦрдг: рдмрд╛рдПрдБ;">
      <th>рдпреБрдЧ</th>
      <th>рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐</th>
      <th>рд╕рддреНрдпрд╛рдкрди рд╣рд╛рдирд┐</th>
      <th>рдкрд░рд┐рд╢реБрджреНрдзрддрд╛</th>
      <th>рдпрд╛рдж рдХрд░реЗрдВ</th>
      <th>F1</th>
      <th>рд╕рдЯреАрдХрддрд╛</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>0.237721</td>
      <td>0.068198</td>
      <td>0.903148</td>
      <td>0.921132</td>
      <td>0.912051</td>
      <td>0.979713</td></tr>
    <tr>
      <td>2</td>
      <td>0.053160</td>
      <td>0.059337</td>
      <td>0.927697</td>
      <td>0.932990</td>
      <td>0.930336</td>
      <td>0.983113</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.029850</td>
      <td>0.059346</td>
      <td>0.929267</td>
      <td>0.939143</td>
      <td>0.934179</td>
      <td>0.984257</td>
    </tr>
  </tbody>
</рддрд╛рд▓рд┐рдХрд╛><p>





    рдЯреНрд░реЗрдирдЖрдЙрдЯрдкреБрдЯ(рдЧреНрд▓реЛрдмрд▓_рд╕реНрдЯреЗрдк=2634, рдЯреНрд░реЗрдирд┐рдВрдЧ_рд▓реЙрд╕=0.08569671253227518)



рд╣рдо рджреЛрдмрд╛рд░рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 'рдореВрд▓реНрдпрд╛рдВрдХрди' рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╣рдо рдЕрдиреНрдп рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрдбреЗрдЯрд╛ рд╕реЗрдЯ.


```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ.рдореВрд▓реНрдпрд╛рдВрдХрди()
```



<div>
    <рд╢реИрд▓реА>
        /* рдХреБрдЫ рд╕реНрдЯрд╛рдЗрд▓рд┐рдВрдЧ рдмрдВрдж рдХрд░ рджреЗрддрд╛ рд╣реИ */
        рдкреНрд░рдЧрддрд┐ {
            /* рдлрд╝рд╛рдпрд░рдлрд╝реЙрдХреНрд╕ рдФрд░ рдУрдкреЗрд░рд╛ рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдмреЙрд░реНрдбрд░ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдорд┐рд▓рддрд╛ рд╣реИ */
            рд╕реАрдорд╛: рдХреЛрдИ рдирд╣реАрдВ;
            /* рд╕рдлрд╝рд╛рд░реА рдкреЙрд▓реАрдлрд╝рд┐рд▓ рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдВ рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рддрд╛рдХрд┐ рдкреГрд╖реНрдарднреВрдорд┐ рдЫрд╡рд┐рдпрд╛рдВ рдЕрдкреЗрдХреНрд╖рд╛ рдХреЗ рдЕрдиреБрд░реВрдк рдХрд╛рдо рдХрд░реЗрдВред
            рдкреГрд╖реНрдарднреВрдорд┐-рдЖрдХрд╛рд░: рдСрдЯреЛ;
        }
    </рд╢реИрд▓реА>

  <рдкреНрд░рдЧрддрд┐ рдорд╛рди='408' рдЕрдзрд┐рдХрддрдо='204' рд╢реИрд▓реА='рдЪреМрдбрд╝рд╛рдИ:300рдкреАрдПрдХреНрд╕; рдКрдВрдЪрд╛рдИ:20рдкреАрдПрдХреНрд╕; рд▓рдВрдмрд╡рдд-рд╕рдВрд░реЗрдЦрдг: рдордзреНрдп;'></рдкреНрд░рдЧрддрд┐>
  [204/204 00:05]
</div>{'eval_los': 0.05934586375951767,
     'eval_precision': 0.9292672127518264,
     'eval_recall': 0.9391430808815304,
     'eval_f1': 0.9341790463472988,
     'eval_accuracy': 0.9842565968195466,
     'рдпреБрдЧ': 3.0}



рдпрджрд┐ рд╣рдо рдХрд┐рд╕реА рдПрдХрд▓ рд╢реНрд░реЗрдгреА рдХреА рд╕рдЯреАрдХрддрд╛/рд░рд┐рдХреЙрд▓/рдПрдл1 рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдкрд░рд┐рдгрд╛рдо рдХреЛ рд╕реАрдзреЗ рдЙрд╕реА рдореВрд▓реНрдпрд╛рдВрдХрди рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдЗрдирдкреБрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди, рд▓реЗрдмрд▓, _ = рдЯреНрд░реЗрдирд░.рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА(рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"])
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = np.argmax(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ, рдЕрдХреНрд╖=2)

# рдЙрдкреЗрдХреНрд╖рд┐рдд рд╕реВрдЪрдХрд╛рдВрдХ (рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди) рд╣рдЯрд╛рдПрдВ
true_predictions = [
    [рд▓реЗрдмрд▓_рд╕реВрдЪреА[рдкреА] (рдкреА, рдПрд▓) рдХреЗ рд▓рд┐рдПрдЬрд╝рд┐рдк (рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА, рд▓реЗрдмрд▓) рдпрджрд┐ рдПрд▓ != -100]
    рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП, рдЬрд╝рд┐рдк рдореЗрдВ рд▓реЗрдмрд▓(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд▓реЗрдмрд▓)
]
true_labels = [
    [label_list[l] рдЬрд╝рд┐рдк рдореЗрдВ (p, l) рдХреЗ рд▓рд┐рдП (рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА, рд▓реЗрдмрд▓) рдпрджрд┐ l != -100]
    рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП, рдЬрд╝рд┐рдк рдореЗрдВ рд▓реЗрдмрд▓(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд▓реЗрдмрд▓)
]

рдкрд░рд┐рдгрд╛рдо = metric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рд╕рддреНрдп_рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд╕рдВрджрд░реНрдн=рд╕рддреНрдп_рд▓реЗрдмрд▓)
рдкрд░рд┐рдгрд╛рдо
```




    {'рдПрд▓рдУрд╕реА': {'рдкрд░рд┐рд╢реБрджреНрдзрддрд╛': 0.949718574108818,
      'рд░рд┐рдХреЙрд▓': 0.966768525592055,
      'рдПрдл1': 0.9581677077418134,
      'рд╕рдВрдЦреНрдпрд╛': 2618},
     'MISC': {'рдкрд░рд┐рд╢реБрджреНрдзрддрд╛': 0.8132387706855791,
      'рд░рд┐рдХреЙрд▓': 0.8383428107229894,
      'рдПрдл1': 0.8255999999999999,
      'рд╕рдВрдЦреНрдпрд╛': 1231},
     'рдУрдЖрд░рдЬреА': {'рдкрд░рд┐рд╢реБрджреНрдзрддрд╛': 0.9055232558139535,
      'рд░рд┐рдХреЙрд▓': 0.9090466926070039,
      'рдПрдл1': 0.9072815533980583,
      'рд╕рдВрдЦреНрдпрд╛': 2056},
     'рдкреНрд░рддрд┐': {'рд╕рдЯреАрдХрддрд╛': 0.9759552042160737,
      'рд░рд┐рдХреЙрд▓': 0.9765985497692815,
      'рдПрдл1': 0.9762767710049424,
      'рд╕рдВрдЦреНрдпрд╛': 3034},
     'рд╕рдордЧреНрд░_рдкрд░рд┐рд╢реБрджреНрдзрддрд╛': 0.9292672127518264,
     'рд╕рдордЧреНрд░_рд░рд┐рдХреЙрд▓': 0.9391430808815304,
     'рд╕рдордЧреНрд░_f1': 0.9341790463472988,
     'рд╕рдордЧреНрд░_рд╕рдЯреАрдХрддрд╛': 0.9842565968195466}



рдЕрдВрдд рдореЗрдВ, рдореЙрдбрд▓ рдХреЛ [ЁЯдЧ рдореЙрдбрд▓ рд╣рдм](https://huggingface.co/models) рдкрд░ рдЕрдкрд▓реЛрдб рдХрд░рдирд╛ рди рднреВрд▓реЗрдВ (рдХреИрд╕реЗ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдВ](https://huggingface.co/transformers/model_sharing.html) рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдирд╛)ред рдлрд┐рд░ рдЖрдк рд╕реАрдзреЗ рдореЙрдбрд▓ рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рджреНрд╡рд╛рд░рд╛ рдЕрдкрд▓реЛрдб рдХрд┐рдП рдЧрдП рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдЖрдкрдиреЗ рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдХрд┐рдпрд╛ рдерд╛ред



```рдЕрдЬрдЧрд░

```