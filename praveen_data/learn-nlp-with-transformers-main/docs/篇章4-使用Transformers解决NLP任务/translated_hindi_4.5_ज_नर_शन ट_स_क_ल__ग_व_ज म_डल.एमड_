рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдЬрдкреНрдЯрд░ рдиреЛрдЯрдмреБрдХ [рдЕрдзреНрдпрд╛рдп 4 рдХреЛрдб рдЖрдзрд╛рд░](https://github.com/datawhalechina/learn-nlp-with-transformers/tree/main/docs/%E7%AF%87%E7%AB) рдореЗрдВ рд╣реИ %A04 -%E4%BD%BF%E7%94%A8рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░%E8%A7%A3%E5%86%B3NLP%E4%BB%BB%E5%8A%A1)ред

рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреЛ рд╕реАрдзреЗ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП Google Colab рдиреЛрдЯрдмреБрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрд╢рдВрд╕рд╛ рдХреА рдЬрд╛рддреА рд╣реИ, рддрд╛рдХрд┐ рдЖрдк рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдФрд░ рдореЙрдбрд▓ рдЬрд▓реНрджреА рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХреЗрдВред
рдпрджрд┐ рдЖрдк рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЛ Google рдХреЗ рдХреЛрд▓рд╛рдм рдореЗрдВ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдФрд░ ЁЯдЧрдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдЗрд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЛ рдЕрдирдХрдореНрдореЗрдВрдЯ рдХрд░реЗрдВред


```рдЕрдЬрдЧрд░
# ! рдкрд┐рдк рдбреЗрдЯрд╛рд╕реЗрдЯ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ
# -i https://pypi.tona.tsinghua.edu.cn/simple
```

рдпрджрд┐ рдЖрдк рдЗрд╕ рдЬреНрдпреВрдкрд┐рдЯрд░ рдиреЛрдЯрдмреБрдХ рдХреЛ рдЕрдкрдиреА рд╕реНрдерд╛рдиреАрдп рдорд╢реАрди рдкрд░ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХреЗ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдЙрдкрд░реЛрдХреНрдд рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рд╕реНрдерд╛рдкрд┐рдд рд╣реИрдВред

рдЖрдк рдЗрд╕реЗ [рдпрд╣рд╛рдВ](https://github.c) рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрдЗрд╕ рдЬреНрдпреВрдкрд┐рдЯрд░ рдиреЛрдЯрдмреБрдХ рдХреА рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдУрдо/рд╣рдЧрд┐рдВрдЧрдлреЗрд╕/рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕/рдЯреНрд░реА/рдорд╛рд╕реНрдЯрд░/рдЙрджрд╛рд╣рд░рдг/рднрд╛рд╖рд╛-рдореЙрдбрд▓рд┐рдВрдЧ) рдЖрдк рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рддрд░рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдПрдХрд╛рдзрд┐рдХ рдЬреАрдкреАрдпреВ рдпрд╛ рдЯреАрдкреАрдпреВ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

# рдлрд╛рдЗрди-рдЯреНрдпреВрди рднрд╛рд╖рд╛ рдореЙрдбрд▓

рд╡рд░реНрддрдорд╛рди рдЬреНрдпреВрдкрд┐рдЯрд░ рдиреЛрдЯрдмреБрдХ рдореЗрдВ, рд╣рдо рдмрддрд╛рдПрдВрдЧреЗ рдХрд┐ рднрд╛рд╖рд╛ рдореЙрдбрд▓ рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдордирдорд╛рдиреЗ рдврдВрдЧ рд╕реЗ [ЁЯдЧрдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕] (https://github.com/huggingface/transformers) рдореЙрдбрд▓ рдХреЛ рдХреИрд╕реЗ рдареАрдХ рдХрд┐рдпрд╛ рдЬрд╛рдПред 

рдпрд╣ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рджреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХрд╡рд░ рдХрд░реЗрдЧрд╛:

+ рдХрд╛рд░рдг рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ (рд╕реАрдПрд▓рдПрдо): рдореЙрдбрд▓ рдХреЛ рд╡рд╛рдХреНрдп рдореЗрдВ рдЕрдЧрд▓реЗ рд╕реНрдерд╛рди рдкрд░ рдЪрд░рд┐рддреНрд░ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдмреАрдИрдЖрд░рдЯреА-рдкреНрд░рдХрд╛рд░ рдореЙрдбрд▓ рдХреЗ рдбрд┐рдХреЛрдбрд░ рдФрд░ рдЬреАрдкреАрдЯреА рдХреЗ рд╕рдорд╛рди, рдмрд╛рдПрдВ рд╕реЗ рджрд╛рдПрдВ рдЗрдирдкреБрдЯ рд╡рд░реНрдг)ред рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдореЙрдбрд▓ рдзреЛрдЦрд╛ рдирд╣реАрдВ рджреЗ рд░рд╣рд╛ рд╣реИ, рдореЙрдбрд▓ рдХреЛ рдмрд╛рдж рдХреЗ рдкрд╛рддреНрд░реЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдореЙрдбрд▓ рдПрдХ рдзреНрдпрд╛рди рдорд╛рд╕реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрдм рдореЙрдбрд▓ рдХрд┐рд╕реА рд╡рд╛рдХреНрдп рдореЗрдВ рд╕реНрдерд┐рддрд┐ i+1 рдкрд░ рд╡рд░реНрдг рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рдпрд╣ рдорд╛рд╕реНрдХ рдЙрд╕реЗ рд╕реНрдерд┐рддрд┐ i рдХреЗ рдмрд╛рдж рд╡рд░реНрдгреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╕реЗ рд░реЛрдХ рджреЗрдЧрд╛ред

![рдЕрдиреБрдорд╛рди рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд╛рд░рдг рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ рдХрд╛рд░реНрдп рдЪрд┐рддреНрд░](./images/causal_langage_modeling.png)

+ рдирдХрд╛рдмрдкреЛрд╢ рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ (рдирдХрд╛рдмрдкреЛрд╢рдбреА рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ (рдПрдордПрд▓рдПрдо): рдореЙрдбрд▓ рдХреЛ рдХреБрдЫ рд╡рд░реНрдгреЛрдВ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдЗрдирдкреБрдЯ рдореЗрдВ "рдорд╛рд╕реНрдХ" рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (рдмреАрдИрдЖрд░рдЯреА-рдкреНрд░рдХрд╛рд░ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХрд╛рд░реНрдп)ред рдЗрд╕ рддрд░рд╣ рд╕реЗ рдореЙрдбрд▓ рдкреВрд░реЗ рд╡рд╛рдХреНрдп рдХреЛ рджреЗрдЦ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдореЙрдбрд▓ "\[MASK\]" рдорд╛рд░реНрдХрд░ рдХреЗ рдкрд╣рд▓реЗ рдФрд░ рдмрд╛рдж рдХреЗ рд╡рд░реНрдгреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЙрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ "\[MASK\]" рдЪрд┐рд╣реНрди рд╕реЗ рдкрд╣рд▓реЗ рдХреЗ рд╡рд░реНрдг рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИред

![рд╡рд┐рдЬреЗрдЯ рдЕрдиреБрдорд╛рди рдирдХрд╛рдмрдкреЛрд╢ рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ рдХрд╛рд░реНрдп рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ](images/masked_langage_modeling.png)

рдЗрд╕рдХреЗ рдмрд╛рдж, рд╣рдо рдмрддрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдХреИрд╕реЗ рд▓реЛрдб рдФрд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдП, рдФрд░ "рдЯреНрд░реЗрдирд░" рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЙрдбрд▓ рдХреЛ рдХреИрд╕реЗ рдареАрдХ рдХрд┐рдпрд╛ рдЬрд╛рдПред

рдмреЗрд╢рдХ, рдЖрдк рдЗрд╕ рдЬреНрдпреВрдкрд┐рдЯрд░ рдиреЛрдЯрдмреБрдХ рдХреЗ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рд╕реАрдзреЗ рд╡рд┐рддрд░рд┐рдд рд╡рд╛рддрд╛рд╡рд░рдг рдпрд╛ рдЯреАрдкреАрдпреВ рдореЗрдВ рднреА рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ [рдЙрджрд╛рд╣рд░рдг рдлрд╝реЛрд▓реНрдбрд░] (https://github.com/huggingface/transformers/tree/master/) рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг)ред

## рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рдХрд░реЗрдВ

рдЗрди рдЕрдЧрд▓реЗ рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рд╣рдо [рд╡рд┐рдХреАрдЯреЗрдХреНрд╕реНрдЯ 2](https://huggingface.co/datasets/wikit) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗрдЙрджрд╛рд╣рд░рдг рдХреЗ рддреМрд░ рдкрд░ ext#data-instances) рдбреЗрдЯрд╛рд╕реЗрдЯред рдЖрдк рдЗрд╕ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ ЁЯдЧрдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдбреЗрдЯрд╛рд╕реЗрдЯ = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ ('рд╡рд┐рдХреАрдЯреЗрдХреНрд╕реНрдЯ', 'рд╡рд┐рдХреАрдЯреЗрдХреНрд╕реНрдЯ-2-рд░реЙ-v1')
```

    рдбреЗрдЯрд╛рд╕реЗрдЯ рд╡рд┐рдХреАрдЯреЗрдХреНрд╕реНрдЯ рдХрд╛ рдкреБрди: рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ (/Users/niepig/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/1.0.0/aa5e094000ec7afeb74c3be92c88313cd6f132d564c7effd961c10fd47c76f20)


рдпрджрд┐ рдЖрдкрдХреЛ рдирд┐рдореНрди рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ:
![рдЕрдиреБрд░реЛрдз рддреНрд░реБрдЯрд┐](images/request_error.png)

рд╕рдорд╛рдзрд╛рди:

рдореИрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛: ```/etc/hosts`` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ ```199.232.68.133 raw.githubsercontent.com``` рдПрдХ рдкрдВрдХреНрддрд┐ рдЬреЛрдбрд╝реЗрдВ

Windowso рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛: ```C:\Windows\System32\drivers\etc\hosts`` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдПрдХ рдкрдВрдХреНрддрд┐ ```199.232.68.133 raw.githubusercontent.com``` рдЬреЛрдбрд╝реЗрдВ

рдмреЗрд╢рдХ рдЖрдк рдЙрдкрд░реЛрдХреНрдд рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ [рд╣рдм](https://huggingface.co/datasets) рдкрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЙрдкрд▓рдмреНрдз рдХрд┐рд╕реА рднреА рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛ рдЕрдкрдиреА рдЦреБрдж рдХреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдмрд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдХреНрд╖реЛрдВ рдХреЛ рдЕрдирдЯрд┐рдкреНрдкрдгреА рдХрд░реЗрдВ рдФрд░ рдкрде рдХреЛ рдлрд╝рд╛рдЗрд▓ рдкрде рд╕реЗ рдмрджрд▓реЗрдВ рдЬреЛ рдЖрдкрдХреЛ рдпрд╣рд╛рдВ рд▓реЗ рдЬрд╛рдПрдЧрд╛:


```рдЕрдЬрдЧрд░
# рдбреЗрдЯрд╛рд╕реЗрдЯ = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ ("рдЯреЗрдХреНрд╕реНрдЯ", рдбреЗрдЯрд╛_рдлрд╝рд╛рдЗрд▓реНрд╕ = {"рдЯреНрд░реЗрди": path_to_train.txt, "рд╕рддреНрдпрд╛рдкрди": path_to_validation.txt}
```

рдЖрдк рд╕реАрдПрд╕рд╡реА рдпрд╛ JSON рдлрд╝рд╛рдЗрд▓реЛрдВ рд╕реЗ рднреА рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдкреВрд░реНрдг рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рджреЗрдЦреЗрдВред

рдХрд┐рд╕реА рдбреЗрдЯрд╛ рдореЗрдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рддрддреНрд╡ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рдПрдХ рдХреБрдВрдЬреА рдХрд╛ рдЪрдпрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдлрд┐рд░ рдЙрд╕реЗ рдПрдХ рдЗрдВрдбреЗрдХреНрд╕ рджреЗрдирд╛ рд╣реЛрдЧрд╛:


```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ["traрдореЗрдВ"][10]
```




    {'рдкрд╛рда': 'рдЧреЗрдо рдХреА рдпреБрджреНрдз рдкреНрд░рдгрд╛рд▓реА, рдмреНрд▓рд┐рдЯреНрдЬрд╝ рдкреНрд░рдгрд╛рд▓реА, рд╕реАрдзреЗ рд╡рд▓реНрдХрд┐рд░рд╛ рдХреНрд░реЙрдирд┐рдХрд▓реНрд╕ рд╕реЗ рд▓реА рдЧрдИ рд╣реИред рдорд┐рд╢рди рдХреЗ рджреМрд░рд╛рди, рдЦрд┐рд▓рд╛рдбрд╝реА рдпреБрджреНрдзрдХреНрд╖реЗрддреНрд░ рдорд╛рдирдЪрд┐рддреНрд░ рдХреЗ рд╢реАрд░реНрд╖ @-@ рдиреАрдЪреЗ рдкрд░рд┐рдкреНрд░реЗрдХреНрд╖реНрдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЗрдХрд╛рдИ рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВ: рдПрдХ рдмрд╛рд░ рдПрдХ рдЪрд░рд┐рддреНрд░ рд╣реЛрддрд╛ рд╣реИ рдЪрдпрдирд┐рдд, рдЦрд┐рд▓рд╛рдбрд╝реА рддреАрд╕рд░реЗ @-@ рд╡реНрдпрдХреНрддрд┐ рдореЗрдВ рдкрд╛рддреНрд░ рдХреЛ рдпреБрджреНрдз рдХреЗ рдореИрджрд╛рди рдореЗрдВ рдШреБрдорд╛рддрд╛ рд╣реИред рдПрдХ рдкрд╛рддреНрд░ рдкреНрд░рддрд┐ @-@ рдореЛрдбрд╝ рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдХрд╛рд░реНрдп рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдкрд╛рддреНрд░реЛрдВ рдХреЛ рдЕрдиреНрдп рдкрд╛рддреНрд░реЛрдВ рдХреА рдХреАрдордд рдкрд░ рдХрдИ рдореЛрдбрд╝ рджрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рдкрд╛рддреНрд░ рдореЗрдВ рдПрдХ рдореЛрдбрд╝ рд╣реЛрддрд╛ рд╣реИ рдЫреАрдПрд▓рдбреА рдФрд░ рдЖрдВрджреЛрд▓рди рдХреА рджреВрд░реА рдЙрдирдХреЗ рдПрдХреНрд╢рди рдЧреЗрдЬ рджреНрд╡рд╛рд░рд╛ рд╕реАрдорд┐рдд рд╣реИред рдЧреЗрдордкреНрд▓реЗ рдХреЗ рджреМрд░рд╛рди, рдкрд╛рддреНрд░реЛрдВ рдХреЛ рдХреБрдЫ рдШрдЯрд┐рдд рд╣реЛрдиреЗ рдкрд░, рдЬреИрд╕реЗ рдХрд┐ рдЙрдирдХреЗ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдмрд┐рдВрджреБ (рдПрдЪрдкреА) рдХрдо рд╣реЛ рдЬрд╛рдирд╛ рдпрд╛ рдмрд╛рд╣рд░ рд╣реЛ рдЬрд╛рдирд╛, рдЕрдзрд┐рдХрддрдо рдиреМ рдЕрдХреНрд╖рд░ рд╕реМрдВрдкреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рджреБрд╢реНрдорди рдХреЗ рд╣рдорд▓реЛрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рд┐рддреНрд░ рдореЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ "рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ" рд╣реЛрддреА рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рд┐рддреНрд░ рдХреЗ рд▓рд┐рдП рдЕрджреНрд╡рд┐рддреАрдп рдХреМрд╢рд▓ рдЙрдиреНрд╣реЗрдВ "рд╡реНрдпрдХреНрддрд┐рдЧрдд рдХреНрд╖рдорддрд╛" рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЬрдиреНрдордЬрд╛рдд рдХреМрд╢рд▓ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рддрдм рддрдХ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рд░рд╣рддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдХрд┐ рдХрд╣рд╛рдиреА рджреНрд╡рд╛рд░рд╛ рдЕрдиреНрдпрдерд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рди рдХрд┐рдпрд╛ рдЬрд╛рдПредрдпрд╛ рддреЛ рдХрд┐рд╕реА рдкрд╛рддреНрд░ рдХреА рд╕рд╣рд╛рдпрддрд╛ рдХрд░реЗрдВ рдпрд╛ рдЙрд╕реЗ рдмрд╛рдзрд┐рдд рдХрд░реЗрдВ, рдФрд░ "рдмреИрдЯрд▓ рдкреЛрдЯреЗрдВрд╢рд┐рдпрд▓реНрд╕", рдЬреЛ рдкреВрд░реЗ рдЦреЗрд▓ рдореЗрдВ рд╡рд┐рдХрд╕рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рд╣рдореЗрд╢рд╛ рдПрдХ рдкрд╛рддреНрд░ рдХреЛ рд╡рд░рджрд╛рди рджреЗрддреЗ рд╣реИрдВ, рдмреИрдЯрд▓ рдкреЛрдЯреЗрдВрд╢рд┐рдпрд▓реНрд╕ рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдкреНрд░рддреНрдпреЗрдХ рдкрд╛рддреНрд░ рдореЗрдВ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп "рдорд╛рд╕реНрдЯрд░реНрд╕ рдЯреЗрдмрд▓", рдПрдХ рдЧреНрд░рд┐рдб @-@ рдЖрдзрд╛рд░рд┐рдд рдХреМрд╢рд▓ рддрд╛рд▓рд┐рдХрд╛ рд╣реЛрддреА рд╣реИред рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рднрд┐рдиреНрди рдХреМрд╢рд▓ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдиреЗ рдФрд░ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдкрд╛рддреНрд░реЛрдВ рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рдХреНрд╖рдорддрд╛рдПрдВ рднреА рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдпреБрджреНрдз рдХреЗ рдореИрджрд╛рди рдкрд░ рдЕрд╕реНрдерд╛рдпреА рдмрдврд╝рд╛рд╡рд╛ рджреЗрддреА рд╣реИрдВ: рдХрд░реНрдЯ "рдбрд╛рдпрд░реЗрдХреНрдЯ рдХрдорд╛рдВрдб" рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрдкрдиреЗ рдПрдХреНрд╢рди рдкреНрд╡рд╛рдЗрдВрдЯ рдЬреА рдХреЛ рдХрдо рдХрд┐рдП рдмрд┐рдирд╛ рдпреБрджреНрдз рдХреЗ рдореИрджрд╛рди рдореЗрдВ рдШреВрдо рд╕рдХрддрд╛ рд╣реИредрдЖрдЧреЗ, рд░реАрд▓рд╛ рдХрд╛ рдЪрд░рд┐рддреНрд░ рдЕрдкрдиреЗ "рд╡рд╛рд▓реНрдХрд┐рд░рд┐рдпрд╛ рдлреЙрд░реНрдо" рдореЗрдВ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрдЬреЗрдп рдмрди рд╕рдХрддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЗрдореНрдХрд╛ рдЕрдкрдиреЗ рднрд╛рд░реА рд╣рдерд┐рдпрд╛рд░ рд╕реЗ рдХрдИ рджреБрд╢реНрдорди рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдирд┐рд╢рд╛рдирд╛ рдмрдирд╛ рд╕рдХрддреА рд╣реИред



рдбреЗрдЯрд╛ рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЛ рд╢реАрдШреНрд░рддрд╛ рд╕реЗ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП, рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдлрд╝рдВрдХреНрд╢рди рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдХреБрдЫ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдЪрдпрдирд┐рдд рдЙрджрд╛рд╣рд░рдг рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛ред


```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдХреНрд▓рд╛рд╕рд▓реЗрдмрд▓ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдкрд╛рдВрдбрд╛ рдХреЛ рдкреАрдбреА рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ
IPython.display рд╕реЗ рдЖрдпрд╛рдд рдбрд┐рд╕реНрдкреНрд▓реЗ, HTML

def show_random_elements(рдбреЗрдЯрд╛рд╕реЗрдЯ, num_examples=10):
    assert num_examples <= len(рдбреЗрдЯрд╛рд╕реЗрдЯ), "рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдореМрдЬреВрдж рддрддреНрд╡реЛрдВ рд╕реЗ рдЕрдзрд┐рдХ рддрддреНрд╡ рдирд╣реАрдВ рдЪреБрди рд╕рдХрддреЗред"
    рдЪреБрдирддрд╛ рд╣реИ = []
    рд░рд╛ рдореЗрдВ _ рдХреЗ рд▓рд┐рдПnge(num_examples):
        рдкрд┐рдХ = рд░реИрдВрдбрдо.рд░реИрдВрдбрд┐рдВрдЯ(0, рд▓реЗрди(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
        рдЪрдпрди рдХрд░рддреЗ рд╕рдордп:
            рдкрд┐рдХ = рд░реИрдВрдбрдо.рд░реИрдВрдбрд┐рдВрдЯ(0, рд▓реЗрди(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
        рдЪреБрдирддрд╛ рд╣реИ.рдЬреЛрдбрд╝реЗрдВ(рдЪреБрдиреЗрдВ)
    
    рдбреАрдПрдл = рдкреАрдбреА.рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо(рдбреЗрдЯрд╛рд╕реЗрдЯ[рдЪреБрдирддрд╛ рд╣реИ])
    рдХреЙрд▓рдо рдХреЗ рд▓рд┐рдП, dataset.features.items() рдЯрд╛рдЗрдк рдХрд░реЗрдВ:
        рдпрджрд┐ isinstance(рдкреНрд░рдХрд╛рд░, рдХреНрд▓рд╛рд╕рд▓реЗрдмрд▓):
            рдбреАрдПрдл[рдХреЙрд▓рдо] = рдбреАрдПрдл[рдХреЙрд▓рдо].рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо(рд▓реИрдореНрдмреНрдбрд╛ рдЖрдИ: рдЯрд╛рдЗрдк.рдирд╛рдо[рдЖрдИ])
    рдбрд┐рд╕реНрдкреНрд▓реЗ(HTML(df.to_html()))
```


```рдЕрдЬрдЧрд░
show_random_elements(рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"])
```


<рддрд╛рд▓рд┐рдХрд╛ рд╕реАрдорд╛='1' рд╡рд░реНрдЧ='рджрд╛рдЯреИрдлрд╝реНрд░реЗрдо">
  <рд╕рд┐рд░>
    <tr рд╢реИрд▓реА = "рдкрд╛рда-рд╕рдВрд░реЗрдЦрдг: рджрд╛рдПрдВ;">
      <рде></рде>
      <th>рдкрд╛рда</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3 рдорд╛рд░реНрдЪ 1967 рдХреЛ, рд╕рдВрд╕рдж рдиреЗ рдЯреНрд░реЙрдирд╣реИрдо рдФрд░ рдмреЛрдбреЛ рдХреЗ рдмреАрдЪ рд╣реЗрд▓рдЧрд▓реИрдВрдб рддрдЯ рдкрд░ рдЪрд╛рд░ рд╢реЙрд░реНрдЯ рдЯреЗрдХ @-@рдСрдлрд╝ рдФрд░ рд▓реИрдВрдбрд┐рдВрдЧ рд╣рд╡рд╛рдИ рдЕрдбреНрдбреЗ рдмрдирд╛рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ рдФрд░ рдбреЗ рд╣реИрд╡рд┐рд▓реИрдВрдб рдХрдирд╛рдбрд╛ рдбреАрдПрдЪрд╕реА @-@6 рдЯреНрд╡рд┐рди рдУрдЯрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдСрд░реНрдбрд░ рджрд┐рдпрд╛ рдФрд░ рдпреЛрдЬрдирд╛ рдмрдирд╛рдИ рдХрдВрдкрдиреА рдмреНрд░рд╛рдереЗрдВрд╕ рдПрд╕рдЯреАрдУрдПрд▓ рд╢реБрд░реВ рдХрд░реЗрдВред рдЗрд╕рдиреЗ рдмрд┐рдирд╛ рд╕рдмреНрд╕рд┐рдбреА рдХреЗ рдорд╛рд░реНрдЧ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡реЗрджрди рдХрд┐рдпрд╛, рд▓реЗрдХрд┐рди рд░рд┐рдпрд╛рдпрдд рдбрдмреНрд▓реНрдпреВрдЗрд╕реЗ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рдФрд░ рд╡рд┐рдбрд░реЛ рдХреЛ рд╕рдмреНрд╕рд┐рдбреА рджреЗ рджреА рдЧрдИ, рдЬреЛ рд╕рдореБрджреНрд░реА рд╡рд┐рдорд╛рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╛рд░реНрдЧреЛрдВ рдХрд╛ рд╕рдВрдЪрд╛рд▓рди рдХрд░ рд░рд╣рд╛ рдерд╛
    </tr>
    <tr>
      <th>1</th>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>рд░рд╛рд╡ рд░рдореЗрд╢ рдХреЛ рдПрдХ рддрд╛рдВрддреНрд░рд┐рдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЪреБрдирд╛ рдЧрдпрд╛ рдерд╛ рдЬреЛ рд╡рд░реНрддрдорд╛рди рдпреБрдЧ рдореЗрдВ рдЧрд┐рд▓ рдХреЗ рдЪрд░рд┐рддреНрд░ рдХреА рдорджрдж рдХрд░рддрд╛ рд╣реИред рдореБрдореИрде рдЦрд╛рди рдХреЛ рдПрдХ рдЕрдиреНрдп рдЖрдЗрдЯрдо рдирдВрдмрд░ рдХреЗ рд▓рд┐рдП рдЪреБрдирд╛ рдЧрдпрд╛ рдерд╛, рдЬреЛ рдШрд░рд╛рдирд╛ рдореЛрдЧреБрдбреБ (1992) рдХреЗ рд╣рд┐рдЯ рдЧреАрдд "рдмрдВрдЧрд╛рд░реВ рдХреЛрдбрд┐рдкреЗрдЯреНрдЯрд╛" рдХрд╛ рд░реАрдорд┐рдХреНрд╕ рд╕рдВрд╕реНрдХрд░рдг рдерд╛; рд╕рдВрдЧреАрдд рднреА рдПрдо. рдПрдо. рдЪрд┐рд░рд╛рди рджреНрд╡рд╛рд░рд╛ рд░рдЪрд╛ рдЧрдпрд╛ рдерд╛рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж рдЬреАрд╡реА рдиреЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдЙрдкрд╕реНрдерд┐рддрд┐ рджрд░реНрдЬ рдХреА, рдЬрд┐рд╕рд╕реЗ рд░рд╛рдЬрдиреАрддрд┐ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХреЗ рдмрд╛рдж рдЙрдирдХреА рдкрд╣рд▓реА рдлрд┐рд▓реНрдо рдордЧрдзреАрд░рд╛ рдмрдиреАред рдЬрдм рд░рд╛рдЬрд╛рдореМрд▓реА рдиреЗ рдПрдХ рдХреИрдорд┐рдпреЛ рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рд╕реБрдЭрд╛рдпрд╛, рддреЛ рдЪрд┐рд░рдВрдЬреАрд╡реА рд╢реБрд░реВ рдореЗрдВ рдЭрд┐рдЭрдХ рд░рд╣реЗ рдереЗ рдЬрдм рддрдХ рдХрд┐ рдирд┐рд░реНрджреЗрд╢рдХ рдиреЗ рдкреВрд░рд╛ рдЕрдиреБрдХреНрд░рдо рдФрд░ рдорд╣рддреНрд╡ рдирд╣реАрдВ рдмрддрд╛рдпрд╛ред рдЧрд╛рдирд╛ .\n</td>
    </tr>
    <tr>
      <рде>3</рде>
      <td></td>
    </tr>
    <tr>
      <рде>4</рде>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>= = = рдХреБрд▓ рдиреЙрдирд╕реНрдЯреЙрдк рдПрдХреНрд╢рди рдХреБрд╢реНрддреА (2015 - рд╡рд░реНрддрдорд╛рди ) = = = \n</td>
    </tr>
    <tr>
      <th>6</th>
      <td>рдбреЗрд▓реА рдЯреЗрд▓реАрдЧреНрд░рд╛рдл рдиреЗ рджреГрд╢реНрдп рдЙрдкрдиреНрдпрд╛рд╕ рдХреЛ 2011 рдХреЗ рдЕрдкрдиреЗ рд╡реАрдбрд┐рдпреЛ рдЧреЗрдо рдкреБрд░рд╕реНрдХрд╛рд░реЛрдВ рдореЗрдВ "рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда рд╕реНрдХреНрд░рд┐рдкреНрдЯ" рдХрд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рджрд┐рдпрд╛, рдЬрд┐рд╕рдореЗрдВ рдХрд╣рд╛ рдЧрдпрд╛ рдХрд┐ "рд▓рд╡' рдореЗрдВ рдПрдХ рд╣рд╛рдИ рд╕реНрдХреВрд▓ рд╢рд┐рдХреНрд╖рдХ рдХреА рдЕрдкрдиреЗ рдЫрд╛рддреНрд░ рдХреА рдЪрд┐рдВрддрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реНрддрд░рд┐рдд рдХрдерд╛ рд╕рдмрд╕реЗ рдореБрдЦреНрдпрдзрд╛рд░рд╛ рд╡реАрдбрд┐рдпреЛ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЦреЗрд▓реЛрдВ рдХреА рд╣рд┐рдореНрдордд рдирд╣реАрдВ рд╣реЛрдЧреА
    </tr>
    <tr>
      <рде>7</рде>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
    </tr>
    <tr>
      <рде>9</рде><td></td>
    </tr>
  </tbody>
</рддрд╛рд▓рд┐рдХрд╛>


рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдХреБрдЫ рдкрд╛рда рд╡рд┐рдХрд┐рдкреАрдбрд┐рдпрд╛ рд▓реЗрдЦреЛрдВ рдХреЗ рдкреВрд░реНрдг рдкреИрд░рд╛рдЧреНрд░рд╛рдл рд╣реИрдВ, рдЬрдмрдХрд┐ рдЕрдиреНрдп рдХреЗрд╡рд▓ рд╢реАрд░реНрд╖рдХ рдпрд╛ рд░рд┐рдХреНрдд рдкрдВрдХреНрддрд┐рдпрд╛рдБ рд╣реИрдВред

## рдХрд╛рд░рдгрд╛рддреНрдордХ рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ (рд╕реАрдПрд▓рдПрдо)

рдХрд╛рд░рдг рднрд╛рд╖рд╛ рдореЙрдбрд▓ (рд╕реАрдПрд▓рдПрдо) рдХреЗ рд▓рд┐рдП, рд╣рдо рдкрд╣рд▓реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рд╕рднреА рдкрд╛рда рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЯреЛрдХрди рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЙрдиреНрд╣реЗрдВ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред рдлрд┐рд░ рд╣рдо рдЙрдиреНрд╣реЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЕрдиреБрдХреНрд░рдо рд▓рдВрдмрд╛рдИ рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВрдЧреЗред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдореЙрдбрд▓ рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдкрд╛рда рдХрд╛ рдПрдХ рд╕рддрдд рдмреНрд▓реЙрдХ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧрд╛:

```
рдкрд╛рда 1
```
рдпрд╛
```
рдкрд╛рда 1 рдХрд╛ рдЕрдВрдд [BOS_TOKEN] рдкрд╛рда 2 рдХреА рд╢реБрд░реБрдЖрдд
```

рдпрд╣ рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдХрдИ рдореВрд▓ рдкрд╛рдареЛрдВ рдХреЛ рдлреИрд▓рд╛рддреЗ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред рд▓реЗрдмрд▓ рдЗрдирдкреБрдЯ рдХреЗ рд╕рдорд╛рди рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рдмрд╛рдИрдВ рдУрд░ рд▓реЗ рдЬрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдо [`distilgpt2`](https://huggingface.co/distilgpt2) рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЖрдк [рдпрд╣рд╛рдВ](https://huggingface.co/models?filter=causal-lm) рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рд╕реА рднреА рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
рдореЙрдбрд▓_рдЪреЗрдХрдкреЙрдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рдЬреАрдкреАрдЯреА2"
```

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПрд╢рдмреНрджрд╛рд╡рд▓реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рднреА рдкрд╛рда рдХреЛ рдЯреИрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ (рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░) рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдпреЗ рдСрдкрд░реЗрд╢рди рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреНрд▓рд╛рд╕ рджреНрд╡рд╛рд░рд╛ рдкреВрд░реЗ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ
    
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(model_checkpoint, use_fast=True)
```

рдЕрдм рд╣рдо рд╕рднреА рдЯреЗрдХреНрд╕реНрдЯ рдкрд░ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдСрдкрд░реЗрд╢рди рдХреЛ рдХреЗрд╡рд▓ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реЗ рдореИрдк рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдЯреЗрдХреНрд╕реНрдЯ рдкрд░ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ:


```рдЕрдЬрдЧрд░
рдбреАрдИрдПрдлрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝_рдлрд╝рдВрдХреНрд╢рди(рдЙрджрд╛рд╣рд░рдг):
    рд╡рд╛рдкрд╕реА рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░(рдЙрджрд╛рд╣рд░рдг["рдкрд╛рда"])
```

рдлрд┐рд░ рд╣рдо рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЛ рддреЗрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреИрдЪ = рдЯреНрд░реВ рдФрд░ 4 рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдЯреЛрдХрдирдирд╛рдЗрдЬреЗрд╢рди рдкрд░ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВред рдлрд┐рд░ рд╣рдореЗрдВ ```рдЯреЗрдХреНрд╕реНрдЯ``` рдХреЙрд▓рдо рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕реЗ рдЫреЛрдбрд╝ рджреЗрддреЗ рд╣реИрдВред



```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = рдбреЗрдЯрд╛рд╕реЗрдЯ.рдПрдордПрдкреА(рдЯреЛрдХрдирд╛рдЗрдЬ_рдлрдВрдХреНрд╢рди, рдмреИрдЪреЗрдб=рдЯреНрд░реВ, num_proc=4, рд░рд┐рдореВрд╡_рдХреЙрд▓рдо=["рдЯреЗрдХреНрд╕реНрдЯ"])
```

рдпрджрд┐ рдЕрдм рд╣рдо рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рдПрдХ рддрддреНрд╡ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рдЗрдирдкреБрдЯ_рдЖрдИрдбреНрд╕ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:


```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"][1]
```




    {'рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ': [1, 1, 1, 1, 1, 1, 1, 1, 1],
     'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [796, 569, 18354, 7496, 17740, 6711, 796, 220, 198]}



рдЕрдЧрд▓рд╛ рдЪрд░рдг рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдХрдард┐рди рд╣реИ: рд╣рдореЗрдВ рд╕рднреА рдкрд╛рдареЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рдЬреЛрдбрд╝рдирд╛ рд╣реЛрдЧрд╛, рдФрд░ рдлрд┐рд░ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ `рдмреНрд▓реЙрдХ_рд╕рд╛рдЗрдЬрд╝` рдХреЗ рдЫреЛрдЯреЗ рдмреНрд▓реЙрдХреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдо `рдмреИрдЪ=рдЯреНрд░реВ` рд╡рд┐рдХрд▓реНрдк рдХреЗ рд╕рд╛рде `рдореИрдк` рд╡рд┐рдзрд┐ рдХрд╛ рдлрд┐рд░ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдпрд╣ рд╡рд┐рдХрд▓реНрдк рд╣рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдирдореВрдиреЗ рд▓реМрдЯрд╛рдХрд░ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдирдореВрдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕ рддрд░рд╣ рд╣рдо рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рдПрдХ рдмреИрдЪ рд╕реЗ рдирдП рдЙрджрд╛рд╣рд░рдг рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдореЙрдбрд▓ рдХреЛ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдЖрдкрдХреА рд╡реАрдбрд┐рдпреЛ рдореЗрдореЛрд░реА рдХреЛ рдлрдЯрдиреЗ рд╕реЗ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдВ рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ 128 рдкрд░ рд╕реЗрдЯ рдХреА рдЧрдИ рд╣реИ ЁЯТеред


```рдЕрдЬрдЧрд░
# рдмреНрд▓реЙрдХ_рдЖрдХрд╛рд░ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░.рдореЙрдбрд▓_рдореИрдХреНрд╕_рд▓реЗрдВрде
рдмреНрд▓реЙрдХ_рдЖрдХрд╛рд░ = 128
```

рдлрд┐рд░ рд╣рдо рдЕрдкрдиреЗ рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рд╕рдореВрд╣реАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рд▓рд┐рдЦрддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
def рд╕рдореВрд╣_рдкрд╛рда(рдЙрджрд╛рд╣рд░рдг):
    # рд╕рднреА рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВ
    concatenated_examples = {k: sum(examples[k], []) for k in example.keys()}
    total_length = len(concatenated_examples[list(examples.keys())[0]])
    # рд╣рдо рд╢реЗрд╖рдлрд▓ рдХреЗ рдЕрдиреБрд░реВрдк рднрд╛рдЧ рдХреЛ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рдпрджрд┐ рдореЙрдбрд▓ рдЗрд╕рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рддреЛ рдкреИрдбрд┐рдВрдЧ рдЬреЛрдбрд╝реА рдЬрд╛ рд╕рдХрддреА рд╣реИ рдФрд░ рдЖрдк рдЕрдкрдиреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЗрд╕ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рдХрд╕реНрдЯрдорд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
    рдХреБрд▓_рд▓рдВрдмрд╛рдИ = (рдХреБрд▓_рд▓рдВрдмрд╛рдИ // рдмреНрд▓реЙрдХ_рдЖрдХрд╛рд░) * рдмреНрд▓реЙрдХ_рдЖрдХрд╛рд░
    # max_len рджреНрд╡рд╛рд░рд╛ рд╡рд┐рднрд╛рдЬрд┐рдд.
    рдкрд░рд┐рдгрд╛рдо = {
        k: [рдЯреА[рдЖрдИ: рдЖрдИ + рдмреНрд▓реЙрдХ_рд╕рд╛рдЗрдЬ] рдлреЙрд░ рдЖрдИ рдЗрди рд░реЗрдВрдЬ(0, рдХреБрд▓_рд▓рдВрдмрд╛рдИ, рдмреНрд▓реЙрдХ_рдЖрдХрд╛рд░)]
        concatenated_examples.items() рдореЗрдВ k, t рдХреЗ рд▓рд┐рдП
    }
    рдкрд░рд┐рдгрд╛рдо["рд▓реЗрдмрд▓"] = рдкрд░рд┐рдгрд╛рдо["input_ids"].рдХреЙрдкреА()
    рд╡рд╛рдкрд╕реА рдкрд░рд┐рдгрд╛рдо
```

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдордиреЗ рд▓реЗрдмрд▓ рдХреЗ рдЗрдирдкреБрдЯ рдХреЛ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдХрд┐рдпрд╛ рд╣реИред

рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдореЙрдбрд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рджрд╛рдИрдВ рдУрд░ рдЪрд▓рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдЗрд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред

рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, `рдореИрдк` рд╡рд┐рдзрд┐ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 1,000 рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХрд╛ рдПрдХ рдмреИрдЪ рднреЗрдЬреЗрдЧреАред рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдВ рд╣рдо рд╢реЗрд╖ рднрд╛рдЧреЛрдВ рдХреЛ рд╣рдЯрд╛ рджреЗрдВрдЧреЗ рддрд╛рдХрд┐ рд╕рдВрдпреЛрдЬрд┐рдд рдЯреЛрдХрдирдпреБрдХреНрдд рдкрд╛рда рдкреНрд░рддреНрдпреЗрдХ 1000 рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ `рдмреНрд▓реЙрдХ_рд╕рд╛рдЗрдЬрд╝` рдХрд╛ рдЧреБрдгрдЬ рд╣реЛред рдЖрдк рдЙрдЪреНрдЪ рдмреИрдЪ рдЖрдХрд╛рд░ рдкрд╛рд╕ рдХрд░рдХреЗ рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдмреЗрд╢рдХ рдпрд╣ рднреА рдзреАрдореА рдЧрддрд┐ рд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛)ред рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЛ рддреЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк `рдорд▓реНрдЯреАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ` рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
lm_datasets = рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк(
    рд╕рдореВрд╣_рдкрд╛рда,
    рдмреИрдЪ = рд╕рддреНрдп,
    рдмреИрдЪ_рдЖрдХрд╛рд░=1000,
    num_proc=4,
)```

рдЕрдм рд╣рдо рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдбреЗрдЯрд╛рд╕реЗрдЯ рдмрджрд▓ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ: рдЕрдм рдирдореВрдиреЗ рдореЗрдВ рд╡рд░реНрдгреЛрдВ рдХреЗ `рдмреНрд▓реЙрдХ_рд╕рд╛рдЗрдЬрд╝` рд╕рдиреНрдирд┐рд╣рд┐рдд рдмреНрд▓реЙрдХ рд╣реИрдВ, рдЬреЛ рд╕рдВрднрд╡рддрдГ рдореВрд▓ рдкрд╛рда рдХреЗ рдХрдИ рдЯреБрдХрдбрд╝реЛрдВ рддрдХ рдлреИрд▓реЗ рд╣реБрдП рд╣реИрдВред


```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░.рдбрд┐рдХреЛрдб(lm_datasets["рдЯреНрд░реЗрди"][1]["input_ids"])
```




    ' рдЧреЗрдо рдФрд░ "рдиреЗрдорд▓реЗрд╕" рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рджреВрд╕рд░реЗ рдпреВрд░реЛрдкрд┐рдпрди рдпреБрджреНрдз рдХреЗ рджреМрд░рд╛рди рдЧреИрд▓рд┐рдпрд╛ рд░рд╛рд╖реНрдЯреНрд░ рдХреА рд╕реЗрд╡рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдПрдХ рджрдВрдбрд╛рддреНрдордХ рд╕реИрдиреНрдп рдЗрдХрд╛рдИ рд╣реИ, рдЬреЛ рдЧреБрдкреНрдд рдмреНрд▓реИрдХ рдСрдкрд░реЗрд╢рди рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрдВрдкреАрд░рд┐рдпрд▓ рдпреВрдирд┐рдЯ "рдХреИрд▓рд╛рдорд╛рдЯреА рд░реЗрд╡реЗрди" рдХреЗ рдЦрд┐рд▓рд╛рдл рдЦрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВред рдЦреЗрд▓ рдХрд╛ рд╡рд┐рдХрд╛рд╕ 2010 рдореЗрдВ рд╢реБрд░реВ рд╣реБрдЖ рд╡рд▓реНрдХрд┐рд░рд┐рдпрд╛ рдХреНрд░реЙрдирд┐рдХрд▓реНрд╕ II рдкрд░ рдХрд┐рдП рдЧрдП рдХрд╛рд░реНрдп рдХреЗ рдПрдХ рдмрдбрд╝реЗ рд╣рд┐рд╕реНрд╕реЗ рдореЗрдВ рдЗрд╕рдиреЗ рдорд╛рдирдХ рдХреЛ рдмрд░рдХрд░рд╛рд░ рд░рдЦрд╛рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ, рдЗрд╕рдореЗрдВ рдХрдИ рд╕рдорд╛рдпреЛрдЬрди рднреА рд╣реБрдП, рдЬреИрд╕реЗ рдХрд┐ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рдирд╡рд╛рдЧрдВрддреБрдХреЛрдВ рдХреЗ рд▓рд┐рдП рдЦреЗрд▓ рдХреЛ рдФрд░ рдЕрдзрд┐рдХ рдХреНрд╖рдорд╛рд╢реАрд▓ рдмрдирд╛рдирд╛, рдЪрд░рд┐рддреНрд░ рдбрд┐рдЬрд╛рдЗрдирд░ рд░рд╛рдпрддрд╛ рд╣реЛрдиреНрдЬреМ рдФрд░ рд╕рдВрдЧреАрддрдХрд╛рд░ рд╣рд┐рддреЛрд╢реА рд╕рд╛рдХрд┐рдореЛрдЯреЛ рджреЛрдиреЛрдВ рд╡рд╛рд▓реНрдХрд┐рд░рд┐рдпрд╛ рдХреНрд░реЙрдирд┐рдХрд▓реНрд╕ II рдХреЗ рдирд┐рд░реНрджреЗрд╢рдХ рддрд╛рдХреЗрд╢реА рдУрдЬрд╝ рдХреЗ рд╕рд╛рде рдкрд┐рдЫрд▓реА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рд╕реЗ рд▓реМрдЯреЗред



рдЕрдм рдЬрдм рдбреЗрдЯрд╛ рд╕рд╛рдл рд╣реЛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╣рдо рдЕрдкрдиреЗ рдЯреНрд░реЗрдирд░ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдо рдПрдХ рдореЙрдбрд▓ рдмрдирд╛рдПрдВрдЧреЗ:


```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForCausalLM рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдореЙрдбрд▓ = AutoModelForCausalLM.from_pretrained(model_checkpoint)
```

рдЯреЙрд░реНрдЪ рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ


```рдЕрдЬрдЧрд░

рдЖрдпрд╛рдд рдЖрдпрд╛рддlib.util
#рдЖрдпрд╛рддрдЖрдпрд╛рддрд▓рд┐рдм_рдореЗрдЯрд╛рдбреЗрдЯрд╛
a = рдЖрдпрд╛рддlib.util.find_spec("рдорд╢рд╛рд▓") рдХреЛрдИ рдирд╣реАрдВ рд╣реИ
рдкреНрд░рд┐рдВрдЯ(рдП)
# _рдорд╢рд╛рд▓_рд╕рдВрд╕реНрдХрд░рдг = рдЖрдпрд╛рддрд▓рд┐рдм_рдореЗрдЯрд╛рдбреЗрдЯрд╛.рд╕рдВрд╕реНрдХрд░рдг("рдорд╢рд╛рд▓")
# рдкреНрд░рд┐рдВрдЯ(_рдорд╢рд╛рд▓_рд╕рдВрд╕реНрдХрд░рдг)
```

    рд╕рддреНрдп


рдФрд░ рдХреБрдЫ `рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ`:


```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдЯреНрд░реЗрдирд░, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ
```


```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧ = рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ(
    "рдкрд░реАрдХреНрд╖рдг-рд╕реАрдПрд▓рдПрдо",
    рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ = "рдпреБрдЧ",
    рд╕реАрдЦрдиреЗ рдХреА рджрд░=2e-5,
    рд╡рдЬрд╝рди_рдХреНрд╖рдп=0.01,
)
```

рд╣рдо рдпрд╣ рд╕рдм `рдЯреНрд░реЗрдирд░` рд╡рд░реНрдЧ рдХреЛ рд╕реМрдВрдкрддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
    рдореЙрдбрд▓=рдореЙрдбрд▓,
    рддрд░реНрдХ = рдЯреНрд░рд╛рдИрдирд┐рдВрдЧ_рдЖрд░реНрдЧреНрд╕,
    рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдПрд▓рдПрдо_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
    eval_dataset=lm_datasets["рд╕рддреНрдпрд╛рдкрди"],
)
```

рддрдм рд╣рдо рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```

      0%||31/7002 [04:16<14:27:52, 7.47 рд╕реЗрдХрдВрдб/рдЗрдЯ]

рдПрдХ рдмрд╛рд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рдиреЗ рдкрд░, рд╣рдо рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдкрд░ рдЗрд╕рдХреА рдЙрд▓рдЭрди рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
рдЧрдгрд┐рдд рдЖрдпрд╛рдд рдХрд░реЗрдВ
eval_results = рдЯреНрд░реЗрдирд░.рдореВрд▓реНрдпрд╛рдВрдХрди()
рдкреНрд░рд┐рдВрдЯ(f"рдкрд░реЗрдкреНрд▓реЗрдХреНрд╕рд┐рдЯреА: {math.exp(eval_results['eval_los']):.2f}")
```

## рдорд╛рд╕реНрдХ рд▓реИрдВрдЧреНрд╡реЗрдЬ рдореЙрдбрд▓рд┐рдВрдЧ (рдПрдордПрд▓рдПрдо)

рдорд╛рд╕реНрдХреНрдб рд▓реИрдВрдЧреНрд╡реЗрдЬ рдореЙрдбрд▓ (рдПрдордПрд▓рдПрдо) рд╣рдо рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдЪрд░рдг рдХреЗ рд╕рд╛рде рдкрд╣рд▓реЗ рдХреА рддрд░рд╣ рд╣реА рдбреЗрдЯрд╛рд╕реЗрдЯ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ:

рд╣рдо рдХреБрдЫ рд╡рд░реНрдгреЛрдВ рдХреЛ рдмреЗрддрд░рддреАрдм рдврдВрдЧ рд╕реЗ "MASK" рдХрд░реЗрдВрдЧреЗ (рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП "[MASK]" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ) рдФрд░ рд▓реЗрдмрд▓ рдХреЛ рдХреЗрд╡рд▓рд▓реЗрдмрд▓ рдХреЛ "[MASK]" рд╕реНрдерд┐рддрд┐ рдкрд░ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рдЙрди рд╡рд░реНрдгреЛрдВ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдЬреЛ "MASK" рдирд╣реАрдВ рд╣реИрдВ)ред

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдо [`distilroberta-base`](https://huggingface.co/distilroberta-base) рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЖрдк [рдпрд╣рд╛рдВ](https://huggingface.co/models?filter=causal-lm) рд╕реВрдЪреАрдмрджреНрдз рдХреЛрдИ рднреА рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
рдореЙрдбрд▓_рдЪреЗрдХрдкреЙрдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рд░реЛрдмрд░реНрдЯрд╛-рдмреЗрд╕"
```

рд╣рдо рдкрд╣рд▓реЗ рдХреА рддрд░рд╣ рд╣реА рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдлрд╝рдВрдХреНрд╢рди рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдореЗрдВ рдмрд╕ рдЕрдкрдиреЗ рджреНрд╡рд╛рд░рд╛ рдЪреБрдиреЗ рдЧрдП рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:


```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(model_checkpoint, use_fast=True)
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк (рдЯреЛрдХрдирд╛рдЗрдЬ_рдлрдВрдХреНрд╢рди, рдмреИрдЪреЗрдб = рдЯреНрд░реВ, num_proc = 4, рд░рд┐рдореВрд╡_рдХреЙрд▓рдо = ["рдЯреЗрдХреНрд╕реНрдЯ"])```

рдкрд╣рд▓реЗ рдХреА рддрд░рд╣, рд╣рдо рдкрд╛рда рдХреЛ рдПрдХ рд╕рд╛рде рд╕рдореВрд╣рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд▓рдВрдмрд╛рдИ `рдмреНрд▓реЙрдХ_рд╕рд╛рдЗрдЬрд╝` рдХреЗ рдирдореВрдиреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╡рд╛рдХреНрдп рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕ рдЪрд░рдг рдХреЛ рдЫреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред


```рдЕрдЬрдЧрд░
lm_datasets = рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк(
    рд╕рдореВрд╣_рдкрд╛рда,
    рдмреИрдЪ = рд╕рддреНрдп,
    рдмреИрдЪ_рдЖрдХрд╛рд░=1000,
    num_proc=4,
)
```

рджреЛ рдЕрдкрд╡рд╛рджреЛрдВ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдмрд╛рдХреА рд╕рдм рдХреБрдЫ рд╡реИрд╕рд╛ рд╣реА рд╣реИ рдЬреИрд╕рд╛ рд╣рдордиреЗ рдкрд╣рд▓реЗ рдХрд┐рдпрд╛ рдерд╛ред рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рд╣рдо рднрд╛рд╖рд╛ рдореЙрдбрд▓ рдХреЛ рдЫреБрдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForMaskedLM рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдореЙрдбрд▓ = AutoModelForMaskedLM.from_pretrained(model_checkpoint)
```

рджреВрд╕рд░рд╛, рд╣рдо рдПрдХ рд╡рд┐рд╢реЗрд╖ рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рд╣реИ рдЬреЛ рдирдореВрдиреЗ рд▓реЗрдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЯреЗрдВрд╕рд░ рдореЗрдВ рдмреИрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред

рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдЦрд╛рд╕ рдирд╣реАрдВ рдерд╛, рдЗрд╕рд▓рд┐рдП рд╣рдордиреЗ рдХреЗрд╡рд▓ рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред рдпрд╣рд╛рдВ рд╣рдо рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ "MASK" рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред

рдЗрд╕реЗ рд╣рдо рдРрд╕реЗ рдорд╛рди рд╕рдХрддреЗ рд╣реИрдВрдПрдХ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЪрд░рдг (`рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░`) рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдореЗрдВ рд╡рд░реНрдгреЛрдВ рдХреЛ рд╣рдореЗрд╢рд╛ рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдЫрд┐рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ рдореЗрдВ рдпрд╣ рдЪрд░рдг рдХрд░рдХреЗ, рд╣рдо рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╣рд░ рдмрд╛рд░ рдбреЗрдЯрд╛ рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╕рдордп рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдорд╛рд╕реНрдХрд┐рдВрдЧ рдПрдХ рдирдП рддрд░реАрдХреЗ рд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИред

рдорд╛рд╕реНрдХрд┐рдВрдЧ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, `рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕` рднрд╛рд╖рд╛ рдореЙрдбрд▓ рдХреЛ рдорд╛рд╕реНрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `DataCollatorForEnglishModeling` рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рд╣рдо рдорд╛рд╕реНрдХрд┐рдВрдЧ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:


```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рд╕реЗ DataCollatorForрднрд╛рд╖рд╛рдореЙрдбрд▓рд┐рдВрдЧ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ = рдбреЗрдЯрд╛рдХреЛрд▓реЗрдЯрд░рдлреЙрд░рд▓реИрдВрдЧреНрд╡реЗрдЬрдореЙрдбрд▓рд┐рдВрдЧ(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░=рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░, рдПрдордПрд▓рдПрдо_рдкреНрд░реЛрдмреЗрдмрд┐рд▓рд┐рдЯреА=0.15)
```

рдлрд┐рд░ рд╣рдореЗрдВ рд╕рдм рдХреБрдЫ рдЯреНрд░реЗрдирд░ рдХреЛ рд╕реМрдВрдкрдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╢реБрд░реВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:


```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
    рдореЙрдбрд▓=рдореЙрдбрд▓,
    рддрд░реНрдХ=рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧ,
    рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдПрд▓рдПрдо_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
    eval_dataset=lm_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"],
    рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░=рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░,
)
```


```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```

рдкрд╣рд▓реЗ рдХреА рддрд░рд╣, рд╣рдо рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдкрд░ рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╕реАрдПрд▓рдПрдо рдЙрджреНрджреЗрд╢реНрдп рдХреА рддреБрд▓рдирд╛ рдореЗрдВ, рдЙрд▓рдЭрди рдмрд╣реБрдд рдХрдо рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдордПрд▓рдПрдо рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд╕рд╛рде рд╣рдореЗрдВ рд╢реЗрд╖ рдЯреЛрдХрди рддрдХ рдкрд╣реБрдВрдЪ рд░рдЦрддреЗ рд╣реБрдП рдХреЗрд╡рд▓ рдЫрд┐рдкреЗ рд╣реБрдП рдЯреЛрдХрди (рдпрд╣рд╛рдВ рдХреБрд▓ рдХрд╛ 15%) рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

рдЗрд╕рд▓рд┐рдП, рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдпрд╣ рдПрдХ рдЖрд╕рд╛рди рдХрд╛рдо рд╣реИред


```рдЕрдЬрдЧрд░
eval_results = рдЯреНрд░реЗрдирд░.рдореВрд▓реНрдпрд╛рдВрдХрди()
рдкреНрд░рд┐рдВрдЯ(f"рдкрд░реЗрдкреНрд▓реЗрдХреНрд╕рд┐рдЯреА: {math.exp(eval_results['eval_los']):.2f}")
```


```рдЕрдЬрдЧрд░
рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ [ЁЯдЧрдореЙрдбрд▓ рд╕реЗрдВрдЯрд░](https://huggingface.co/models) рдкрд░ [рдЕрдкрд▓реЛрдб](https://huggingface.co/transformers/model_sharing.html) рдХрд░рдирд╛ рди рднреВрд▓реЗрдВред
```