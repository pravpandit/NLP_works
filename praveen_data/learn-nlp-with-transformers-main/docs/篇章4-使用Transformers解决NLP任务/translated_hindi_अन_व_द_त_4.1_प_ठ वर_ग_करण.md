рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдЬрдкреНрдЯрд░ рдиреЛрдЯрдмреБрдХ [рдЕрдзреНрдпрд╛рдп 4 рдХреЛрдб рдмреЗрд╕](https://github.com/datawhalechina/learn-nlp-with-transformers/tree/main/docs/%E7%AF%87%E7%) рдореЗрдВ рд╣реИ AB%A04-%E4%BD%BF%E7%94%A8Transformers%E8%A7%A3%E5%86%B3NLP%E4%BB%BB%E5%8A%A1).

рдЖрдк рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреЛ рдЦреЛрд▓рдиреЗ рдФрд░ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдбреЗрдЯрд╛рд╕реЗрдЯ рдФрд░ рдореЙрдбрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ Google рдХреЛрд▓рд╛рдм рдиреЛрдЯрдмреБрдХ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
рдпрджрд┐ рдЖрдк рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЛ Google Colab рдореЗрдВ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдФрд░ ЁЯдЧDatasets рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬрд╝ рдХреЛ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИрдЙрдиреНрд╣реЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрджреЗрд╢ рджреЗрдВред

```рдЕрдЬрдЧрд░
!рдкрд╛рдЗрдк рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ
```

рдпрджрд┐ рдЖрдк рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдиреЗ рдЙрдкрд░реЛрдХреНрдд рдирд┐рд░реНрднрд░рддрд╛рдПрдБ рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд▓реА рд╣реИрдВред
рдЖрдк рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЗ рдорд▓реНрдЯреА-рдЬреАрдкреАрдпреВ рд╡рд┐рддрд░рд┐рдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдВ рдЙрджрд╛рд╣рд░рдг рднреА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ)ред

# рдкрд╛рда рд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдареАрдХ рдХрд░реЗрдВ

рд╣рдо рджрд┐рдЦрд╛рдПрдВрдЧреЗ рдХрд┐ рдЯреА рд╕реЗ рдЯреЗрдХреНрд╕реНрдЯ рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕] (https://github.com/huggingface/transformers) рдХреЛрдбрдмреЗрд╕ рдореЗрдВ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВрд╡рд╣ [рдЧреНрд▓реВ рдмреЗрдВрдЪрдорд╛рд░реНрдХ](https://рдЧреНрд▓реВрдмреЗрдВрдЪрдорд╛рд░реНрдХ.com/)ред

![рдкрд╛рда рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдкрд░ рд╡рд┐рдЬреЗрдЯ рдЕрдиреБрдорд╛рди](https://github.com/huggingface/notebooks/blob/master/examples/images/text_classification.png?raw=1)

GLUE рд╕реВрдЪреА рдореЗрдВ 9 рд╡рд╛рдХреНрдп-рд╕реНрддрд░реАрдп рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рдЕрд░реНрдерд╛рддреН:
- [CoLA](https://nyu-mll.github.io/CoLA/) (рднрд╛рд╖рд╛рдИ рд╕реНрд╡реАрдХрд╛рд░реНрдпрддрд╛ рдХрд╛ рдХреЛрд╖) рдпрд╣ рдкрд╣рдЪрд╛рди рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рд╡рд╛рдХреНрдп рд╡реНрдпрд╛рдХрд░рдгрд┐рдХ рд░реВрдк рд╕реЗ рд╕рд╣реА рд╣реИ рдпрд╛ рдирд╣реАрдВред
- [рдПрдордПрдирдПрд▓рдЖрдИ](https://arxiv.org/abs/1704.05426) (рдмрд╣реБ-рд╢реИрд▓реА рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдЕрдиреБрдорд╛рди)рдкреЛрдерд┐рд╕рд┐рд╕, рджреВрд╕рд░реЗ рд╡рд╛рдХреНрдп рдФрд░ рдкрд░рд┐рдХрд▓реНрдкрдирд╛ рдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдз рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ: рд╢рд╛рдорд┐рд▓, рд╡рд┐рд░реЛрдзрд╛рднрд╛рд╕реА рдпрд╛ рдЕрд╕рдВрдмрдВрдзрд┐рддред
- [MRPC](https://www.microsoft.com/en-us/download/details.aspx?id=52398) (Microsoft рд░рд┐рд╕рд░реНрдЪ рдкреИрд░рд╛рдлреНрд░реЗрдЬрд╝ рдХреЙрд░реНрдкрд╕) рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ рдХрд┐ рдХреНрдпрд╛ рджреЛ рд╡рд╛рдХреНрдп рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рдкреИрд░рд╛рдлреНрд░реЗрдЬрд╝ рд╣реИрдВред
- [QNLI](https://rajpurkar.github.io/SQuAD-explorer/) (рдкреНрд░рд╢реНрди-рдЙрддреНрддрд░ рджреЗрдиреЗ рд╡рд╛рд▓рд╛ рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдЕрдиреБрдорд╛рди) рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ рдХрд┐ рдХреНрдпрд╛ рджреВрд╕рд░реЗ рд╡рд╛рдХреНрдп рдореЗрдВ рдкрд╣рд▓реЗ рд╡рд╛рдХреНрдп рдореЗрдВ рдкреНрд░рд╢реНрди рдХрд╛ рдЙрддреНрддрд░ рд╣реИред
-[рдХреНрдпреВрдХреНрдпреВрдкреА](рдПрдЪttps://data.quora.com/First-Quora-Dataset-Release-Question-Pairs) (Quora рдкреНрд░рд╢реНрди рдЬреЛрдбрд╝реЗ2) рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ рдХрд┐ рдХреНрдпрд╛ рджреЛ рдкреНрд░рд╢реНрди рд╢рдмреНрджрд╛рд░реНрде рдХреА рджреГрд╖реНрдЯрд┐ рд╕реЗ рд╕рдорд╛рди рд╣реИрдВред
- [рдЖрд░рдЯреАрдИ](https://aclweb.org/aclwiki/Recognising_Textual_Entailment) (рдЯреЗрдХреНрд╕реНрдЯреБрдЕрд▓ рдПрдВрдЯреЗрд▓рдореЗрдВрдЯ рдХреЛ рдкрд╣рдЪрд╛рдирдирд╛) рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рд╡рд╛рдХреНрдп рдПрдХ рдкрд░рд┐рдХрд▓реНрдкрдирд╛ рдХреЗ рд╕рд╛рде рдПрдХ рдЖрд╡рд╢реНрдпрдХ рд╕рдВрдмрдВрдз рдореЗрдВ рд╣реИред
- [рдПрд╕рдПрд╕рдЯреА-2](https://nlp.stanford.edu/sentiment/index.html) (рд╕реНрдЯреИрдирдлреЛрд░реНрдб рд╕реЗрдВрдЯреАрдореЗрдВрдЯ рдЯреНрд░реАрдмреИрдВрдХ) рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рд╡рд╛рдХреНрдп рднрд╛рд╡рдирд╛ рдореЗрдВ рд╕рдХрд╛рд░рд╛рддреНрдордХ рд╣реИ рдпрд╛ рдирдХрд╛рд░рд╛рддреНрдордХред
- [рдПрд╕рдЯреАрдПрд╕-рдмреА](http://ixa2.si.ehu.es/stswiki/index.php/STSbenchmark) (рд╕рд┐рдореЗрдВрдЯрд┐рдХ рдЯреЗрдХреНрд╕реНрдЯреБрдЕрд▓ рд╕рдорд╛рдирддрд╛ рдмреЗрдВрдЪрдорд╛рд░реНрдХ) рджреЛ рд╡рд╛рдХреНрдпреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдорд╛рдирддрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ (рд╕реНрдХреЛрд░ 1-5 рдЕрдВрдХ рд╣реИрдВ)ред
- [рдбрдмреНрд▓реНрдпреВрдПрдирдПрд▓рдЖрдИ](https://cs.nyu.edu/faculty/davise/papers/WinogradSchemas/WS.html) (рд╡рд┐рдиреЛрдЧреНрд░рд╛рдб рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдЕрдиреБрдорд╛рди) рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЕрдирд╛рдо рд╕рд░реНрд╡рдирд╛рдо рд╡рд╛рд▓рд╛ рд╡рд╛рдХреНрдп рдФрд░ рдЗрд╕ рд╕рд░реНрд╡рдирд╛рдо рдХреЛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╡рд╛рдХреНрдп рд╢рд╛рдорд┐рд▓ рд╣реИ рдпрд╛ рдирд╣реАрдВред

рдЙрдкрд░реЛрдХреНрдд рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП, рд╣рдо рджрд┐рдЦрд╛рдПрдВрдЧреЗ рдХрд┐ рд╕рд░рд▓ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдХреИрд╕реЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдП рдФрд░ рдкреНрд░реА-рдЯреНрдпреВрди рдХрд┐рдпрд╛ рдЬрд╛рдПредрдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЗрдВ `рдЯреНрд░реЗрдирд░` рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ред

```рдЕрдЬрдЧрд░
GLUE_TASKS = ["рдХреЛрд▓рд╛", "рдПрдордПрдирдПрд▓рдЖрдИ", "рдПрдордПрдирдПрд▓рдЖрдИ-рдПрдордПрдо", "рдПрдордЖрд░рдкреАрд╕реА", "рдХреНрдпреВрдПрдирдПрд▓рдЖрдИ", "рдХреНрдпреВрдХреНрдпреВрдкреА", "рдЖрд░рдЯреАрдИ", "рдПрд╕рдПрд╕рдЯреА2", "рдПрд╕рдЯреАрдПрд╕рдмреА", "рдбрдмреНрд▓реНрдпреВрдПрдирдПрд▓рдЖрдИ"]
```

рдпрд╣ рдиреЛрдЯрдмреБрдХ рд╕реИрджреНрдзрд╛рдВрддрд┐рдХ рд░реВрдк рд╕реЗ рдХрд┐рд╕реА рднреА рдкрд╛рда рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ ([рдореЙрдбрд▓ рдкреИрдирд▓] (https://huggingface.co/models)) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдк рдЬрд┐рд╕ рдХрд╛рд░реНрдп рд╕реЗ рдирд┐рдкрдЯ рд░рд╣реЗ рд╣реИрдВ рд╡рд╣ рдЕрд▓рдЧ рд╣реИ, рддреЛ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдЗрд╕реЗ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдорд╛рдореВрд▓реА рдмрджрд▓рд╛рд╡ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА, рдЖрдкрдХреЛ рдмреАрдЯреАрдП рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПрд╡реАрдбрд┐рдпреЛ рдореЗрдореЛрд░реА рдУрд╡рд░рдлрд╝реНрд▓реЛ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЗ GPU рд╡реАрдбрд┐рдпреЛ рдореЗрдореЛрд░реА рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдлрд╝рд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП ch рдЖрдХрд╛рд░ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

```рдЕрдЬрдЧрд░
рдХрд╛рд░реНрдп = "рдХреЛрд▓рд╛"
рдореЙрдбрд▓_рдЪреЗрдХрдкреЙрдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб"
рдмреИрдЪ_рдЖрдХрд╛рд░ = 16
```

## рдбреЗрдЯрд╛ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ

рд╣рдо рдбреЗрдЯрд╛ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдореВрд▓реНрдпрд╛рдВрдХрди рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [ЁЯдЧ рдбреЗрдЯрд╛рд╕реЗрдЯ] (https://github.com/huggingface/datasets) рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдбреЗрдЯрд╛ рд▓реЛрдбрд┐рдВрдЧ рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рд╡рд┐рдзрд┐ рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ `load_dataset` рдФрд░ `load_metric` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ, рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ
```

`рдПрдордПрдирдПрд▓рдЖрдИ-рдПрдордПрдо` рдХреЛ рдЫреЛрдбрд╝рдХрд░, рдЕрдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реАрдзреЗ рдХрд╛рд░реНрдп рдирд╛рдо рд╕реЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдбреЗрдЯрд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХреИрд╢ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред

```рдЕрдЬрдЧрд░
рд╡рд╛рд╕реНрддрд╡рд┐рдХ_рдХрд╛рд░реНрдп = "рдПрдордПрдирдПрд▓рдЖрдИ" рдпрджрд┐ рдХрд╛рд░реНрдп == "рдПрдордПрдирдПрд▓рдЖрдИ-рдПрдордПрдо" рдЕрдиреНрдпрдерд╛ рдХрд╛рд░реНрдп
рдбреЗрдЯрд╛рд╕реЗрдЯ = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ ("рдЧреЛрдВрдж", рд╡рд╛рд╕реНрддрд╡рд┐рдХ_рдХрд╛рд░реНрдп)
рдореАрдЯреНрд░рд┐рдХ = рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ ('рдЧреЛрдВрдж', рд╡рд╛рд╕реНрддрд╡рд┐рдХ_рдХрд╛рд░реНрдп)
```

рдпрд╣ `рдбреЗрдЯрд╛рд╕реЗрдЯ` рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реНрд╡рдпрдВ рдПрдХ [`рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ`](https://huggingface.co/docs/datasets/package_reference/main_classes.html#datasetdict) рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рд╣реИ, рдХреЗрд╡рд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ, рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдФрд░ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП рдХрд░рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИрд╕рдВрдмрдВрдзрд┐рдд рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдмрдВрдзрд┐рдд рдХреБрдВрдЬреА (рдЯреНрд░реЗрди, рд╕рддреНрдпрд╛рдкрди, рдкрд░реАрдХреНрд╖рдг) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

```рдЕрдЬрдЧрд░
рдбрд╛рдЯрд╛рд╕реЗрдЯ
```

рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ({
рдЯреНрд░реЗрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рд╡рд╛рдХреНрдп', 'рд▓реЗрдмрд▓', 'idx'],
рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 8551
})
рд╕рддреНрдпрд╛рдкрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рд╡рд╛рдХреНрдп', 'рд▓реЗрдмрд▓', 'idx'],
рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 1043
})
рдкрд░реАрдХреНрд╖рдг: рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рд╡рд╛рдХреНрдп', 'рд▓реЗрдмрд▓', 'idx'],
рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 1063
})
})

рдбреЗрдЯрд╛ рд╡рд┐рднрд╛рдЬрди рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП, рдбреЗрдЯрд╛ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдВрдЬреА (рдЯреНрд░реЗрди, рд╕рддреНрдпрд╛рдкрди, рдпрд╛ рдкрд░реАрдХреНрд╖рдг) рдФрд░ рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"][0]
```

{'idx':0,
'рд▓реЗрдмрд▓': 1,
'рд╡рд╛рдХреНрдп': "рд╣рдорд╛рд░реЗ рдорд┐рддреНрд░ рдЗрд╕ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ рдирд╣реАрдВ рдорд╛рдиреЗрдВрдЧреЗ, рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдЕрдЧрд▓реЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ рддреЛ рдЫреЛрдбрд╝ рд╣реА рджреАрдЬрд┐рдПред"}

рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдбреЗрдЯрд╛ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ, рдирд┐рдореНрди рдлрд╝рдВрдХреНрд╢рди рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдХреБрдЫ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХрд╛ рдЪрдпрди рдХрд░реЗрдЧрд╛ред

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдкрд╛рдВрдбрд╛ рдХреЛ рдкреАрдбреА рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ
IPython.display рд╕реЗ рдЖрдпрд╛рдд рдбрд┐рд╕реНрдкреНрд▓реЗ, HTML

def show_random_elements(рдбреЗрдЯрд╛рд╕реЗрдЯ, num_examples=10):
assert num_examples <= len(рдбреЗрдЯрд╛рд╕реЗрдЯ), "рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдореМрдЬреВрдж рддрддреНрд╡реЛрдВ рд╕реЗ рдЕрдзрд┐рдХ рддрддреНрд╡ рдирд╣реАрдВ рдЪреБрди рд╕рдХрддреЗред"
рдЪреБрдирддрд╛ рд╣реИ =[]
рд░реЗрдВрдЬ рдореЗрдВ _ рдХреЗ рд▓рд┐рдП (num_examples):
рдкрд┐рдХ = рд░реИрдВрдбрдо.рд░реИрдВрдбрд┐рдВрдЯ(0, рд▓реЗрди(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
рдЪрдпрди рдХрд░рддреЗ рд╕рдордп:
рдкрд┐рдХ = рд░реИрдВрдбрдо.рд░реИрдВрдбрд┐рдВрдЯ(0, рд▓реЗрди(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
рдЪреБрдирддрд╛ рд╣реИ.рдЬреЛрдбрд╝реЗрдВ(рдЪреБрдиреЗрдВ)

рдбреАрдПрдл = рдкреАрдбреА.рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо(рдбреЗрдЯрд╛рд╕реЗрдЯ[рдЪреБрдирддрд╛ рд╣реИ])
рдХреЙрд▓рдо рдХреЗ рд▓рд┐рдП, dataset.features.items() рдЯрд╛рдЗрдк рдХрд░реЗрдВ:
рдпрджрд┐ isinstance(рдкреНрд░рдХрд╛рд░, datasets.ClassLabel):
рдбреАрдПрдл[рдХреЙрд▓рдо] = рдбреАрдПрдл[рдХреЙрд▓рдо].рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо(рд▓реИрдореНрдмреНрдбрд╛ рдЖрдИ: рдЯрд╛рдЗрдк.рдирд╛рдо[рдЖрдИ])
рдбрд┐рд╕реНрдкреНрд▓реЗ(HTML(df.to_html()))
```

```рдЕрдЬрдЧрд░
show_random_elements(рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"])
```

<рддрд╛рд▓рд┐рдХрд╛ рд╕реАрдорд╛ = "1" рд╡рд░реНрдЧ = "рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо">
<рд╕рд┐рд░>
<tr рд╢реИрд▓реА = "рдкрд╛рда-рд╕рдВрд░реЗрдЦрдг: рджрд╛рдПрдВ;">
<tрдЬ></th>
<th>рд╡рд╛рдХреНрдп</th>
<th>рд▓реЗрдмрд▓</th>
<th>idx</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>рдЬрд┐рддрдирд╛ рдЕрдзрд┐рдХ рдореИрдВ рдЬреЛ рд╕реЗ рдмрд╛рдд рдХрд░рддрд╛ рд╣реВрдВ, рднрд╛рд╖рд╛рд╡рд┐рдЬреНрдЮрд╛рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЙрддрдирд╛ рд╣реА рдХрдо рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╕реИрд▓реА рдиреЗ рдЙрд╕реЗ рд╕рд░рд╛рд╣рдирд╛ рдХрд░рдирд╛ рд╕рд┐рдЦрд╛рдпрд╛ рд╣реИред</td>
<td>рд╕реНрд╡реАрдХрд╛рд░реНрдп</td>
<td>196</td>
</tr>
<tr>
<th>1</th>
<td>рдХреНрдпрд╛ рдмрдЪреНрдЪреЗ рд╣рдорд╛рд░реА рдХрдХреНрд╖рд╛ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдЖ рдЧрдП рд╣реИрдВ?</td><td>рдЕрд╕реНрд╡реАрдХрд╛рд░реНрдп</td>
<td>3748</td>
</tr>
<tr>
<th>2</th>
<td>рдореИрдВрдиреЗ рдореИрд░реА рдХреЛ рдПрдХ рдХрд┐рддрд╛рдм рджреАред</td>
<td>рд╕реНрд╡реАрдХрд╛рд░реНрдп</td>
<td>5302</td>
</tr>
<tr>
<рде>3</рде>
<td>рдкреНрд░рддреНрдпреЗрдХ рдЫрд╛рддреНрд░, рдЬрд┐рд╕рдиреЗ рднрд╛рдЧ рд▓рд┐рдпрд╛ty, рдЕрдЪреНрдЫрд╛ рд╕рдордп рдмрд┐рддрд╛рдпрд╛ред</td>
<td>рдЕрд╕реНрд╡реАрдХрд╛рд░реНрдп</td>
<td>4944</td>
</tr>
<tr>
<рде>4</рде>
<td>рдмрд┐рд▓ рдиреЗ рдореЗрдЯрд▓ рдлрд╝рд┐рдПрдЯ рдХреЛ рдХреБрдЪрд▓ рджрд┐рдпрд╛ред</td>
<td>рд╕реНрд╡реАрдХрд╛рд░реНрдп</td>
<td>2178</td>
</tr>
<tr>
<th>5</th>
<td>рдЗрд╕рдиреЗ рдореЗрд░реЗ рдкреИрд░ рдореЗрдВ рдХрд╛рдЯ рд▓рд┐рдпрд╛ред</td>
<td>рд╕реНрд╡реАрдХрд╛рд░реНрдп</td>
<td>5908</td>
</tr>
<tr>
<th>6</th>
<td>рд▓рдбрд╝рдХреЛрдВ рдХреЛ рдЖрдВрдЯреА рдореИрд░реА рдиреЗ рдПрдХ рдЕрдЪреНрдЫреА рдорд╛рдБ рдмрдирд╛рдпрд╛ред</td>
<td>рдЕрд╕реНрд╡реАрдХрд╛рд░реНрдп</td>
<td>736</td>
</tr>
<tr>
<рде>7</рде>
<td>рдЕрдзрд┐рдХ рдЖрджрдореА рдпрд╣рд╛рдБ рд╣реИред</td>
<td>рдЕрд╕реНрд╡реАрдХрд╛рд░реНрдп</td>
<td>5403</td>
</tr>
<tr>
<th>8</th>
<td>рдореЗрд░реА рдорд╛рдБ рдиреЗ рдореЗрд░реЗ рд▓рд┐рдП рдЬрдиреНрдорджрд┐рди рдмрдирд╛рдпрд╛рдХреЗрдХ.</td>
<td>рд╕реНрд╡реАрдХрд╛рд░реНрдп</td>
<td>3761</td>
</tr>
<tr>
<th>9</th><td>рдРрд╕рд╛ рдкреНрд░рддреАрдд рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдЧреНрд░реЗрдЧрд░реА рдХрдВрдкрдиреА рдХреЗ рдкреНрд░рддрд┐ рд╡рдлрд╛рджрд╛рд░ рд░рд╣рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ред</td>
<td>рд╕реНрд╡реАрдХрд╛рд░реНрдп</td>
<td>4334</td>
</tr>
</tbody>
</рддрд╛рд▓рд┐рдХрд╛>

рдореВрд▓реНрдпрд╛рдВрдХрди рдореАрдЯреНрд░рд┐рдХ [`datasets.Metric`](https://huggingface.co/docs/datasets/package_reference/main_classes.html#datasets.Metric) рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ:

```рдЕрдЬрдЧрд░
рдореАрдЯреНрд░рд┐рдХ
```

рдореАрдЯреНрд░рд┐рдХ(рдирд╛рдо: "рдЧреЛрдВрдж", рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: {'рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ': рдорд╛рди(dtype='int64', id=рдХреЛрдИ рдирд╣реАрдВ), 'рд╕рдВрджрд░реНрдн': рдорд╛рди(dtype='int64', id=None)}, рдЙрдкрдпреЛрдЧ: """
рдкреНрд░рддреНрдпреЗрдХ GLUEрдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд╕рдВрдмрджреНрдз GLUE рдореВрд▓реНрдпрд╛рдВрдХрди рдореАрдЯреНрд░рд┐рдХ рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдВред
рддрд░реНрдХ:
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ: рд╕реНрдХреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдХреА рд╕реВрдЪреАред
рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд╡рд╛рдж рдХреЛ рдЯреЛрдХрди рдХреА рд╕реВрдЪреА рдореЗрдВ рдЕрдВрдХрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
рд╕рдВрджрд░реНрдн: рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд╡рд╛рдж рдХреЗ рд▓рд┐рдП рд╕рдВрджрд░реНрднреЛрдВ рдХреА рд╕реВрдЪреАред
рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрджрд░реНрдн рдХреЛ рдЯреЛрдХрди рдХреА рд╕реВрдЪреА рдореЗрдВ рдЕрдВрдХрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
рд░рд┐рдЯрд░реНрди: GLUE рдЙрдкрд╕рдореБрдЪреНрдЪрдп рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдЗрдирдореЗрдВ рд╕реЗ рдПрдХ рдпрд╛ рдХрдИ:
"рд╕рдЯреАрдХрддрд╛": рд╕рдЯреАрдХрддрд╛
"f1": F1 рд╕реНрдХреЛрд░
"рдкрд┐рдпрд░реНрд╕рди": рдкрд┐рдпрд░реНрд╕рди рд╕рд╣рд╕рдВрдмрдВрдз
"рд╕реНрдкреАрдпрд░рдореИрдирд░": рд╕реНрдкреАрдпрд░рдореИрди рд╕рд╣рд╕рдВрдмрдВрдз
"рдореИрдереНрдпреВрдЬрд╝_рд╕рд╣рд╕рдВрдмрдВрдз": рдореИрдереНрдпреВ рд╕рд╣рд╕рдВрдмрдВрдз
рдкреВрд░реНрд╡рдкреНрд░рдЪреБрд░:

>>> рдЧреЛрдВрдж_рдореЗрдЯреНрд░рд┐рдХ = рдбреЗрдЯрд╛рд╕реЗрдЯ.рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ ('рдЧреЛрдВрдж', 'рдПрд╕рдПрд╕рдЯреА2') # 'рдПрд╕рдПрд╕рдЯреА2' рдпрд╛ рдХреЛрдИ рднреА ["рдПрдордПрдирдПрд▓рдЖрдИ", "рдПрдордПрдирдПрд▓рдЖрдИ_рдорд┐рд╕рдореИрдЪреНрдб", "рдПрдордПрдирдПрд▓рдЖрдИ_рдореИрдЪреЗрдб", "рдХреНрдпреВрдПрдирдПрд▓рдЖрдИ", "рдЖрд░рдЯреАрдИ", "рдбрдмреНрд▓реНрдпреВрдПрдирдПрд▓рдЖрдИ", " рд╣рдВрд╕"]
>>> рд╕рдВрджрд░реНрдн = [0, 1]
>>> рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = [0, 1]
>>> рдкрд░рд┐рдгрд╛рдо = рдЧреЛрдВрдж_рдореЗрдЯреНрд░рд┐рдХ.рдХрдВрдкреНрдпреВрдЯ(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд╕рдВрджрд░реНрдн=рд╕рдВрджрд░реНрдн)
>>> рдкреНрд░рд┐рдВрдЯ(рдкрд░рд┐рдгрд╛рдо)
{'рд╕рдЯреАрдХрддрд╛': 1.0}

>>> рдЧреЛрдВрдж_рдореЗрдЯреНрд░рд┐рдХ = рдбреЗрдЯрд╛рд╕реЗрдЯ.рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ ('рдЧреЛрдВрдж', 'рдПрдордЖрд░рдкреАрд╕реА') # 'рдПрдордЖрд░рдкреАрд╕реА' рдпрд╛ 'рдХреНрдпреВрдХреНрдпреВрдкреА'
>>> рд╕рдВрджрд░реНрдн = [0, 1]
>>> рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = [0, 1]
>>> рдкрд░рд┐рдгрд╛рдо = рдЧреЛрдВрдж_рдореАрдЯреНрд░рд┐рдХ.рдХрдВрдкреНрдпреВрдЯ(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирдХреНрд░рд┐рдпрд╛рдПрдБ, рд╕рдиреНрджрд░реНрдн = рд╕рдиреНрджрд░реНрдн)
>>> рдкреНрд░рд┐рдВрдЯ(рдкрд░рд┐рдгрд╛рдо)
{'рд╕рдЯреАрдХрддрд╛': 1.0, 'рдПрдл1': 1.0}

>>> рдЧреЛрдВрдж_рдореЗрдЯреНрд░рд┐рдХ = рдбреЗрдЯрд╛рд╕реЗрдЯ.рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ ('рдЧреЛрдВрдж', 'рдПрд╕рдЯреАрдПрд╕рдмреА')
>>> рд╕рдВрджрд░реНрдн = [0., 1., 2., 3., 4., 5.]
>>> рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = [0., 1., 2., 3., 4., 5.]
>>> рдкрд░рд┐рдгрд╛рдо = рдЧреЛрдВрдж_рдореЗрдЯреНрд░рд┐рдХ.рдХрдВрдкреНрдпреВрдЯ(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд╕рдВрджрд░реНрдн=рд╕рдВрджрд░реНрдн)
>>> рдкреНрд░рд┐рдВрдЯ({"рдкреАрдпрд░рд╕рди": рд░рд╛рдЙрдВрдб(рдкрд░рд┐рдгрд╛рдо["рдкреАрдпрд░рд╕рди"], 2), "рд╕реНрдкреАрдпрд░рдореИрдирд░": рд░рд╛рдЙрдВрдб(рдкрд░рд┐рдгрд╛рдо["рд╕реНрдкреАрдпрд░рдореИрди"], 2)})
{'рдкрд┐рдпрд░реНрд╕рди': 1.0, 'рд╕реНрдкреАрдпрд░рдореИрди': 1.0}

>>> рдЧреЛрдВрдж_рдореЗрдЯреНрд░рд┐рдХ = рдбреЗрдЯрд╛рд╕реЗрдЯ.рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ ('рдЧреЛрдВрдж', 'рдХреЛрд▓рд╛')
>>> рджреЗрдЦреЗрдВрдПрдиреНрд╕реЗрд╕ = [0, 1]
>>> рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = [0, 1]
>>> рдкрд░рд┐рдгрд╛рдо = рдЧреЛрдВрдж_рдореЗрдЯреНрд░рд┐рдХ.рдХрдВрдкреНрдпреВрдЯ(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд╕рдВрджрд░реНрдн=рд╕рдВрджрд░реНрдн)
>>> рдкреНрд░рд┐рдВрдЯ(рдкрд░рд┐рдгрд╛рдо)
{'рдореИрдереНрдпреВрдЬрд╝_рд╕рд╣рд╕рдВрдмрдВрдз': 1.0}
""", рд╕рдВрдЧреНрд░рд╣реАрдд рдЙрджрд╛рд╣рд░рдг: 0)

рдореАрдЯреНрд░рд┐рдХ рдХреА 'рдЧрдгрдирд╛' рд╡рд┐рдзрд┐ рдХреЛ рд╕реАрдзреЗ рдХреЙрд▓ рдХрд░реЗрдВ, рдореАрдЯреНрд░рд┐рдХ рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 'рд▓реЗрдмрд▓' рдФрд░ 'рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ' рдкрд╛рд╕ рдХрд░реЗрдВ:

```рдЕрдЬрдЧрд░
рдПрдирдкреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реБрдиреНрди рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдирдХрд▓реА_рдкреНрд░реЗрдб = np.random.randint(0, 2, рдЖрдХрд╛рд░=(64,))
рдирдХрд▓реА_рд▓реЗрдмрд▓ = np.random.randint(0, 2, рдЖрдХрд╛рд░=(64,))
metric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рдирдХрд▓реА_рдкреНрд░реЗрдб, рд╕рдВрджрд░реНрдн=рдирдХрд▓реА_рд▓реЗрдмрд▓)
```

{'рдорд╛tthews_correlation': 0.1513518081969605}

рдкреНрд░рддреНрдпреЗрдХ рдкрд╛рда рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдореАрдЯреНрд░рд┐рдХ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╣реИ, рдЬреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ:

- CoLA рдХреЗ рд▓рд┐рдП: [рдореИрдереНрдпреВрдЬрд╝ рд╕рд╣рд╕рдВрдмрдВрдз рдЧреБрдгрд╛рдВрдХ](https://en.wikipedia.org/wiki/Matthews_correlation_coefficient)
- рдПрдордПрдирдПрд▓рдЖрдИ рдХреЗ рд▓рд┐рдП (рдорд┐рд▓рд╛рди рдпрд╛ рдмреЗрдореЗрд▓): рд╕рдЯреАрдХрддрд╛
- рдПрдордЖрд░рдкреАрд╕реА рдХреЗ рд▓рд┐рдП: рд╕рдЯреАрдХрддрд╛ рдФрд░ [рдПрдл1 рд╕реНрдХреЛрд░](https://en.wikipedia.org/wiki/F1_score)
- рдХреНрдпреВрдПрдирдПрд▓рдЖрдИ рдХреЗ рд▓рд┐рдП: рд╕рдЯреАрдХрддрд╛
- QQP рдХреЗ рд▓рд┐рдП: рд╕рдЯреАрдХрддрд╛ рдФрд░ [F1 рд╕реНрдХреЛрд░](https://en.wikipedia.org/wiki/F1_score)
- рдЖрд░рдЯреАрдИ рдХреЗ рд▓рд┐рдП: рд╕рдЯреАрдХрддрд╛
- рдПрд╕рдПрд╕рдЯреА-2 рдХреЗ рд▓рд┐рдП: рд╕рдЯреАрдХрддрд╛
- рдПрд╕рдЯреАрдПрд╕-рдмреА рдХреЗ рд▓рд┐рдП: [рдкреАрдИрдЖрдЧрдЬрдиреА рд╕рд╣рд╕рдВрдмрдВрдз рдЧреБрдгрд╛рдВрдХ](https://en.wikipedia.org/wiki/Pearson_correlation_coefficient) рдФрд░ [рд╕реНрдкреАрдпрд░рдореИрди_рд░реИрдВрдХ_рд╕рд╣рд╕рдВрдмрдВрдз_рдЧреБрдгрд╛рдВрдХ](https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient)
- рдбрдмреНрд▓реНрдпреВрдПрдирдПрд▓рдЖрдИ рдХреЗ рд▓рд┐рдП: рд╕рдЯреАрдХрддрд╛

рдЗрд╕рд▓рд┐рдП рдореАрдЯреНрд░рд┐рдХ рдХреЛ рдХрд╛рд░реНрдп рдХреЗ рд╕рд╛рде рд╕рдВрд░реЗрдЦрд┐рдд рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ

## рдбреЗрдЯрд╛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ

рдореЙрдбрд▓ рдореЗрдВ рдбреЗрдЯрд╛ рдлреАрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЯреВрд▓ рдХреЛ 'рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░' рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдкрд╣рд▓реЗ рдЗрдирдкреБрдЯ рдХреЛ рдЯреЛрдХрдирд╛рдЗрдЬрд╝ рдХрд░реЗрдВ, рдлрд┐рд░ рдЯреЛрдХрди рдХреЛ рд╕рд╣ рдореЗрдВ рдмрджрд▓реЗрдВрдкреНрд░реА-рдореЙрдбрд▓ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд░рд┐рд╕реНрдкреЙрдиреНрд╕рд┐рдВрдЧ рдЯреЛрдХрди рдЖрдИрдбреА, рдФрд░ рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░реЗрдВред

рдбреЗрдЯрд╛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЕрдкрдиреЗ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `AutoTokenizer.from_pretrained` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ:

- рд╣рдореЗрдВ рдПрдХ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдорд┐рд▓рддрд╛ рд╣реИ рдЬреЛ рдПрдХ-рдПрдХ рдХрд░рдХреЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред
- рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рдЕрдиреБрд░реВрдк рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рд╣рдо рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рд╢рдмреНрджрд╛рд╡рд▓реА рднреА рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ, рд╕рдЯреАрдХ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдЯреЛрдХрди рд╡реЛрдХabulary.

рдЗрд╕ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдЯреЛрдХрди рд╢рдмреНрджрд╛рд╡рд▓реА рдХреЛ рдХреИрд╢ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддрд╛рдХрд┐ рджреЛрдмрд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдкрд░ рдЗрд╕реЗ рджреЛрдмрд╛рд░рд╛ рдбрд╛рдЙрдирд▓реЛрдб рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(model_checkpoint, use_fast=True)
```

рдзреНрдпрд╛рди рджреЗрдВ: `use_fast=True` рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред PreTrainedTokenizerFast рдкреНрд░рдХрд╛рд░, рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди рдлрд╛рд╕реНрдЯ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ (рдЬреИрд╕реЗ рдорд▓реНрдЯреА-рдереНрд░реЗрдбреЗрдб рдлрд╛рд╕реНрдЯ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░) рдХреА рдХреБрдЫ рд╡рд┐рд╢реЗрд╖ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИрддреЗрдЬрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдирд╣реАрдВ рд╣реИ, рдмрд╕ рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдХреЛ рд╣рдЯрд╛ рджреЗрдВред

рдореЙрдбрд▓ рдХреЗ рдЕрдиреБрд░реВрдк рд▓рдЧрднрдЧ рд╕рднреА рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдореЗрдВ рддреЗрдЬрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рд╣реЛрддреЗ рд╣реИрдВред рд╣рдо [рдореЙрдбрд▓ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреЙрд░реЗрд╕реНрдкреЛрдВрдбреЗрдВрд╕ рдЯреЗрдмрд▓] (https://huggingface.co/transformers/index.html#) рдореЗрдВ рд╕рднреА рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдЕрдиреБрд░реВрдк рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдмрдбрд╝реА рдореЗрдЬ)ред

рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдПрдХрд▓ рдкрд╛рда рдпрд╛ рдкрд╛рда рдХреА рдПрдХ рдЬреЛрдбрд╝реА рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рдж рдкреНрд░рд╛рдкреНрдд рдбреЗрдЯрд╛ рдкреНрд░реА-рдЯреНрд░реЗрдирд┐рдВрдЧ рдореЙрдбрд▓ рдХреЗ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рд╕реЗ рдорд┐рд▓рддрд╛ рд╣реИ

```рдЕрдЬрдЧрд░
рдЯреЛрдХрдиizer ("рд╣реИрд▓реЛ, рдпрд╣ рдПрдХ рд╡рд╛рдХреНрдп!", "рдФрд░ рдпрд╣ рд╡рд╛рдХреНрдп рдЗрд╕рдХреЗ рд╕рд╛рде рдЬрд╛рддрд╛ рд╣реИред")
```

{'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [101, 7592, 1010, 2023, 2028, 6251, 999, 102, 1998, 2023, 6251, 3632, 2007, 2009, 1012, 102], 'рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}

рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдЪреБрдиреЗ рдЧрдП рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рд╣рдо рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рд╕реЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд░рд┐рдЯрд░реНрди рджреЗрдЦреЗрдВрдЧреЗред рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдФрд░ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдмреАрдЪ рдПрдХ-рд╕реЗ-рдПрдХ рдкрддреНрд░рд╛рдЪрд╛рд░ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдВ] (https:/) рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред /huggingface.co/transformers/preprocessing.html).

рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░реА-рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдбреЗрдЯрд╛ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдбреЗрдЯрд╛ рдкреНрд░рд╛рд░реВрдк рдХреЛ рдЬрд╛рдирдирд╛ рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВред

```рдЕрдЬрдЧрд░
Task_to_keys = {
"рдХреЛрд▓рд╛": ("рд╡рд╛рдХреНрдп", рдХреЛрдИ рдирд╣реАрдВ),
"рдПрдордПрдирдПрд▓рдЖрдИ": ("рдЖрдзрд╛рд░", "рдкрд░рд┐рдХрд▓реНрдкрдирд╛"),
"рдПрдордПрдирдПрд▓рдЖрдИ-рдПрдордПрдо": ("рдЖрдзрд╛рд░", "рдкрд░рд┐рдХрд▓реНрдкрдирд╛"),
"рдПрдордЖрд░рдкреАрд╕реА": ("рд╡рд╛рдХреНрдп1", "рд╡рд╛рдХреНрдп2"),
"qnli": ("рдкреНрд░рд╢реНрди", "рд╡рд╛рдХреНрдп"),
"qqp": ("рдкреНрд░рд╢реНрди1", "рдкреНрд░рд╢реНрди2"),
"рдЖрд░рдЯреАрдИ": ("рд╡рд╛рдХреНрдп1", "рд╡рд╛рдХреНрдп2"),
"sst2": ("рд╡рд╛рдХреНрдп", рдХреЛрдИ рдирд╣реАрдВ),
"stsb": ("рд╡рд╛рдХреНрдп1", "рд╡рд╛рдХреНрдп2"),
"рдбрдмреНрд▓реНрдпреВ.рдПрдирд▓реА": ("рд╡рд╛рдХреНрдп1", "рд╡рд╛рдХреНрдп2"),
}
```

рдбреЗрдЯрд╛ рдкреНрд░рд╛рд░реВрдк рдЬрд╛рдВрдЪреЗрдВ:

```рдЕрдЬрдЧрд░
рд╡рд╛рдХреНрдп1_рдХреБрдВрдЬреА, рд╡рд╛рдХреНрдп2_рдХреБрдВрдЬреА = рдХрд╛рд░реНрдп_рд╕реЗ_рдХреБрдВрдЬреА[рдХрд╛рд░реНрдп]
рдпрджрд┐ рд╡рд╛рдХреНрдп2_рдХреБрдВрдЬреА рдХреЛрдИ рдирд╣реАрдВ рд╣реИ:
рдкреНрд░рд┐рдВрдЯ(f"рд╡рд╛рдХреНрдп: {рдбреЗрдЯрд╛рд╕реЗрдЯ['рдЯреНрд░реЗрди'][0][sentence1_key]}")
рдЕрдиреНрдп:
рдкреНрд░рд┐рдВрдЯ(f"рд╡рд╛рдХреНрдп 1: {рдбреЗрдЯрд╛рд╕реЗрдЯ['рдЯреНрд░реЗрди'][0][рд╡рд╛рдХреНрдп1_рдХреБрдВрдЬреА]}")
рдкреНрд░рд┐рдВрдЯ(f"рд╡рд╛рдХреНрдп 2: {рдбреЗрдЯрд╛рд╕реЗрдЯ['рдЯреНрд░реЗрди'][0][sentence2_key]}")
```

рд╡рд╛рдХреНрдп: рд╣рдорд╛рд░реЗ рдорд┐рддреНрд░ рдЗрд╕ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ рдирд╣реАрдВ рдорд╛рдиреЗрдВрдЧреЗ, рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдЕрдЧрд▓реЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ рддреЛ рдЫреЛрдбрд╝ рд╣реА рджреЗрдВред

рдлрд┐рд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЛрдб рдХреЛ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдбрд╛рд▓реЗрдВ:

```рдЕрдЬрдЧрд░
рдбреАрдИрдПрдлрд╝ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕_рдлрдВрдХреНрд╢рдиреАрдкрд░(рдЙрджрд╛рд╣рд░рдг):
рдпрджрд┐ рд╡рд╛рдХреНрдп2_рдХреБрдВрдЬреА рдХреЛрдИ рдирд╣реАрдВ рд╣реИ:
рд╡рд╛рдкрд╕реА рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░(рдЙрджрд╛рд╣рд░рдг[рд╡рд╛рдХреНрдп1_рдХреБрдВрдЬреА], рдХрд╛рдЯ-рдЫрд╛рдБрдЯ=рд╕рддреНрдп)
рд╡рд╛рдкрд╕реА рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ (рдЙрджрд╛рд╣рд░рдг[рд╡рд╛рдХреНрдп1_рдХреА], рдЙрджрд╛рд╣рд░рдг[рд╡рд╛рдХреНрдп2_рдХреА], рдХрд╛рдЯ-рдЫрд╛рдБрдЯ=рд╕рддреНрдп)
```

рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдПрдХрд▓ рдирдореВрдиреЗ рдпрд╛ рдПрдХрд╛рдзрд┐рдХ рдирдореВрдиреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдпрджрд┐ рдЗрдирдкреБрдЯ рдПрдХрд╛рдзрд┐рдХ рдирдореВрдиреЗ рд╣реИ, рддреЛ рдПрдХ рд╕реВрдЪреА рд▓реМрдЯрд╛ рджреА рдЬрд╛рддреА рд╣реИ:

```рдЕрдЬрдЧрд░
рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕_рдлрдВрдХреНрд╢рди(рдбреЗрдЯрд╛рд╕реЗрдЯ['рдЯреНрд░реЗрди'][:5])
```

{'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [[101, 2256, 2814, 2180, 1005, 1056, 4965, 2023,4106, 1010, 2292, 2894, 1996, 2279, 2028, 2057, 16599, 1012, 102], [101, 2028, 2062, 18404, 2236, 3989, 1998, 1045, 1005, 1049, 3228, 2039, 1012, 102], [101, 2028, 2062, 18404, 2236, 398 9, 2030, 1045 , 1005, 1049, 3228, 2039, 1012, 102] 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ': [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ': [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 , 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 , 1, 1, 1, 1, 1, 1, 1, 1,1, 1, 1, 1, 1, 1, 1, 1, 1, 1,, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1 , 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 , 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]]}

рдЗрд╕рдХреЗ рдмрд╛рдж, рдбреЗрдЯрд╛рд╕реЗрдЯ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рд╕рднреА рдирдореВрдиреЛрдВ рдХреЛ рдореИрдк рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдФрд░ рд╕рднреА рдирдореВрдиреЛрдВ рдореЗрдВ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рддреИрдпрд╛рд░_рдЯреНрд░реЗрди_рдлреАрдЪрд░реНрд╕ рд▓рд╛рдЧреВ рдХрд░рдХреЗ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

```рдЕрдЬрдЧрд░
рдПрдиреНрдХреЛрдбреЗрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк (рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕_рдлрд╝рдВрдХреНрд╢рди, рдмреИрдЪ = рд╕рддреНрдп)
```

рдЗрд╕рд╕реЗ рднреА рдмреЗрд╣рддрд░, рд▓реМрдЯрд╛рдП рдЧрдП рдкрд░рд┐рдгрд╛рдо рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕реАрдП рд╣реЛрдВрдЧреЗрдЕрдЧрд▓реА рдмрд╛рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд░рддреЗ рд╕рдордп рдкреБрдирд░реНрдЧрдгрдирд╛ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╢реЗрдб рдХрд░реЗрдВ (рд▓реЗрдХрд┐рди рдпрд╣ рднреА рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдпрджрд┐ рдЗрдирдкреБрдЯ рдмрджрд▓рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдХреИрд╢ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ!) рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдлрд╝рдВрдХреНрд╢рди рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдкрд░рд┐рд╡рд░реНрддрди рд╣реИрдВ , рдХреИрд╢реНрдб рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрджрд┐ рдкрд░рд┐рд╡рд░реНрддрди рд╣реИрдВ, рддреЛ рдкреБрди: рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░реЗрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдЗрдирдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдирд╣реАрдВ рдмрджрд▓рддреЗ рд╣реИрдВ, рддреЛ рдЬрдм рдЖрдк рдЗрдирдкреБрдЯ рдмрджрд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдХреИрд╢ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░рдирд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╣реИред рд╕рд╛рдлрд╝ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ `load_from_cache_file=' рд╣реИ рдЧрд▓рдд` рдкреИрд░рд╛рдореАрдЯрд░редрдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдКрдкрд░ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ `рдмреИрдЪ = рдЯреНрд░реВ` рдкреИрд░рд╛рдореАрдЯрд░ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреА рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдорд╛рдирд╛рдВрддрд░ рдореЗрдВ рдЗрдирдкреБрдЯ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдереНрд░реЗрдбреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

## рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реЗрдВ

рдЕрдм рдЬрдм рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рд╣реИ, рддреЛ рд╣рдореЗрдВ рдЕрдкрдиреЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдФрд░ рдлрд┐рд░ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдПрдХ seq2seq рдХрд╛рд░реНрдп рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рд╣рдореЗрдВ рдПрдХ рдореЙрдбрд▓ рд╡рд░реНрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рдЗрд╕ рдХрд╛рд░реНрдп рдХреЛ рд╣рд▓ рдХрд░ рд╕рдХреЗ `AutoModelForSequenceClassification` рд╡рд░реНрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЗ рд╕рдорд╛рди, `from_pretrained` рдорд┐рд▓рд╛hod рд╣рдореЗрдВ рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдФрд░ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рднреА рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдореЙрдбрд▓ рдХреЛ рдХреИрд╢ рднреА рдХрд░реЗрдЧрд╛ рддрд╛рдХрд┐ рдореЙрдбрд▓ рдмрд╛рд░-рдмрд╛рд░ рдбрд╛рдЙрдирд▓реЛрдб рди рд╣реЛред

рдпрд╣ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдПрд╕рдЯреАрдПрд╕-рдмреА рдПрдХ рдкреНрд░рддрд┐рдЧрдорди рд╕рдорд╕реНрдпрд╛ рд╣реИ, рдФрд░ рдПрдордПрдирдПрд▓рдЖрдИ рдПрдХ 3-рд╡рд░реНрдЧреАрдХрд░рдг рд╕рдорд╕реНрдпрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForSequenceClassification, рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕, рдЯреНрд░реЗрдирд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ

num_labels = 3 рдпрджрд┐ рдХрд╛рд░реНрдп.рд╕реНрдЯрд╛рд░реНрдЯреНрд╕рд╡рд┐рде("рдПрдордПрдирдПрд▓рдЖрдИ") рдЕрдиреНрдпрдерд╛ 1 рдпрджрд┐ рдХрд╛рд░реНрдп ===рдПрд╕рдЯреАрдПрд╕рдмреА" рдЕрдиреНрдпрдерд╛ 2
рдореЙрдбрд▓ = AutoModelForSequenceClassification.from_pretrained(model_checkpoint, num_labels=num_labeрдПрд▓рдПрд╕)
```

рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 0%| | 0.00/268рдПрдо [00:00<?, ?рдмреА/рдПрд╕]

DistilBertForSequenceClassification рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░рддреЗ рд╕рдордп рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб рдкрд░ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рдХреБрдЫ рд╡рдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛: ['vocab_projector.weight', 'vocab_transform.weight', 'vocab_projector.bias', 'vocab_layer_norm.bias', 'vocab_transform.bias', 'vocab_layer_norm.weight']
- рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдЕрдиреНрдп рдХрд╛рд░реНрдп рдкрд░ рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЗ рд╕рд╛рде рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯрдлреЙрд░рд╕реАрдХреНрд╡реЗрдВрд╕рдХреНрд▓рд╛рд╕рд┐рдлрд┐рдХреЗрд╢рди рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддреЛ рдпрд╣ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╣реИture (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП BertForPreTraining рдореЙрдбрд▓ рд╕реЗ BertForSequenceClassification рдореЙрдбрд▓ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдирд╛)ред
- рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдРрд╕реЗ рдореЙрдбрд▓ рдХреЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ DistilBertForSequenceClassification рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЬрд┐рд╕рдХреЗ рдмрд┐рд▓реНрдХреБрд▓ рд╕рдорд╛рди рд╣реЛрдиреЗ рдХреА рдЖрдк рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддреЗ рд╣реИрдВ (BertForSequenceClassification рдореЙрдбрд▓ рд╕реЗ BertForSequenceClassification рдореЙрдбрд▓ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдирд╛) рддреЛ рдпрд╣ рдЕрдкреЗрдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИред
DistilBertForSequenceClassificationrSequenceClassification рдХреЗ рдХреБрдЫ рд╡рдЬрд╝рди рдХреЛ рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб рдкрд░ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░рдирдП рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдП рдЧрдП рд╣реИрдВ: ['pre_classifier.weight', 'classifier.weight', 'pre_classifier.bias', 'classifier.bias']
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдФрд░ рдЕрдиреБрдорд╛рди рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд╕рдВрднрд╡рддрдГ рдЗрд╕ рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрдирд╕реНрдЯреНрд░реАрдо рдХрд╛рд░реНрдп рдкрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░рд╛ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд╛рд░реНрдп рдПрдХ рдкрд╛рда рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рд╣реИ, рдФрд░ рд╣рдо рдПрдХ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рднрд╛рд╖рд╛ рдореЙрдбрд▓ рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ, рдпрд╣ рд╣рдореЗрдВ рд╕рдВрдХреЗрдд рджреЗрдЧрд╛ рдХрд┐ рдореЙрдбрд▓ рд▓реЛрдб рдХрд░рддреЗ рд╕рдордп рдХреБрдЫ рдмреЗрдЬреЛрдбрд╝ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреИрд░рд╛рдореАрдЯрд░ рд╣рдЯрд╛ рджрд┐рдП рдЧрдП рдереЗ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: рдкреВрд░реНрд╡ рдХрд╛ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдореБрдЦ -рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рднрд╛рд╖рд╛ рдореЙрдбрд▓ wрдЬреИрд╕рд╛ рдХрд┐ рдлреЗрдВрдХ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдкрд╛рда рд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдореБрдЦ рдХреЛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛)ред

`рдЯреНрд░реЗрдирд░` рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЙрдкрдХрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ 3 рдФрд░ рддрддреНрд╡реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрд┐рдВрдЧреНрд╕/рдкреИрд░рд╛рдореАрдЯрд░ [`рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреВрдореЗрдВрдЯреНрд╕`](https://huggingface.co/transformers/main_classes/trainer.html# рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░.рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕) рдЗрд╕ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрд┐рдВрдЧ рдореЗрдВ рд╡реЗ рд╕рднреА рдЧреБрдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВред

```рдЕрдЬрдЧрд░
рдореЗрдЯреНрд░рд┐рдХ_рдирд╛рдо = "рдкрд┐рдпрд░реНрд╕рди" рдпрджрд┐ рдХрд╛рд░реНрдп == "рдПрд╕рдЯреАрдПрд╕рдмреА" рдЕрдиреНрдпрдерд╛ "рдореИрдереНрдпреВрдЬрд╝_рд╕рд╣рд╕рдВрдмрдВрдз" рдпрджрд┐ рдХрд╛рд░реНрдп == "рдХреЛрд▓рд╛" рдЕрдиреНрдпрдерд╛ "рд╕рдЯреАрдХрддрд╛"

рддрд░реНрдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ(
"рдкрд░реАрдХреНрд╖рдг-рдЧреЛрдВрдж",
рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ = "рдпреБрдЧ",
save_strategy = "рдпреБрдЧ",
рд╕реАрдЦрдиреЗ рдХреА рджрд░=2e-5,
рдкреНрд░рддрд┐_рдбрд┐рд╡рд╛рдЗрд╕_рдЯреНрд░реЗрди_рдмреИрдЪ_рдЖрдХрд╛рд░=рдмреИрдЪ_рдЖрдХрд╛рд░,
рдкреНрд░рддрд┐_рдбрд┐рд╡рд╛рдЗрд╕_eval_batch_size=рдмреИрдЪ_рдЖрдХрд╛рд░,
num_train_epochs=5,
рд╡рдЬрд╝рди_рдХреНрд╖рдп=0.01,
Load_best_model_at_end=рд╕рддреНрдп,
metric_for_best_model=metric_name,
)
```

рдЙрдкрд░реЛрдХреНрдд рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ = "рдпреБрдЧ" рдкреИрд░рд╛рдореАрдЯрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЛрдб рдХреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдпреБрдЧ рдореЗрдВ рдПрдХ рд╕рддреНрдпрд╛рдкрди рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВрдЧреЗред

рдЙрдкрд░реЛрдХреНрдд рдмреИрдЪ_рдЖрдХрд╛рд░рдЗрд╕ рдиреЛрдЯрдмреБрдХ рд╕реЗ рдкрд╣рд▓реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ.

рдЕрдВрдд рдореЗрдВ, рдЪреВрдВрдХрд┐ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрд▓рдЧ-рдЕрд▓рдЧ рдореВрд▓реНрдпрд╛рдВрдХрди рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдХрд╛рд░реНрдп рдирд╛рдо рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдкрджреНрдзрддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдбреАрдИрдПрдлрд╝ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕(eval_pred):
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ, рд▓реЗрдмрд▓ = eval_pred
рдпрджрд┐ рдХрд╛рд░реНрдп != "stsb":
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = np.argmax(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ, рдЕрдХреНрд╖=1)
рдЕрдиреНрдп:
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ[:, 0]
рд╡рд╛рдкрд╕реА metric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд╕рдВрджрд░реНрдн=рд▓реЗрдмрд▓)
```

рд╕рднреА рдХреЛ `рдЯреНрд░реЗрдирд░` рдХреЛ рдкрд╛рд╕ рдХрд░реЗрдВ:

```рдЕрдЬрдЧрд░
рд╕рддреНрдпрд╛рдкрди_рдХреБрдВрдЬреА = "рд╕рддреНрдпрд╛рдкрди_рдмреЗрдореЗрд▓"рдпрджрд┐ рдХрд╛рд░реНрдп == "рдПрдордПрдирдПрд▓рдЖрдИ-рдПрдордПрдо" рдЕрдиреНрдпрдерд╛ "рд╕рддреНрдпрд╛рдкрди_рдорд┐рд▓рд╛рди" рдпрджрд┐ рдХрд╛рд░реНрдп == "рдПрдордПрдирдПрд▓рдЖрдИ" рдЕрдиреНрдпрдерд╛ "рд╕рддреНрдпрд╛рдкрди"
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
рдирдореВрдирд╛,
рддрд░реНрдХ,
рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдПрдиреНрдХреЛрдбреЗрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
eval_dataset=encoded_dataset[validation_key],
рдЯреЛрдХрдирдирд╛рдЗрдЬрд░=рдЯреЛрдХрдирд╛рдЗрдЬрд░,
рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ = рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕
)
```

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╢реБрд░реВ рдХрд░реЛ:

```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрд▓рдо рдореЗрдВ `DistilBertForSequenceClassification.forward` рдореЗрдВ рдХреЛрдИ рд╕рдВрдЧрдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: idx, рд╡рд╛рдХреНрдпред
***** рджреМрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг*****
рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 8551
рдпреБрдЧреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 5
рдкреНрд░рддрд┐ рдЙрдкрдХрд░рдг рддрд╛рддреНрдХрд╛рд▓рд┐рдХ рдмреИрдЪ рдЖрдХрд╛рд░ = 16
рдХреБрд▓ рдЯреНрд░реЗрди рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ (рд╕рдорд╛рдирд╛рдВрддрд░, рд╡рд┐рддрд░рд┐рдд рдФрд░ рд╕рдВрдЪрдп рд╕рд╣рд┐рдд) = 16
рдХреНрд░рдорд┐рдХ рд╕рдВрдЪрдп рдЪрд░рдг = 1
рдХреБрд▓ рдЕрдиреБрдХреВрд▓рди рдЪрд░рдг = 2675

<div>

<рдкреНрд░рдЧрддрд┐ рдорд╛рди='2675' рдЕрдзрд┐рдХрддрдо='2675' рд╢реИрд▓реА='рдЪреМрдбрд╝рд╛рдИ:300рдкреАрдПрдХреНрд╕; рдКрдВрдЪрд╛рдИ:20рдкреАрдПрдХреНрд╕; рд▓рдВрдмрд╡рдд-рд╕рдВрд░реЗрдЦрдг: рдордзреНрдп;'></рдкреНрд░рдЧрддрд┐>
[2675/2675 02:49, рдпреБрдЧ 5/5]
</div>
<рддрд╛рд▓рд┐рдХрд╛ рд╕реАрдорд╛ = "1" рд╡рд░реНрдЧ = "рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо">
<рд╕рд┐рд░>
<tr рд╢реИрд▓реА = "рдкрд╛рда-рд╕рдВрд░реЗрдЦрдг: рдмрд╛рдПрдБ;">
<th>рдпреБрдЧ</th>
<th>рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐</th>
<th>рд╕рддреНрдпрд╛рдкрди рд╣рд╛рдирд┐</th><th>рдореИрдереНрдпреВрдЬрд╝ рд╕рд╣рд╕рдВрдмрдВрдз</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0.525400</td>
<td>0.520955</td>
<td>0.409248</td>
</tr>
<tr>
<td>2</td>
<td>0.351600</td>
<td>0.570341</td>
<td>0.477499</td>
</tr>
<tr>
<td>3</td><td>0.236100</td>
<td>0.622785</td>
<td>0.499872</td>
</tr>
<tr>
<td>4</td>
<td>0.166300</td>
<td>0.806475</td>
<td>0.491623</td>
</tr>
<tr>
<td>5</td>
<td>0.125700</td>
<td>0.882225</td>
<td>0.513900</td>
</tr>
</tbody>
</рддрд╛рд▓рд┐рдХрд╛><p>

рдореВрд▓реНрдпрд╛рдВрдХрди рд╕реЗрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрд▓рдо рдбреА`DistilBertForSequenceClassification.forward` рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: idx, рд╡рд╛рдХреНрдпред
***** рдЪрд▓ рд░рд╣рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди *****
рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 1043
рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ = 16
рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рдЯреЗрд╕реНрдЯ-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-535 рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ
рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-535/config.json рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛
рдореЙрдбрд▓ рд╡рдЬрд╝рди test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-535/pytorch_model.bin рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛
рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-535/рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░_рдХреЙрдиреНрдлрд┐рдЧ.рдЬреЗрд╕рди рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИ рд╣реИ
рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди рдлрд╝рд╛рдЗрд▓ рдкрд░реАрдХреНрд╖рдг-рдЧреЛрдВрдж/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-535/рдПрд╕ рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИрд╡рд┐рд╢реЗрд╖_рдЯреЛрдХрди_рдорд╛рдирдЪрд┐рддреНрд░.json
рдореВрд▓реНрдпрд╛рдВрдХрди рд╕реЗрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрд▓рдо рдореЗрдВ `DistilBertForSequenceClassification.forward` рдореЗрдВ рдХреЛрдИ рд╕рдВрдЧрдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: idx, рд╡рд╛рдХреНрдпред
***** рдЪрд▓ рд░рд╣рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди *****
рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 1043
рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ = 16
рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рдЯреЗрд╕реНрдЯ-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-1070 рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ
рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-1070/config.json рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛
рдореЙрдбрд▓ рд╡рдЬрд╝рди test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-1070/pytorch_model.bin рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдЯреЗрд╕реНрдЯ-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-1070/рдЯреА рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИ рд╣реИokenizer_config.json
рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди рдлрд╝рд╛рдЗрд▓ test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-1070/рд╕реНрдкреЗрд╢рд▓_рдЯреЛрдХреЗрдВрд╕_рдореИрдк.рдЬреЗрд╕рди рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИ
рдореВрд▓реНрдпрд╛рдВрдХрди рд╕реЗрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрд▓рдо рдореЗрдВ `DistilBertForSequenceClassification.forward` рдореЗрдВ рдХреЛрдИ рд╕рдВрдЧрдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: idx, рд╡рд╛рдХреНрдпред
***** рдЪрд▓ рд░рд╣рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди *****
рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 1043
рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ = 16
рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рдЯреЗрд╕реНрдЯ-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-1605 рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ
рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-1605/config.json рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛
рдореЙрдбрд▓ рд╡рдЬрд╝рди рдкрд░реАрдХреНрд╖рдг-рдЧреЛрдВрдж/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-1605/рдкреАрдЖрдИрдЯреА рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛рдСрд░реНрдЪ_рдореЙрдбрд▓.рдмрд┐рди
рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-1605/рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░_рдХреЙрдиреНрдлрд╝рд┐рдЧ.json рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИ
рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди рдлрд╝рд╛рдЗрд▓ рдкрд░реАрдХреНрд╖рдг-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-1605/рд╕реНрдкреЗрд╢рд▓_рдЯреЛрдХреЗрдВрд╕_рдореИрдк.рдЬреЗрд╕рди рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИ
рдореВрд▓реНрдпрд╛рдВрдХрди рд╕реЗрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрд▓рдо рдореЗрдВ `DistilBertForSequenceClassification.forward` рдореЗрдВ рдХреЛрдИ рд╕рдВрдЧрдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: idx, рд╡рд╛рдХреНрдпред
***** рдЪрд▓ рд░рд╣рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди *****
рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 1043
рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ = 16
рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рдЯреЗрд╕реНрдЯ-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-2140 рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ
рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрд░реАрдХреНрд╖рдг-рдЧреЛрдВрдж/рдЪреЗрдХрдкреЛ рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛int-2140/config.json
рдореЙрдбрд▓ рд╡рдЬрд╝рди test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-2140/pytorch_model.bin рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛
рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-2140/рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░_рдХреЙрдиреНрдлрд╝рд┐рдЧ.json рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИ
рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди рдлрд╝рд╛рдЗрд▓ test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-2140/рд╕реНрдкреЗрд╢рд▓_рдЯреЛрдХреЗрдВрд╕_рдореИрдк.рдЬреЗрд╕рди рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИ
рдореВрд▓реНрдпрд╛рдВрдХрди рд╕реЗрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрд▓рдо рдореЗрдВ `DistilBertForSequenceClassification.forward` рдореЗрдВ рдХреЛрдИ рд╕рдВрдЧрдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: idx, рд╡рд╛рдХреНрдпред
***** рдЪрд▓ рд░рд╣рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди *****
рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 1043
рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ = 16
рдореЙрдбрд▓ рдЪреЗрдХрдкреЛ рд╕рд╣реЗрдЬрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИint рд╕реЗ рдкрд░реАрдХреНрд╖рдг-рдЧреЛрдВрдж/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-2675
рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-2675/config.json рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛
рдореЙрдбрд▓ рд╡рдЬрд╝рди test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-2675/pytorch_model.bin рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛
рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-2675/рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░_рдХреЙрдиреНрдлрд┐рдЧ.json рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИ
рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди рдлрд╝рд╛рдЗрд▓ test-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-2675/special_tokens_map.json рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИ

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреВрд░рд╛ рд╣реЛ рдЧрдпрд╛ред рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ huggingface.co/models рдкрд░ рд╕рд╛рдЭрд╛ рдХрд░рдирд╛ рди рднреВрд▓реЗрдВ =)

рдЯреЗрд╕реНрдЯ-рдЧреНрд▓реВ/рдЪреЗрдХрдкреЙрдЗрдВрдЯ-2675 рд╕реЗ рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда рдореЙрдбрд▓ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ (рд╕реНрдХреЛрд░: 0.5138995234247261)ред

рдЯреНрд░реЗрдирдЖрдЙрдЯрдкреБрдЯ(рдЧреНрд▓реЛрдмрд╛рдПрд▓_рд╕реНрдЯреЗрдк=2675, рдЯреНрд░реЗрдирд┐рдВрдЧ_рд▓реЙрд╕=0.27181456521292713, рдореЗрдЯреНрд░рд┐рдХреНрд╕={'рдЯреНрд░реЗрди_рд░рдирдЯрд╛рдЗрдо': 169.649, 'рдЯреНрд░реЗрди_рд╕реИрдВрдкрд▓реНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 252.02, 'рдЯреНрд░реЗрди_рд╕реНрдЯреЗрдкреНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 15.768, 'рдЯреЛрдЯрд▓_рдлреНрд▓реЛрд╕': 229537542078168.0, 'рдЯреНрд░реЗрди_ рд╣рд╛рдирд┐' : 0.27181456521292713, 'рдпреБрдЧ': 5.0})

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдмрд╛рдж рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВ:

```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ.рдореВрд▓реНрдпрд╛рдВрдХрди()
```

рдореВрд▓реНрдпрд╛рдВрдХрди рд╕реЗрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрд▓рдо рдореЗрдВ `DistilBertForSequenceClasssification.forward` рдореЗрдВ рдХреЛрдИ рд╕рдВрдЧрдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: idx, рд╡рд╛рдХреНрдпред
***** рдЪрд▓ рд░рд╣рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди *****
рд╕рдВрдЦреНрдпрд╛рдЙрджрд╛рд╣рд░рдг = 1043
рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ = 16

<div>

<рдкреНрд░рдЧрддрд┐ рдорд╛рди='66' рдЕрдзрд┐рдХрддрдо='66' рд╢реИрд▓реА='рдЪреМрдбрд╝рд╛рдИ:300рдкреАрдПрдХреНрд╕; рдКрдВрдЪрд╛рдИ:20рдкреАрдПрдХреНрд╕; рд▓рдВрдмрд╡рдд-рд╕рдВрд░реЗрдЦрдг: рдордзреНрдп;'></рдкреНрд░рдЧрддрд┐>
[66/66 00:00]
</div>

{'рдпреБрдЧ': 5.0,
'eval_los': 0.8822253346443176,
'eval_matthews_correlation': 0.5138995234247261,
'eval_runtime': 0.9319,
'eval_samples_рдкреНрд░рддрд┐_рд╕реЗрдХрдВрдб': 1119.255,
'рдЗрд╡рд▓_рд╕реНрдЯреЗрдкреНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 70.825}

рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдЖрдкрдХреЗ рдореЙрдбрд▓ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХреИрд╕рд╛ рд░рд╣рд╛, рдЖрдк рдЗрд╕рдХреА рддреБрд▓рдирд╛ [GLUE рдмреЗрдВрдЪрдорд╛рд░реНрдХ рд▓реАрдбрд░рдмреЛрд░реНрдб](https://gloebenchmark.com/leaderboard) рд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░ рд╕рд┐рдпрд░рдЪреМрдзрд░реА

`рдЯреНрд░реЗрдирд░` [рдСрдкреНрдЯреБрдирд╛] (https://optona.org/) рдпрд╛ [рд░реЗ рдЯреНрдпреВрди] (https://docs.ray.io/en/latest/tune/) рдХреЛрдб рдмреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░ рдЦреЛрдЬ рдХрд╛ рднреА рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

рдирд┐рд░реНрднрд░рддрд╛рдПрдБ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджреЛ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдЕрдирдХрдореНрдореЗрдВрдЯ рдХрд░реЗрдВ:

```рдЕрдЬрдЧрд░
! рдкрд┐рдк рдСрдкреНрдЯреБрдирд╛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ
! рдкрд┐рдк рдЗрдВрд╕реНрдЯрд╛рд▓ рд░реЗ[рдЯреНрдпреВрди]
```

рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░ рдЦреЛрдЬ рдХреЗ рджреМрд░рд╛рди, `рдЯреНрд░реЗрдирд░` рдХрдИ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рд▓реМрдЯрд╛рдПрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдПрдХ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдореЙрдбрд▓ рдореЗрдВ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ `рдЯреНрд░реЗрдирд░` рд▓рдЧрд╛рддрд╛рд░ рдкрд╛рд░рд┐рдд рдореЙрдбрд▓ рдХреЛ рдкреБрди: рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд╕рдХреЗ:

```рдЕрдЬрдЧрд░
рдбреАрдИрдПрдлрд╝ рдореЙрдбрд▓_рдЗрдирд┐рдЯ():
рдСрдЯреЛрдореЙрдбрд▓ рд▓реМрдЯрд╛рдПрдВForSequenceClassification.from_pretrained(model_checkpoint, num_labels=num_labels)
```

`рдЯреНрд░реЗрдирд░` рдХреЛ рдкрд┐рдЫрд▓реА рдХреЙрд▓ рдХреЗ рд╕рдорд╛рди:

```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
рдореЙрдбрд▓_рдЗрдирд┐рдЯ=рдореЙрдбрд▓_рдЗрдирд┐рдЯ,
рддрд░реНрдХ = рддрд░реНрдХ,
рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдПрдиреНрдХреЛрдбреЗрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
eval_dataset=encoded_dataset[validation_key],
рдЯреЛрдХрдирдирд╛рдЗрдЬрд░=рдЯреЛрдХрдирд╛рдЗрдЬрд░,
рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ = рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕
)
```

/root/.cache/huggingface/transformers/23454919 рдкрд░ рдХреИрд╢ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ https://huggingface.co/distilbert-base-uncased/resolve/main/config.json рд▓реЛрдб рд╣реЛ рд░рд╣реА рд╣реИ702d26495337f3da04d1655c7ee010d5ec9d77bdb9e399e00302c0a1.d423bdf2f58dc8b77d5f5d18028d7ae4a72dcfd8f468e81fe979ada957a8c361
рдореЙрдбрд▓ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди DistilBertConfig {
"рд╕рдХреНрд░рд┐рдпрдг": "рдЧреЗрд▓реБ",
"рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░": [
"рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯрдлреЙрд░рдорд╛рд╕реНрдХрдбрдПрд▓рдПрдо"
],
"рдЕрдЯреЗрдВрд╢рди_рдбреНрд░реЙрдкрдЖрдЙрдЯ": 0.1,
"рдордВрдж": 768,
"рдбреНрд░реЙрдкрдЖрдЙрдЯ": 0.1,
"hidden_dim": 3072,
"рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝рд░_рд░реЗрдВрдЬ": 0.02,
"max_position_embeddings": 512,
"рдореЙрдбрд▓_рдкреНрд░рдХрд╛рд░": "рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ",
"рдПрди_рд╣реЗрдбреНрд╕": 12,
"рдПрди_рд▓реЗрдпрд░реНрд╕": 6,
"рдкреИрдб_рдЯреЛрдХрди_рдЖрдИрдбреА": 0,
"qa_dropout": 0.1, "seq_classif_dropout": 0.2,
"sinusoidal_pos_embds": рдЕрд╕рддреНрдп,
"рдЯрд╛рдИ_рд╡реЗрдЯ_": рд╕рддреНрдп,
"рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░_рд╕рдВрд╕реНрдХрд░рдг": "4.9.1",
"vocab_size": 30522
}

/root/.cache/huggingface/transformers/9c169103d7e5a73936dd2b627e42851bec0831212b677c637033ee4bce9ab5ee.126183e36 рдкрд░ рд╡реЗрдЯ рдлрд╝рд╛рдЗрд▓ https://huggingface.co/distilbert-base-uncased/resolve/main/pytorch_model.bin рд▓реЛрдб рд╣реЛ рд░рд╣реА рд╣реИ 6 6 67471617ae2f0835fab707baa54b731f991507ebbb55ea85adb12a
DistilBertForSequenceClassification рдкреНрд░рд╛рд░рдВрдн рдХрд░рддреЗ рд╕рдордп рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб рдкрд░ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рдХреБрдЫ рд╡рдЬрд╝рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛:['vocab_projector.weight', 'vocab_transform.weight', 'vocab_projector.bias', 'vocab_layer_norm.bias', 'vocab_transform.bias', 'vocab_layer_norm.weight']
- рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдЕрдиреНрдп рдХрд╛рд░реНрдп рдкрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЗ рд╕рд╛рде DistilBertForSequenceClassification рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд░рд╣реЗ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП BertForPreTraining рдореЙрдбрд▓ рд╕реЗ BertForSequenceClassification рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдирд╛) рддреЛ рдпрд╣ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╣реИред
- рдпрджрд┐ рдЖрдк DistilBertForSequenceClassification рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддреЛ рдпрд╣ рдЕрдкреЗрдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИрдХрд┐рд╕реА рдореЙрдбрд▓ рдХрд╛ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдЬрд┐рд╕рдХреЗ рдмрд┐рд▓реНрдХреБрд▓ рд╕рдорд╛рди рд╣реЛрдиреЗ рдХреА рдЖрдк рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддреЗ рд╣реИрдВ (рдПрдХ BertForSequenceClassification рдореЙрдбрд▓ рд╕реЗ BertForSequenceClassification рдореЙрдбрд▓ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдирд╛)ред
DistilBertForSequenceClassification рдХреЗ рдХреБрдЫ рдирдП рд╡рдЬрд╝рди рдХреЛ рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб рдкрд░ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдЗрдиреНрд╣реЗрдВ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: ['pre_classifier.weight', 'classifier.weight', 'pre_classifier.bias', 'classifier.bias']
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд╕рдВрднрд╡рддрдГ рдЗрд╕ рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрдирд╕реНрдЯреНрд░реАрдо рдХрд╛рд░реНрдп рдкрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПрдЕрдиреБрдорд╛рди.

рд╡рд┐рдзрд┐ рдХреЛ `рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░_рд╕рд░реНрдЪ` рдХрд╣реЗрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд▓рдВрдмрд╛ рд╕рдордп рд▓рдЧ рд╕рдХрддрд╛ рд╣реИред рд╣рдо рдкрд╣рд▓реЗ рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░ рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдкреВрд░реА рдорд╛рддреНрд░рд╛ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдХрд╛ 1/10 рднрд╛рдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

```рдЕрдЬрдЧрд░
best_run = trainer.hyperparameter_search(n_trials=10, рджрд┐рд╢рд╛ = "рдЕрдзрд┐рдХрддрдо")
```

`hyperparameter_search` рд╕рд░реНрд╡реЛрддреНрддрдо рдореЙрдбрд▓ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рд▓реМрдЯрд╛рдПрдЧрд╛:

```рдЕрдЬрдЧрд░
best_run
```

`рдЯреНрд░реЗрдирд░` рдХреЛ рд╕рд░реНрд╡реЛрддреНрддрдо рдкрд╛рдП рдЧрдП рдорд╛рдкрджрдВрдбреЛрдВ рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВ:

```рдЕрдЬрдЧрд░best_run.hyperparameters.items() рдореЗрдВ n, v рдХреЗ рд▓рд┐рдП:
setattr(trainer.args, n, v)

рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()```

рдЕрдВрдд рдореЗрдВ, рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рди рднреВрд▓реЗрдВ рдХрд┐ рдореЙрдбрд▓ рдХреИрд╕реЗ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ, рдореЙрдбрд▓ рдХреЛ [ЁЯдЧ рдореЙрдбрд▓ рд╣рдм](https://huggingface.co/models) рдкрд░ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ, рдлрд┐рд░ рдЖрдк рдореЙрдбрд▓ рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реАрдзреЗ рдЕрдкрд▓реЛрдб рдХрд┐рдП рдЧрдП рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдмрд┐рд▓реНрдХреБрд▓ рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреА рд╢реБрд░реБрдЖрдд рдХреА рддрд░рд╣ред

```рдЕрдЬрдЧрд░

```