рдЗрд╕ рд▓реЗрдЦ рдХреЗ рд▓рд┐рдП рд╕рдВрджрд░реНрдн рд╕рд╛рдордЧреНрд░реА [рд╣рдЧрд┐рдВрдЧ рдлреЗрд╕ рд╣реЛрдордкреЗрдЬ] (https://huggingface.co/) рдкрд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рддрд╣рдд рдкрд╛рдареНрдпрдХреНрд░рдо рд╣реИ, рдЬреЛ рдЕрдВрд╢ рдФрд░ рд╡реНрдпрд╛рдЦреНрдпрд╛ (рдмреЛрд▓реНрдб рдЗрдЯреИрд▓рд┐рдХ рдореЗрдВ) рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЯреНрд░реЗрдирд░ рдХреЗ рдореБрдЦреНрдп рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд░рд┐рдЪрдп рднреА рдЬреЛрдбрд╝рддрд╛ рд╣реИред рдФрд░ рддрд░реНрдХред рдЗрдЪреНрдЫреБрдХ рдЫрд╛рддреНрд░ [рдореВрд▓ рдкрд╛рда](https://huggingface.co/course/chapter1) рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
****
рдЗрд╕ рдЕрдзреНрдпрд╛рдп рдХреА рдореБрдЦреНрдп рд╕рд╛рдордЧреНрд░реА рдореЗрдВ рджреЛ рднрд╛рдЧ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:
- рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдЯреВрд▓ рдПрдирдПрд▓рдкреА рдХрд╛рд░реНрдп рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ
- рдЯреНрд░реЗрдирд░ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдореЙрдбрд▓ рдмрдирд╛рдПрдВ<br>

рдЕрдВрддрд░реНрд╡рд╕реНрддреБ
-[1. рдкрд░рд┐рдЪрдп](#1--рдкрд░рд┐рдЪрдп)
- [рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕](#рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕)
- [рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдФрд░ рдЪреМрдХрд┐рдпрд╛рдВ](#рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдФрд░ рдЪреМрдХрд┐рдпрд╛рдВ)
- [рдЕрдиреБрдорд╛рди рдПрдкреАрдЖрдИ](#рдж-рдЕрдиреБрдорд╛рди-рдПрдкреАрдЖрдИ)
- [2. рдПрдирдПрд▓рдкреА рд╕рдорд╕реНрдпрд╛рдУрдВ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛](#2-рдПрдирдПрд▓рдкреА рд╕рдорд╕реНрдпрд╛рдУрдВ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛)
- [3. рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рдкреАрдЫреЗ](#3-рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рдкреАрдЫреЗ)
- [рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдкреНрд░реА-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ](#3-рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рдкреАрдЫреЗ)=рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ](#рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдкреНрд░реА-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ)
- [рдПрдХ рдореЙрдбрд▓ рдЪреБрдиреЗрдВ](#рдПрдХ рдореЙрдбрд▓ рдЪреБрдиреЗрдВ)
- [рдореЙрдбрд▓ рдкреНрд░рдореБрдЦ](#рдореЙрдбрд▓-рдкреНрд░рдореБрдЦ)- [рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ](#рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ)
- [4. рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рдмрдирд╛рдПрдВ](#4-рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░-рдПрдкреАрдЖрдИ рдмрдирд╛рдПрдВ)
- [рд╣рдм рд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ](#рд╣рдм рд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ)
- [рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдбреЗрдЯрд╛рд╕реЗрдЯ](#рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдбреЗрдЯрд╛рд╕реЗрдЯ)
- [рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PyTorch рдореЗрдВ рдлрд╛рдЗрди-рдЯреНрдпреВрди](# -trainer-api- рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PyTorch рдореЗрдВ рдлрд╛рдЗрди-рдЯреНрдпреВрди)
- [рдкреНрд░рд╢рд┐рдХреНрд╖рдг](#рдкреНрд░рд╢рд┐рдХреНрд╖рдг)
- [рдореВрд▓реНрдпрд╛рдВрдХрди рд╕рдорд╛рд░реЛрд╣](#рдореВрд▓реНрдпрд╛рдВрдХрди рд╕рдорд╛рд░реЛрд╣)
- [5. рдЕрдиреБрдкреВрд░рдХ рдЕрдиреБрднрд╛рдЧ](#5-рдЕрдиреБрдкреВрд░рдХ рдЕрдиреБрднрд╛рдЧ)
- [рдЪреМрдерд╛ рдЪрд╛ рдХреНрдпреЛрдВ рдХрд░рддрд╛ рд╣реИрдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреЗ рд╢рд┐рдХреНрд╖рдХ рдореЙрдбрд▓ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ? ](#рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХрд╛ рдЪреМрдерд╛ рдЕрдзреНрдпрд╛рдп рдореЙрдбрд▓ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдХрд░рддрд╛ рд╣реИ)
- [рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдореБрдЦреНрдп рдкреИрд░рд╛рдореАрдЯрд░](# рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдореБрдЦреНрдп рдкреИрд░рд╛рдореАрдЯрд░)
- [рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓ рд▓реЛрдбрд┐рдВрдЧ рд╡рд┐рдзрд┐рдпрд╛рдВ](#рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓ рд▓реЛрдбрд┐рдВрдЧ рд╡рд┐рдзрд┐рдпрд╛рдВ)
- [рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧтАФтАФрдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ рддрдХрдиреАрдХ](#рдбрд╛рдпрдирд╛рдорд┐рдХ-рдкреИрдбрд┐рдВрдЧрдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ рддрдХрдиреАрдХ)

## 1 рдкрд░рд┐рдЪрдп
рдпрд╣ рдЕрдзреНрдпрд╛рдп [рд╣рдЧрд┐рдВрдЧ рдлреЗрд╕ рдЗрдХреЛрд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд▓рд╛рдЗрдмреНрд░реЗрд░реА](https://github.com/huggingface) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛тАФтАФЁЯдЧ рдЯреНрд░реИрдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг (рдПрдирдПрд▓рдкреА) рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдирдПрд╕рдлреЙрд░реНрдорд░реНрд╕ред
### рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреЗ (рд╕рдВрдХреНрд╖рд┐рдкреНрдд) рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рдХреБрдЫ рд╕рдВрджрд░реНрдн рдмрд┐рдВрджреБ рдпрд╣рд╛рдВ рджрд┐рдП рдЧрдП рд╣реИрдВ:
![рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕_рдХреНрд░реЛрдиреЛ](https://img-blog.csdnimg.cn/3ba51fe4f21d4d528ca7b0f2fd78aee4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA56We5rSb5Y2O,size_ 20,рд░рдВрдЧ_FFFFFF,t_70,g_se,x_16#рддрд╕реНрд╡реАрд░_рдХреЗрдВрджреНрд░)
[рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░](https://arxiv.org/abs/1706.03762) рдЬреВрди 2017 рдореЗрдВ рдкреНрд░рдХрд╛рд╢рд┐рдд рд╣реБрдЖ рдерд╛ред рдореВрд▓ рд╢реЛрдзрдЖрд░рд╕реА рдиреЗ рдЕрдиреБрд╡рд╛рдж рдХрд╛рд░реНрдпреЛрдВ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд┐рдпрд╛, рдЬрд┐рд╕рдореЗрдВ рдХрдИ рдкреНрд░рднрд╛рд╡рд╢рд╛рд▓реА рдореЙрдбрд▓ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- рдЬреВрди 2018: [рдЬреАрдкреАрдЯреА](https://cdn.openai.com/research-covers/рднрд╛рд╖рд╛-рдЕрдирд╕реБрдкрд░рд╡рд╛рдЗрдЬреНрдб/рднрд╛рд╖рд╛_рдЕрдВрдбрд░рд╕реНрдЯреИрдВрдбрд┐рдВрдЧ_рдкреЗрдкрд░.рдкреАрдбреАрдПрдл), рдкрд╣рд▓рд╛ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдЬрд┐рд╕реЗ рд╡рд┐рднрд┐рдиреНрди рдПрдирдПрд▓рдкреА рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдареАрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рд╕реНрдерд┐рддрд┐ рд╣рд╛рд╕рд┐рд▓ рдХреА рдереА -рдЕрддреНрдпрд╛рдзреБрдирд┐рдХ рдкрд░рд┐рдгрд╛рдо

- рдЕрдХреНрдЯреВрдмрд░ 2018: [BERT](https://arxiv.org/abs/1810.04805), рдмреЗрд╣рддрд░ рд╡рд╛рдХреНрдп рд╕рд╛рд░рд╛рдВрд╢ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдПрдХ рдФрд░ рдмрдбрд╝рд╛ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ (рдЕрдЧрд▓реЗ рдЕрдзреНрдпрд╛рдп рдореЗрдВ рдЗрд╕ рдкрд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА!)

-рдлрд░рд╡рд░реАary 2019: [GPT-2](https://cdn.openai.com/better-рднрд╛рд╖рд╛-рдореЙрдбрд▓/рднрд╛рд╖рд╛_рдореЙрдбрд▓_are_unsupervised_multitask_learners.pdf), GPT рдХрд╛ рдПрдХ рдЙрдиреНрдирдд (рдФрд░ рдмрдбрд╝рд╛) рд╕рдВрд╕реНрдХрд░рдг рдЬрд┐рд╕реЗ рдиреИрддрд┐рдХ рдЪрд┐рдВрддрд╛рдУрдВ рдХреЗ рдХрд╛рд░рдг рддреБрд░рдВрдд рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЬрд╛рд░реА рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛

- рдЕрдХреНрдЯреВрдмрд░ 2019: [BERT](https://arxiv.org/abs/1810.04805), рдПрдХ рдФрд░ рдмрдбрд╝рд╛ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдЬрд┐рд╕реЗ рдмреЗрд╣рддрд░ рд╡рд╛рдХреНрдп рд╕рд╛рд░рд╛рдВрд╢ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ (рдЕрдЧрд▓реЗ рдЕрдзреНрдпрд╛рдп рдореЗрдВ рдЗрд╕ рдкрд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА!) рдорд╣реАрдирд╛: [DistilBERT] (https://arxiv.org/abs/1910.01108), BERT рдХрд╛ рдПрдХ рдЖрд╕реБрдд рд╕рдВрд╕реНрдХрд░рдг60% рддреЗрдЬрд╝ рд╣реИ рдФрд░ 40% рдХрдо рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА BERT рдХреЗ 97% рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдмрд░рдХрд░рд╛рд░ рд░рдЦрддрд╛ рд╣реИ
- рдЕрдХреНрдЯреВрдмрд░ 2019: [BART](https://arxiv.org/abs/1910.13461) рдФрд░ [T5](https://arxiv.org/abs/1910.10683), рджреЛ рдмрдбрд╝реЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдЬреЛ рд╕рдорд╛рди рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдореВрд▓ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ (рдРрд╕рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдкрд╣рд▓рд╛)
- рдордИ 2020: [рдЬреАрдкреАрдЯреА-3](https://arxiv.org/abs/2005.14165), рдЬреАрдкреАрдЯреА-2 рдХрд╛ рдПрдХ рдмрдбрд╝рд╛ рд╕рдВрд╕реНрдХрд░рдг рдЬреЛ рдмрд┐рдирд╛ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпреЛрдВ рдкрд░ рдЕрдЪреНрдЫрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддрд╛ рд╣реИ (рдЬрд┐рд╕реЗ рдЬреАрд░реЛ-рд╢реЙрдЯ рд▓рд░реНрдирд┐рдВрдЧ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ)

рдпрд╣ рд╕реВрдЪреА рд╡реНрдпрд╛рдкрдХ рдирд╣реАрдВ рд╣реИ,рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдХреБрдЫ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓реЛрдВ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдирд╛ рд╣реИ, рд╕рд╛рдорд╛рдиреНрдпрддрдпрд╛, рдЙрдиреНрд╣реЗрдВ рддреАрди рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

- рдЬреАрдкреАрдЯреА (рдХреЗрд╡рд▓ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░-рдбрд┐рдХреЛрдбрд░ рднрд╛рдЧ, рдСрдЯреЛрд░реЗрдЧреНрд░реЗрд╕рд┐рд╡ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ)
- BERT (рдХреЗрд╡рд▓ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░-рдПрдирдХреЛрдбрд░ рднрд╛рдЧ, рдСрдЯреЛрдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ)
- BART/T5 (рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░-рдПрдирдХреЛрдбрд░-рдбрд┐рдХреЛрдбрд░ рдореЙрдбрд▓)

### рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдФрд░ рдЪреМрдХрд┐рдпрд╛рдБ
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреЗ рдЕрдзреНрдпрдпрди рдореЗрдВ, рдХреБрдЫ рд╢рдмреНрдж рд╕рд╛рдордиреЗ рдЖрдПрдВрдЧреЗ: рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдФрд░ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдФрд░рдореЙрдбрд▓ред рдЗрди рд╢рдмреНрджреЛрдВ рдХреЗ рдереЛрдбрд╝реЗ рдЕрд▓рдЧ рдЕрд░реНрде рд╣реИрдВ:

рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░: рдореЙрдбрд▓ рдХреА рдореВрд▓ рд╕рдВрд░рдЪрдирд╛ рдФрд░ рдмреБрдирд┐рдпрд╛рджреА рд╕рдВрдЪрд╛рд▓рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ

рдЪреЗрдХрдкреЙрдЗрдВрдЯ: рдореЙрдбрд▓ рдХреА рдПрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реНрдерд┐рддрд┐, рдЗрд╕ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдЗрд╕ рд╕рдордп рд╡рдЬрди рд▓реЛрдб рд╣реЛ рдЬрд╛рдПрдЧрд╛ (рдЖрдк рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рд╣реЗрдЬрдирд╛ рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ)ред

рдореЙрдбрд▓: рдпрд╣ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╢рдмреНрдж рд╣реИ, "рд╡рд╛рд╕реНрддреБрдХрд▓рд╛" рдпрд╛ "рдЪреЗрдХрдкреЙрдЗрдВрдЯ" рдЬрд┐рддрдирд╛ рд╕рдЯреАрдХ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рджреЛрдиреЛрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдЕрд╕реНрдкрд╖реНрдЯрддрд╛ рдХреЛ рдХрдо рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ, рддреЛ рдпрд╣ рдкрд╛рдареНрдпрдХреНрд░рдо рд╡рд╛рд╕реНрддреБрдХрд╛рд░ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдЧрд╛рдИ рдпрд╛ рдЪреЗрдХрдкреЙрдЗрдВрдЯ
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдмреАрдИрдЖрд░рдЯреА рдПрдХ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рд╣реИ, рдФрд░ рдмрд░реНрдЯ-рдмреЗрд╕-рдХреЗрд╕реНрдб (рдмреАрдИрдЖрд░рдЯреА рдХреЗ рдкрд╣рд▓реЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП Google рдЯреАрдо рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рд╡рдЬрди рдХрд╛ рдПрдХ рд╕реЗрдЯ) рдПрдХ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк "рдмреАрдИрдЖрд░рдЯреА рдореЙрдбрд▓" рдФрд░ "рдмрд░реНрдЯ-" рдХрд╣ рд╕рдХрддреЗ рд╣реИрдВред рдмреЗрд╕-рдХреЗрд╕реНрдб рдореЙрдбрд▓"ред

*** рдмрдбрд╝реЗ рдбреЗрдЯрд╛ рдореЗрдВ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреА рдЕрд╡рдзрд╛рд░рдгрд╛ рдХрд╛ рдЕрдзрд┐рдХ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрдм рдкреНрд░рд╢рд┐рдХреНрд╖рдг, рдореЙрдбрд▓ рдХреЛ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рдкрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рд╣реЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореЙрдбрд▓ рдХреЛ рдПрдХ рдпреБрдЧ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ), рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдЕрджреНрдпрддрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ред рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдореЙрдбрд▓ рдХреЛ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛рдПрдХ рдЪреМрдХреА рдХреЗ рд░реВрдк рдореЗрдВ)
рдЗрд╕рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдореЙрдбрд▓ рдХреА рд╕реНрдерд┐рддрд┐ рдФрд░ рд╡рдЬрд╝рди рдХреЗ рдПрдХ рд╕реЗрдЯ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдЗрд╡реЗрдВрдЯ рд╣реИ, рдФрд░ рдЗрд╕рдХрд╛ рдореВрд▓ рдЙрджреНрджреЗрд╢реНрдп рдХреНрд░реИрд╢ рд╕рдордп рдХреЛ рдХрдо рдХрд░рдирд╛ рд╣реИ, рдпрд╛рдиреА рдбреЗрдЯрд╛рдмреЗрд╕ рдХреНрд░реИрд╢ рдХреЗ рдмрд╛рдж рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд╕рдордп рдХреЛ рдХрдо рдХрд░рдирд╛ рдПрдХ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕реНрдерд┐рддрд┐ рдХреЗ рдХрд╛рд░рдг.
### рдЕрдиреБрдорд╛рди рдПрдкреАрдЖрдИ
[рдореЙрдбрд▓ рд╣рдм](https://huggingface.co/models) рдореЗрдВ рдмрд╣реБрднрд╛рд╖реА рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЖрдк рднрд╛рд╖рд╛ рд▓реЗрдмрд▓ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рдЦреЛрдЬ рдХреЛ рдкрд░рд┐рд╖реНрдХреГрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рдПрдХ рдореЛрдб рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрдПрд▓ рдЬреЛ рджреВрд╕рд░реА рднрд╛рд╖рд╛ рдореЗрдВ рдЯреЗрдХреНрд╕реНрдЯ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред

рдХрд┐рд╕реА рдореЙрдбрд▓ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдкрдХреЛ рдПрдХ рд╡рд┐рдЬреЗрдЯ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ - рдЗрдВрдлрд╝рд░реЗрдВрд╕ рдПрдкреАрдЖрдИ (рдСрдирд▓рд╛рдЗрди рдкрд░реАрдХреНрд╖рдг рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ)ред рдпрд╛рдиреА, рдЖрдк рдЗрд╕ рдкреГрд╖реНрда рдкрд░ рд╕реАрдзреЗ рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЖрдк рдХрд╕реНрдЯрдо рджрд░реНрдЬ рдХрд░рдХреЗ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдореЙрдбрд▓ рдХреЗ рдкрд░рд┐рдгрд╛рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред text. рдЗрд╕ рддрд░рд╣, рдЖрдк рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЙрд╕рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рддреНрд╡рд░рд┐рдд рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
![рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ рдмреЗрд╕ рдореЙрдбрд▓ (рдмрд┐рдирд╛ рдЖрд╡рд░рдг рд╡рд╛рд▓рд╛)](https://img-blog.csdnimg.cn/0edebca3ab8248b4b2bac88f88ab79c0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA56We5rSb5Y2O,size_20,рд░рдВрдЧ_FFFFFF,t_70,g_se,x_16#pic_center)
## 2. рдПрдирдПрд▓рдкреА рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛
рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ, рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреНрдпрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдкрд╣рд▓реЗ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: рдкрд╛рдЗрдкрд▓рд╛рдЗрдиред

>ЁЯдЧ[рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА](https://github.com/huggingface/transformers) рд╕рд╛рдЭрд╛ рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред [рдореЙрдбрд▓ рд╣рдм](https://huggingface.co/models) рдореЗрдВ рд╣рдЬрд╛рд░реЛрдВ рдкреНрд░реА- рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдЯреАрдЬрд┐рд╕реЗ рдХреЛрдИ рднреА рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЖрдк рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдореЙрдбрд▓ рднреА рд╣рдм рдкрд░ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ!

ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рд╕рдмрд╕реЗ рдмреБрдирд┐рдпрд╛рджреА рд╡рд╕реНрддреБ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рд╣реИред рдпрд╣ рдореЙрдбрд▓ рдХреЛ рдЙрд╕рдХреЗ рдЖрд╡рд╢реНрдпрдХ рдкреНрд░реА- рдФрд░ рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЪрд░рдгреЛрдВ рд╕реЗ рдЬреЛрдбрд╝рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдореЗрдВ рдХрд┐рд╕реА рднреА рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рд╕реАрдзреЗ рдЗрдирдкреБрдЯ рдХрд░рдиреЗ рдФрд░ рд╕рдордЭрдиреЗ рдпреЛрдЧреНрдп рдЙрддреНрддрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ

рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░рд┐рдпрд░ = рдкрд╛рдЗрдкрд▓рд╛рдЗрди ("рднрд╛рд╡рдирд╛-рд╡рд┐рд╢реНрд▓реЗрд╖рдг")
рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░рд┐рдпрд░ ("рдореИрдВ рдЕрдкрдиреА рдкреВрд░реА рдЬрд┐рдВрджрдЧреА рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рдХреЛрд░реНрд╕ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░ рд░рд╣рд╛ рд╣реВрдВред")
```
```рдЕрдЬрдЧрд░
[{'рд▓реЗрдмрд▓': 'рд╕рдХрд╛рд░рд╛рддреНрдордХ', 'рд╕реНрдХреЛрд░рдИ': 0.9598047137260437}]
```
рд╣рдо рдХреБрдЫ рд╡рд╛рдХреНрдпреЛрдВ рдореЗрдВ рднреА рдЗрд╕реЗ рдкрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ!
```рдЕрдЬрдЧрд░
рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░рд┐рдпрд░([
"рдореИрдВ рдкреВрд░реА рдЬрд┐рдВрджрдЧреА рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рдХреЛрд░реНрд╕ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддрд╛ рд░рд╣рд╛ рд╣реВрдВред"
"рдореБрдЭреЗ рдЗрд╕рд╕реЗ рдмрд╣реБрдд рдирдлрд░рдд рд╣реИ!"
])
```
```рдЕрдЬрдЧрд░
[{'рд▓реЗрдмрд▓': 'рд╕рдХрд╛рд░рд╛рддреНрдордХ', 'рд╕реНрдХреЛрд░': 0.9598047137260437},
{'рд▓реЗрдмрд▓': 'рдирдХрд╛рд░рд╛рддреНрдордХ', 'рд╕реНрдХреЛрд░': 0.9994558095932007}]
```
рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХрд╛ рдЪрдпрди рдХрд░рддреА рд╣реИ рдЬрд┐рд╕реЗ рдЕрдВрдЧреНрд░реЗрдЬреА рднрд╛рд╡рдирд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдареАрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рддреЗ рд╕рдордп, рдирд┐рдореНрди рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдореЛрдб рдХреЛ рдХреИрд╢ рдХрд░реЗрдВрдПрд▓. рдпрджрд┐ рдЖрдк рдХрдорд╛рдВрдб рдХреЛ рджреЛрдмрд╛рд░рд╛ рдЪрд▓рд╛рддреЗ рд╣реИрдВ, рддреЛ рдХреИрд╢реНрдб рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдореЙрдбрд▓ рдХреЛ рджреЛрдмрд╛рд░рд╛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрдИ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред

рдХрд┐рд╕реА рдкрд╛рда рдХреЛ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдореЗрдВ рдкрд╛рд╕ рдХрд░рддреЗ рд╕рдордп рддреАрди рдореБрдЦреНрдп рдЪрд░рдг рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВ:

1. рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ: рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рдРрд╕реЗ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдореЙрдбрд▓ рд╕рдордЭ рд╕рдХреЗред

2. рдЗрдирдкреБрдЯ рдореЙрдбрд▓: рдореЙрдбрд▓ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕реНрдб рдЗрдирдкреБрдЯ рдХреЛ рдореЙрдбрд▓ рдореЗрдВ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

3. рдкреЛрд╕реНрдЯрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ: рдореЙрдбрд▓ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдХреЛ рдкреЛрд╕реНрдЯрдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рд╕рдордЭ рд╕рдХреЗрдВред

рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдХреБрдЫ рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЗрдВ arрдЗ:

- рд╕реБрд╡рд┐рдзрд╛-рдирд┐рд╖реНрдХрд░реНрд╖рдг (рдкрд╛рда рдХрд╛ рд╡реЗрдХреНрдЯрд░ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ)

- рдлрд┐рд▓-рдорд╛рд╕реНрдХ рдХрд┐рд╕реА рджрд┐рдП рдЧрдП рдкрд╛рда рдореЗрдВ рд░рд┐рдХреНрдд рд╕реНрдерд╛рди рдХреЛ рднрд░рддрд╛ рд╣реИ (рдХреНрд▓реЛрдЬрд╝)

- рдПрдирдИрдЖрд░ (рдирд╛рдорд┐рдд рдЗрдХрд╛рдИ рдкрд╣рдЪрд╛рди) рдкрд╛рд░реНрдЯ-рдСрдлрд╝-рд╕реНрдкреАрдЪ рдЯреИрдЧрд┐рдВрдЧ

- рдкреНрд░рд╢реНрди-рдЙрддреНрддрд░

-рднрд╛рд╡рдирд╛рдУрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг

- рд╕рдВрдХреНрд╖реЗрдкрдг

- рдкрд╛рда-рдкреАрдврд╝реА

- рдЕрдиреБрд╡рд╛рдж

-рд╢реВрдиреНрдп-рд╢реЙрдЯ-рд╡рд░реНрдЧреАрдХрд░рдг

рдЖрдк рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╣рдм рд╕реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореЙрдбрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдХрд╛ рдЪрдпрди рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЯреЗрдХреНрд╕реНрдЯ рдЬрдирд░реЗрд╢рдиред [рдореЙрдбрд▓ рд╣рдм](https://huggingface.co/models) рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдЯреА рдкрд░ рд╕рдВрдмрдВрдзрд┐рдд рдЯреИрдм рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВредрд╡рд╣ рдЪрд▓рд╛ рдЧрдпрд╛, рдкреЗрдЬ рдХреЗрд╡рд▓ рдЯреЗрдХреНрд╕реНрдЯ рдЬрдирд░реЗрд╢рди рдХрд╛рд░реНрдп рджрд┐рдЦрд╛рдПрдЧрд╛, рд╕реЗрд╡рд╛ рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рдореЙрдбрд▓ред
(***рдореЙрдбрд▓ рдХреЛ рдХрд╛рд░реНрдп рд╕реЗ рдорд┐рд▓рд╛рдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдХ рдФрд░ рд╡рд┐рдЪрд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдбреЗрдЯрд╛рд╕реЗрдЯ рдЙрд╕ рдХрд╛рд░реНрдп рдореЗрдВ рдирд┐рд╣рд┐рдд рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЙрддрдирд╛ рдХрд░реАрдм рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕реЗ рдЖрдкрдХреЛ рд╕рдВрднрд╛рд▓рдирд╛ рд╣реИред рджреЛрдиреЛрдВ рдбреЗрдЯрд╛рд╕реЗрдЯ рдЬрд┐рддрдиреЗ рдХрд░реАрдм рд╣реЛрдВрдЧреЗ, рдЙрддрдирд╛ рдмреЗрд╣рддрд░ рд╣реЛрдЧрд╛ред***)

рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдПрдкреАрдЖрдИ рд╡рд┐рднрд┐рдиреНрди рдПрдирдПрд▓рдкреА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓ рд╕рдХрддрд╛ рд╣реИред рдЖрдк рдкреВрд░реНрдг рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдпрд╛ рд╕рд┐рд░реНрдл рдПрдирдХреЛрдбрд░ рдпрд╛ рдбреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрдИрдХреЛрдбрд░, рдЖрдк рдЬрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрд╛рд░реНрдп рдХреЛ рд╣рд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЙрд╕рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдирд┐рдореНрди рддрд╛рд▓рд┐рдХрд╛ рдЗрд╕рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреА рд╣реИ:

рдореЙрдбрд▓ |. рдЙрджрд╛рд╣рд░рдг |
-------- |. ----- |-----
рдПрдирдХреЛрдбрд░ | рдЕрд▓реНрдмрд░реНрдЯ, рдмрд░реНрдЯ, рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ, рдЗрд▓реЗрдХреНрдЯреНрд░рд╛, рд░реЙрдмрд░реНрдЯрд╛ |ред рд╡рд╛рдХреНрдп рд╡рд░реНрдЧреАрдХрд░рдг, рдирд╛рдорд┐рдд рдЗрдХрд╛рдИ рдорд╛рдиреНрдпрддрд╛, рдирд┐рд╖реНрдХрд░реНрд╖рдг рдкреНрд░рд╢реНрди рдЙрддреНрддрд░
рдбрд┐рдХреЛрдбрд░ | CTRL, GPT, GPT-2, рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ XL |
рдПрдирдХреЛрдбрд░-рдбрд┐рдХреЛрдбрд░ | BART, T5, рдореИрд░рд┐рдПрди, mBART |ред рд╕рд╛рд░рд╛рдВрд╢ рдкреАрдврд╝реА, рдЕрдиреБрд╡рд╛рдж, рдЬрдирд░реЗрдЯрд┐рд╡ рдкреНрд░рд╢реНрди рдЙрддреНрддрд░

рдКрдкрд░ рджрд┐рдЦрд╛рдИ рдЧрдИ рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЗрдВ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП рд╣реИрдВрдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдкрд░ред рд╡реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд┐рдП рдЧрдП рд╣реИрдВ рдФрд░ рдЕрдкрдиреЗ рд╡реЗрд░рд┐рдПрдВрдЯ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЖрдк рд╕реАрдЦреЗрдВрдЧреЗ рдХрд┐ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рдЕрдВрджрд░ рдХреНрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдХреИрд╕реЗ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред
>рдЙрдкрд░реЛрдХреНрдд рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдХреЗ рд╕рд░рд▓ рдЙрджрд╛рд╣рд░рдг рдпрд╣рд╛рдВ рджреЗрдЦреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ --[рд╣рдЧрд┐рдВрдЧ рдлреЗрд╕ рд╣реЛрдордкреЗрдЬ рдХреЛрд░реНрд╕ 1: рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓](https://blog.csdn.net/qq_56591814/article/details/120124306)ред
>рдпрд╛ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП [Colab рдореЗрдВ рдЦреЛрд▓реЗрдВ](https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter1/section3.ipynb) рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВрдПрдХ Google Colab рдиреЛрдЯрдмреБрдХ рдЬрд┐рд╕рдореЗрдВ рдЕрдиреНрдп рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
рдпрджрд┐ рдЖрдк рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЪрд▓рд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдЕрдиреБрд╢рдВрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк [рд╕реЗрдЯрд┐рдВрдЧреНрд╕](https://huggingface.co/course/chapter0) рджреЗрдЦреЗрдВред
## 3. рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рдкреАрдЫреЗ
>рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдХреЗ рд▓рд┐рдП рдХреЛрдб: [рдХреЛрд▓реИрдм рдореЗрдВ рдЦреЛрд▓реЗрдВ](https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter2/section2_pt.ipynb) (PyTorch)<br>
>рдпреВрдЯреНрдпреВрдм рд╡реАрдбрд┐рдпреЛ: [рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЕрдВрджрд░ рдХреНрдпрд╛ рд╣реБрдЖ](https://youtu.be/1pedAIvTWXk)

рдЪрд▓реЛ рд╕рд╛рде - рд╕рд╛рде рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВрдПрдХ рд╕рдВрдкреВрд░реНрдг рдЙрджрд╛рд╣рд░рдг рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдЬрдм рд╣рдо рдзрд╛рд░рд╛ 1 рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдкрд░реНрджреЗ рдХреЗ рдкреАрдЫреЗ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ:
```рдЕрдЬрдЧрд░

рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ

рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░рд┐рдпрд░ = рдкрд╛рдЗрдкрд▓рд╛рдЗрди ("рднрд╛рд╡рдирд╛-рд╡рд┐рд╢реНрд▓реЗрд╖рдг")
рдХреНрд▓рд╛рд╕рд┐рдлрд╛рдпрд░рд┐рдпрд░([
"рдореИрдВ рдкреВрд░реА рдЬрд┐рдВрджрдЧреА рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рдХреЛрд░реНрд╕ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддрд╛ рд░рд╣рд╛ рд╣реВрдВред"
"рдореБрдЭреЗ рдЗрд╕рд╕реЗ рдмрд╣реБрдд рдирдлрд░рдд рд╣реИ!",
])
```
```рдЕрдЬрдЧрд░
[{'рд▓реЗрдмрд▓': 'рд╕рдХрд╛рд░рд╛рддреНрдордХ', 'рд╕реНрдХреЛрд░': 0.9598047137260437},
{'рд▓реЗрдмрд▓': 'рдирдХрд╛рд░рд╛рддреНрдордХ', 'рд╕реНрдХреЛрд░': 0.9994558095932007}]
```
рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдЕрдзреНрдпрд╛рдп 1 рдореЗрдВ рджреЗрдЦрд╛, рдпрд╣ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рддреАрди рдЪрд░рдгреЛрдВ рдХреЛ рдЬреЛрдбрд╝рддреА рд╣реИ: рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ, рдкреАрдПрдореЙрдбрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрдирдкреБрдЯ ssing, рдФрд░ рдкреЛрд╕реНрдЯрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ:
![full_nlp_pipeline ](https://img-blog.csdnimg.cn/7f19b775bfe94fa0bb9e35d883567e16.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA56We5rSb 5Y2O, рдЖрдХрд╛рд░_20,рд░рдВрдЧ_FFFFFF,t_70,g_se,x_16#рддрд╕реНрд╡реАрд░_рдХреЗрдВрджреНрд░)

рдЖрдЗрдП рдЗрди рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВред
### рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ
рдЕрдиреНрдп рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рддрд░рд╣, рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рд╕реАрдзреЗ рдХрдЪреНрдЪреЗ рдкрд╛рда рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдорд╛рд░реА рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдореЗрдВ рдкрд╣рд▓рд╛ рдХрджрдо рдкрд╛рда рдЗрдирдкреБрдЯ рдХреЛ рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдирд╛ рд╣реИрд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдореЙрдбрд▓ рд╕рдордЭ рд╕рдХреЗред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдХ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдЗрд╕рдХреЗ рд▓рд┐рдП рдЬрд╝рд┐рдореНрдореЗрджрд╛рд░ рд╣реЛрдЧрд╛:

- рдЗрдирдкреБрдЯ рдХреЛ рд╢рдмреНрджреЛрдВ, рдЙрдкрд╢рдмреНрджреЛрдВ рдпрд╛ рдкреНрд░рддреАрдХреЛрдВ (рдЬреИрд╕реЗ рд╡рд┐рд░рд╛рдо рдЪрд┐рд╣реНрди) рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдирд╛, рдЬрд┐рдиреНрд╣реЗрдВ рдЯреЛрдХрди рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ
- рдкреНрд░рддреНрдпреЗрдХ рдЯреЛрдХрди рдХреЛ рдПрдХ рдкреВрд░реНрдгрд╛рдВрдХ рдореЗрдВ рдореИрдк рдХрд░рдирд╛
- рдЕрдиреНрдп рдЗрдирдкреБрдЯ рдЬреЛрдбрд╝рдирд╛ рдЬреЛ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ

рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреНрд▓рд╛рд╕ рдФрд░ рдЗрд╕рдХреА from_pretrained рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рд╕рднреА рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдареАрдХ рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИ рдЬрдм рдореЙрдбрд▓ рдХреЛ рдкреНрд░реАрдЯреНрд░реЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдореЙрдб рдХрд╛ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдирд╛рдо рд╕реЗрдЯ рдХрд░реЗрдВрдИрдПрд▓, рдЬреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдореЙрдбрд▓ рдХреЗ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рд╕реЗ рдЬреБрдбрд╝реЗ рдбреЗрдЯрд╛ рдХреЛ рд▓рд╛рдПрдЧрд╛ рдФрд░ рдЗрд╕реЗ рдХреИрд╢ рдХрд░реЗрдЧрд╛ (рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХреЗрд╡рд▓ рдкрд╣рд▓реА рдмрд╛рд░ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрдм рдЖрдк рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдХреЛрдб рдХреЛ рдЪрд▓рд╛рдПрдВрдЧреЗ)ред

рдЪреВрдБрдХрд┐ рднрд╛рд╡рдирд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЪреЗрдХрдкреЙрдЗрдВрдЯ [distilbert-base-uncased-finetuned-sst-2-english](https://huggingface.co/distilbert-base-uncased-finetuned-sst-2-english) рд╣реИ, рд╣рдо рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЪреЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдпреВрдПрдирд╕реАрдПsed-finetuned-sst-2-рдЕрдВрдЧреНрд░реЗрдЬреА"
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(рдЪреЗрдХрдкреЙрдЗрдВрдЯ)
```
```рдЕрдЬрдЧрд░
raw_inputs = [
"рдореИрдВ рдкреВрд░реА рдЬрд┐рдВрджрдЧреА рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рдХреЛрд░реНрд╕ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддрд╛ рд░рд╣рд╛ рд╣реВрдВред"
"рдореБрдЭреЗ рдЗрд╕рд╕реЗ рдмрд╣реБрдд рдирдлрд░рдд рд╣реИ!",
]
рдЗрдирдкреБрдЯреНрд╕ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░(raw_inputs, рдкреИрдбрд┐рдВрдЧ=рд╕рд╣реА, рдЯреНрд░рдВрдХреЗрд╢рди=рд╕рд╣реА, рд░рд┐рдЯрд░реНрди_рдЯреЗрдВрд╕рд░реНрд╕='рдкреАрдЯреА')
#return_tensors='pt' рдХрд╛ рдЕрд░реНрде рд╣реИ рд░рд┐рдЯрд░реНрдирд┐рдВрдЧ рдкрд╛рдЗрдЯреЛрд░рдЪ рдЯреЗрдВрд╕рд░ред рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЗрд╕реЗ рдореЙрдбрд▓ рдореЗрдВ рдЗрдирдкреБрдЯ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЯреЗрдВрд╕рд░ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
#padding=True рдХрд╛ рдЕрд░реНрде рд╣реИ рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдХреЛ рд╡реЗрдВ рдкрд░ рдкреИрдбрд┐рдВрдЧ рдХрд░рдирд╛e рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ, рдЯреНрд░рдВрдХреЗрд╢рди=рд╕рддреНрдп рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд▓рдВрдмрд╛ рдЕрдиреБрдХреНрд░рдо рдЫреЛрдЯрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ

рдкреНрд░рд┐рдВрдЯ(рдЗрдирдкреБрдЯ)

```
PyTorch рдЯреЗрдВрд╕рд░ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ:

```рдЕрдЬрдЧрд░
{
'input_ids': рдЯреЗрдВрд╕рд░([
[101, 1045, 1005, 2310, 2042, 3403, 2005, 1037, 17662, 12172, 2607, 2026, 2878, 2166, 1012, 102],
[101, 1045, 5223, 2023, 2061, 2172, 999, 102,0, 0, 0, 0, 0, 0, 0, 0]
]),
'рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ': рдЯреЗрдВрд╕рд░([
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
[1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0]
])
}
```
### рдПрдХ рдореЙрдбрд▓ рдЪреБрдирдирд╛
рдбрдмреНрд▓реНрдпреВрд╣рдо рдЕрдкрдиреЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рд╡реИрд╕реЗ рд╣реА рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рд╣рдордиреЗ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдерд╛ред рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдПрдХ рдСрдЯреЛрдореЙрдбрд▓ рдХреНрд▓рд╛рд╕ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ from_pretrained рд╡рд┐рдзрд┐ рднреА рд╣реИ:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдореЙрдбрд▓ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЪреЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб-рдлрд╛рдЗрдирдЯреНрдпреВрдиреНрдб-рдПрд╕рдПрд╕рдЯреА-2-рдЗрдВрдЧреНрд▓рд┐рд╢"
рдореЙрдбрд▓ = AutoModel.from_pretrained(рдЪреЗрдХрдкреЙрдЗрдВрдЯ)
```
рдСрдЯреЛрдореЙрдбрд▓ рд╡рд░реНрдЧ рдФрд░ рдЙрд╕рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕рднреА рд╡рд░реНрдЧ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓ рд╣реИрдВред рдСрдЯреЛрдореЙрдбрд▓ рд╡рд░реНрдЧ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдЖрд╡рд░рдг рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ рд╕реВрдЯ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рддрд╛ рд╣реИрдЕрдкрдиреЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдореЙрдбрд▓ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЛ рдмреНрд▓реА рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ рдЙрд╕ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдореЙрдбрд▓ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░реЗрдВред рдЬреЛ рд▓реЗрдЦ рдХреЗ рдЕрдВрдд рдореЗрдВ рд╣реИред***)

рдЗрд╕ рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ рдореЗрдВ, рд╣рдо рдЙрд╕реА рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рдордиреЗ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдореЗрдВ рдкрд╣рд▓реЗ рдХрд┐рдпрд╛ рдерд╛ (рдЗрд╕реЗ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдерд╛) рдФрд░ рдЗрд╕рдХреЗ рд╕рд╛рде рдПрдХ рдореЙрдбрд▓ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯрд┐рдПрдЯ рдХрд░рддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдЗрд╕ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдореЗрдВ рдХреЗрд╡рд▓ рдореВрд▓ рдЯреНрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдЙрддреНрддрд░рджрд╛рддрд╛ рдореЙрдбреНрдпреВрд▓: рдХреБрдЫ рдЗрдирдкреБрдЯ рджрд┐рдП рдЬрд╛рдиреЗ рдкрд░, рдпрд╣ рдЖрдЙрдЯрдкреБрдЯ рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╣рдо рдЫреБрдкреЗ рд╣реБрдП рд░рд╛рдЬреНрдп рдХрд╣рддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпреЗ рдЫрд┐рдкреЗ рд╣реБрдП рд░рд╛рдЬреНрдп рдЕрдкрдиреЗ рдЖрдк рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛрддреЗ рд╣реИрдВ, рд╡реЗ рдЖрдорддреМрд░ рдкрд░ рдореЙрдбрд▓ рдХреЗ рджреВрд╕рд░реЗ рднрд╛рдЧ (рдореЙрдбрд▓ рд╣реЗрдб) рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ рд╣реЛрддреЗ рд╣реИрдВред
### рдореЙрдбрд▓ рдкреНрд░рдореБрдЦ
рд╣рдо рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реА рдореЙрдбрд▓ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдкреНрд░рддреНрдпреЗрдХ рдХрд╛рд░реНрдп рдХреЗ рд╕рд╛рде рдЕрд▓рдЧ-рдЕрд▓рдЧ рдореЙрдбрд▓ рд╣реЗрдб рдЬреБрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВред

рдореЙрдбрд▓ рдкреНрд░рдореБрдЦ: рдЫрд┐рдкреЗ рд╣реБрдП рд░рд╛рдЬреНрдпреЛрдВ (рдЙрд░реНрдл рд▓реЙрдЧрд┐рдЯреНрд╕ рд╡реИрдХреНрдЯрд░) рдХреЗ рдЙрдЪреНрдЪ-рдЖрдпрд╛рдореА рд╡реИрдХреНрдЯрд░ рдХреЛ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╡рд┐рднрд┐рдиреНрди рдЖрдпрд╛рдореЛрдВ рдкрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд░реЗрдВред рд╡реЗ рдЖрдо рддреМрд░ рдкрд░ рдПрдХ рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдиреЗ рд╣реЛрддреЗ рд╣реИрдВрдпрд╛ рдХрдИ рд░реИрдЦрд┐рдХ рдкрд░рддреЗрдВ:
![рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░_рдФрд░_рд╣реЗрдб](https://img-blog.csdnimg.cn/9156c4e09d184e7c88732e60ae59e05e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA56We5rSb5Y2 O,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)
рдЗрд╕ рдЖрд░реЗрдЦ рдореЗрдВ, рдореЙрдбрд▓ рдХреЛ рдЗрд╕рдХреА рдПрдореНрдмреЗрдбрд┐рдВрдЧ рдкрд░рдд рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рдХреА рдкрд░рддреЛрдВ рджреНрд╡рд╛рд░рд╛ рджрд░реНрд╢рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдПрдореНрдмреЗрдбрд┐рдВрдЧ рдкрд░рдд рд╕реЗ рдЧреБрдЬрд░рддрд╛ рд╣реИ рдФрд░ рд╡рд╛рдХреНрдп рдХреЗ рдЕрдВрддрд┐рдо рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЙрдЧрд┐рдЯреНрд╕ рд╡реЗрдХреНрдЯрд░ рдХреЛ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддрд╛ рд╣реИред

ЁЯдЧрдмрд╣реБрдд рд╕рд╛рд░реЗ рд╣реИрдВрдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХреБрдЫ рдореЙрдбрд▓ рд╣реЗрдб рдиреАрдЪреЗ рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВ:
* рдореЙрдбрд▓ (рдЫрд┐рдкреЗ рд╣реБрдП рд░рд╛рдЬреНрдпреЛрдВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ)
*рдлреЙрд░рдХреЙрд╕рд▓рдПрд▓рдПрдо
*рдорд╛рд╕реНрдХрдбрдПрд▓рдПрдо рдХреЗ рд▓рд┐рдП
*рдмрд╣реБрд╡рд┐рдХрд▓реНрдкреА рдХреЗ рд▓рд┐рдП
*рд╕рд╡рд╛рд▓ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП
* рдЕрдиреБрдХреНрд░рдо рд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП
* рдЯреЛрдХрдирд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП
* рдПрд╡рдВ рдЕрдиреНрдп ЁЯдЧ

рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рднрд╛рд╡рдирд╛ рд╡рд░реНрдЧреАрдХрд░рдг рдХреЛ рд▓реЗрдВ, рд╣рдореЗрдВ рдЕрдиреБрдХреНрд░рдо рд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд╕рд╛рде рдПрдХ рдореЙрдбрд▓ рд╣реЗрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рд╡рд╛рдХреНрдпреЛрдВ рдХреЛ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдпрд╛ рдирдХрд╛рд░рд╛рддреНрдордХ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо), рд╣рдо рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗрд╡рд╣ рдСрдЯреЛрдореЙрдбрд▓ рд╡рд░реНрдЧ рд╣реИ, рд▓реЗрдХрд┐рди AutoModelForSequenceClassification:

(*** рдХрд╣рдиреЗ рдХрд╛ рддрд╛рддреНрдкрд░реНрдп рдпрд╣ рд╣реИ рдХрд┐, рдкрд╣рд▓реЗ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдореЙрдбрд▓ = AutoModel.from_pretrained(checkpoint) рднрд╛рд╡рдирд╛ рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдХреЗ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рдХреНрдпреЛрдВрдХрд┐ рдореЙрдбрд▓ рд╣реЗрдб рд▓реЛрдб рдирд╣реАрдВ рд╣реИ***)
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForSequenceClassification рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЪреЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб-рдлрд╛рдЗрдирдЯреНрдпреВрдиреНрдб-рдПрд╕рдПрд╕рдЯреА-2-рдЗрдВрдЧреНрд▓рд┐рд╢"
рдореЙрдбрд▓ = AutoModelForSequenceClassification.from_pretrained(рдЪреЗрдХрдкреЙрдЗрдВрдЯ)
рдЖрдЙрдЯрдкреБрдЯ = рдореЙрдбрд▓(**рдЗрдирдкреБрдЯ)
```
рдореЙрдбрд▓ рд╣реЗрдб рддрд╛рдЙрдЪреНрдЪ-рдЖрдпрд╛рдореА рд╡реЗрдХреНрдЯрд░ рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдкрд╣рд▓реЗ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рджреЗрдЦрд╛ рдерд╛ рдФрд░ рдПрдХ рд╡реЗрдХреНрдЯрд░ рдХреЛ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рджреЛ рдорд╛рди рд╣реЛрддреЗ рд╣реИрдВ (рдкреНрд░рддреНрдпреЗрдХ рд▓реЗрдмрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ):
```рдЕрдЬрдЧрд░
рдкреНрд░рд┐рдВрдЯ(рдЖрдЙрдЯрдкреБрдЯ.рд▓реЙрдЧрд┐рдЯреНрд╕.рдЖрдХрд╛рд░)
```
```рдЕрдЬрдЧрд░
рдЯреЙрд░реНрдЪ.рдЖрдХрд╛рд░([2,2])
```
рдЪреВрдБрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ рджреЛ рд╡рд╛рдХреНрдп рдФрд░ рджреЛ рд▓реЗрдмрд▓ рд╣реИрдВ, рдореЙрдбрд▓ рд╕реЗ рд╣рдореЗрдВ рдЬреЛ рдкрд░рд┐рдгрд╛рдо рдорд┐рд▓рддрд╛ рд╣реИ рд╡рд╣ рдЖрдХрд╛рд░ 2 x 2 рдХрд╛ рд╣реЛрддрд╛ рд╣реИред
### рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рдж
рдореЙрдбрд▓ рд╕реЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд╣рдореЗрдВ рдЬреЛ рдорд╛рди рдорд┐рд▓рддреЗ рд╣реИрдВ, рдЙрдирдХрд╛ рдЕрдкрдиреЗ рдЖрдк рдореЗрдВ рдХреЛрдИ рдорддрд▓рдм рдирд╣реАрдВ рд╣реИ, рдЖрдЗрдП рдПрдХ рдирдЬрд░ рдбрд╛рд▓рддреЗ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
рдкреНрд░рд┐рдВрдЯ(рдЖрдЙрдЯрдкреБрдЯ.рд▓реЙрдЧрд┐рдЯреНрд╕)
```
```рдЕрдЬрдЧрд░
рдЯреЗрдВрд╕рд░([[-1.5607, 1.6123],
[4.1692, -3.3464]], grad_fn=<AddmmBackward>)
```
рд╣рдорд╛рд░реЗ рдореЙрдбрд▓ рдиреЗ рдкрд╣рд▓реЗ рд╡рд╛рдХреНрдп рдХреЗ рдкрд░рд┐рдгрд╛рдо [-1.5607, 1.6123] рдФрд░ рджреВрд╕рд░реЗ рд╡рд╛рдХреНрдп рдХреЗ рдкрд░рд┐рдгрд╛рдо [4.1692, -3.3464] рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреА рд╣реИред рдпреЗ рд╕рдВрднрд╛рд╡реНрдпрддрд╛рдПрдВ рдирд╣реАрдВ рд╣реИрдВ, рдмрд▓реНрдХрд┐ рдореЙрдбрд▓ рдХреА рдЕрдВрддрд┐рдо рдкрд░рдд рджреНрд╡рд╛рд░рд╛ рдХрдЪреНрдЪреЗ, рдЕрд╕рд╛рдорд╛рдиреНрдп рд╕реНрдХреЛрд░ рдЖрдЙрдЯрдкреБрдЯ рд╣реИрдВ рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП, рдЙрдиреНрд╣реЗрдВ рд╕рднреА ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдореЙрдбрд▓ рдЖрдЙрдЯрдкреБрдЯ рд▓реЙрдЧрд┐рдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐ рдлрд╝рдВрдХреНрд╢рди рдЖрдо рддреМрд░ рдкрд░ рдЕрдВрддрд┐рдо рд╕рдХреНрд░рд┐рдпрдг рдлрд╝рдВрдХреНрд╢рди (рдЬреИрд╕реЗ рд╕реЙрдлреНрдЯрдореИрдХреНрд╕) рдХреЛ рдЬреЛрдбрд╝рддрд╛ рд╣реИредрд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХреНрд░реЙрд╕ рдПрдиреНрдЯреНрд░реЙрдкреА рд╣рд╛рдирд┐ рдлрд╝рдВрдХреНрд╢рди
(***рдкреВрд░рдХ: рдкрд╛рдЗрдЯреЛрд░рдЪ рдореЗрдВ, рдХреНрд░реЙрд╕ рдПрдиреНрдЯреНрд░реЙрдкреА рд▓реЙрд╕ рд╕реАрдИрд▓реЙрд╕ рдЧрдгрд┐рддреАрдп рдХреНрд░реЙрд╕ рдПрдВрдЯреНрд░реЙрдкреА рд▓реЙрд╕ (рдПрдирдПрд▓рдПрд▓рдПрд▓реЙрд╕) рдирд╣реАрдВ рд╣реИред рдкрд╛рдЗрдЯреЛрд░рдЪ рдХрд╛ рдХреНрд░реЙрд╕рдПрдВрдЯреНрд░реЙрдкреАрд▓реЙрд╕ рд╕реЙрдлреНрдЯрдореИрдХреНрд╕-рд▓реЙрдЧ-рдПрдирдПрд▓рдПрд▓рдПрд▓реЙрд╕ рдХреЛ рдПрдХ рдЪрд░рдг рдореЗрдВ рдорд░реНрдЬ рдХрд░рдирд╛ рд╣реИред рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП, рдХреГрдкрдпрд╛ рдЭрд┐рд╣реВ рд▓реЗрдЦ рджреЗрдЦреЗрдВ ["рдХреИрд╕реЗ рдПрдирдПрд▓рдПрд▓рдПрд▓реЙрд╕ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП?"] (https://zhuanlan.zhihu.com/p/30187567)***я╝Й

```рдЕрдЬрдЧрд░
рдорд╢рд╛рд▓ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = рдорд╢рд╛рд▓.рдПрдирдПрди.рдХрд╛рд░реНрдпрд╛рддреНрдордХ.рд╕реЙрдлреНрдЯрдореИрдХреНрд╕(рдЖрдЙрдЯрдкреБрдЯ.рд▓реЙрдЧрд┐рдЯреНрд╕, рдордВрдж=-1)
рдкреНрд░рд┐рдВрдЯ(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ)
```
```рдЕрдЬрдЧрд░
рдЯреЗрдВрд╕рд░([[4.0195e-02, 9.5980e-01],
[9.9946e-01, 5.4418e-04]], grad_fn=<рд╕реЙрдлреНрдЯрдореИрдХреНрд╕рдмреИрдХрд╡рд░реНрдб>)
```
рдЗрд╕ рдмрд╛рд░ рдЖрдЙрдЯрдкреБрдЯ рдПрдХ рдкрд╣рдЪрд╛рдирдиреЗ рдпреЛрдЧреНрдп рд╕рдВрднрд╛рд╡реНрдпрддрд╛ рд╕реНрдХреЛрд░ рд╣реИред

рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдерд┐рддрд┐ рдХреЗ рдЕрдиреБрд░реВрдк рд▓реЗрдмрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдореЙрдбрд▓ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА id2label рд╕рдВрдкрддреНрддрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
model.config.id2label
```
```рдЕрдЬрдЧрд░
{0:'рдирдХрд╛рд░рд╛рддреНрдордХ', 1: 'рд╕рдХрд╛рд░рд╛рддреНрдордХ'}
```
рдЕрдм рд╣рдо рдпрд╣ рдирд┐рд╖реНрдХрд░реНрд╖ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдореЙрдбрд▓ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рддрд╛ рд╣реИ:

рдкрд╣рд▓рд╛ рд╡рд╛рдХреНрдп: рдирдХрд╛рд░рд╛рддреНрдордХ: 0.0402, рд╕рдХрд╛рд░рд╛рддреНрдордХ: 0.9598<br>
рджреВрд╕рд░рд╛ рд╡рд╛рдХреНрдп: рдирдХрд╛рд░рд╛рддреНрдордХ: 0.9995, рд╕рдХрд╛рд░рд╛рддреНрдордХ: 0.0005

## 4. рдмрд┐рд▓реНрдб рдЯреНрд░реЗрдирд░рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдкреАрдЖрдИ
>рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдХреЗ рд▓рд┐рдП рдХреЛрдб: [Colab рдореЗрдВ рдЦреЛрд▓реЗрдВ](https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter3/section3.ipynb) (PyTorch), рдЗрд╕рдХреА рдЕрдиреБрд╢рдВрд╕рд╛ рдХреА рдЬрд╛рддреА рд╣реИ рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдВ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред Colab рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдмрд╣реБрдд рддреЗрдЬрд╝реА рд╕реЗ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИ, рдФрд░ GPU рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдкреНрд░рд╢рд┐рдХреНрд╖рдг рднреА рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рддреЗрдЬрд╝ рд╣реЛрддрд╛ рд╣реИред
>рдЦреЛрд▓рдиреЗ рдХреЗ рдмрд╛рдж, рдКрдкрд░реА рдмрд╛рдПрдВ рдХреЛрдиреЗ рдореЗрдВ "рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ" рдЯреИрдм рдЪреБрдиреЗрдВ, рдиреЛрдЯрдмреБрдХ рд╕реЗрдЯрд┐рдВрдЧреНрд╕-рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдПрдХреНрд╕реЗрд▓реЗрд░реЗрдЯрд░ рдХреЛрдИ рдирд╣реАрдВ рд╕реЗ рдЬреАрдкреАрдпреВ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

рдзрд╛рд░рд╛ 3 рдореЗрдВ, рд╣рдордиреЗ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдХрд┐ рдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВрд╡рд╣ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП рд╢рдмреНрдж рдЦрдВрдбрдХ рдФрд░ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рд╣реИ, рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдареАрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдЖрдк рдпрд╣реА рд╕реАрдЦреЗрдВрдЧреЗ!

- рдореЙрдбрд▓ рд╣рдм рд╕реЗ рдмрдбрд╝реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреИрд╕реЗ рддреИрдпрд╛рд░ рдХрд░реЗрдВ
- рдореЙрдбрд▓ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдЪреНрдЪ-рд╕реНрддрд░реАрдп рдЯреНрд░реЗрдирд░рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ
- рдХрд╕реНрдЯрдо рдЯреНрд░реЗрдирд┐рдВрдЧ рд▓реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ
- рдХрд┐рд╕реА рднреА рд╡рд┐рддрд░рд┐рдд рд╕реЗрдЯрдЕрдк рдкрд░ рдХрд╕реНрдЯрдо рдЯреНрд░реЗрдирд┐рдВрдЧ рд▓реВрдк рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП ЁЯдЧрдПрдХреНрд╕реЗрд▓рд░реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рд▓рд╛рдн рдХреИрд╕реЗ рдЙрдард╛рдПрдВ
### рд╣рдм рд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ
>рдпреВрдЯреНрдпреВрдм рд╡реАрдбрд┐рдпреЛ: [рд╣рдЧрд┐рдВрдЧ рдлреЗрд╕рдИ рдбреЗрдЯрд╛рд╕реЗрдЯ рдЕрд╡рд▓реЛрдХрди](https://youtu.be/_BZearw7f0w) (рдкрд╛рдЗрдЯреЛрд░рдЪ)

рд╣рдм рдореЗрдВ рди рдХреЗрд╡рд▓ рдореЙрдбрд▓ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ; рдЗрд╕рдореЗрдВ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдХрдИ [рдбреЗрдЯрд╛рд╕реЗрдЯ] (https://huggingface.co/datasets) рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рд╣рдо рдЕрдиреБрд╢рдВрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдирдП рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓реЛрдб рдХрд░рдиреЗ рдФрд░ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ ](https://huggingface.co/docs/datasets/loading_datasets.html#from-the-huggingface-hub))ред

MRPC рдбреЗрдЯрд╛рд╕реЗрдЯ рдЙрди 10 рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ рдЬреЛ [GLUE рдмреЗрдВрдЪрдорд╛рд░реНрдХ](https://gloebenchmark.com) рдмрдирд╛рддреЗ рд╣реИрдВ/)ред GLUE рдмреЗрдВрдЪрдорд╛рд░реНрдХ рдПрдХ рдЕрдХрд╛рджрдорд┐рдХ рдмреЗрдВрдЪрдорд╛рд░реНрдХ рд╣реИ рдЬреЛ 10 рдЕрд▓рдЧ-рдЕрд▓рдЧ рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ ML рдореЙрдбрд▓ рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдорд╛рдкрддрд╛ рд╣реИред рдЗрд╕ рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдореЗрдВ рдкреНрд░рджрд░реНрд╢рдиред

ЁЯдЧ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╣рдм рдкрд░ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рдХреИрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрд╣реБрдд рд╣реА рд╕рд░рд▓ рдХрдорд╛рдВрдб рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рд╣рдо рдПрдордЖрд░рдкреАрд╕реА рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдЗрд╕ рддрд░рд╣ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдХрдЪреНрдЪрд╛_рдбреЗрдЯрд╛рд╕реЗрдЯ = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ ("рдЧреЛрдВрдж", "рдПрдордЖрд░рдкреАрд╕реА")
raw_datasets
```

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ({
рдЯреНрд░реЗрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рд▓реЗрдмрд▓', 'рдЖрдИрдбреАрдПрдХреНрд╕'],
рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 3668
})
рд╕рддреНрдпрд╛рдкрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рд▓реЗрдмрд▓', 'idx'],
рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 408
})
рдкрд░реАрдХреНрд╖рдг: рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рд▓реЗрдмрд▓', 'idx'],
рд╕рдВрдЦреНрдпрд╛ рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 1725
})
})
```
рдпрд╣ рдЖрдкрдХреЛ рдПрдХ рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рджреЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ, рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдФрд░ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ 3,668 рд╡рд╛рдХреНрдп рдЬреЛрдбрд╝реЗ рд╣реИрдВ, рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдореЗрдВ 408 рдЬреЛрдбрд╝реЗ рд╣реИрдВ, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рд╡рд╛рдХреНрдп рдЬреЛрдбрд╝реЗ рдореЗрдВ 1,725 тАЛтАЛрдЬреЛрдбрд╝реЗ рд╣реИрдВ рдбреЗрдЯрд╛ рдХреЗ рдЪрд╛рд░ рдХреЙрд▓рдо: 'рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рд▓реЗрдмрд▓', рдФрд░ 'рдЖрдИрдбреАрдПрдХреНрд╕'ред

рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рд╡рд┐рдзрд┐, рдЖрдк рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд╛рдиреЛрдВ рд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ<br>
- рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рд╣рдм рд╕реЗ,
- рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рд╕реЗ, рдЬреИрд╕реЗ CSV/JSON/text/pandas рдлрд╝рд╛рдЗрд▓реЗрдВ
- рдЗрди-рдореЗрдореЛрд░реА рдбреЗрдЯрд╛ рдЬреИрд╕реЗ рдкрд╛рдпрдерди рдбрд┐рдХреНрдЯ рдпрд╛ рдкрд╛рдВрдбрд╛ рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо рд╕реЗред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: рдбреЗрдЯрд╛рд╕реЗрдЯ = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ ("рдЯреЗрдХреНрд╕реНрдЯ", рдбреЗрдЯрд╛_рдлрд╝рд╛рдЗрд▓реНрд╕ = {"рдЯреНрд░реЗрди": path_to_train.txt, "рд╕рддреНрдпрд╛рдкрди": path_to_validation.txt} рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП, рдХреГрдкрдпрд╛ [рджрд╕реНрддрд╛рд╡реЗрдЬрд╝] (https://link.zhihu.com) рджреЗрдЦреЗрдВ /?target=https%3A//huggingface.co/docs/datasets/loading_datasets.html%23рд╕реНрдерд╛рдиреАрдп-рдлрд╝рд╛рдЗрд▓реЛрдВ рд╕реЗ)

рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрдорд╛рдВрдб рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ ~/.cache/huggingface/dataset рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рдХреИрд╢ рдХрд░рддрд╛ рд╣реИред рдЖрдк HF_HOME рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рд╕реЗрдЯ рдХрд░рдХреЗ рдХреИрд╢ рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рдХрд╕реНрдЯрдорд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╢рдмреНрджрдХреЛрд╢реЛрдВ рдХреА рддрд░рд╣, raw_datasets рдЗрдВрдбреЗрдХреНрд╕ рджреНрд╡рд╛рд░рд╛ рд╡рд╛рдХреНрдп рдЬреЛрдбрд╝реЗ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
raw_train_dataset = raw_datasets["рдЯреНрд░реЗрди"]
raw_train_рдбреЗрдЯрд╛рд╕реЗрдЯ[0]
```

```рдЕрдЬрдЧрд░
{'рдЖрдИрдбреАрдПрдХреНрд╕': 0,
'рд▓реЗрдмрд▓': 1,
'рд╡рд╛рдХреНрдп 1': 'рдЕрдорд░реЛрдЬрд╝реА рдиреЗ рдЕрдкрдиреЗ рднрд╛рдИ, рдЬрд┐рд╕реЗ рд╡реЗ "рдЧрд╡рд╛рд╣" рдХрд╣рддреЗ рдереЗ, рдкрд░ рдЬрд╛рдирдмреВрдЭрдХрд░ рдЙрдирдХреЗ рд╕рд╛рдХреНрд╖реНрдп рдХреЛ рд╡рд┐рдХреГрдд рдХрд░рдиреЗ рдХрд╛ рдЖрд░реЛрдк рд▓рдЧрд╛рдпрд╛рдЗред',
'рд╡рд╛рдХреНрдп 2': 'рдЙрдиреНрд╣реЗрдВ рдХреЗрд╡рд▓ "рдЧрд╡рд╛рд╣" рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддреЗ рд╣реБрдП, рдЕрдорд░реЛрдЬреА рдиреЗ рдЕрдкрдиреЗ рднрд╛рдИ рдкрд░ рдЬрд╛рдирдмреВрдЭрдХрд░ рдЙрдирдХреЗ рд╕рд╛рдХреНрд╖реНрдп рдХреЛ рд╡рд┐рдХреГрдд рдХрд░рдиреЗ рдХрд╛ рдЖрд░реЛрдк рд▓рдЧрд╛рдпрд╛ред'}
```
```рдЕрдЬрдЧрд░
рдкрд╛рдВрдбрд╛ рдХреЛ рдкреАрдбреА рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рд╕рддреНрдпрд╛рдкрди=pd.DataFrame(raw_datasets['рд╕рддреНрдпрд╛рдкрди'])
рдорд╛рдиреНрдпрдХрд░рдг
```
![рд╕рддреНрдпрд╛рдкрди](https://img-blog.csdnimg.cn/df0adbee66ba40dc862e64f5df5e0022.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA56We5rSb5Y2O,size_20 ,рд░рдВрдЧ_FFFFFF,t_70,g_se,x_16#pic_center)
рдпрд╣ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рд▓реЗрдмрд▓ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рд╣реИрдкреВрд░реНрдгрд╛рдВрдХ рдФрд░ рдХрд┐рд╕реА рдФрд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдХреЙрд▓рдо рдХрд╛ рдкреНрд░рдХрд╛рд░ raw_train_dataset рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```рдЕрдЬрдЧрд░
raw_train_dataset.features
```

```рдЕрдЬрдЧрд░
{'рд╡рд╛рдХреНрдп1': рдорд╛рди(dtype='string', id=None),
'рд╡рд╛рдХреНрдп2': рдорд╛рди(dtype='string', id=None),
'рд▓реЗрдмрд▓': рдХреНрд▓рд╛рд╕ рд▓реЗрдмрд▓(num_classes=2, рдирд╛рдо=['not_equivalent', 'рд╕рдорддреБрд▓реНрдп'], name_file=рдХреЛрдИ рдирд╣реАрдВ, id=рдХреЛрдИ рдирд╣реАрдВ),
'idx': рд╡реИрд▓реНрдпреВ(dtype='int32', id=None)}
```
рд▓реЗрдмрд▓ рдХреНрд▓рд╛рд╕рд▓реЗрдмрд▓ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИ, рд▓реЗрдмрд▓=1 рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╡рд╛рдХреНрдпреЛрдВ рдХреА рдЬреЛрдбрд╝реА ar рд╣реИрдПрдХ-рджреВрд╕рд░реЗ рдХреЗ рд▓рд┐рдП рдкреИрд░рд╛рдлреНрд░реЗрд╢, рд▓реЗрдмрд▓ = 0 рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╡рд╛рдХреНрдп рдЬреЛрдбрд╝реА рдореЗрдВ рдЕрд╕рдВрдЧрдд рдЕрд░реНрде рд╣реИрдВред

### рдбреЗрдЯрд╛рд╕реЗрдЯ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ
>рдпреВрдЯреНрдпреВрдм рд╡реАрдбрд┐рдпреЛ [уАКрдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рд╡рд╛рдХреНрдп рдЬреЛрдбрд╝реЗуАЛ](https://youtu.be/0u3ioSwev3s)

рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рдЙрди рд╕рдВрдЦреНрдпрд╛рдУрдВ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдореЙрдбрд▓ рд╕рдордЭ рд╕рдХрддрд╛ рд╣реИред

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЪреЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ = "рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб"
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(рдЪреЗрдХрдкреЙрдЗрдВрдЯ)
```
рдЖрдЗрдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ:
```рдЕрдЬрдЧрд░
рдЗрдирдкреБрдЯреНрд╕ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ ("рдпрд╣ рдкрд╣рд▓рд╛ рд╣реИрд╡рд╛рдХреНрдпред", "рдпрд╣ рджреВрд╕рд░рд╛ рд╣реИред")
рдЖрджрд╛рдиреЛрдВ
```

```рдЕрдЬрдЧрд░
{'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [101, 2023, 2003, 1996, 2034, 6251, 1012, 102, 2023, 2003, 1996, 2117, 2028, 1012, 102],
'рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА': [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1],
'рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}
```
рдЗрд╕рд▓рд┐рдП рд╡рд╛рдХреНрдп рдпреБрдЧреНрдореЛрдВ рдХреА рд╕реВрдЪреА рдХреЛ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдореЗрдВ рдкрд╛рд╕ рдХрд░рдХреЗ, рд╣рдо рд╕рдВрдкреВрд░реНрдг рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝реЗрд╢рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИ:```рдкрд╛рдпрдерди
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = рдЯреЛрдХрдиреАрдЬрд╝реЗрд░(
raw_datasets["рдЯреНрд░реЗрди"]["рд╡рд╛рдХреНрдп1"],
raw_datasets["рдЯреНрд░реЗрди"]["рд╡рд╛рдХреНрдп2"],
рдкреИрдбрд┐рдВрдЧ = рд╕рддреНрдп,
рдХрд╛рдЯ-рдЫрд╛рдБрдЯ = рд╕рддреНрдп,
)
```
рдпрд╣ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╡рд┐рдзрд┐ рдареАрдХ рд╣реИ, рд▓реЗрдХрд┐рди рдиреБрдХрд╕рд╛рди рдпрд╣ рд╣реИ рдХрд┐ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдмрд╛рдж, рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рдЕрдм рдбреЗрдЯрд╛рд╕реЗрдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд▓реМрдЯрд╛рддрд╛ рд╣реИ (рд╣рдорд╛рд░реА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде: рдЗрдирдкреБрдЯ_рдЖрдИрдбреА, рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ рдФрд░ рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА, рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдХреБрдВрдЬреА-рдореВрд▓реНрдп рдЬреЛрдбрд╝реЗ)ред рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдореЛрд░реА рдореЗрдВ рдлрд╝рд┐рдЯ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдмрдбрд╝рд╛ рд╣реИ, рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЖрдЙрдЯ рдСрдлрд╝ рдореЗрдореЛрд░реА рдЕрдкрд╡рд╛рдж рдХрд╛ рдХрд╛рд░рдг рдмрдиреЗрдЧрд╛рдЯреИрд╕реЗрдЯреНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдбрд┐рд╕реНрдХ рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдЕрдкрд╛рдЪреЗ рдПрд░реЛ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд▓реЛрдб рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдирдореВрдиреЗ рд╕рднреА рдореЗрдореЛрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИрдВ)ред

рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рдХреЛ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЕрдзрд┐рдХ рд▓рдЪреАрд▓реА рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдпрд╣ рд╡рд┐рдзрд┐ рдХреЗрд╡рд▓ рдЯреЛрдХрдирдирд╛рдЗрдЬреЗрд╢рди рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЛ рдкреВрд░рд╛ рдХрд░ рд╕рдХрддреА рд╣реИред рдореИрдк рд╡рд┐рдзрд┐ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХреЛ рдореИрдк рдкрд░ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ рд╕рдорд╛рди рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рддреЛ рдЖрдЗрдП рдЗрдирдкреБрдЯ рдХреЛ рдЯреЛрдХрдирд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ:

```рдЕрдЬрдЧрд░
рдбреАрдИрдПрдлрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝_рдлрдВрдХреНрд╢рди(рдЙрджрд╛рд╣рд░рдг):
рд░рд┐рдЯрд░реНрди рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ (example["рд╡рд╛рдХреНрдп1"], рдЙрджрд╛рд╣рд░рдг["рд╡рд╛рдХреНрдп2"], рдХрд╛рдЯ-рдЫрд╛рдБрдЯ=рд╕рддреНрдп)
```
рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд▓реЗрддрд╛ рд╣реИ (рд╣рдорд╛рд░реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдЖрдЗрдЯрдо рдХреА рддрд░рд╣) рдФрд░ рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд▓реМрдЯрд╛рддрд╛ рд╣реИ (рддреАрди рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде: рдЗрдирдкреБрдЯ_рдЖрдИрдбреА, рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ, рдФрд░ рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА)ред

рдкреИрдбрд┐рдВрдЧ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдЯреЛрдХрдирдирд╛рдЗрдЬреЗрд╢рди рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдкреВрд░реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреА рдЕрдзрд┐рдХрддрдо рдЕрдиреБрдХреНрд░рдо рд▓рдВрдмрд╛рдИ рдХреЗ рд╕рднреА рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЛ рдкреИрдб рдХрд░рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмреИрдЪ рдореЗрдВ рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реИред рдЗрд╕рд╕реЗ рдмрд╣реБрдд рд╕рдордп рдФрд░ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╢рдХреНрддрд┐ рдХреА рдмрдЪрдд рд╣реЛ рд╕рдХрддреА рд╣реИ рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдордЕрддрдГ рд▓рдВрдмрд╛рдИ рдмрд╣реБрдд рдЕрд╕рдВрдЧрдд рд╣реИ!

рдиреАрдЪреЗ рдкреВрд░реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░ рд▓рд╛рдЧреВ рдЯреЛрдХрдирд╛рдЗрдЬреЗрд╢рди рд╡рд┐рдзрд┐ рд╣реИред рд╣рдордиреЗ рдореИрдк рдХреЙрд▓ рдореЗрдВ рдмреИрдЪ = рдЯреНрд░реВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХреЗ рдмрдЬрд╛рдп рдПрдХ рд╣реА рдмрд╛рд░ рдореЗрдВ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рдкреВрд░реЗ рдмреИрдЪ рдкрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд╕реЗ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рддреЗрдЬ рд╣реЛ рдЬрд╛рддреА рд╣реИ (рдХреНрдпреЛрдВрдХрд┐ ЁЯдЧрдЯреЛрдХрдирд╛рдЗрдЬрд░реНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдЯреАрдЯреЛрдХрдирд╛рдЗрдЬрд░ рд░рд╕реНрдЯ рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдПрдХ рд╕рд╛рде рдмрд╣реБрдд рд╕рд╛рд░реЗ рдЗрдирдкреБрдЯ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддреЗ рд╕рдордп рдмрд╣реБрдд рддреЗрдЬ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред

```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = raw_рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк(рдЯреЛрдХрдирд╛рдЗрдЬ_рдлрдВрдХреНрд╢рди, рдмрд╛tched=рд╕рддреНрдп)
рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ
```
ЁЯдЧ рдЬрд┐рд╕ рддрд░рд╣ рд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЗрд╕ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ, рд╡рд╣ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдПрдХ рдирдпрд╛ рдлрд╝реАрд▓реНрдб рдЬреЛрдбрд╝рдХрд░ рд╣реЛрддрд╛ рд╣реИ, рдЬреИрд╕реЗ:
```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ({
рдЯреНрд░реЗрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ', 'рдЖрдИрдбреАрдПрдХреНрд╕', 'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА', 'рд▓реЗрдмрд▓', 'рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА'],
рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 3668
})
рд╕рддреНрдпрд╛рдкрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ', 'рдЖрдИрдбреАрдПрдХреНрд╕', 'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА', 'рд▓реЗрдмрд▓', 'рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА'],
рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 3668
})рдПрд╕'],
рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 408
})
рдкрд░реАрдХреНрд╖рдг: рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдЕрдЯреЗntion_mask', 'idx', 'input_ids', 'label', 'sentence1', 'sentence2', 'token_type_ids'],
рд╕рдВрдЦреНрдпрд╛ рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 1725
})
})
```
>рдпрджрд┐ рдЖрдк рдЗрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рддреЗрдЬрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдк рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЛ рддреЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддреЗ рд╕рдордп рдорд▓реНрдЯреА-рдереНрд░реЗрдбреЗрдб рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП num_proc рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЕрдВрдд рдореЗрдВ, рдЬрдм рд╣рдо рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдХреЛ рдмреИрдЪ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рд╕рднреА рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЛ рдЗрд╕ рдмреИрдЪ рдореЗрдВ рд╕рдмрд╕реЗ рд▓рдВрдмреЗ рдЕрдиреБрдХреНрд░рдо рдХреА рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ - рд╣рдо рдЗрд╕реЗ рдбрд╛рдпрдиреЗрдорд┐рдХ рдкреИрдбрд┐рдВрдЧ рдХрд╣рддреЗ рд╣реИрдВ (рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ: рдкреИрдбрд┐рдирдкреНрд░рддреНрдпреЗрдХ рдмреИрдЪ рдХрд╛ рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рд╕рдорд╛рди рд▓рдВрдмрд╛рдИ рддрдХ рд╣реЛред рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рд╛рдордЧреНрд░реА рдЕрдВрдд рдореЗрдВ рд╣реИ)ред
### рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PyTorch рдореЗрдВ рдлрд╝рд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ
рдЪреВрдВрдХрд┐ PyTorch рдПрдХ рд▓рдкреЗрдЯрд╛ рд╣реБрдЖ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реВрдк рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдиреЗ рдПрдХ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░.рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рд▓рд┐рдЦрд╛ рд╣реИ, рдЬреЛ рдПрдХ рд╕рд░рд▓ рд▓реЗрдХрд┐рди рдПрдХ рдкреВрд░реНрдг-рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рд╡рд╛рд▓рд╛ PyTorch рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рд▓реВрдк рд╣реИ рдЬреЛ ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреВрд▓рд┐рдд рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдХрдИ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╡рд┐рдХрд▓реНрдк рдФрд░ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдлрд╝рдВрдХреНрд╢рди рд╣реИрдВред рдФрд░ рдорд▓реНрдЯреА-рдЬреАрдкреАрдпреВ/рдЯреАрдкреАрдпреВ рд╡рд┐рддрд░рд┐рдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдорд┐рд╢реНрд░рд┐рдд рдкрд░рд┐рд╢реБрджреНрдзрддрд╛ рдХрд╛ рднреА рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЯреНрд░реЗрдирд░ рдПрдкреАрдЖрдИ рдПрдХ рдкреИрдХреЗрдЬреНрдб рдЯреНрд░реЗрдирд░ рд╣реИ (рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдирд┐рд░реНрдорд┐рдд рдПрдХ рдЫреЛрдЯрд╛ рдврд╛рдВрдЪрд╛, рдпрд╛ рдЯреЗрдиреНрд╕рд░рдлреНрд▓реЛ рдХреЗ рд▓рд┐рдП рдЯреАрдПрдлрдЯреНрд░реЗрдирд░)ред

рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЯреНрд░реЗрдирд░ рд╢реБрд░реБрдЖрдд рдореЗрдВ рдореМрдЬреВрдж рдирд╣реАрдВ рдерд╛ (рдпрд╣ рд╢реБрд░реБрдЖрддреА рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдореМрдЬреВрдж рдирд╣реАрдВ рдерд╛), рдФрд░ рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рд╛рд░реЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдПрдирдПрд▓рдкреА рдХрд╛рд░реНрдп рдореЗрдВ рдХрдИ рд╕рд╛рдорд╛рдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рд╣реЛрддреЗ рд╣реИрдВ, рдЗрдиреНрд╣реЗрдВ рдЯреНрд░реЗрдирд░ рджреНрд╡рд╛рд░рд╛ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╕рдордЭрд╛ рдЬрд╛рддрд╛ рд╣реИ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдордЭ рдХреЗ рд▓рд┐рдП, рдЖрдк [рдЯреНрд░реЗрдирд░ рдХреЛрдб](https://github.com/huggingface/transformers/blob/m) рдХрд╛ рдореВрд▓ рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВрдбреБрдУрдбреБрдУ рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдЦрд┐рдд aster/examples/pytorch/multiple-choice/run_swag.py) рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╢реБрд░реВ рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЖрд╡рд╢реНрдпрдХ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдорд░реНрдЬ рдХрд░ рджреЗрддрд╛ рд╣реИред

рдбреЗрдЯрд╛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдЯреНрд░реЗрдирд░ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдХреБрдЫ рд╕рд░рд▓ рдХрджрдо рдЙрдард╛рдиреЗ рдкрдбрд╝рддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рдЖрдк рдореЙрдбрд▓ рдХрд╛ рдмреБрдирд┐рдпрд╛рджреА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реВрдк рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЕрдиреНрдпрдерд╛, рдЖрдкрдХреЛ рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдХреНрд░реИрдЪ рд╕реЗ рд▓реЛрдб рдФрд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рд╡рд┐рднрд┐рдиреНрди рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдФрд░ рдЪрд░рдг рджрд░ рдЪрд░рдг рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реВрдк рд▓рд┐рдЦреЗрдВред рдХрд╕реНрдЯрдо рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реВрдк рдХреА рд╕рд╛рдордЧреНрд░реА рдЗрд╕ рдЦрдВрдб рдХреЗ рдЕрдВрдд рдореЗрдВ рд╣реИрдЖрдпрди)ред рдЯреНрд░реЗрдирд░ рдХрд╛ рд╕рдмрд╕реЗ рдХрдард┐рди рд╣рд┐рд╕реНрд╕рд╛ рд╢рд╛рдпрдж рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рддрд╛рд╡рд░рдг рддреИрдпрд╛рд░ рдХрд░рдирд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕реАрдкреАрдпреВ рдкрд░ рдмрд╣реБрдд рдзреАрдореА рдЧрддрд┐ рд╕реЗ рдЪрд▓рддрд╛ рд╣реИ (рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЬреАрдкреАрдпреВ рд╕реЗрдЯ рдЕрдк рдирд╣реАрдВ рд╣реИ, рддреЛ рдЖрдк Google рдкрд░ рдореБрдлреНрдд рдЬреАрдкреАрдпреВ рдпрд╛ рдЯреАрдкреАрдпреВ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХреЛрд▓рд╛рдм)

рдкреНрд░рд╢рд┐рдХреНрд╖рдХ рдХреЗ рдореБрдЦреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВ:
- рдореЙрдбрд▓: рдкреНрд░рд╢рд┐рдХреНрд╖рдг, рдореВрд▓реНрдпрд╛рдВрдХрди рдпрд╛ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдореЙрдбрд▓
- рддрд░реНрдХ (рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ): рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреИрд░рд╛рдореАрдЯрд░ред рдпрджрд┐ рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдХреЗ рдЖрдзрд╛рд░ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╣реЛрдЧрд╛
- рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ (рдбреЗрдЯрд╛рдХреЛрд▓реЗрдЯрд░, рд╡реИрдХрд▓реНрдкрд┐рдХ) - рдПрдХ рдордЬреЗрджрд╛рд░рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ рдпрд╛ eval_рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдмреИрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ
- рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ: рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ
- eval_dataset: рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ
- рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕: рдореВрд▓реНрдпрд╛рдВрдХрди рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдкрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдореАрдЯреНрд░рд┐рдХ рдФрд░ рдЙрд╕рдХреЗ рдореВрд▓реНрдп рд╡рд╛рд▓реЗ рдХреБрдВрдЬреА-рдореВрд▓реНрдп рдЬреЛрдбрд╝реЗ рдХреЗ рд╕рд╛рде рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд▓реМрдЯрд╛рдПрдЧрд╛ред
- рдХреЙрд▓рдмреИрдХ (рдХреЙрд▓рдмреИрдХ рдлрд╝рдВрдХреНрд╢рди, рд╡реИрдХрд▓реНрдкрд┐рдХ): рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реВрдк рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрд▓рдмреИрдХ рдХреА рдПрдХ рд╕реВрдЪреА (рдЯреНрд░реЗрдирд░рдХреЙрд▓рдмреИрдХ рдХреА рд╕реВрдЪреА)
- рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд░: рдПрдХ рдЯрдкрд▓ рдЬрд┐рд╕рдореЗрдВ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд░ рдФрд░ рд╕реАрдЦрдиреЗ рдХреА рджрд░ рд╕рдорд╛рдпреЛрдЬрдХ рд╢рд╛рдорд┐рд▓ рд╣реИрдВoup, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд░ рдПрдбрдордбрдмреНрд▓реНрдпреВ рд╣реИ, рдФрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реАрдЦрдиреЗ рдХреА рджрд░ 5e-5 рд╕реЗ 0 рддрдХ рдПрдХ рд░реИрдЦрд┐рдХ рд╕реАрдЦрдиреЗ рдХреА рджрд░ рд╣реИ

рдЙрдкрд░реЛрдХреНрдд рдореБрдЦреНрдп рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ рдкреИрд░рд╛рдореАрдЯрд░ рдФрд░ рдЧреБрдг рд╣реИрдВ (рдЙрдирдореЗрдВ рд╕реЗ рджрд░реНрдЬрдиреЛрдВ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП, рдЖрдк рдЙрдиреНрд╣реЗрдВ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдирд╛ рд╕рдордп рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдВрдкреВрд░реНрдг рдЯреНрд░реЗрдирд░ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдпрд╣рд╛рдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ](https://huggingface.co/transformers /main_classes/trainer.html?highlight=trainer#transformers.Trainer))

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдиреЗ рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд▓рд┐рдпрд╛ рд╣реИрдЗрд╡рд┐рдЕрд╕ рдЕрдиреБрднрд╛рдЧ:

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoTokenizer, DataCollatorWithPadding рдЖрдпрд╛рдд рдХрд░реЗрдВ

raw_datasets = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ('рдЧреЛрдВрдж', 'mrpc')#MRPC рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рджреЛ рд╡рд╛рдХреНрдп рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рдкреИрд░рд╛рдлреНрд░реЗрд╢ рд╣реИрдВ
рдЪреЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ = "рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб"
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(рдЪреЗрдХрдкреЙрдЗрдВрдЯ)

рдбреАрдИрдПрдлрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝_рдлрдВрдХреНрд╢рди(рдЙрджрд╛рд╣рд░рдг):
рд╡рд╛рдкрд╕реА рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ (рдЙрджрд╛рд╣рд░рдг["рд╡рд╛рдХреНрдп1"], рдЙрджрд╛рд╣рд░рдг["рд╡рд╛рдХреНрдп2"], рдХрд╛рдЯ-рдЫрд╛рдБрдЯ=рд╕рддреНрдп)

рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = raw_рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк(рдЯреЛрдХрдирд╛рдЗрдЬ_рдлрдВрдХреНрд╢рди, рдмреИрдЪ =рд╕рддреНрдп)

рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ = рдбреЗрдЯрд╛рдХреЛрд▓реЗрдЯрд░рд╡рд┐рдердкреИрдбрд┐рдВрдЧ(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░=рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░)# рдбрд╛рдпрдиреЗрдорд┐рдХ рдкреИрдбрд┐рдВрдЧ, рдпрд╛рдиреА, рдкреНрд░рддреНрдпреЗрдХ рдмреИрдЪ рдХреЗ рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдХреЛ рд╕рдорд╛рди рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдбрд┐рдВрдЧ рдХрд░рдирд╛
```

#### рдкреНрд░рд╢рд┐рдХреНрд╖рдг
рдЯреНрд░реЗрдирд░ рдХрд╛ рдкрд╣рд▓рд╛ рдкреИрд░рд╛рдореАрдЯрд░ рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕ рдХреНрд▓рд╛рд╕ рд╣реИ, рдЬреЛ рдЯреНрд░реЗрдирд┐рдВрдЧ рд▓реВрдк рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдПрдХ рд╕рдмрд╕реЗрдЯ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЯреНрд░реЗрдирд░ рдореЗрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рд╣рд╛рдЗрдкрд░рдкреИрд░рд╛рдореАрдЯрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдПрдХрдорд╛рддреНрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдЬреЛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рд╡рд╣ рд╣реИ: рд╡рд╣ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЬрд╣рд╛рдВ рдореЙрдбрд▓ рдпрд╛ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЕрдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ 3 рдпреБрдЧреЛрдВ рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░рд╢рд┐рдХреНрд╖рдг, рдЖрджрд┐) (рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕ рдореЗрдВ рджрд░реНрдЬрдиреЛрдВ рдкреИрд░рд╛рдореАрдЯрд░ рднреА рд╣реИрдВ, рд╕рд╛рдорд╛рдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рд▓реЗрдЦ рдХреЗ рдЕрдВрдд рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рд╣реИрдВ, рдФрд░ рдкреВрд░рд╛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдКрдкрд░ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдЯреНрд░реЗрдирд░ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ)

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧреНрд╕ = рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ("рдкрд░реАрдХреНрд╖рдг-рдкреНрд░рд╢рд┐рдХреНрд╖рдХ")
```
рдЪрд░рдг 2: рдореЙрдбрд▓ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ
рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдХреА рддрд░рд╣, рд╣рдо рджреЛ рд▓реЗрдмрд▓ рдХреЗ рд╕рд╛рде AutoModelForSequenceClassification рдХреНрд▓рд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ:(***рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдХрд╛рд░реНрдп рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХрд╛рд░реНрдп рдкреНрд░рдореБрдЦ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ***)
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForSequenceClassification рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдореЙрдбрд▓ = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=2)#рд▓реЗрдмрд▓ рдХреА рд╕рдВрдЦреНрдпрд╛ 2 рд╣реИ, рдЬреЛ рдмрд╛рдЗрдирд░реА рд╡рд░реНрдЧреАрдХрд░рдг рд╣реИ
```
рдЗрд╕ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдПрдХ рдЪреЗрддрд╛рд╡рдиреА рдХреА рд╕реВрдЪрдирд╛ рджреА рдЬрд╛рдПрдЧреА рдХреНрдпреЛрдВрдХрд┐ BERT рдХреЛ рд╡рд╛рдХреНрдп рдпреБрдЧреНрдо рд╡рд░реНрдЧреАрдХрд░рдг рдореЗрдВ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдкреНрд░рдореБрдЦ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИредрдХрд╛рд░реНрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЕрдиреБрдХреНрд░рдо рд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рдПрдХ рдирдпрд╛ рд╢реАрд░реНрд╖ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╣реИ, рдЪреЗрддрд╛рд╡рдиреА рдЗрдВрдЧрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдХреБрдЫ рд╡рдЬрд╝рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЫреЛрдбрд╝реЗ рдЧрдП рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рд╕рд┐рд░ рднрд╛рдЧ рдХреЗ рдЕрдиреБрд░реВрдк), рдЬрдмрдХрд┐ рдХреБрдЫ рдЕрдиреНрдп рднрд╛рд░ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ (рдирдпрд╛ рд╢реАрд░реНрд╖ рдЕрдиреБрднрд╛рдЧ), рдФрд░ рдЕрдВрдд рдореЗрдВред рдЖрдкрдХреЛ рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрддреНрд╕рд╛рд╣рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдореЙрдбрд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдПрдХ рдЯреНрд░реЗрдирд░ рдЯреНрд░реЗрдирд░ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдореЙрдбрд▓ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдм рддрдХ рдмрдирд╛рдП рдЧрдП рд╕рднреА рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЛ рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрди рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ: рдореЙрдбрд▓, рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧ, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рд╕рддреНрдпрд╛рдкрди рдбреЗрдЯрд╛рд╕реЗрдЯ, рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ рдФрд░ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ (рдпреЗ рд╕рднреА рдЯреНрд░реЗрдирд░ рдХреЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВ):

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдЯреНрд░реЗрдирд░ рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ

рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
рдирдореВрдирд╛,
рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧ,
рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
eval_dataset=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"],
рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░=рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░,
рдЯреЛрдХрдирдирд╛рдЗрдЬрд░=рдЯреЛрдХрдирд╛рдЗрдЬрд░,
)
```
рдЙрдкрд░реЛрдХреНрдд рдХреА рддрд░рд╣ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдкрд╛рд╕ рдХрд░рддреЗ рд╕рдордп, рдкреИрд░рд╛рдореАрдЯрд░ data_colllator рдкрд╣рд▓реЗ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ DataCollatorWithPadding рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕ рдХреЙрд▓ рдореЗрдВ data_collator=data ta_colllator рд▓рд╛рдЗрди b рд╣реЛ рд╕рдХрддреА рд╣реИрдИ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЧрдпрд╛ред (рд▓реЗрдХрд┐рди рдЕрдиреБрднрд╛рдЧ 2 рдореЗрдВ рдЖрдкрдХреЛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдпрд╣ рднрд╛рдЧ рджрд┐рдЦрд╛рдирд╛ рдЕрднреА рднреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рдерд╛!)

рдЕрдкрдиреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░ рдореЙрдбрд▓ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдмрд╕ рдЯреНрд░реЗрдирд░ рдХреА рдЯреНрд░реЗрди рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```
рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ (рдЬреАрдкреАрдпреВ рдХреЗ рд╕рд╛рде рдХреЛрд▓рд╛рдм рдкрд░ рд▓рдЧрднрдЧ 6 рдорд┐рдирдЯ), рдФрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрд▓рдо рдореЗрдВ `BertForSequenceClassification.forward` рдореЗрдВ рдХреЛрдИ рд╕рдВрдЧрдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: рд╡рд╛рдХреНрдп 1, рд╡рд╛рдХреНрдп 2, idxред
***** рд░рдирд┐рдВрдЧ рдЯреНрд░реИрдЗрдирд┐рдВрдЧ*****
рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 3668
рдпреБрдЧреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 3
рдкреНрд░рддрд┐ рдЙрдкрдХрд░рдг рддрд╛рддреНрдХрд╛рд▓рд┐рдХ рдмреИрдЪ рдЖрдХрд╛рд░ = 8
рдХреБрд▓ рдЯреНрд░реЗрди рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ (рд╕рдорд╛рдирд╛рдВрддрд░, рд╡рд┐рддрд░рд┐рдд рдФрд░ рд╕рдВрдЪрдп рд╕рд╣рд┐рдд) = 8
рдХреНрд░рдорд┐рдХ рд╕рдВрдЪрдп рдЪрд░рдг = 1
рдХреБрд▓ рдЕрдиреБрдХреВрд▓рди рдЪрд░рдг = 1377

рдЪрд░рдг рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐
500 0.544700
1000 0.326500

рдЯреНрд░реЗрдирдЖрдЙрдЯрдкреБрдЯ(рдЧреНрд▓реЛрдмрд▓_рд╕реНрдЯреЗрдк=1377, рдЯреНрд░реЗрдирд┐рдВрдЧ_рд▓реЙрд╕=0.3773723704795865, рдореЗрдЯреНрд░рд┐рдХреНрд╕={'рдЯреНрд░реЗрди_рд░рдирдЯрд╛рдЗрдо': 379.1704, 'рдЯреНрд░реЗрди_рд╕реИрдВрдкрд▓реНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 29.021, 'рдЯреНрд░реЗрди_рд╕реНрдЯреЗрдкреНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 3.632, 'рдЯреЛрдЯрд▓_рдлреНрд▓реЛрд╕': 405470580750720ред 0, 'рдЯреНрд░реЗрди_рд▓реЙрд╕': 0.3773723704795865, 'рдпреБрдЧ': 3.0})
# рд░рди рдХреЗ рджреМрд░рд╛рди рдХреЗрд╡рд▓ 500 рдЪрд░рдгреЛрдВ рдФрд░ 1000 рдЪрд░рдгреЛрдВ рдХреЗ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ рдЕрдВрддрд┐рдо рдкрд░рд┐рдгрд╛рдо 1377 рдЪрд░рдгреЛрдВ рдХрд╛ рд╣реЛрддрд╛ рд╣реИ, рдЕрдВрддрд┐рдо рд╣рд╛рдирд┐ 0.377 рд╣реЛрддреА рд╣реИ
```

рд╣рдо рдкрд╣рд▓реЗ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рдж рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"]
```
```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ', 'рдЖрдИрдбреАрдПрдХреНрд╕', 'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА', 'рд▓реЗрдмрд▓', 'рд╡рд╛рдХреНрдп1', 'рд╡рд╛рдХреНрдп2', 'рдЯреЛрдХрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА'],
рд╕рдВрдЦреНрдпрд╛_рдкрдВрдХреНрддрд┐рдпрд╛рдБ: 408
})
```
рд╣рдо рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░.рдкреНрд░реЗрдбрд┐рдХреНрдЯ рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрдореЙрдбрд▓ рдХрд╛:
```рдЕрдЬрдЧрд░
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = рдЯреНрд░реЗрдирд░.рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА(рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"])
рдкреНрд░рд┐рдВрдЯ(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ.рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ.рдЖрдХрд╛рд░, рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ.рд▓реЗрдмрд▓_рдЖрдИрдбреА.рдЖрдХрд╛рд░)
```

```рдЕрдЬрдЧрд░
(408, 2) (408,)
```
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рд╡рд┐рдзрд┐ рддреАрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдЯреБрдкрд▓ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддреА рд╣реИред
- рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди: рдЕрдиреБрдорд╛рдирд┐рдд рдорд╛рди, рдЖрдХрд╛рд░: [рдмреИрдЪ_рдЖрдХрд╛рд░, рд╕рдВрдЦреНрдпрд╛_рд▓реЗрдмрд▓], рдЬреЛ рд╕реЙрдлреНрдЯрдореИрдХреНрд╕ рдХреЗ рдмрд╛рдж рдкрд░рд┐рдгрд╛рдо рдХреЗ рдмрдЬрд╛рдп рд▓реЙрдЧ рд╣реЛрддрд╛ рд╣реИ
- рд▓реЗрдмрд▓_рдЖрдИрдбреА: рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЗрдмрд▓ рдЖрдИрдбреА
- рдореЗрдЯреНрд░рд┐рдХреНрд╕: рдореВрд▓реНрдпрд╛рдВрдХрди рд╕рдВрдХреЗрддрдХ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐ рд╣реИ, рдФрд░ рдХреБрдЫ рд╕рдордп рдореЗрдЯреНрд░рд┐рдХреНрд╕ (рдХреБрд▓ рд╕рдордп рдФрд░ рдФрд╕рдд)редрднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП рдЖрдпреБ рд╕рдордп рдЖрд╡рд╢реНрдпрдХ рд╣реИ)ред рд▓реЗрдХрд┐рди рдПрдХ рдмрд╛рд░ рдЬрдм рд╣рдо рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЯреНрд░реЗрдирд░ рдХреЛ рдкрд╛рд╕ рдХрд░ рджреЗрддреЗ рд╣реИрдВ, рддреЛ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рд░рд┐рдЯрд░реНрди рдорд╛рди рднреА рдЖрдЙрдЯрдкреБрдЯ рд╣реЛ рдЬрд╛рдПрдЧрд╛

![рдПрдордЖрд░рдкреАрд╕реА](https://img-blog.csdnimg.cn/7a920b0dddf147cf87b38fb18a0ad0a8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA56We5rSb5Y2O,size_ 20, рд░рдВрдЧ_FFFFFF,t_70,g_se,x_16#pic_center)
```рдЕрдЬрдЧрд░
рдореЗрдЯреНрд░рд┐рдХреНрд╕ = {'рдЯреЗрд╕реНрдЯ_рд▓реЙрд╕': 0.6269022822380066, 'рдЯреЗрд╕реНрдЯ_рд░рдирдЯрд╛рдЗрдо': 4.0653, 'рдЯреЗрд╕реНрдЯ_рд╕реИрдВрдкрд▓реНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 100.362, 'рдЯреЗрд╕реНрдЯ_рд╕реНрдЯреЗрдкреНрд╕_рдкрд░_рд╕реЗрдХрдВрдб':12.545})
```
рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди 408 x 2 (408 рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ, рджреЛ рд▓реЗрдмрд▓) рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде рдПрдХ 2рдбреА рд╕рд░рдгреА рд╣реИред рд▓реЗрдмрд▓ рдХреЗ рд╕рд╛рде рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдиреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдиреЛрдВ рдХреЗ рджреВрд╕рд░реЗ рдЕрдХреНрд╖ рдкрд░ рдЕрдзрд┐рдХрддрдо рдореВрд▓реНрдп рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рд▓реЗрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
```рдЕрдЬрдЧрд░
рдПрдирдкреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реБрдиреНрди рдЖрдпрд╛рдд рдХрд░реЗрдВ
preds = np.argmax(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ.рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рдЕрдХреНрд╖=-1)
```
рд╕рд╛рде рд╣реА, рдЙрдкрд░реЛрдХреНрдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ, рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдореЙрдбрд▓ рд╣рд░ 500 рдХрджрдо рдкрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐ рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдЖрдкрдХреЛ рдпрд╣ рдирд╣реАрдВ рдмрддрд╛рддрд╛ рдХрд┐ рдореЙрдбрд▓ рдХрд┐рддрдирд╛ рдЕрдЪреНрдЫрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддрд╛ рд╣реИause:
1. рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ рдкреИрд░рд╛рдореАрдЯрд░ рдореЙрдбрд▓ рдХреЛ рдпрд╣ рдмрддрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдПрдХ рдмрд╛рд░ рдиреБрдХрд╕рд╛рди рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рддрдиреЗ "рдЪрд░рдг" (eval_steps) рдпрд╛ "рдпреБрдЧ" рд╣реИрдВред
2. рдкреНрд░рд╢рд┐рдХреНрд╖рдХ рдХрд╛ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореВрд▓реНрдпрд╛рдВрдХрди рд╕рдВрдХреЗрддрдХреЛрдВ рдХреЗ рдореВрд▓реНрдпреЛрдВ рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ (рдЬреИрд╕реЗ рдПрд╕реАрд╕реА, рдПрдл1 рд╕реНрдХреЛрд░, рдЖрджрд┐)ред рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдХреЗ рдмрд┐рдирд╛, рдХреЗрд╡рд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддреА рд╣реИ, рдЬреЛ рдПрдХ рд╕рд╣рдЬ рд╕рдВрдЦреНрдпрд╛ рдирд╣реАрдВ рд╣реИред

рдпрджрд┐ рд╣рдо рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдлрд╝рдВрдХреНрд╢рди рд▓рд┐рдЦрдиреЗ рдФрд░ рдЯреНрд░реЗрдирд░ рдХреЛ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдлрд╝реАрд▓реНрдб рдореЗрдВ рдореЗрдЯреНрд░рд┐рдХ v рднреА рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧрд╛рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рджреНрд╡рд╛рд░рд╛ рд▓реМрдЯрд╛рдП рдЧрдП рдорд╛рдиред
#### рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд╛рд░реНрдп
рдЕрдм рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХреИрд╕реЗ рдХрд░реЗрдВ:
- EvalPrediction рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдкрд╛рд╕ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП EvalPrediction рдПрдХ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдлрд╝реАрд▓реНрдб рдФрд░ рдПрдХ label_ids рдлрд╝реАрд▓реНрдб рдХреЗ рд╕рд╛рде рдПрдХ рдЯрдкрд▓ рд╣реИред
- рдХреБрдВрдЬреА рдХреЗ рдХреБрдВрдЬреА-рдореВрд▓реНрдп рдЬреЛрдбрд╝реЗ рдХреЗ рд╕рд╛рде рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд▓реМрдЯрд╛рддрд╛ рд╣реИ: рдореАрдЯреНрд░рд┐рдХ рдирд╛рдо (рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкреНрд░рдХрд╛рд░), рдорд╛рди: рдореАрдЯреНрд░рд┐рдХ рдорд╛рди (рдлреНрд▓реЛрдЯ рдкреНрд░рдХрд╛рд░)ред

***рдпрд╣реА рд╣реИ [рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ 4.1](https://datawhalechina.github.io/learn-nlp-with-transformers/#/./%E7%AF%87%E7%AB%A04-%E4%BD %рдмреАрдПрдл%рдИ7%94%A8рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░%E8%A7%A3%E5%86%B3NLP%E4%BB%BB%E5%8A%A1/4.1-%E6%96%87%E6%9C%AC%E5%88%86%E7 %B1%BB) рдиреЗ рдХрд╣рд╛: рдореАрдЯреНрд░рд┐рдХ рдХреА рдЧрдгрдирд╛ рд╡рд┐рдзрд┐ рдХреЛ рд╕реАрдзреЗ рдХреЙрд▓ рдХрд░реЗрдВ рдФрд░ рдореАрдЯреНрд░рд┐рдХ рдХрд╛ рдореВрд▓реНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЗрдмрд▓ рдФрд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдХреЛ рдкрд╛рд╕ рдХрд░реЗрдВред рдХреЗрд╡рд▓ рдРрд╕рд╛ рдХрд░рдиреЗ рд╕реЗ рд╣рдо рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдПрд╕реАрд╕реА рдФрд░ рдПрдл1 рдЬреИрд╕реЗ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдВрдХреЗрддрдХ рддрджрдиреБрд╕рд╛рд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ)ред рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП)***

рдЕрдкрдиреЗ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдореАрдЯреНрд░рд┐рдХ рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░реЗрдВрдЧреЗ, рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде, рд╣рдо рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрдПрдордЖрд░рдкреАрд╕реА рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдЬреБрдбрд╝реА рдореАрдЯреНрд░рд┐рдХ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдЬрд┐рддрдиреА рд╣реА рдЖрд╕рд╛рдиреА рд╕реЗ рджреА рдЧрдИ рд╡рд╕реНрддреБ рдореЗрдВ рдПрдХ рдЧрдгрдирд╛ рд╡рд┐рдзрд┐ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рдо рдореАрдЯреНрд░рд┐рдХ рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдореАрдЯреНрд░рд┐рдХ = рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ ("рдЧреЛрдВрдж", "рдПрдордЖрд░рдкреАрд╕реА")
metric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди, рд╕рдВрджрд░реНрдн=рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ.рд▓реЗрдмрд▓_рдЖрдИрдбреА)
```

```рдЕрдЬрдЧрд░
{'рд╕рдЯреАрдХрддрд╛': 0.8578431372549019, 'рдПрдл1': 0.8996539792387542}#рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдкрд░ рдореЙрдбрд▓ рдХреА рд╕рдЯреАрдХрддрд╛ 85.78% рд╣реИ, рдФрд░ рдПрдл1 рд╕реНрдХреЛрд░ 89.97 рд╣реИ
```
рдХрд╛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЖрд░рдВрднреАрдХрд░рдгрдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдореЙрдбрд▓ рд╣реЗрдб рдЕрдВрддрд┐рдо рдореАрдЯреНрд░рд┐рдХ рдорд╛рди рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдВ рдЕрдВрддрд┐рдо рдкрд░рд┐рдгрд╛рдо рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдП рдЧрдП рдкрд░рд┐рдгрд╛рдо рд╕реЗ рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдПрд╕реАрд╕реА рдФрд░ рдПрдл1 рджреЛ рдореАрдЯреНрд░рд┐рдХ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдмреАрдИрдЖрд░рдЯреА рдкреЗрдкрд░ рдореЗрдВ рдЧреНрд▓реВ рдмреЗрдВрдЪрдорд╛рд░реНрдХ рдХреЗ рдПрдордЖрд░рдкреАрд╕реА рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдмреЗрд╕ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП F1 рд╕реНрдХреЛрд░ 88.9 рд╣реИ, рдпрд╣ рдЕрди-рдХреЗрд╕реНрдб рдореЙрдбрд▓ рд╣реИ, рдФрд░ рд╣рдо рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдХреЗрд╕реНрдб рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЬреЛ рдмреЗрд╣рддрд░ рдкрд░рд┐рдгрд╛рдо рдмрддрд╛рддрд╛ рд╣реИ (рдХреЗрд╕реНрдб рдХрд╛ рдорддрд▓рдм рдЕрдВрдЧреНрд░реЗрдЬреА рдореЗрдВ рдХреЗрд╕-рд╕реЗрдВрд╕рд┐рдЯрд┐рд╡ рд╣реИ)ред

рдЙрдкрд░реЛрдХреНрдд рдХреЛ рдПрдХ рд╕рд╛рде рд░рдЦрдиреЗ рдкрд░, рд╣рдореЗрдВ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдорд┐рд▓рддрд╛ рд╣реИрд╕рдорд╛рд░реЛрд╣:

```рдЕрдЬрдЧрд░
рдбреАрдИрдПрдлрд╝ рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕(eval_preds):
рдореАрдЯреНрд░рд┐рдХ = рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ ("рдЧреЛрдВрдж", "рдПрдордЖрд░рдкреАрд╕реА")
рд▓реЙрдЧрд┐рдЯ, рд▓реЗрдмрд▓ = eval_preds
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = np.argmax(рд▓реЙрдЧрд┐рдЯреНрд╕, рдЕрдХреНрд╖=-1)
рд╡рд╛рдкрд╕реА metric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд╕рдВрджрд░реНрдн=рд▓реЗрдмрд▓)
```
рдлрд┐рд░ рдкреНрд░рддреНрдпреЗрдХ рдпреБрдЧ рдХреЛ рдПрдХ рдмрд╛рд░ рд╕рддреНрдпрд╛рдкрди рдореВрд▓реНрдпрд╛рдВрдХрди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд░реЗрдВред рддреЛ рдпрд╣рд╛рдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рд╣рдо te_metrics рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдмрд╛рдж рдХрдВрдкреНрдпреВрдЯреНрд░реЗрдирд░ рдХреИрд╕реЗ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧреНрд╕ = рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ('рдкрд░реАрдХреНрд╖рдг-рдкреНрд░рд╢рд┐рдХреНрд╖рдХ', рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐='рдпреБрдЧ'')
рдореЙрдбрд▓ = AutoModelForSequenceClassification.from_pretraiрдиреЗрдб(рдЪреЗрдХрдкреЙрдЗрдВрдЯ, num_labels=2)
```
```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
рдирдореВрдирд╛,
рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧ,
рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
eval_dataset=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"],
рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░=рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░,
рдЯреЛрдХрдирдирд╛рдЗрдЬрд░=рдЯреЛрдХрдирд╛рдЗрдЬрд░,
рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕ = рдХрдВрдкреНрдпреВрдЯ_рдореЗрдЯреНрд░рд┐рдХреНрд╕
)
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдордиреЗ рдПрдХ рдирдпрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдмрдирд╛рдпрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ "рдпреБрдЧ" рдФрд░ рдПрдХ рдирдпрд╛ рдореЙрдбрд▓ рдкрд░ рд╕реЗрдЯ рд╣реИ - рдЕрдиреНрдпрдерд╛, рд╣рдо рдХреЗрд╡рд▓ рдЙрд╕ рдореЙрдбрд▓ рдХрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЬрд╛рд░реА рд░рдЦреЗрдВрдЧреЗ рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рд╣реИ рдПрдХ рдирдпрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд░рди рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```
рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдореЗрдВ 6 рдорд┐рдирдЯ рдФрд░ 33 рд╕реЗрдХрдВрдб рдХрд╛ рд╕рдордп рд▓рдЧрд╛, рдЬреЛ рдкрд┐рдЫрд▓реА рдмрд╛рд░ рд╕реЗ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдерд╛ред рдЕрдВрддрд┐рдо рджреМрдбрд╝ рдХреЗ рдкрд░рд┐рдгрд╛рдо рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрд▓рдо рдореЗрдВ `BertForSequenceClassification.forward` рдореЗрдВ рдХреЛрдИ рд╕рдВрдЧрдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: рд╡рд╛рдХреНрдп 1, рд╡рд╛рдХреНрдп 2, idxред
***** рджреМрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг *****
рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 3668
рдпреБрдЧреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ = 3
рдкреНрд░рддрд┐ рдЙрдкрдХрд░рдг рддрд╛рддреНрдХрд╛рд▓рд┐рдХ рдмреИрдЪ рдЖрдХрд╛рд░ = 8
рдХреБрд▓ рдЯреНрд░реЗрди рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ (рд╕рдорд╛рдирд╛рдВрддрд░, рд╡рд┐рддрд░рд┐рдд рдФрд░ рд╕рдВрдЪрдп рд╕рд╣рд┐рдд) = 8
рдЧреНрд░реИрдбрд┐рдпрдиt рд╕рдВрдЪрдп рдЪрд░рдг = 1
рдХреБрд▓ рдЕрдиреБрдХреВрд▓рди рдЪрд░рдг = 1377

рдпреБрдЧ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐ рд╕рддреНрдпрд╛рдкрди рд╣рд╛рдирд┐ рд╕рдЯреАрдХрддрд╛ F1
1 рдХреЛрдИ рд▓реЙрдЧ рдирд╣реАрдВ 0.557327 0.806373 0.872375
2 0.552700 0.458040 0.862745 0.903448
3 0.333900 0.560826 0.867647 0.907850
рдЯреНрд░реЗрдирдЖрдЙрдЯрдкреБрдЯ(рдЧреНрд▓реЛрдмрд▓_рд╕реНрдЯреЗрдк=1377, рдЯреНрд░реЗрдирд┐рдВрдЧ_рд▓реЙрд╕=0.37862846690325436, рдореЗрдЯреНрд░рд┐рдХреНрд╕={'рдЯреНрд░реЗрди_рд░рдирдЯрд╛рдЗрдо': 393.5652, 'рдЯреНрд░реЗрди_рд╕реИрдВрдкрд▓реНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 27.96, 'рдЯреНрд░реЗрди_рд╕реНрдЯреЗрдкреНрд╕_рдкрд░_рд╕реЗрдХрдВрдб': 3.499, 'рдЯреЛрдЯрд▓_рдлреНрд▓реЛрд╕': 405470580750720ред 0, 'рдЯреНрд░реЗрди_рд▓реЙрд╕': 0.37862846690325436, 'рдпреБрдЧ': 3.0})
```
рдЗрд╕ рдмрд╛рд░, рдореЙрдбрд▓ рдХрд░реЗрдЧрд╛рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╣рд╛рдирд┐ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдкреНрд░рддреНрдпреЗрдХ рдпреБрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рд╕рддреНрдпрд╛рдкрди рд╣рд╛рдирд┐ рдФрд░ рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░реЗрдВ, рдореЙрдбрд▓ рдХреЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдХрд╛рд░реНрдп рдкреНрд░рдореБрдЦ рдЖрд░рдВрднреАрдХрд░рдг рдХреЗ рдХрд╛рд░рдг, рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рд╕рдЯреАрдХрддрд╛/F1 рд╕реНрдХреЛрд░ рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХреА рдЧрдИ рддреБрд▓рдирд╛ рдореЗрдВ рдереЛрдбрд╝рд╛ рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдЙрд╕реА рд░реЗрдВрдЬ рдореЗрдВ.

рдЯреНрд░реЗрдирд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХрдИ рдЬреАрдкреАрдпреВ/рдЯреАрдкреАрдпреВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдорд┐рд╢реНрд░рд┐рдд рдкрд░рд┐рд╢реБрджреНрдзрддрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХрд╛ рднреА рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕ рдореЗрдВ fp16 = True рд╕реЗрдЯ рдХрд░рдХреЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ, рд▓реЗрдХрд┐рди рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рд╣реИрд░реИрдкрд░ рдПрдкреАрдЖрдИ рдореЗрдВ рднреА рдЗрд╕рдХреА рдХрдорд┐рдпрд╛рдВ рд╣реИрдВ, рдпрд╛рдиреА, рдЖрдк рдХрдИ рдЕрдиреБрдХреВрд▓рд┐рдд рдСрдкрд░реЗрд╢рди рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЗрд╕рд▓рд┐рдП рд╣рдо рдирд┐рдпрдорд┐рдд рдкрд╛рдЗрдЯреЛрд░рдЪ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реВрдк рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рд╡рд┐рддрд░рд┐рдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕реЗрд▓реЗрд░реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рднреА рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ (рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рд╕рднреА рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ)ред рдПрдХ рдПрдХрд▓ рдЬреАрдкреАрдпреВ/рд╕реАрдкреАрдпреВ)ред =pt), рдпрд╛ рдЕрдиреБрд╡рд╛рдж рдХрд░реЗрдВ [уАКрдкреАрдЖрд░ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд░реЗрдВрдИ-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓уАЛ](https://blog.csdn.net/qq_56591814/article/details/120147114)ред

## 5. рдЕрдиреБрдкреВрд░рдХ рдЕрдиреБрднрд╛рдЧ
### рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХрд╛ рдЪреМрдерд╛ рдЕрдзреНрдпрд╛рдп рдореЙрдбрд▓ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдХрд░рддрд╛ рд╣реИ?

рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рджреЛ рддрд░реАрдХреЗ рд╣реИрдВ:

- рдлрд╝реАрдЪрд░ рдирд┐рд╖реНрдХрд░реНрд╖рдг (рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдмрд╛рдж рдореЗрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╡рдЬрд╝рди рд╕рдорд╛рдпреЛрдЬрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)

- рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ (рдмрд╕ рдбрд╛рдЙрдирд╕реНрдЯреНрд░реАрдо рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХреБрдЫ рдпреБрдЧреЛрдВ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВ рдФрд░ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рд╡рдЬрди рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВ)

BERT рдХрд╛ рдкрд╛рдБрдЪрд╡рд╛рдБ рднрд╛рдЧ (рдкреНрд░рдпреЛрдЧ)редрдкреЗрдкрд░ рдореЗрдВ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рд╣рд╛рд▓рд╛рдВрдХрд┐ рдмреАрдИрдЖрд░рдЯреА рдХреЗ рдкрд╛рд╕ рдПрдирдПрд▓рдкреА рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рджреЛ рддрд░реАрдХреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдП рдмрд┐рдирд╛ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ рдкрд░рд┐рдгрд╛рдо рдЖрдЙрдЯрдкреБрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрд╢рдВрд╕рд╛ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИ, рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдЧрд┐рдВрдЧ рдлреЗрд╕ рдХреЗ рд▓реЗрдЦрдХ рдпрд╣ рднреА рд╕рд▓рд╛рд╣ рджреЗрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд╛ рдкреНрд░рднрд╛рд╡ рдлреАрдЪрд░ рдирд┐рд╖реНрдХрд░реНрд╖рдг рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдХрд╛рдлреА рдмреЗрд╣рддрд░ рд╣реЛрдЧрд╛ (рдЬрдм рддрдХ рдХрд┐ рдЖрдк рдЬрд┐рджреНрджреА рди рд╣реЛрдВ рдФрд░ рдмрд╣реБрдд рдЬрдЯрд┐рд▓ рдореЙрдбрд▓ рдХреЗ рд╕рд╛рде рдлреАрдЪрд░ рдирд┐рд╖реНрдХрд░реНрд╖рдг рдХрд╛ рдкрд╛рд▓рди рди рдХрд░реЗрдВ)ред

рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЯреНрд░реЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдкрд╣рд▓реЗ рдХрд┐рдпрд╛ рдЬрд╛ рдЪреБрдХрд╛ рд╣реИрдЕрдпрд╕реНрдХ: рдЯреНрд░реЗрдирд░ рдПрдХ PyTorch рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рд▓реВрдк рдПрдкреАрдЖрдИ рд╣реИ рдЬреЛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕ рдХреЗ рд▓рд┐рдП рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рд╕рд░рд▓ рд╣реИ, рдЕрдиреНрдпрдерд╛, рдЖрдкрдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реВрдк рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

рдпрд╣ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЕрдиреБрдЪреНрдЫреЗрдж рдореЗрд░реА рд╕рдордЭ рд╕реЗ рд╣реИ рдФрд░ рдПрдЪрдПрдл рдореБрдЦрдкреГрд╖реНрда рдкрд╛рдареНрдпрдХреНрд░рдо рдореЗрдВ рдирд╣реАрдВ рд╣реИред

### рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдореБрдЦреНрдп рдкреИрд░рд╛рдореАрдЯрд░
рджрд░реНрдЬрдиреЛрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВ, рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдзреНрдпрд╛рдпреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдореБрдЦреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВ:
- рдЖрдЙрдЯрдкреБрдЯ_рдбреАрдЖрдИрдЖрд░ (рдПрд╕рдЯреАрдЖрд░): рд╡рд╣ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЬрд╣рд╛рдВ рдореЙрдбрд▓ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдФрд░ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕рд╣реЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВрдПрдб рдореЙрдбрд▓ рдХреЛ рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрдЧрд▓реА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП, [уАКрд╡рди-рд╕реНрдЯреЙрдк рдмреАрдИрдЖрд░рдЯреА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдЧрд┐рдВрдЧрдлреЗрд╕ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛уАЛ](https://zhuanlan.zhihu.com/p/344767513?utm_source) рджреЗрдЦреЗрдВред =wechat_session&utm_medium=social&utm_oi=1400823417357139968&utm_campaign=shareopn)
- рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ : рддреАрди рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ
- "рдирд╣реАрдВ": рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдХреЛрдИ рдореВрд▓реНрдпрд╛рдВрдХрди рдирд╣реАрдВ
- "рдЪрд░рдг": рдкреНрд░рддреНрдпреЗрдХ eval_steps рдХреЗ рд▓рд┐рдП рдкреВрд░реНрдг (рдФрд░ рд░рд┐рдХреЙрд░реНрдб) рдореВрд▓реНрдпрд╛рдВрдХрди
- "рдпреБрдЧ": рдкреНрд░рддреНрдпреЗрдХ рдпреБрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВред- рд▓рд░реНрдирд┐рдВрдЧ_рд░реЗрдЯ (рдлреНрд▓реЛрдЯ, рд╡реИрдХрд▓реНрдкрд┐рдХ) - рдПрдбрдордбрдмреНрд▓реВ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд░ рд▓рд░реНрдирд┐рдВрдЧ рд░реЗрдЯ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ 5e-5
- рд╡реЗрдЯ_рдбреЗрдХреЗ (рдлреНрд▓реЛрдЯ, рд╡реИрдХрд▓реНрдкрд┐рдХ, рдбрд┐рдлреЙрд▓реНрдЯреНрд╕ 0): рдпрджрд┐ 0 рдирд╣реАрдВ рд╣реИ, рддреЛ рдПрдбрдордбрдмреНрд▓реНрдпреВ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд░ рдореЗрдВ рд╕рднреА рдкреВрд░реНрд╡рд╛рдЧреНрд░рд╣реЛрдВ рдФрд░ рд▓реЗрдпрд░рдиреЙрд░реНрдо рд╡реЗрдЯ рдХреЛ рдЫреЛрдбрд╝рдХрд░, рд╕рднреА рдкрд░рддреЛрдВ рдкрд░ рд▓рд╛рдЧреВ рд╡реЗрдЯ рдбреЗрдХреЗ, ight рдбреЗрдХреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП, рдХреГрдкрдпрд╛ рдЬрд╝реАрд╣реБ рд▓реЗрдЦ рджреЗрдЦреЗрдВред рдпрд╣ 9102 рд╣реИ, рдЕрдм рдПрдбрдо + рдПрд▓2 рдирд┐рдпрдорд┐рддреАрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ](https://zhuanlan.zhihu.com/p/63982470)ред
- save_strategy (str рдпрд╛ IntervalStrategy, рд╡реИрдХрд▓реНрдкрд┐рдХ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ "рдЪрд░рдг"): рдЪреЗрдХрдкрдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕рдВрднрд╛рд╡рд┐рдд рдмрдЪрдд рд░рдгрдиреАрддрд┐рдпрд╛рдБ рд╣реИрдВ:
- "рдирд╣реАрдВ": рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдХреЛрдИ рдмрдЪрдд рдирд╣реАрдВ
- "рдпреБрдЧ": рдкреНрд░рддреНрдпреЗрдХ рдпреБрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ
- "рдЪрд░рдг": рдкреНрд░рддрд┐ рдЪрд░рдг рдПрдХ рдмрд╛рд░ рд╕рд╣реЗрдЬреЗрдВред
- fp16 (рдмреВрд▓, рд╡реИрдХрд▓реНрдкрд┐рдХ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗ рдЧрд▓рдд) - 32-рдмрд┐рдЯ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдмрдЬрд╛рдп 16-рдмрд┐рдЯ (рдорд┐рд╢реНрд░рд┐рдд) рд╕рдЯреАрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред
- metric_for_best_model (str, рд╡реИрдХрд▓реНрдкрд┐рдХ): рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдореЙрдбрд▓реЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдореАрдЯреНрд░рд┐рдХ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПload_best_model_at_end рдХреЗ рд╕рдВрдпреЛрдЬрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдореВрд▓реНрдпрд╛рдВрдХрди рджреНрд╡рд╛рд░рд╛ рд▓реМрдЯрд╛рдИ рдЧрдИ рдореАрдЯреНрд░рд┐рдХ рдХрд╛ рдирд╛рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЙрдкрд╕рд░реНрдЧ "eval_" рдХреЗ рд╕рд╛рде рдпрд╛ рдЙрд╕рдХреЗ рдмрд┐рдирд╛ред
- num_train_epochs (рдлреНрд▓реЛрдЯ, рд╡реИрдХрд▓реНрдкрд┐рдХ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ 3 рд╣реИ) - рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпреБрдЧреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛
-load_best_model_at_end (рдмреВрд▓, рд╡реИрдХрд▓реНрдкрд┐рдХ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗ рдЧрд▓рдд): рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдЕрдВрдд рдореЗрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдкрд╛рдП рдЧрдП рд╕рд░реНрд╡реЛрддреНрддрдо рдореЙрдбрд▓ рдХреЛ рд▓реЛрдб рдХрд░рдирд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред

### рдореЙрдбрд▓ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЗ
рдСрдЯреЛрдореЙрдбрд▓ рд╡рд░реНрдЧ рдФрд░ рдЙрд╕рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕рднреА рд╡рд░реНрдЧ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓реЛрдВ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рд╕рд░рд▓ рд░реИрдкрд░ рд╣реИрдВ, рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЖрдкрдХреЗ рдЪреЗрдХрдкреЛрдИ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рдореЙрдбрд▓ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИрдПрдирдЯреА рдФрд░ рдлрд┐рд░ рдЙрд╕ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдореЙрдбрд▓ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯрд┐рдпреЗрдЯ рдХрд░реЗрдВред

рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╕реАрдзреЗ рдЙрд╕ рд╡рд░реНрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЗрд╕рдХреА рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдпрд╣ BERT рдореЙрдбрд▓ рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред

BERT рдореЙрдбрд▓ рдХреЛ рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдкрд╣рд▓реА рдЪреАрдЬрд╝ рдЬреЛ рдЖрдкрдХреЛ рдХрд░рдиреЗ рдХреА рдЬрд╝рд░реВрд░рдд рд╣реИ рд╡рд╣ рд╣реИ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд▓реЛрдб рдХрд░рдирд╛:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ BertConfig, BertModel рдЖрдпрд╛рдд рдХрд░реЗрдВ

# рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдирд┐рд░реНрдорд╛рдг
рдХреЙрдиреНрдлрд┐рдЧ = BertConfig()

#рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реЗ рдореЙрдбрд▓ рдмрдирд╛рдирд╛
рдореЙрдбрд▓ = рдмрд░реНрдЯрдореЙрдбрд▓(рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди)
```
рдХреЙрдиреНрдлрд┐рдЧ рдХреЙрдиреНрдлрд┐рдЧрдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдпреВрд░реЗрд╢рди рдореЗрдВ рдХрдИ рдЧреБрдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:
```рдЕрдЬрдЧрд░
рдкреНрд░рд┐рдВрдЯ(рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди)
```
```рдЕрдЬрдЧрд░
рдмрд░реНрдЯрдХреЙрдиреНрдлрд┐рдЧ {
[...]
"hidden_size": 768, #hidden_states рд╡реЗрдХреНрдЯрд░ рдХрд╛ рдЖрдХрд╛рд░
"рдордзреНрдпрд╡рд░реНрддреА_рдЖрдХрд╛рд░": 3072, #рдПрдлрдПрдлрдПрди рдХреА рдкрд╣рд▓реА рдкрд░рдд рдореЗрдВ рдиреНрдпреВрд░реЙрдиреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛, рдпрд╛рдиреА, рдзреНрдпрд╛рди рдкрд░рдд рдЖрдпрд╛рдо рдХреЛ 4 рдЧреБрдирд╛ рддрдХ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░реЗрдЧреА рдЬрдм рдЗрд╕реЗ рдкреВрд░реНрдг рдХрдиреЗрдХреНрд╢рди рдХреА рдкрд╣рд▓реА рдкрд░рдд рдореЗрдВ рдкрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛
"max_position_embeddings": 512,#рдЕрдзрд┐рдХрддрдо рдЕрдиреБрдХреНрд░рдо рд▓рдВрдмрд╛рдИ 512
"num_attention_heads": 12,
"num_hidden_layers": 12,
[...]
}
```hidden_size:hidden_states рд╡реЗрдХреНрдЯрд░ рдХрд╛ рдЖрдХрд╛рд░<br>
num_hidden_layers: рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреА рдкрд░рддреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реЗ рдПрдХ рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рд╕реЗ рдЗрд╕реЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ BertConfig, BertModel рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдХреЙрдиреНрдлрд┐рдЧ = BertConfig()
рдореЙрдбрд▓ = рдмрд░реНрдЯрдореЙрдбрд▓(рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди)

# рдореЙрдбрд▓ рдХреЛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ
```
рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╡рд┐рдХреГрдд рд╡рд░реНрдгреЛрдВ рдХреЛ рдЖрдЙрдЯрдкреБрдЯ рдХрд░реЗрдЧрд╛; рдЗрд╕реЗ рдкрд╣рд▓реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд╣рдо рдореЙрдбрд▓ рдХреЛ рд╕реНрдХреНрд░реИрдЪ рд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрдпрд╣ рдореМрдЬреВрджрд╛ рдХрд╛рд░реНрдп рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдХрд╛рдлреА рд▓рдВрдмрд╛ рд╕рдордп рдФрд░ рдмрд╣реБрдд рд╕рд╛рд░рд╛ рдбреЗрдЯрд╛ рд▓рдЧреЗрдЧрд╛ред

рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП from_pretrained рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ BertModel рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдореЙрдбрд▓ = BertModel.from_pretrained("bert-base-cased")
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдкрдиреЗ рдкрд╣рд▓реЗ рджреЗрдЦрд╛, рд╣рдо рдмрд░реНрдЯрдореЙрдбрд▓ рдХреЛ рдСрдЯреЛрдореЙрдбрд▓ рдХреНрд▓рд╛рд╕ рд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рднрд╛рд╡ рд╕рдорд╛рди рд╣реИред рд╣рдо рдмрд╛рдж рдореЗрдВ рдСрдЯреЛрдореЙрдбрд▓ рдХреНрд▓рд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЗрд╕рдХрд╛ рдлрд╛рдпрджрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдореЙрдбрд▓ рд╕рдВрд░рдЪрдирд╛ рд╕реЗрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╣рд┐рд╕реНрд╕рд╛ рдЖрдкрдХреЗ рдХреЛрдб рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИрдИ рдПрдХ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рджреВрд╕рд░реЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рднреА рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рднрд▓реЗ рд╣реА рдореЙрдбрд▓ рд╕рдВрд░рдЪрдирд╛ рдЕрд▓рдЧ рд╣реЛ, рдЬрдм рддрдХ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рд╕рдорд╛рди рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддрдм рддрдХ рдпрд╣ рднреА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред

***рдСрдЯреЛрдореЙрдбрд▓ рд╡рд░реНрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╡рд┐рднрд┐рдиреНрди рдЪреМрдХрд┐рдпреЛрдВ рд╕реЗ рдЧреБрдЬрд░рддреЗ рд╣реБрдП, рдЖрдк рдХрд╛рд░реНрдп рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬрдм рддрдХ рдХрд┐ рдЗрд╕ рдореЙрдбрд▓ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рдЗрд╕ рдХрд╛рд░реНрдп рдХреЛ рд╕рдВрднрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ), рдпрджрд┐ рдЖрдк рдмрд░реНрдЯрдореЙрдбрд▓ рдЪреБрдирддреЗ рд╣реИрдВ, рддреЛ рдореЙрдбрд▓ рд╕рдВрд░рдЪрдирд╛ рддрдп рд╣реЛ рдЬрд╛рддреА рд╣реИред *

рдЙрдкрд░реЛрдХреНрдд рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдордиреЗ BertConfig рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ (BertConfig рдПрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╣реИрдмрд┐рдирд╛ рдХрд┐рд╕реА рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ ized рдореЙрдбрд▓), рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдмрдЬрд╛рдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдкрд╛рд░рд┐рдд рдХрд░ рджрд┐рдпрд╛ ""рдмрд░реНрдЯ-рдмреЗрд╕-рдХреЗрд╕реНрдб" рдПрдХ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХрд╛ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╕реНрд╡рдпрдВ BERT рдХреЗ рд▓реЗрдЦрдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЖрдк рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдЗрд╕рдХреЗ [рдореЙрдбрд▓ рдХрд╛рд░реНрдб рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ ](https://huggingface.co/bert-base-cased)ред

рдореЙрдбрд▓ рдХреЛ рдЕрдм рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рд╕рднреА рднрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реАрдзреЗ рдЙрд╕ рдХрд╛рд░реНрдп рдкрд░ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕ рдкрд░ рдЗрд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдпрд╛ рдХрд┐рд╕реА рдирдП рдХрд╛рд░реНрдп рдкрд░ рдЗрд╕реЗ рдареАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рд╡рдЬрд╝рди рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХреИрд╢ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЗрд╕рд▓рд┐рдП рдлрд╝реВ)редfrom_pretrained рд╡рд┐рдзрд┐ рдореЗрдВ ture рдХреЙрд▓ рдЙрдиреНрд╣реЗрдВ рджреЛрдмрд╛рд░рд╛ рдбрд╛рдЙрдирд▓реЛрдб рдирд╣реАрдВ рдХрд░реЗрдЧреА), рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ ~/.cache/huggingface/transformers рд╣реИред рдЖрдк HF_HOME рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рд╕реЗрдЯ рдХрд░рдХреЗ рдХреИрд╢ рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдореЙрдбрд▓ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдореЙрдбрд▓ рд╣рдм рдкрд░ рдХрд┐рд╕реА рднреА рдореЙрдбрд▓ рдХрд╛ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬрдм рддрдХ рдХрд┐ рдпрд╣ BERT рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рд╣реИ BERT рдЪреМрдХрд┐рдпреЛрдВ рдХреА рдкреВрд░реА рд╕реВрдЪреА [рдпрд╣рд╛рдВ] (https://huggingface.co/) рдкрд░ рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИред рдореЙрдбрд▓?рдлрд╝рд┐рд▓реНрдЯрд░=рдмрд░реНрдЯ).
### рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧтАФтАФрдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ рддрдХрдиреАрдХ
>рдпреВрдЯреНрдпреВрдм рд╡реАрд╡рд┐рдЪрд╛рд░рдзрд╛рд░рд╛: [уАКрдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ рдХреНрдпрд╛ рд╣реИуАЛ](https://youtu.be/7q5NyFT8REg)

PyTorch рдореЗрдВ, DataLoader рдХрд╛ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ - рдХреЛрд▓реЗрдЯ рдлрд╝рдВрдХреНрд╢рдиред рдпрд╣ рдирдореВрдиреЛрдВ рдХреЗ рдПрдХ рдмреИрдЪ рдХреЛ рдПрдХ рд╕рд╛рде рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП PyTorch рдЯреЗрдВрд╕рд░ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЖрдкрдХреЗ рддрддреНрд╡ рд╕реВрдЪрд┐рдпрд╛рдБ, рдЯреБрдкрд▓реНрд╕ рдпрд╛ рд╢рдмреНрджрдХреЛрд╢ рд╣реИрдВ)ред

рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдореМрдЬреВрдж рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдо рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓рдВрдмрд╛рдИ рдХреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЗрдирдкреБрдЯ рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЛ рдкреИрдбреЗрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдореЙрдбрд▓ рдореЗрдВ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ,рдПрдХ рд╣реА рдмреИрдЪ рдХреЗ рдЯреЗрдВрд╕рд░ рд╕рдорд╛рди рд▓рдВрдмрд╛рдИ рдХреЗ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП)ред рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдмреИрдЪ рдореЗрдВ рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдбрд┐рдВрдЧ рдХрд░рдирд╛ рдкреВрд░реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреА рдЕрдзрд┐рдХрддрдо рдЕрдиреБрдХреНрд░рдо рд▓рдВрдмрд╛рдИ рддрдХ рд╕рднреА рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЛ рдкреИрдбрд┐рдВрдЧ рдХрд░рдиреЗ рд╕реЗ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реИред
рдиреЛрдЯ: рдпрджрд┐ рдЖрдк рдЯреАрдкреАрдпреВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЕрднреА рднреА рдореЙрдбрд▓ рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдб рд▓рдЧрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЯреАрдкреАрдпреВ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реИред
рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ рдХреЛрд▓реЗрдЯ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬреЛ рдмреИрдЪ рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдкрд░ рд╕рд╣реА рдорд╛рддреНрд░рд╛ рдореЗрдВ рдкреИрдбрд┐рдВрдЧ рд▓рд╛рдЧреВ рдХрд░реЗрдЧрд╛ (рдбреЗрдЯрд╛ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдмреИрдЪреЛрдВ рдХреЗ рд▓рд┐рдП, рднрд┐рдиреНрди)редрдкреИрдбрд┐рдВрдЧ рдХреА рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓рдВрдмрд╛рдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред) ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╣рдореЗрдВ DataCollatorWithPadding рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдРрд╕реА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рдЬрдм рдЖрдк рдЗрд╕реЗ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕реЗ рдПрдХ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ) рдкреИрдбрд┐рдВрдЧ рдЯреЛрдХрди, рдФрд░ рдХреНрдпрд╛ рдореЙрдбрд▓ рдмрд╛рдИрдВ рдУрд░ рдкреИрдбрд┐рдВрдЧ рдЪрд╛рд╣рддрд╛ рд╣реИред рдЗрдирдкреБрдЯ рдХреЗ рджрд╛рдИрдВ рдУрд░), рдФрд░ рдпрд╣ рд╡рд╣ рд╕рдм рдХреБрдЫ рдХрд░реЗрдЧрд╛ рдЬреЛ рдЖрдкрдХреЛ рдЪрд╛рд╣рд┐рдП:

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ DataCollatorWithPadding рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ = рдбреЗрдЯрд╛рдХреЛрд▓реЗрдЯрд░рд╡рд┐рдердкреИрдбрд┐рдВрдЧ(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░=рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░)
```
рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП, рд╣рдо рдирдореВрдиреЗ рдЪреБрдирддреЗ рд╣реИрдВрдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рдЬрд┐рд╕реЗ рд╣рдо рдПрдХ рд╕рд╛рде рдмреИрдЪ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдпрд╣рд╛рдВ рд╣рдореЗрдВ idx, рд╡рд╛рдХреНрдп 1, рдФрд░ рд╡рд╛рдХреНрдп 2 рдХреЙрд▓рдо рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЙрдирдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЙрдирдореЗрдВ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рд╣реИрдВ (рдЬреЛ рдмреИрдЪ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЗрдирдкреБрдЯ рдХреА рд▓рдВрдмрд╛рдИ рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ):

```рдЕрдЬрдЧрд░
рдирдореВрдиреЗ = рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"][:8]
рдирдореВрдиреЗ = {
k: k рдХреЗ рд▓рд┐рдП v, рдирдореВрдиреЗ.рдЖрдЗрдЯрдо() рдореЗрдВ v рдпрджрд┐ k ["idx", "sentence1", "sentence2"] рдореЗрдВ рдирд╣реАрдВ рд╣реИ
}
[рдирдореВрдиреЛрдВ рдореЗрдВ x рдХреЗ рд▓рд┐рдП len(x)["input_ids"]]
```

```рдЕрдЬрдЧрд░
[50, 59, 47, 67, 59, 50,62, 32]
```
рд╣рдореЗрдВ d рдХрд╛ рдХреНрд░рдо рдорд┐рд▓рд╛рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓рдВрдмрд╛рдИред рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдмреИрдЪ рдореЗрдВ рд╕рднреА рдЕрдиреБрдХреНрд░рдореЛрдВ рдХреЛ 67 рдХреА рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдб рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдбрд╛рдпрдирд╛рдорд┐рдХ рдкреИрдбрд┐рдВрдЧ рдХреЗ рдмрд┐рдирд╛, рд╕рднреА рдирдореВрдиреЛрдВ рдХреЛ рдкреВрд░реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рдпрд╛ рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡реАрдХрд╛рд░ рдХреА рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рддрдХ рдкреИрдб рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рджреЛрдмрд╛рд░рд╛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рд╣рдорд╛рд░рд╛ рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ рдмреИрдЪ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдкреИрдб рдХрд░ рд░рд╣рд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдмреИрдЪ = рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░(рдирдореВрдиреЗ)
{k: k рдХреЗ рд▓рд┐рдП v.shape, рдмреИрдЪ.рдЖрдЗрдЯрдо рдореЗрдВ v()}
```

```рдЕрдЬрдЧрд░
{'рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ': рдЯреЙрд░реНрдЪ.рдЖрдХрд╛рд░([8, 67]),
'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': рдЯреЙрд░реНрдЪ.рдЖрдХрд╛рд░([8, 67]),
'рдЯреАрдУрдХреЗрди_рдЯрд╛рдЗрдк_рдЖрдИрдбреА': рдЯреЙрд░реНрдЪ.рдЖрдХрд╛рд░([8, 67]),
'рд▓реЗрдмрд▓': рдЯреЙрд░реНрдЪ.рдЖрдХрд╛рд░([8])}
```

рдпреБрдХреНрддрд┐рдпрд╛рдБ: рдКрдкрд░ рджрд┐рдП рдЧрдП рдмреЛрд▓реНрдб рдЗрдЯреИрд▓рд┐рдХ рд╢рдмреНрдж рд▓реЗрдЦрдХ рдХреА рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдБ рд╣реИрдВ, рдЬреЛ рдореВрд▓ рдкрд╛рда рдХреЗ рднрд╛рдЧ рдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЛ рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рдЖрддреА рд╣реИ, рддреЛ рдХреГрдкрдпрд╛ рд╣рдореЗрдВ рд╕рдордп рдкрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдВред рдзрдиреНрдпрд╡рд╛рджред