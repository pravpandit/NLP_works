рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдЬрдкреНрдЯрд░ рдиреЛрдЯрдмреБрдХ [рдЕрдзреНрдпрд╛рдп 4 рдХреЛрдб рдмреЗрд╕](https://github.com/datawhalechina/learn-nlp-with-transformers/tree/main/docs/%E7%AF%87%E7%) рдореЗрдВ рд╣реИ AB%A04-%E4%BD%BF%E7%94%A8Transformers%E8%A7%A3%E5%86%B3NLP%E4%BB%BB%E5%8A%A1).

рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдбреЗрдЯрд╛рд╕реЗрдЯ рдФрд░ рдореЙрдбрд▓ рдХреЛ рддреБрд░рдВрдд рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреЛ рд╕реАрдзреЗ Google рдХреЛрд▓рд╛рдм рдиреЛрдЯрдмреБрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреЛрд▓рдиреЗ рдХреА рдЕрдиреБрд╢рдВрд╕рд╛ рдХреА рдЬрд╛рддреА рд╣реИред
рдпрджрд┐ рдЖрдк рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЛ Google рдХреЛрд▓реИрдм рдореЗрдВ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдФрд░ ЁЯдЧрдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬрд╝ рдХреЛ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрди рдЖрджреЗрд╢ред

```рдЕрдЬрдЧрд░
# !рдкрд┐рдк рдбреЗрдЯрд╛рд╕реЗрдЯ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ
```

# рдорд╢реАрди рдкреНрд░рд╢реНрди рдЙрддреНрддрд░ рдХрд╛рд░реНрдп рдкрд░ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдореЙрдбрд▓ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реЗрдВ

рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдореЗрдВ, рд╣рдо рд╕реАрдЦреЗрдВрдЧреЗ рдХрд┐ рдорд╢реАрди рдкреНрд░рд╢реНрди рдЙрддреНрддрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [ЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕] (https://github.com/huggingface/transformers)rmer рдореЙрдбрд▓ рдХреЗ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдореЙрдбрд▓ рдХреЛ рдХреИрд╕реЗ рдареАрдХ рдХрд┐рдпрд╛ рдЬрд╛рдПред рдпрд╣ рд▓реЗрдЦ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдПрдХреНрд╕рдЯреНрд░реИрдХреНрдЯрд┐рд╡ рдкреНрд░рд╢реНрди рдЙрддреНрддрд░ рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИ рдХрд╛рд░реНрдп: рдПрдХ рдкреНрд░рд╢реНрди рдФрд░ рдПрдХ рдкрд╛рда рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЙрд╕ рдкрд╛рда рдЦрдВрдб (рд╕реНрдкреИрди) рдХреЛ рдЦреЛрдЬреЗрдВ рдЬреЛ рдкреНрд░рд╢реНрди рдХрд╛ рдЙрддреНрддрд░ рджреЗ рд╕рдХреЗрдЯреЗрдХреНрд╕реНрдЯ рд╕реЗ рд╕реНрдЯрд┐рдпрдиред 'рдЯреНрд░реЗрдирд░' рдПрдкреАрдЖрдИ рдФрд░ рдбреЗрдЯрд╛рд╕реЗрдЯ рдкреИрдХреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рдЖрд╕рд╛рдиреА рд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓реЛрдб рдХрд░реЗрдВрдЧреЗ рдФрд░ рдлрд┐рд░ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрди рдХрд░реЗрдВрдЧреЗред рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЪрд┐рддреНрд░ рдПрдХ рд╕рд░рд▓ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддрд╛ рд╣реИ
![QA рдХрд╛рд░реНрдп рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╡рд┐рдЬреЗрдЯ рдЕрдиреБрдорд╛рди](images/question_answering.png)

**рдиреЛрдЯ:** рдиреЛрдЯ: рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдкреНрд░рд╢реНрди рдХрд╛ рдЙрддреНрддрд░ рджреЗрдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдкрд╛рда рд╕реЗ рдЙрддреНрддрд░ рдирд┐рдХрд╛рд▓рдирд╛ рд╣реИ, рди рдХрд┐ рд╕реАрдзреЗ рдЙрддреНрддрд░ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛!

рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдореЗрдВ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ SQU рдХреЗ рд╕рдорд╛рди рдХрд┐рд╕реА рднреА рдирд┐рд╖реНрдХрд░реНрд╖рд╛рддреНрдордХ рдкреНрд░рд╢реНрди рдЙрддреНрддрд░ рдХрд╛рд░реНрдп рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИAD 1 рдФрд░ SQUAD 2, рдФрд░ [рдореЙрдбрд▓ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЙрдбрд▓ рд╣рдм] (https://huggingface.co/models) рдореЗрдВ рдХрд┐рд╕реА рднреА рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрдм рддрдХ рдХрд┐ рдЗрди рдореЙрдбрд▓реЛрдВ рдореЗрдВ рдПрдХ рдЯреЛрдХрди рд╡рд░реНрдЧреАрдХрд░рдг рд╣реЗрдб рдФрд░ рдПрдХ рддреЗрдЬрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рд╣реЛрддрд╛ рд╣реИ рдореЙрдбрд▓ рдФрд░ рддреЗрдЬрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЗ рдмреАрдЪ рдкрддреНрд░рд╛рдЪрд╛рд░, рджреЗрдЦреЗрдВ: [рдпрд╣ рддрд╛рд▓рд┐рдХрд╛] (https://huggingface.co/transformers/index.html#bigtable)ред

рдпрджрд┐ рдЖрдкрдХрд╛ рдбреЗрдЯрд╛рд╕реЗрдЯ рдЗрд╕ рдиреЛрдЯрдмреБрдХ рд╕реЗ рдЕрд▓рдЧ рд╣реИ, рддреЛ рдЖрдк рдЕрдкрдиреЗ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ (рдХрдВрдкреНрдпреВрдЯрд░ рдПрдо) рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдХреЗрд╡рд▓ рдорд╛рдореВрд▓реА рд╕рдорд╛рдпреЛрдЬрди рдХреЗ рд╕рд╛рде рд╕реАрдзреЗ рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрдПрдореЛрд░реА, рдЧреНрд░рд╛рдлрд┐рдХреНрд╕ рдХрд╛рд░реНрдб рдЖрдХрд╛рд░), рдЖрдкрдХреЛ рдЖрдЙрдЯ-рдСрдл-рдореЗрдореЛрд░реА рддреНрд░реБрдЯрд┐рдпреЛрдВ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдмреИрдЪ рдЖрдХрд╛рд░ рдХреЛ рдЙрдЪрд┐рдд рд░реВрдк рд╕реЗ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред
рдЙрди рддреАрди рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдВ, рдлрд┐рд░ рдмрд╛рдХреА рдиреЛрдЯрдмреБрдХ рд╕реБрдЪрд╛рд░реВ рд░реВрдк рд╕реЗ рдЪрд▓рдиреА рдЪрд╛рд╣рд┐рдП:

```рдЕрдЬрдЧрд░
# рд╕реНрдХреНрд╡рд╛рдб_v2 рдХреНрд░рдорд╢рдГ SQUAD v1 рдпрд╛ SQUAD v2 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╣реА рдпрд╛ рдЧрд▓рдд рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИред
# рдпрджрд┐ рдЖрдк рдЕрдиреНрдп рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рд╕рддреНрдп рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдореЙрдбрд▓ "рдЕрдирд┐рд╡рд╛рд░реНрдп" рдкреНрд░рд╢реНрдиреЛрдВ рдХрд╛ рдЙрддреНрддрд░ рджреЗ рд╕рдХрддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд, рдХреБрдЫ рдкреНрд░рд╢реНрдиреЛрдВ рдХрд╛ рдЙрддреНрддрд░ рдирд╣реАрдВ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЧрд▓рдд рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╕рднреА рдкреНрд░рд╢реНрдиреЛрдВ рдХрд╛ рдЙрддреНрддрд░ рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
рд╕реНрдХреНрд╡рд╛рдб_v2 = рдЧрд╝рд▓рдд
рдореЙрдбрд▓_рдЪреЗрдХрдкреЙрдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб"
рдмреИрдЪ_рдЖрдХрд╛рд░ = 16
```

## рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓реЛрдб рдХрд░реЗрдВ

рд╣рдо рдбреЗрдЯрд╛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдФрд░ рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП (рдмреЗрдВрдЪрдорд╛рд░реНрдХ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП) [ЁЯдЧ рдбреЗрдЯрд╛рд╕реЗрдЯ] (https://github.com/huggingface/datasets) рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред

рдЗрди рджреЛрдиреЛрдВ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ `load_dataset` рдФрд░ `load_metric` рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдкреВрд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ, рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ
```

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдо рдЗрд╕ рдиреЛрдЯрдмреБрдХ рд╕рд┐рдорд┐рд▓рд░ рдореЗрдВ [SQUAD рдбреЗрдЯрд╛рд╕реЗрдЯ](https://rajpurkar.github.io/SQuAD-explorer/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗрд╡рд╛рдИ, рдпрд╣ рдиреЛрдЯрдмреБрдХ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╕рднреА рдкреНрд░рд╢реНрди рдЙрддреНрддрд░ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рд╕рд╛рде рднреА рд╕рдВрдЧрдд рд╣реИред

рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ (json рдпрд╛ csv рдкреНрд░рд╛рд░реВрдк) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХреГрдкрдпрд╛ [рдбреЗрдЯрд╛рд╕реЗрдЯ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝] (https://huggingface.co/docs/datasets/loading_datasets.html#from-local-files) рджреЗрдЦреЗрдВ рдЖрдкрдХрд╛ рдЕрдкрдирд╛ рдбреЗрдЯрд╛рд╕реЗрдЯред рдЖрдкрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдХреЙрд▓рдо рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдирд╛рдореЛрдВ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред

```рдЕрдЬрдЧрд░
# рдбреЗрдЯрд╛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ (рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдиреЗрдЯрд╡рд░реНрдХ рд╣реИ)
рдбреЗрдЯрд╛рд╕реЗрдЯ = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ ("рд╕реНрдХреНрд╡рд╛рдб_v2" рдпрджрд┐ рд╕реНрдХреНрд╡рд╛рдб_v2 рдЕрдиреНрдпрдерд╛ "рд╕реНрдХреНрд╡рд╛рдб")```

рдпрд╣ `рдбреЗрдЯрд╛рд╕реЗрдЯ` рдСрдмреНрдЬреЗрдХреНрдЯ рдПрдХ [`рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ`](https://huggingface.co/docs/datasets/package_reference/main_classes.html#datasetdict) рд╕рдВрд░рдЪрдирд╛ рд╣реИ, рдФрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг, рд╕рддреНрдпрд╛рдкрди рдФрд░ рдкрд░реАрдХреНрд╖рдг рдХреНрд░рдорд╢рдГ рдЗрд╕ рдирд┐рд░реНрджреЗрд╢ рдореЗрдВ рдПрдХ рдХреБрдВрдЬреА рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИрдВ .

```рдЕрдЬрдЧрд░
# рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдбреЗрдЯрд╛рд╕реЗрдЯ рдФрд░ рдЙрдирдХреЗ рдЧреБрдг рджреЗрдЦреЗрдВ
рдбреЗрдЯрд╛рд╕реЗрдЯ
```

рдбреЗрдЯрд╛рд╕реЗрдЯрдбрд┐рдХреНрдЯ({
рдЯреНрд░реЗрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдЖрдИрдбреА', 'рд╢реАрд░реНрд╖рдХ', 'рд╕рдВрджрд░реНрдн', 'рдкреНрд░рд╢реНрди', 'рдЙрддреНрддрд░'],
num_rows: 87599
})
рд╕рддреНрдпрд╛рдкрди: рдбреЗрдЯрд╛рд╕реЗрдЯ({
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ: ['рдЖрдИрдбреА', 'рд╢реАрд░реНрд╖рдХ', 'рд╕рдВрджрд░реНрдн', 'рдкреНрд░рд╢реНрди', 'рдЙрддреНрддрд░'],
num_rows: 10570})
})

рдЪрд╛рд╣реЗ рд╡рд╣ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯ рд╣реЛ, рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рд╣реЛ рдпрд╛ рдкрд░реАрдХреНрд╖рдг рд╕реЗрдЯ рд╣реЛ, рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╢реНрдиреЛрддреНрддрд░ рдбреЗрдЯрд╛ рдирдореВрдиреЗ рдореЗрдВ рддреАрди рдХреБрдВрдЬреА рд╣реЛрдВрдЧреА: "рд╕рдВрджрд░реНрдн", "рдкреНрд░рд╢реНрди" рдФрд░ "рдЙрддреНрддрд░"ред

рд╣рдо рдХрд┐рд╕реА рдирдореВрдиреЗ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"][0]
# рдЙрддреНрддрд░ рдЙрддреНрддрд░ рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВ
# рд╕рдиреНрджрд░реНрдн рдкрд╛рда рдЕрдВрд╢реЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ
# рдкреНрд░рд╢реНрди рдкреНрд░рд╢реНрдиреЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ
```

{'рдЙрддреНрддрд░': {'рдЙрддреНрддрд░_рдкреНрд░рд╛рд░рдВрдн': [515], 'рдкрд╛рда': ['рд╕реЗрдВрдЯ рдмрд░реНрдирд╛рдбреЗрдЯ рд╕реЛрдмрд┐рд░рд╕']},
'рд╕рдВрджрд░реНрдн': 'рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХреА рджреГрд╖реНрдЯрд┐ рд╕реЗ, рд╕реНрдХреВрд▓ рдХрд╛ рдЪрд░рд┐рддреНрд░ рдХреИрдереЛрд▓рд┐рдХ рд╣реИрднрд╡рди рдХрд╛ рд╕реЛрдиреЗ рдХрд╛ рдЧреБрдВрдмрдж рд╡рд░реНрдЬрд┐рди рдореИрд░реА рдХреА рдПрдХ рд╕реНрд╡рд░реНрдг рдкреНрд░рддрд┐рдорд╛ рд╣реИред рдореБрдЦреНрдп рднрд╡рди рдХреЗ рдареАрдХ рд╕рд╛рдордиреЗ рдФрд░ рдЙрд╕рдХреЗ рд╕рд╛рдордиреЗ, рдореБрдЦреНрдп рднрд╡рди рдХреЗ рдмрдЧрд▓ рдореЗрдВ "рд╡реЗрдирд╛рдЗрдЯ рдПрдб рдореА рдУрдореНрдиреЗрд╕" рдХреЗ рд╕рд╛рде рд╣рдерд┐рдпрд╛рд░ рдЙрдард╛рдП рд╣реБрдП рдИрд╕рд╛ рдорд╕реАрд╣ рдХреА рдПрдХ рддрд╛рдВрдмреЗ рдХреА рдореВрд░реНрддрд┐ рд╣реИ рдкрд╡рд┐рддреНрд░ рд╣реГрджрдп рдХрд╛ рдмреЗрд╕рд┐рд▓рд┐рдХрд╛ рд╣реИред рдмреЗрд╕рд┐рд▓рд┐рдХрд╛ рдХреЗ рдареАрдХ рдкреАрдЫреЗ рдЧреНрд░реЛрдЯреЛ рд╣реИ, рдЬреЛ рдкреНрд░рд╛рд░реНрдердирд╛ рдФрд░ рдЪрд┐рдВрддрди рдХрд╛ рдПрдХ рдореИрд░рд┐рдПрди рд╕реНрдерд╛рди рд╣реИред рдпрд╣ рдлреНрд░рд╛рдВрд╕ рдХреЗ рд▓реВрд░реНрдбреЗрд╕ рдореЗрдВ рдЧреНрд░реЛрдЯреЛ рдХреА рдкреНрд░рддрд┐рдХреГрддрд┐ рд╣реИ рдЬрд╣рд╛рдВ рд╡рд░реНрдЬрд┐рди рдореИрд░реА рдиреЗ 1858 рдореЗрдВ рд╕реЗрдВрдЯ рдмрд░реНрдирд╛рдбреЗрдЯ рд╕реЛрдмрд┐рд░рд╕ рдХреЛ рджрд░реНрд╢рди рджрд┐рдП рдереЗред рдХреЗ рдЕрдВрддрдореБрдЦреНрдп рдбреНрд░рд╛рдЗрд╡ (рдФрд░ рдПрдХ рд╕реАрдзреА рд░реЗрдЦрд╛ рдореЗрдВ рдЬреЛ 3 рдореВрд░реНрддрд┐рдпреЛрдВ рдФрд░ рдЧреЛрд▓реНрдб рдбреЛрдо рд╕реЗ рдЬреБрдбрд╝рддреА рд╣реИ), рдореИрд░реА рдХреА рдПрдХ рд╕рд░рд▓, рдЖрдзреБрдирд┐рдХ рдкрддреНрдерд░ рдХреА рдореВрд░реНрддрд┐ рд╣реИред',
'рдЖрдИрдбреА': '5733be284776f41900661182',
'рдкреНрд░рд╢реНрди': 'рд╡рд░реНрдЬрд┐рди рдореИрд░реА рдХрдерд┐рдд рддреМрд░ рдкрд░ 1858 рдореЗрдВ рд▓реВрд░реНрдбреЗрд╕ рдлреНрд░рд╛рдВрд╕ рдореЗрдВ рдХрд┐рд╕рдХреЗ рд╕рд╛рдордиреЗ рдкреНрд░рдХрдЯ рд╣реБрдИ рдереАрдВ?',
'рд╢реАрд░реНрд╖рдХ': 'рдпреВрдирд┐рд╡рд░реНрд╕рд┐рдЯреА_рдСрдлрд╝_рдиреЛрдЯреНрд░реЗ_рдбреЗрдо'}

рдЙрддреНрддрд░реЛрдВ рдХреЗ рдПрдиреЛрдЯреЗрд╢рди рдкрд░ рдзреНрдпрд╛рди рджреЗрдВред рдЯреЗрдХреНрд╕реНрдЯ рд╕реНрдирд┐рдкреЗрдЯ рдореЗрдВ рдЙрддреНрддрд░ рдкрд╛рда рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЙрддреНрддрд░ рдЙрддреНрддрд░ рдХреА рд╕реНрдерд┐рддрд┐ рднреА рджреЗрддреЗ рд╣реИрдВ (рд╡рд░реНрдг рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдЧрд┐рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрдкрд░реЛрдХреНрдд рдЙрджрд╛рд╣рд░рдг рдореЗрдВ 515рд╡рд╛рдВ)ред

рдЯреАo рдЖрдЧреЗ рд╕рдордЭреЗрдВ рдХрд┐ рдбреЗрдЯрд╛ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдХреБрдЫ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХрд╛ рдЪрдпрди рдХрд░реЗрдЧрд╛ред

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдХреНрд▓рд╛рд╕ рд▓реЗрдмрд▓, рдЕрдиреБрдХреНрд░рдо рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдкрд╛рдВрдбрд╛ рдХреЛ рдкреАрдбреА рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ
IPython.display рд╕реЗ рдЖрдпрд╛рдд рдбрд┐рд╕реНрдкреНрд▓реЗ, HTML

def show_random_elements(рдбреЗрдЯрд╛рд╕реЗрдЯ, num_examples=10):
assert num_examples <= len(рдбреЗрдЯрд╛рд╕реЗрдЯ), "рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдореМрдЬреВрдж рддрддреНрд╡реЛрдВ рд╕реЗ рдЕрдзрд┐рдХ рддрддреНрд╡ рдирд╣реАрдВ рдЪреБрди рд╕рдХрддреЗред"
рдЪреБрдирддрд╛ рд╣реИ = []
рд░реЗрдВрдЬ рдореЗрдВ _ рдХреЗ рд▓рд┐рдП (num_examples):
рдкрд┐рдХ = рд░реИрдВрдбрдо.рд░реИрдВрдбрд┐рдВрдЯ(0, рд▓реЗрди(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
рдЬрдмрдХрд┐рдЪрдпрди рдореЗрдВ рдЪрдпрди рдХрд░реЗрдВ:
рдкрд┐рдХ = рд░реИрдВрдбрдо.рд░реИрдВрдбрд┐рдВрдЯ(0, рд▓реЗрди(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
рдЪреБрдирддрд╛ рд╣реИ.рдЬреЛрдбрд╝реЗрдВ(рдЪреБрдиреЗрдВ)

рдбреАрдПрдл = рдкреАрдбреА.рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо(рдбреЗрдЯрд╛рд╕реЗрдЯ[рдЪреБрдирддрд╛ рд╣реИ])
рдХреЙрд▓рдо рдХреЗ рд▓рд┐рдП, dataset.features.items() рдЯрд╛рдЗрдк рдХрд░реЗрдВ:
рдпрджрд┐ isinstance(рдкреНрд░рдХрд╛рд░, рдХреНрд▓рд╛рд╕рд▓реЗрдмрд▓):
рдбреАрдПрдл[рдХреЙрд▓рдо] = рдбреАрдПрдл[рдХреЙрд▓рдо].рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо(рд▓реИрдореНрдмреНрдбрд╛ рдЖрдИ: рдЯрд╛рдЗрдк.рдирд╛рдо[рдЖрдИ])
elif isinstance(type, Sequence) рдФрд░ isinstance(typ.feature, ClassLabel):
рдбреАрдПрдл[рдХреЙрд▓рдо] = рдбреАрдПрдл[рдХреЙрд▓рдо].рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо(рд▓реИрдореНрдмреНрдбрд╛ рдПрдХреНрд╕: [рдЯрд╛рдЗрдк.рдлреАрдЪрд░.рдирд╛рдо[рдЖрдИ] рдлреЙрд░ рдЖрдИ рдЗрди рдПрдХреНрд╕])
рдбрд┐рд╕реНрдкреНрд▓реЗ(HTML(df.to_html()))
```

```рдЕрдЬрдЧрд░
show_random_elements(рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"], num_examples=2)
```<рддрд╛рд▓рд┐рдХрд╛ рд╕реАрдорд╛ = "1" рд╡рд░реНрдЧ = "рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо">
<рд╕рд┐рд░>
<tr рд╢реИрд▓реА = "рдкрд╛рда-рд╕рдВрд░реЗрдЦрдг: рджрд╛рдПрдВ;">
<рде></рде>
<th>рдЙрддреНрддрд░</th>
<th>рд╕рдВрджрд░реНрдн</th>
<th>рдЖрдИрдбреА</th>
<th>рдкреНрд░рд╢реНрди</th>
<th>рд╢реАрд░реНрд╖рдХ</th>
</tr>
</thead>
<tbody><tr>
<th>0</th>
<td>{'answer_start': [185], 'text': ['рдбреАрдЬрд▓ рдИрдВрдзрди']}</td>
<td>рдЕрд▓реНрдмрд░реНрдЯрд╛ рдореЗрдВ, рдкрд╛рдВрдЪ рдмрд┐рдЯреБрдореЗрди рдЕрдкрдЧреНрд░реЗрдбрд░ рд╕рд┐рдВрдереЗрдЯрд┐рдХ рдХрдЪреНрдЪреЗ рддреЗрд▓ рдФрд░ рдХрдИ рдЕрдиреНрдп рдЙрддреНрдкрд╛рджреЛрдВ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рддреЗ рд╣реИрдВ: рдлреЛрд░реНрдЯ рдореИрдХрдорд░реЗ рдХреЗ рдкрд╛рд╕ рд╕рдирдХреЛрд░ рдПрдирд░реНрдЬреА рдЕрдкрдЧреНрд░реЗрдбрд░, рдЕрд▓реНрдмрд░реНрдЯрд╛ рд╕рд┐рдВрдереЗрдЯрд┐рдХ рдХрдЪреНрдЪреЗ рддреЗрд▓ рдФрд░ рдбреАрдЬрд▓ рдИрдВрдзрди рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рддрд╛ рд╣реИ, рдХреИрдиреЗрдбрд┐рдпрди рдиреЗрдЪрд░;рдЕрд▓ рд░рд┐рд╕реЛрд░реНрд╕реЗрдЬ, рдФрд░ рдлреЛрд░реНрдЯ рдореИрдХрдорд░реЗ рдХреЗ рдкрд╛рд╕ рдиреЗрдХреНрд╕рди рдЕрдкрдЧреНрд░реЗрдбрд░ рд╕рд┐рдВрдереЗрдЯрд┐рдХ рдХрдЪреНрдЪреЗ рддреЗрд▓ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рддреЗ рд╣реИрдВ; рдФрд░ рдПрдбрдореЙрдиреНрдЯрди рдХреЗ рдкрд╛рд╕ рд╢реЗрд▓ рд╕реНрдХреЙрдЯрдлреЛрд░реНрдб рдЕрдкрдЧреНрд░реЗрдбрд░ рд╕рд┐рдВрдереЗрдЯрд┐рдХ рдХрдЪреНрдЪреЗ рддреЗрд▓ рдХреЗ рд╕рд╛рде-рд╕рд╛рде рдкрд╛рд╕ рдХреЗ рд╢реЗрд▓ рдСрдпрд▓ рд░рд┐рдлрд╛рдЗрдирд░реА рдХреЗ рд▓рд┐рдП рдПрдХ рдордзреНрдпрд╡рд░реНрддреА рдлреАрдбрд╕реНрдЯреЙрдХ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ 2015 рдореЗрдВ рд░реЗрдбрд╡рд╛рдЯрд░, рдЕрд▓реНрдмрд░реНрдЯрд╛ рдХреЗ рдкрд╛рд╕ рдирд┐рд░реНрдорд╛рдгрд╛рдзреАрди рд╣реИ рдЕрдкрдиреЗ рдХрдЪреНрдЪреЗ рдмрд┐рдЯреБрдореЗрди рдХреЗ рдЖрдзреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рд╕реАрдзреЗ рдбреАрдЬрд▓ рдИрдВрдзрди рдореЗрдВ рдЕрдкрдЧреНрд░реЗрдб рдХрд░реЗрдВ, рд╢реЗрд╖ рдЙрддреНрдкрд╛рджрди рдХреЛ рдкрд╛рд╕ рдХреЗ рддреЗрд▓ рд░рд┐рдлрд╛рдЗрдирд░рд┐рдпреЛрдВ рдФрд░ рдкреЗрдЯреНрд░реЛрдХреЗрдорд┐рдХрд▓ рд╕рдВрдпрдВрддреНрд░реЛрдВ рдХреЛ рдлреАрдбрд╕реНрдЯреЙрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдмреЗрдЪрд╛ рдЬрд╛рдПрдЧрд╛ред</td>
<td>571b074c9499d21900609be3</tрдШ>
<td>рдХрдЪреНрдЪреЗ рддреЗрд▓ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕рдирдХреЛрд░ рдПрдирд░реНрдЬреА рд╕рдВрдпрдВрддреНрд░ рдХреНрдпрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рддрд╛ рд╣реИ?</td>
<td>рдбрд╛рдорд░</td>
</tr>
<tr>
<th>1</th>
<td>{'answer_start': [191], 'text': ['рдЧреИрд▓реАрд▓рд┐рдпреЛ рдкреНрд░рдгрд╛рд▓реА рдХреЗ рд▓рд┐рдП GIOVE рдЙрдкрдЧреНрд░рд╣']}</td>
<td>рдХрдореНрдкрд╛рд╕-рдПрдо1 рдПрдХ рдкреНрд░рд╛рдпреЛрдЧрд┐рдХ рдЙрдкрдЧреНрд░рд╣ рд╣реИ рдЬрд┐рд╕реЗ рд╕рд┐рдЧреНрдирд▓ рдкрд░реАрдХреНрд╖рдг рдФрд░ рд╕рддреНрдпрд╛рдкрди рдФрд░ рдЖрд╡реГрддреНрддрд┐ рдлрд╛рдЗрд▓рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП 14 рдЕрдкреНрд░реИрд▓ 2007 рдХреЛ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдХрдореНрдкрд╛рд╕ рдХреЗ рд▓рд┐рдП рдХрдореНрдкрд╛рд╕-рдПрдо1 рдХреА рднреВрдорд┐рдХрд╛ рдЧреИрд▓реАрд▓рд┐рдпреЛ рдХрдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдЬреАрдЖрдИрдУрд╡реАрдИ рдЙрдкрдЧреНрд░рд╣реЛрдВ рдХреА рднреВрдорд┐рдХрд╛ рдХреЗ рд╕рдорд╛рди рд╣реИ рдХрдореНрдкрд╛рд╕-рдПрдо1 рд▓рдЧрднрдЧ рдЧреЛрд▓рд╛рдХрд╛рд░ рд╣реИ, рдЗрд╕рдореЗрдВ рдКрдВрдЪрд╛рдИ рд╣реИ21,150 рдХрд┐рдореА рдФрд░ 55.5 рдбрд┐рдЧреНрд░реА рдХрд╛ рдЭреБрдХрд╛рд╡ред</td>
<td>56e1161ccd28a01900c6757b</td>
<td>рдХрдореНрдкрд╛рд╕-рдПрдо1 рдЙрдкрдЧреНрд░рд╣ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдЕрдиреНрдп рдХрд┐рд╕ рдЙрдкрдЧреНрд░рд╣ рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд╕рдорд╛рди рд╣реИ?</td>
<td>BeiDou_рдиреЗрд╡рд┐рдЧреЗрд╢рди_рд╕реИрдЯреЗрд▓рд╛рдЗрдЯ_рд╕рд┐рд╕реНрдЯрдо</td>
</tr>
</tbody>
</рддрд╛рд▓рд┐рдХрд╛>

## рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдирд╛

рдореЙрдбрд▓ рдореЗрдВ рдбреЗрдЯрд╛ рдлреАрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЯреВрд▓ рдХреЛ `рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░` рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдкрд╣рд▓реЗ рдЗрдирдкреБрдЯ рдХреЛ рдЯреЛрдХрдирд╛рдЗрдЬрд╝ рдХрд░рддрд╛ рд╣реИ, рдлрд┐рд░ рдЯреЛрдХрди рдХреЛ рд╕рдВрдмрдВрдзрд┐рдд рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИрдкреНрд░реА-рдореЙрдбрд▓ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдЯреЛрдХрди рдЖрдИрдбреА, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИред

рдбреЗрдЯрд╛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЕрдкрдиреЗ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `AutoTokenizer.from_pretrained` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ:

- рд╣рдореЗрдВ рдПрдХ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдорд┐рд▓рддрд╛ рд╣реИ рдЬреЛ рдПрдХ-рдПрдХ рдХрд░рдХреЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред
- рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рдЕрдиреБрд░реВрдк рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рд╣рдо рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рд╢рдмреНрджрд╛рд╡рд▓реА, рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ, рдЯреЛрдХрди рд╢рдмреНрджрд╛рд╡рд▓реА рднреА рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВредрдИ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЧрдП рдЯреЛрдХрди рд╢рдмреНрджрд╛рд╡рд▓реА рдХреЛ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддрд╛рдХрд┐ рджреЛрдмрд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдкрд░ рдЗрд╕реЗ рджреЛрдмрд╛рд░рд╛ рдбрд╛рдЙрдирд▓реЛрдб рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(model_checkpoint)
```

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред PreTrainedTokenizerFast, рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди рдлрд╛рд╕реНрдЯ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ (рдЬреИрд╕реЗ рдорд▓реНрдЯреА-рдереНрд░реЗрдбреЗрдб рдлрд╛рд╕реНрдЯ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░) рдХреА рдХреБрдЫ рд╡рд┐рд╢реЗрд╖ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

рдореЙрдбрд▓реЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд▓рдЧрднрдЧ рд╕рднреА рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдореЗрдВ рдХреЛрд░ рд╣реЛрддрд╛ рд╣реИрддреЗрдЬреА рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ред рд╣рдо [рдореЙрдбрд▓ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреЙрд░реЗрд╕реНрдкреЛрдВрдбреЗрдВрд╕ рдЯреЗрдмрд▓] (https://huggingface.co/transformers/index.html#bigtable) рдореЗрдВ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдЕрдиреБрд░реВрдк рд╕рднреА рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдЬрд╝реЛрд░ isinstance(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░, рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░.PreTrainedTokenizerFast)
```

```рдЕрдЬрдЧрд░
# рдпрджрд┐ рд╣рдо рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рдж рдЯреЗрдХреНрд╕реНрдЯ рдлреЙрд░реНрдореЗрдЯ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдХреЗрд╡рд▓ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреА рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдЕрд░реНрде рд╣реИ рдкреА рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди рдЬреЛрдбрд╝рдирд╛рдкреБрдирдГ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓.
рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ ("рдПрдХрд▓ рдкрд╛рда рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝: {}"ред рдкреНрд░рд╛рд░реВрдк (рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░.рдЯреЛрдХрдирд╛рдЗрдЬрд╝ ("рдЖрдкрдХрд╛ рдирд╛рдо рдХреНрдпрд╛ рд╣реИ?"), add_special_tokens=True))
рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ ("2 рдЯреЗрдХреНрд╕реНрдЯ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝: {}"ред рдкреНрд░рд╛рд░реВрдк (рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░.рдЯреЛрдХрдирд╛рдЗрдЬрд╝ ("рдореЗрд░рд╛ рдирд╛рдо рд╕рд┐рд▓реНрд╡реЗрди рд╣реИред", add_special_tokens=True)))
# рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рдХреЗ рд▓рд┐рдП рдЯреЛрдХрди рдЖрдИрдбреА рдФрд░ рдПрдХ рдПрдЯреЗрдЯрдирд┐рдпрди рдорд╛рд╕реНрдХ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдкреНрд░рд╛рд░реВрдк рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрди рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```

рдПрдХрд▓ рдкрд╛рда рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝: ['рдХреНрдпрд╛', 'рд╣реИ', 'рдЖрдкрдХрд╛', 'рдирд╛рдо', '?']
2 рдЯреЗрдХреНрд╕реНрдЯ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝: ['[рд╕реАрдПрд▓рдПрд╕]','рдорд╛рдп', 'рдирд╛рдо', 'рд╣реИ', 'sy', '##lva', '##in', '.', '[SEP]']

рдЯреЛрдХрдиреЗрдЬрд╝рд░ рдПрдХ рдПрдХрд▓ рдкрд╛рда рдпрд╛ рдкрд╛рдареЛрдВ рдХреА рдПрдХ рдЬреЛрдбрд╝реА рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЯреЛрдХрдиреЗрдЬрд╝рд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рдж рдкреНрд░рд╛рдкреНрдд рдбреЗрдЯрд╛ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рд╕реЗ рдорд┐рд▓рддрд╛ рд╣реИ

```рдЕрдЬрдЧрд░
# рдПрдХрд▓ рдкрд╛рда рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд░реЗрдВ
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ ("рдЖрдкрдХрд╛ рдирд╛рдо рдХреНрдпрд╛ рд╣реИ?")
```

{'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [101, 2054, 2003, 2115, 2171, 1029, 102], 'рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ': [1, 1, 1, 1, 1, 1, 1]}

```рдЕрдЬрдЧрд░
# рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ 2 рдЯреЗрдХреНрд╕реНрдЯред рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рд╢реБрд░реБрдЖрдд рдореЗрдВ 101 рдЯреЛрдХрди рдЖрдИрдбреА рдФрд░ рдмреАрдЪ рдореЗрдВ 102 рдЯреЛрдХрди рдЬреЛрдбрд╝рддрд╛ рд╣реИdle. рдЖрдИрдбреА рджреЛ рдкрд╛рдареЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рддреА рд╣реИ рдФрд░ 102 рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИред рдпреЗ рдирд┐рдпрдо рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВред
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ ("рдЖрдкрдХрд╛ рдирд╛рдо рдХреНрдпрд╛ рд╣реИ?", "рдореЗрд░рд╛ рдирд╛рдо рд╕рд┐рд▓реНрд╡реЗрди рд╣реИред")
```

{'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [101, 2054, 2003, 2115, 2171, 1029, 102, 2026, 2171, 2003, 25353, 22144, 2378, 1012, 102], 'рдЕрдЯреЗрдВрд╢рди_рдорд╛рд╕реНрдХ': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}

рдЬреЛ рдЯреЛрдХрди рдЖрдИрдбреА рдпрд╛ рдЗрдирдкреБрдЯ_рдЖрдИрдбреА рдЖрдк рдКрдкрд░ рджреЗрдЦрддреЗ рд╣реИрдВ, рд╡реЗ рдЖрдо рддреМрд░ рдкрд░ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдирд╛рдо рдХреЗ рд╕рд╛рде рднрд┐рдиреНрди рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЖрд░рдпреВ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВрдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рдиред рд▓реЗрдХрд┐рди рдЬрдм рддрдХ рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдФрд░ рдореЙрдбрд▓ рдХреЗ рдирд╛рдо рд╕рдорд╛рди рд╣реИрдВ, рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХрд╛ рдЗрдирдкреБрдЯ рдкреНрд░рд╛рд░реВрдк рдореЙрдбрд▓ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░реЗрдЧрд╛, [рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓] рдХреЛ рджреЗрдЦреЗрдВред https://huggingface.co/transformers/preprocessing.html)

рдЕрдм рд╣рдореЗрдВ рдпрд╣ рднреА рд╕реЛрдЪрдиреЗ рдХреА рдЬрд╝рд░реВрд░рдд рд╣реИ рдХрд┐ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдорд╢реАрди рдкреНрд░рд╢реНрди рдЙрддреНрддрд░ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдореЙрдбрд▓ рдмрд╣реБрдд рд▓рдВрдмреЗ рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рдХреИрд╕реЗ рд╕рдВрднрд╛рд▓рддреЗ рд╣реИрдВ, рд╕рд╛рдорд╛рдиреНрдпрддрдпрд╛, рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдЗрдирдкреБрдЯ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдорд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ рд╣рдо рдкреНрд░рд╢реНрди-рдЙрддреНрддрд░ рдбреЗрдЯрд╛ рдореЗрдВ рдУрд╡рд░рд▓реЙрдиреНрдЧ рд╕рдВрджрд░реНрдн рдХреЛ рддреАрди <рдкреНрд░рд╢реНрди, рд╕рдВрджрд░реНрдн, рдЙрддреНрддрд░> рд╕реЗ рдЫреЛрдЯрд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдЙрддреНрддрд░ рдЦреЛ рд╕рдХрддреЗ рд╣реИрдВ (рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрддреНрддрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рд╕реНрдирд┐рдкреЗрдЯ рдирд┐рдХрд╛рд▓рддреЗ рд╣реИрдВ)ред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рд▓рдВрдмрд╛рдИ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛрдиреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдвреВрдВрдврддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЖрдкрдХреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдЗрд╕реЗ рдХреИрд╕реЗ рд╕рдВрднрд╛рд▓рдирд╛ рд╣реИред рд╣рдо рд▓рдВрдмреЗ рдЗрдирдкреБрдЯ рдХреЛ рдХрдИ рдЫреЛрдЯреЗ рдЗрдирдкреБрдЯ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рдореЙрдбрд▓ рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рдЗрдирдкреБрдЯ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдкреВрд░рд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ рдЙрддреНрддрд░ рдореМрдЬреВрдж рд╣реЛ рд╕рдХрддрд╛ рд╣реИрд╕реНрд▓рд╛рдЗрд╕, рд╣рдореЗрдВ рдЖрд╕рдиреНрди рд╕реНрд▓рд╛рдЗрд╕ рдХреЗ рдмреАрдЪ рдЗрдВрдЯрд░рд╕реЗрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдХреЛрдб рдореЗрдВ `doc_stride` рдкреИрд░рд╛рдореАрдЯрд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдорд╢реАрди рдкреНрд░рд╢реНрди рдЙрддреНрддрд░ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдЖрдорддреМрд░ рдкрд░ рдкреНрд░рд╢реНрди рдФрд░ рд╕рдВрджрд░реНрдн рдХреЛ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдореЙрдбрд▓ рдХреЛ рд╕рдВрджрд░реНрдн рд╕реЗ рдЙрддреНрддрд░ рдвреВрдВрдврдиреЗ рджреЗрддреЗ рд╣реИрдВред

```рдЕрдЬрдЧрд░
рдЕрдзрд┐рдХрддрдо_рд▓рдВрдмрд╛рдИ = 384 # рдкреНрд░рд╢реНрди рдФрд░ рд╕рдВрджрд░реНрдн рдХреЛ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЗрдирдкреБрдЯ рд╕реБрд╡рд┐рдзрд╛ рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ
doc_stride = 128 # 2 рд╕реНрд▓рд╛рдЗрд╕ рдХреЗ рдмреАрдЪ рдУрд╡рд░рд▓реИрдкрд┐рдВрдЧ рдЯреЛрдХрди рдХреА рд╕рдВрдЦреНрдпрд╛ред
```

рдлреЙрд░ рд▓реВрдк рдбреЗрдЯрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреБрдирд░рд╛рд╡реГрддреНрдд рд╣реЛрддрд╛ рд╣реИрдПрд╕реЗрдЯ рдФрд░ рдПрдХ рдЕрддреНрдпрдВрдд рд▓рдВрдмреЗ рдирдореВрдиреЗ рдХреА рддрд▓рд╛рд╢ рдХрд░рддрд╛ рд╣реИред рдиреЛрдЯрдмреБрдХ рдЙрджрд╛рд╣рд░рдг рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЕрдзрд┐рдХрддрдо рдЗрдирдкреБрдЯ 384 рд╣реИ (512 рднреА рдЖрдорддреМрд░ рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)

```рдЕрдЬрдЧрд░
рдореЗрд░реЗ рд▓рд┐рдП, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЧрдгрдирд╛ рдХрд░реЗрдВ (рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"]):
рдпрджрд┐ рд▓реЗрди(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░(рдЙрджрд╛рд╣рд░рдг["рдкреНрд░рд╢реНрди"], рдЙрджрд╛рд╣рд░рдг["рд╕рдВрджрд░реНрдн"])["input_ids"]) > 384:
рддреЛрдбрд╝рдирд╛
рдЙрджрд╛рд╣рд░рдг = рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"][i]
```

рдпрджрд┐ рдЗрд╕реЗ рдЫреЛрдЯрд╛ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЗрдирдкреБрдЯ рд▓рдВрдмрд╛рдИ 396 рд╣реИ

```рдЕрдЬрдЧрд░
рд▓реЗрди(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░(рдЙрджрд╛рд╣рд░рдг["рдкреНрд░рд╢реНрди"], рдЙрджрд╛рд╣рд░рдг["рд╕рдВрджрд░реНрдн"])["input_ids"])
```

396

рдЕрдм рдпрджрд┐ рд╣рдо 3 рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рддрдХ рдХрд╛рдЯ-рдЫрд╛рдВрдЯ рдХрд░рддреЗ рд╣реИрдВ84, рдЕрддрд┐рд░рд┐рдХреНрдд-рд▓рдВрдмреЗ рднрд╛рдЧ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдЦреЛ рдЬрд╛рдПрдЧреА

```рдЕрдЬрдЧрд░
рд▓реЗрди (рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ (рдЙрджрд╛рд╣рд░рдг ["рдкреНрд░рд╢реНрди"], рдЙрджрд╛рд╣рд░рдг ["рд╕рдВрджрд░реНрдн"], рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ = рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ, рдЯреНрд░рдВрдХреЗрд╢рди = "рдХреЗрд╡рд▓_рд╕реЗрдХрдВрдб") ["рдЗрдирдкреБрдЯ_рдЖрдИрдбреА"])
```

384

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рд╣рдо рдХреЗрд╡рд▓ рд╕рдВрджрд░реНрдн рдХреЛ рдХрд╛рдЯрддреЗ рд╣реИрдВ, рдкреНрд░рд╢реНрди рдХреЛ рдирд╣реАрдВред рдЪреВрдВрдХрд┐ рд╕рдВрджрд░реНрдн рдкреНрд░рд╢реНрди рдХреЗ рдмрд╛рдж рджреВрд╕рд░реЗ рдкрд╛рда рдХреЗ рдЕрдиреБрд░реВрдк рд╣реЛрддрд╛ рд╣реИ, рд╣рдо рдЗрд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `only_third` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдУрд╡рд░рд▓реИрдк рд▓рдВрдмрд╛рдИ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ `doc_stride` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рд╕реНрд▓рд╛рдЗрд╕ рдХреЗ рдмреАрдЪ.

```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдЙрджрд╛рд╣рд░рдг = рдЯреЛрдХрдирдЗрдЬрд╝реЗрд░(
рдЙрджрд╛рд╣рд░рдг["рдкреНрд░рд╢реНрди"],
рдЙрджрд╛рд╣рд░рдг["рд╕рдВрджрд░реНрдн"],
рдЕрдзрд┐рдХрддрдо_рд▓рдВрдмрд╛рдИ=рдЕрдзрд┐рдХрддрдо_рд▓рдВрдмрд╛рдИ,
рдЯреНрд░рдВрдХреЗрд╢рди = "рдХреЗрд╡рд▓_рд╕реЗрдХрдВрдб",
return_overflowing_tokens=рд╕рддреНрдп,
рд╕реНрдЯреНрд░рд╛рдЗрдб=doc_рд╕реНрдЯреНрд░рд╛рдЗрдб
)
```

рд╕реБрдкрд░ рд▓реЙрдиреНрдЧ рдЗрдирдкреБрдЯ рдХреА рд╕реНрд▓рд╛рдЗрд╕рд┐рдВрдЧ рдХреЗ рдХрд╛рд░рдг рд╣рдореЗрдВ рдХрдИ рдЗрдирдкреБрдЯ рдорд┐рд▓рддреЗ рд╣реИрдВ, рдЗрди рдЗрдирдкреБрдЯ_рдЖрдИрдбреА рдХреА рд▓рдВрдмрд╛рдИ рд╣реЛрддреА рд╣реИ

```рдЕрдЬрдЧрд░
[рдЯреЛрдХрдирдХреГрдд_рдЙрджрд╛рд╣рд░рдг рдореЗрдВ x рдХреЗ рд▓рд┐рдП len(x)["input_ids"]]
```

[384,157]

рд╣рдо рдкреВрд░реНрд╡-рд╕рдВрд╕рд╛рдзрд┐рдд рдЯреЛрдХрди рдЖрдИрдбреА, рдЗрдирдкреБрдЯ_рдЖрдИрдбреА рдХреЛ рдЯреЗрдХреНрд╕реНрдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
i, x рдХреЗ рд▓рд┐рдП enumerate(tokenized_example["input_ids"][:2]):
рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ ("рд╕реНрд▓рд╛рдЗрд╕: {}"ред рдкреНрд░рд╛рд░реВрдк (i))
рдкрдВрдЪрд╛рдпрддреА рд░рд╛рдЬnt(tokenizer.decode(x))
```рд╕реНрд▓рд╛рдЗрд╕: 0
[рд╕реАрдПрд▓рдПрд╕] рдиреЛрдЯреНрд░реЗ рдбреЗрдо рдкреБрд░реБрд╖реЛрдВ рдХреА рдмрд╛рд╕реНрдХреЗрдЯрдмреЙрд▓ рдЯреАрдо рдиреЗ рдХрд┐рддрдиреА рдЬреАрдд рд╣рд╛рд╕рд┐рд▓ рдХреА рд╣реИ? [рдПрд╕рдИрдкреА] рдкреБрд░реБрд╖реЛрдВ рдХреА рдмрд╛рд╕реНрдХреЗрдЯрдмреЙрд▓ рдЯреАрдо рдиреЗ 1,600 рд╕реЗ рдЕрдзрд┐рдХ рдЬреАрдд рд╣рд╛рд╕рд┐рд▓ рдХреА рд╣реИрдВ, рдЬреЛ рдХреЗрд╡рд▓ 12 рд╕реНрдХреВрд▓реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ рдЬреЛ рдЙрд╕ рдЖрдВрдХрдбрд╝реЗ рддрдХ рдкрд╣реБрдВрдЪреА рд╣реИ, рдФрд░ 28 рдПрдирд╕реАрдПрдП рдЯреВрд░реНрдирд╛рдореЗрдВрдЯ рдореЗрдВ рднрд╛рдЧ рд▓реЗ рдЪреБрдХреА рд╣реИ рдСрд╕реНрдЯрд┐рди рдХреИрд░ рдХреЗ рдирд╛рдо рдЯреВрд░реНрдирд╛рдореЗрдВрдЯ рдХреЗ рдПрдХ рдЧреЗрдо рдореЗрдВ рд╕рд░реНрд╡рд╛рдзрд┐рдХ 61 рдЕрдВрдХ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдиреЗ рдХрд╛ рд░рд┐рдХреЙрд░реНрдб рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЯреАрдо рдиреЗ рдХрднреА рднреА рдПрдирд╕реАрдПрдП рдЯреВрд░реНрдирд╛рдореЗрдВрдЯ рдирд╣реАрдВ рдЬреАрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЙрдиреНрд╣реЗрдВ рд╣реЗрд▓реНрдореНрд╕ рдПрдерд▓реЗрдЯрд┐рдХ рдлрд╛рдЙрдВрдбреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рджреЛ рдмрд╛рд░ рд░рд╛рд╖реНрдЯреНрд░реАрдп рдЪреИрдВрдкрд┐рдпрди рдХреЗ рд░реВрдк рдореЗрдВ рдирд╛рдорд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛рдирдВрдмрд░ рдПрдХ рд░реИрдВрдХ рд╡рд╛рд▓реА рдЯреАрдореЛрдВ рдХреЗ рд▓рд┐рдП рдХрдИ рдЙрд▓рдЯрдлреЗрд░ рдХрд┐рдП рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рд╕рдмрд╕реЗ рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рдерд╛ 1974 рдореЗрдВ рдпреВрд╕реАрдПрд▓рдП рдХреЗ рд░рд┐рдХреЙрд░реНрдб 88 - рдЧреЗрдо рдЬреАрддрдиреЗ рдХреЗ рд╕рд┐рд▓рд╕рд┐рд▓реЗ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛ред рдЯреАрдо рдиреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдЖрда рдирдВрдмрд░ - рдПрдХ рдЯреАрдореЛрдВ рдХреЛ рд╣рд░рд╛рдпрд╛ рд╣реИ, рдФрд░ рд╡реЗ рдиреМ рдЬреАрдд рдпреВрд╕реАрдПрд▓рдП рдХреЗ рдмрд╛рдж рджреВрд╕рд░реЗ рд╕реНрдерд╛рди рдкрд░ рд╣реИрдВред 10, рд╕рд░реНрд╡рдХрд╛рд▓рд┐рдХ рд╢реАрд░реНрд╖ рдЯреАрдо рдХреЗ рдЦрд┐рд▓рд╛рдл рдЬреАрдд рдореЗрдВ рдЯреАрдо рдирд╡ рдкреБрдирд░реНрдирд┐рд░реНрдорд┐рдд рдкрд░рд╕реЗрд▓ рдкрд╡реЗрд▓рд┐рдпрди (рдПрдбрдордВрдб рдкреА. рдЬреЙрдпрд╕ рд╕реЗрдВрдЯрд░ рдХреЗ рднреАрддрд░) рдореЗрдВ рдЦреЗрд▓рддреА рд╣реИ, рдЬреЛ 2009-2010 рд╕реАрдЬрд╝рди рдХреА рд╢реБрд░реБрдЖрдд рдХреЗ рд▓рд┐рдП рдлрд┐рд░ рд╕реЗ рдЦреЛрд▓рд╛ рдЧрдпрд╛, рдЯреАрдо рдХреЛ рдорд╛рдЗрдХ рдмреНрд░реЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬреЛ, 201 рдХреЗ рдЕрдиреБрд╕рд╛рд░4 - 15 рд╕реАрдЬрд╝рди, рдиреЛрдЯреНрд░реЗ рдбреЗрдо рдореЗрдВ рдЙрдирдХрд╛ рдкрдВрджреНрд░рд╣рд╡рд╛рдВ, 2009 рдореЗрдВ 332 - 165 рдХрд╛ рд░рд┐рдХреЙрд░реНрдб рд╣рд╛рд╕рд┐рд▓ рдХрд┐рдпрд╛, рдЙрдиреНрд╣реЗрдВ рдПрдирдЖрдИрдЯреА рдХреЗ рд▓рд┐рдП рдЖрдордВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛, рдЬрд╣рд╛рдВ рд╡реЗ рд╕реЗрдореАрдлрд╛рдЗрдирд▓ рдореЗрдВ рдкрд╣реБрдВрдЪреЗ рд▓реЗрдХрд┐рди рдкреЗрди рд╕реНрдЯреЗрдЯ рдиреЗ рдЙрдиреНрд╣реЗрдВ рд╣рд░рд╛ рджрд┐рдпрд╛, рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдЪреИрдВрдкрд┐рдпрдирд╢рд┐рдк рдореЗрдВ рдмрд╛рдпрд▓рд░ рдХреЛ рд╣рд░рд╛рдпрд╛ред 2010 - 11 рдХреА рдЯреАрдо рдиреЗ 25 - 5 рдХреЗ рд░рд┐рдХреЙрд░реНрдб рдХреЗ рд╕рд╛рде рдЕрдкрдиреЗ рдирд┐рдпрдорд┐рдд рд╕реАрдЬрд╝рди рдХреЛ рджреЗрд╢ рдореЗрдВ рд╕рд╛рддрд╡реЗрдВ рд╕реНрдерд╛рди рдкрд░ рд╕рдорд╛рдкреНрдд рдХрд┐рдпрд╛, рдмреНрд░реЗ рдХреА рд▓рдЧрд╛рддрд╛рд░ рдкрд╛рдВрдЪрд╡реАрдВ 20 - рдЬреАрдд рд╕реАрдЬрд╝рди, рдФрд░ 2014 - 15 рд╕реАрдЬрд╝рди рдХреЗ рджреМрд░рд╛рди рдмрд┐рдЧ рдИрд╕реНрдЯ рдореЗрдВ рджреВрд╕рд░реЗ рд╕реНрдерд╛рди рдкрд░ рд░рд╣реАред рдЯреАрдо 32-6 рд╕реЗ рдЖрдЧреЗ рд░рд╣реА рдФрд░ рдПрд╕реАрд╕реА рд╕рдореНрдореЗрд▓рди рдЬреАрддрд╛рдИ рдЯреВрд░реНрдирд╛рдореЗрдВрдЯ, рдмрд╛рдж рдореЗрдВ рдПрд▓реАрдЯ 8 рдореЗрдВ рдЖрдЧреЗ рдмрдврд╝рд╛, рдЬрд╣рд╛рдВ рдПрдирдмреАрдП рдбреНрд░рд╛рдлреНрдЯ рдкрд┐рдХреНрд╕ рдЬреЗрд░рд┐рдпрди рдЧреНрд░рд╛рдВрдЯ рдФрд░ рдкреИрдЯ рдХрдиреЙрдЯрди рдХреЗ рдиреЗрддреГрддреНрд╡ рдореЗрдВ рддрддреНрдХрд╛рд▓реАрди рдЕрдкрд░рд╛рдЬрд┐рдд рдХреЗрдВрдЯреБрдХреА рдХреЗ рдЦрд┐рд▓рд╛рдл рд▓рдбрд╝рддреЗ рд╣реБрдП рдЖрдпрд░рд┐рд╢ рдПрдХ рдорд┐рд╕реНрдб рдмрдЬрд░-рдмреАрдЯрд░ рдкрд░ рд╣рд╛рд░ рдЧрдП, рдЗрд╕ рджреМрд░рд╛рди рд▓рдбрд╝рддреЗ рд╣реБрдП рдЖрдпрд░рд┐рд╢ рдиреЗ рдЕрдВрддрд┐рдо рд░рд╛рд╖реНрдЯреНрд░реАрдп рдЪреИрдВрдкрд┐рдпрди рдбреНрдпреВрдХ рдмреНрд▓реВ рдбреЗрд╡рд┐рд▓реНрд╕ рдХреЛ рджреЛ рдмрд╛рд░ рд╣рд░рд╛рдпрд╛ред рд╕реАрдЬрд╝рди рдореЗрдВ 32 рдЬреАрддреЗрдВ рдереАрдВ [рд╕рд┐рддрдореНрдмрд░]
рдЯреБрдХрдбрд╝рд╛: 1
[рд╕реАрдПрд▓рдПрд╕] рдиреЛрдЯреНрд░реЗ рдбреЗрдо рдкреБрд░реБрд╖реЛрдВ рдХреА рдмрд╛рд╕реНрдХреЗрдЯрдмреЙрд▓ рдЯреАрдо рдиреЗ рдХрд┐рддрдиреА рдЬреАрдд рд╣рд╛рд╕рд┐рд▓ рдХреА рд╣реИ? [рдПрд╕рдИрдкреА] рдЪреИрдВрдкрд┐рдпрдирд╢рд┐рдк 2010-11 рдЯреАрдо рдиреЗ рдЕрдкрдиреЗ рдирд┐рдпрдорд┐рдд рд╕рддреНрд░ рдХрд╛ рд╕рдорд╛рдкрди рджреЗрд╢ рдореЗрдВ рд╕рд╛рддрд╡реЗрдВ рд╕реНрдерд╛рди рдкрд░ рдХрд┐рдпрд╛25-5 рдХрд╛ рд░рд┐рдХреЙрд░реНрдб, рдмреНрд░реЗ рдХреА рд▓рдЧрд╛рддрд╛рд░ рдкрд╛рдВрдЪрд╡реАрдВ 20-рдЬреАрдд рд╕реАрдЬрд╝рди, рдФрд░ 2014-15 рд╕реАрдЬрд╝рди рдХреЗ рджреМрд░рд╛рди рдмрд┐рдЧ рдИрд╕реНрдЯ рдореЗрдВ рджреВрд╕рд░реЗ рд╕реНрдерд╛рди рдкрд░ рд░рд╣реА, рдЯреАрдо 32-6 рд╕реЗ рдЖрдЧреЗ рд╣реЛ рдЧрдИ рдФрд░ рдПрд╕реАрд╕реА рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ рдЯреВрд░реНрдирд╛рдореЗрдВрдЯ рдЬреАрддрд╛, рдмрд╛рдж рдореЗрдВ рдЕрднрд┐рдЬрд╛рдд рд╡рд░реНрдЧ рдореЗрдВ рдЖрдЧреЗ рдмрдврд╝реАред 8, рдЬрд╣рд╛рдВ рдлрд╛рдЗрдЯрд┐рдВрдЧ рдЖрдпрд░рд┐рд╢ рддрддреНрдХрд╛рд▓реАрди рдЕрдкрд░рд╛рдЬрд┐рдд рдХреЗрдВрдЯреБрдХреА рдХреЗ рдЦрд┐рд▓рд╛рдл рдорд┐рд╕реНрдб рдмрдЬрд░-рдмреАрдЯрд░ рдкрд░ рд╣рд╛рд░ рдЧрдпрд╛, рдПрдирдмреАрдП рдбреНрд░рд╛рдлреНрдЯ рдкрд┐рдХреНрд╕ рдЬреЗрд░рд┐рдпрди рдЧреНрд░рд╛рдВрдЯ рдФрд░ рдкреИрдЯ рдХрдиреЙрдЯрди рдХреЗ рдиреЗрддреГрддреНрд╡ рдореЗрдВ рдлрд╛рдЗрдЯрд┐рдВрдЧ рдЖрдпрд░рд┐рд╢ рдиреЗ рд╕реАрдЬрди рдХреЗ рджреМрд░рд╛рди рдЕрдВрддрд┐рдо рд░рд╛рд╖реНрдЯреНрд░реАрдп рдЪреИрдВрдкрд┐рдпрди рдбреНрдпреВрдХ рдмреНрд▓реВ рдбреЗрд╡рд┐рд▓реНрд╕ рдХреЛ рджреЛ рдмрд╛рд░ рд╣рд░рд╛рдпрд╛ рд╕рдмрд╕реЗ рдЬреНрдпрд╛рджрд╛ рд▓рдбрд╝рд╛рдИ рд╕реЗ1908-09 рд╕реЗ рдЖрдпрд░рд┐рд╢ рдЯреАрдоред [рд╕рд┐рддрдореНрдмрд░]

рдЪреВрдВрдХрд┐ рд╣рдордиреЗ рд▓рдВрдмреЗ рдкрд╛рда рдХреЛ рдХрд╛рдЯ рджрд┐рдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдЙрддреНрддрд░ рд╕реНрдерд┐рддрд┐ рдлрд┐рд░ рд╕реЗ рдвреВрдВрдврдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрджрд░реНрдн рдХреА рд╢реБрд░реБрдЖрдд рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖)ред рдорд╢реАрди рдкреНрд░рд╢реНрди рдЙрддреНрддрд░ рдореЙрдбрд▓ рдЙрддреНрддрд░ рд╕реНрдерд┐рддрд┐ (рдЙрддреНрддрд░ рдХреА рд╢реБрд░реБрдЖрдд рдФрд░ рдЕрдВрдд рд╕реНрдерд┐рддрд┐) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ред рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдЕрдВрдд) рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд▓реЗрдмрд▓ рдХреЗ рд░реВрдк рдореЗрдВ (рдЙрддреНрддрд░ рдХреЗ рдЯреЛрдХрди рдЖрдИрдбреАрдПрд╕ рдХреЗ рдмрдЬрд╛рдп)ред рдЗрд╕рд▓рд┐рдП рд╕реНрд▓рд╛рдЗрд╕ рдХреЛ рдореВрд▓ рдЗрдирдкреБрдЯ рдХреЗ рд╕рд╛рде рд╕рдВрдмрдВрдзрд┐рдд рд╕рдВрдмрдВрдз, рд╕реНрд▓рд╛рдЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рдж рд╕рдВрджрд░реНрдн рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЯреЛрдХрди рдХреА рд╕реНрдерд┐рддрд┐ рдФрд░ рд╕реНрдерд┐рддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИредрдореВрд▓ рд▓рдВрдмреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ, рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдореЗрдВ, рдЖрдк рдЗрд╕ рдкрддреНрд░рд╛рдЪрд╛рд░ рдХрд╛ рдорд╛рдирдЪрд┐рддреНрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `рд░рд┐рдЯрд░реНрди_рдСрдлрд╝рд╕реЗрдЯреНрд╕_рдореИрдкрд┐рдВрдЧ` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдЙрджрд╛рд╣рд░рдг = рдЯреЛрдХрдирдирд╛рдЗрдЬрд░(
рдЙрджрд╛рд╣рд░рдг["рдкреНрд░рд╢реНрди"],
рдЙрджрд╛рд╣рд░рдг["рд╕рдВрджрд░реНрдн"],
рдЕрдзрд┐рдХрддрдо_рд▓рдВрдмрд╛рдИ=рдЕрдзрд┐рдХрддрдо_рд▓рдВрдмрд╛рдИ,
рдЯреНрд░рдВрдХреЗрд╢рди = "рдХреЗрд╡рд▓_рд╕реЗрдХрдВрдб",
return_overflowing_tokens=рд╕рддреНрдп,
return_offsets_mapping=рд╕рддреНрдп,
рд╕реНрдЯреНрд░рд╛рдЗрдб=doc_рд╕реНрдЯреНрд░рд╛рдЗрдб
)
# рд╕реНрд▓рд╛рдЗрд╕ рдХреЗ рдкрд╣рд▓реЗ рдФрд░ рдмрд╛рдж рдореЗрдВ рд╕реНрдерд┐рддрд┐ рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдмреАрдЪ рдкрддреНрд░рд╛рдЪрд╛рд░ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ
рдкреНрд░рд┐рдВрдЯ (рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдСрдлрд╝рд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ"][0][:100])
```[(0, 0), (0, 3), (4, 8), (9, 13), (14, 18), (19, 22), (23, 28), (29, 33), ( 34, 37), (37, 38), (38, 39), (40, 50), (51, 55), (56, 60), (60, 61), (0, 0), (0, 3), (4, 7), (7, 8), (8, 9), (10, 20), (21, 25), (26, 29), (30, 34), (35, 36) , (36, 37), (37, 40), (41, 45), (45, 46), (47, 50), (51, 53), (54, 58), (59, 61), ( 62, 69), (70, 73), (74, 78), (79, 86), (87, 91), (92, 96), (96, 97), (98, 101), (102, 106), (107, 115), (116, 118), (119, 121), (122, 126), (127, 138), (138, 139), (140, 146), (147, 153)), (154, 160), (161, 165), (166, 171), (172, 175), (176, 182), (183, 186), (187, 191), (192, 198), (199, 205), (206, 208), (209, 210), (211, 217), (218, 222), (223, 225), (226, 229), (230, 240), (241) , 245), (246, 248), (248, 249), (250, 258), (259, 262), (263, 267), (268, 271), (272, 277), (278, 281 ), (282, 285), (286, 290), (291, 301), (301, 302), (303, 307), (308, 312), (313, 318), (319, 321), (322, 325), (326, 330), (330, 331), (332, 340), (341, 351), (352, 354), (355, 363), (364, 373), (374 ,379), (379, 380), (381, 384), (385, 389), (390, 393), (394, 406), (407, 408), (409, 415), (416, 418) ]
[0, 0]

рдЙрдкрд░реЛрдХреНрдд рдореВрд▓ рд╕рдВрджрд░реНрдн рд╕реНрд▓рд╛рдЗрд╕ рдореЗрдВрдЯреЛрдХрдирд╛рдЗрдЬреНрдб_рдЙрджрд╛рд╣рд░рдг рдХреЗ 0рд╡реЗрдВ рд╕реНрд▓рд╛рдЗрд╕ рдХреЗ рдкрд╣рд▓реЗ 100 рдЯреЛрдХрди рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░рддрд╛ рд╣реИред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкрд╣рд▓рд╛ рдЯреЛрдХрди `[рд╕реАрдПрд▓рдПрд╕]` (0, 0) рдкрд░ рд╕реЗрдЯ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЯреЛрдХрди рдкреНрд░рд╢реНрди рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдирд╣реАрдВ рд╣реИред рдЙрддреНрддрд░ред рджреВрд╕рд░реЗ рдЯреЛрдХрди рдХреА рдЖрд░рдВрдн рдФрд░ рд╕рдорд╛рдкреНрддрд┐ рд╕реНрдерд┐рддрд┐ 0 рдФрд░ 3 рд╣реИред рд╣рдо рд╕реНрд▓рд╛рдЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рдж рд╕рдВрдмрдВрдзрд┐рдд рдЯреЛрдХрди рдХреЛ рдЯреЛрдХрди рдЖрдИрдбреА рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ;рдореВрд▓ рд╕реНрдерд┐рддрд┐ рдкрд░ рдЯреЛрдХрди рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд▓рд╛рдЗрд╕ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЯреЛрдХрди рд╕реНрдерд┐рддрд┐ рдкрд░ рд╡рд╛рдкрд╕ рдореИрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ffset_mapping` рдкреИрд░рд╛рдореАрдЯрд░ред рдЪреВрдВрдХрд┐ рдкреНрд░рд╢реНрди рдХреЛ рд╕рдВрджрд░реНрдн рд╕реЗ рдкрд╣рд▓реЗ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╣рдо рдЗрд╕реЗ рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╕реАрдзреЗ рдкреНрд░рд╢реНрди рд╕реЗ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

```рдЕрдЬрдЧрд░
рдлрд░реНрд╕реНрдЯ_рдЯреЛрдХрди_рдЖрдИрдбреА = рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдЗрдирдкреБрдЯ_рдЖрдИрдбреА"][0][1]
рдСрдлрд╕реЗрдЯ = рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ"][0][1]
print(tokenizer.convert_ids_to_tokens([first_token_id])[0], рдЙрджрд╛рд╣рд░рдг["рдкреНрд░рд╢реНрди"][рдСрдлрд╕реЗрдЯ[0]:рдСрдлрд╕реЗрдЯ[1]])
```

рдХреИрд╕реЗ рдХреИрд╕реЗ

рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЬреА.рдИрд╕реНрд▓рд╛рдЗрд╕ рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ рдмрд╛рдж рдореЗрдВ рд╕реНрдерд┐рддрд┐ рдкрддреНрд░рд╛рдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдкреНрд░рд╢реНрди рдФрд░ рд╕рдВрджрд░реНрдн рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `sequence_ids` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

```рдЕрдЬрдЧрд░
рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреА = рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг.рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреА()
рдкреНрд░рд┐рдВрдЯ(рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреА)
```

[рдХреЛрдИ рдирд╣реАрдВ, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, рдХреЛрдИ рдирд╣реАрдВ, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 , 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 , 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 , 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, рдХреЛрдИ рдирд╣реАрдВ]

`рдХреЛрдИ рдирд╣реАрдВ` рд╡рд┐рд╢реЗрд╖ рдЯреЛрдХрди рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рдФрд░ 0 рдпрд╛ 1 рдкрд╣рд▓реЗ рдФрд░ рджреВрд╕рд░реЗ рдкрд╛рда рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдо q рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВрдкрд╣рд▓реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдИрд╕реНрдЯрд┐рди рдФрд░ рджреВрд╕рд░реЗ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрджрд░реНрдн, рд╡реЗ рдХреНрд░рдорд╢рдГ рдкреНрд░рд╢реНрди рдФрд░ рд╕рдВрджрд░реНрдн рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИрдВ, рд╣рдо рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдмрд╛рдж рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдореЗрдВ рдПрдиреЛрдЯреЗрдЯреЗрдб рдЙрддреНрддрд░ рдХреА рд╕реНрдерд┐рддрд┐ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдЙрддреНрддрд░ = рдЙрджрд╛рд╣рд░рдг["рдЙрддреНрддрд░"]
рдкреНрд░рд╛рд░рдВрдн_рдЪрд╛рд░ = рдЙрддреНрддрд░["рдЙрддреНрддрд░_рдкреНрд░рд╛рд░рдВрдн"][0]
рдЕрдВрдд_рдЪрд╛рд░ = рдкреНрд░рд╛рд░рдВрдн_рдЪрд╛рд░ + рд▓реЗрди(рдЙрддреНрддрд░["рдкрд╛рда"][0])

# рд╡рд░реНрддрдорд╛рди рдЯреЗрдХреНрд╕реНрдЯ рдХрд╛ рд╕реНрдЯрд╛рд░реНрдЯ рдЯреЛрдХрди рдЗрдВрдбреЗрдХреНрд╕ рдвреВрдВрдвреЗрдВред
рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ = 0
рдЬрдмрдХрд┐ рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреА[рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕] != 1:
рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ += 1

# рд╕реА рдХрд╛ рдЕрдВрддрд┐рдо рдЯреЛрдХрди рдЖрдИрдбреАрдиреЗрдХреНрд╕ рдвреВрдВрдвреЗрдВрд╡рд░реНрддрдорд╛рди рдкрд╛рда.
рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ = рд▓реЗрди(рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдЗрдирдкреБрдЯ_рдЖрдИрдбреА"][0]) - 1
рдЬрдмрдХрд┐ рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреА[рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕] != 1:
рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ -= 1

# рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЙрддреНрддрд░ рдкрд╛рда рдЕрдВрддрд░рд╛рд▓ рдХреЗ рдмрд╛рд╣рд░ рд╣реИ, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдирдореВрдиреЗ рдХрд╛ рдбреЗрдЯрд╛ рд╕реАрдПрд▓рдПрд╕ рдЯреЛрдХрди рд╕реНрдерд┐рддрд┐ рдкрд░ рдЪрд┐рд╣реНрдирд┐рдд рд╣реИред
рдСрдлрд╕реЗрдЯ = рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ"][0]
рдпрджрд┐ (рдСрдлрд╕реЗрдЯреНрд╕[рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕][0] <= рд╕реНрдЯрд╛рд░реНрдЯ_рдЪрд╛рд░ рдФрд░ рдСрдлрд╕реЗрдЯреНрд╕[рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕][1] >=рдПрдВрдб_рдЪрд╛рд░):
# рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ рдФрд░ рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ рдХреЛ рдЙрддреНрддрд░ рд╕реНрдерд┐рддрд┐ рдХреЗ рджреЛрдиреЛрдВ рдУрд░ рд▓реЗ рдЬрд╛рдПрдВрдкрд░ред
# рдиреЛрдЯ: рдЙрддреНрддрд░ рд╕реАрдорд╛ рд╢рд░реНрдд рдХреЗ рдЕрдВрдд рдореЗрдВ рд╣реИред
рдЬрдмрдХрд┐ рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ <рд▓реЗрди(рдСрдлрд╝рд╕реЗрдЯ) рдФрд░ рдСрдлрд╝рд╕реЗрдЯ[рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕][0] <= рд╕реНрдЯрд╛рд░реНрдЯ_рдЪрд╛рд░:
рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ += 1
рд╕реНрдЯрд╛рд░реНрдЯ_рдкреЛрдЬреАрд╢рди = рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ - 1рдЬрдмрдХрд┐ рдСрдлрд╕реЗрдЯреНрд╕[рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕][1] >=рдПрдВрдб_рдЪрд╛рд░:
рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ -= 1
рдПрдВрдб_рдкреЛрдЬреАрд╢рди = рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ + 1
рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ ("рдкреНрд░рд╛рд░рдВрдн_рд╕реНрдерд┐рддрд┐: {}, рд╕рдорд╛рдкреНрддрд┐_рд╕реНрдерд┐рддрд┐: {}"ред рдкреНрд░рд╛рд░реВрдк (рдкреНрд░рд╛рд░рдВрдн_рд╕реНрдерд┐рддрд┐, рд╕рдорд╛рдкреНрддрд┐_рд╕реНрдерд┐рддрд┐))
рдЕрдиреНрдп:
рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ ("рдЙрддреНрддрд░ рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдореЗрдВ рдирд╣реАрдВ рд╣реИред")
```

рдкреНрд░рд╛рд░рдВрдн_рд╕реНрдерд┐рддрд┐: 23, рд╕рдорд╛рдкреНрддрд┐_рд╕реНрдерд┐рддрд┐: 26

рдЬрд╝рд░реБрд░рдд рд╣реИрдЙрддреНрддрд░ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рддреНрдпрд╛рдкрди рд╡рд┐рдзрд┐ рд╣реИ: рдЙрддреНрддрд░ рд╕реНрдерд┐рддрд┐ рд╕реВрдЪрдХрд╛рдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рд╕рдВрдмрдВрдзрд┐рдд рдЯреЛрдХрди рдЖрдИрдбреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ, рдлрд┐рд░ рдЗрд╕реЗ рдкрд╛рда рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░реЗрдВ, рдФрд░ рдлрд┐рд░ рдЗрд╕рдХреА рддреБрд▓рдирд╛ рдореВрд▓ рдЙрддреНрддрд░ рд╕реЗ рдХрд░реЗрдВред

```рдЕрдЬрдЧрд░
print(tokenizer.decode(tokenized_example["input_ids"][0][start_position: end_position+1]))
рдкреНрд░рд┐рдВрдЯ (рдЙрддреНрддрд░["рдкрд╛рда"][0])
```

1,600 рд╕реЗ рдЕрдзрд┐рдХ
1,600 рд╕реЗ рдЕрдзрд┐рдХ

рдХрднреА-рдХрднреА рдкреНрд░рд╢реНрди рдХреЛ рд╕рдВрджрд░реНрдн рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдХрднреА-рдХрднреА рд╕рдВрджрд░реНрдн рдХреЛ рдкреНрд░рд╢реНрди рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред рд╡рд┐рднрд┐рдиреНрди рдореЙрдбрд▓реЛрдВ рдХреА рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рд╣реЛрддреА рд╣реИрдВрд╕рдВрдХреЗрдд, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдЗрд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `рдкреИрдбрд┐рдВрдЧ_рд╕рд╛рдЗрдб` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

```рдЕрдЬрдЧрд░
рдкреИрдб_рдСрди_рд░рд╛рдЗрдЯ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░.рдкреИрдбрд┐рдВрдЧ_рд╕рд╛рдЗрдб == "рджрд╛рдПрдВ" #рд╕рдВрджрд░реНрдн рджрд╛рдИрдВ рдУрд░ рд╣реИ
```

рдЕрдм, рд╕рднреА рдЪрд░рдгреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рдорд░реНрдЬ рдХрд░реЗрдВред рдРрд╕реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдЬрд╣рд╛рдВ рд╕рдВрджрд░реНрдн рдореЗрдВ рдХреЛрдИ рдЙрддреНрддрд░ рдирд╣реАрдВ рд╣реИ, рд╣рдо рд╕реАрдзреЗ рдПрдиреЛрдЯреЗрдЯреЗрдб рдЙрддреНрддрд░ рдХреА рд╢реБрд░реБрдЖрдд рдФрд░ рдЕрдВрдд рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реАрдПрд▓рдПрд╕ рдХреА рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкрд░ рд░рдЦрддреЗ рд╣реИрдВред рдпрджрд┐ `allow_impossible_answers` рдкреИрд░рд╛рдореАрдЯрд░ `рдЧрд▓рдд` рд╣реИ рдЗрди рдЕрдиреБрддреНрддрд░рд┐рдд рдирдореВрдиреЛрдВ рдХреЛ рдлреЗрдВрдХ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рд╕рд░рд▓рддрд╛ рдХреЗ рд▓рд┐рдП, рд╣рдо рдкрд╣рд▓реЗ рдЙрдиреНрд╣реЗрдВ рдлреЗрдВрдХ рджреЗрддреЗ рд╣реИрдВред

```рдкрд╛рдпрдердкрд░
рдбреАрдИрдПрдлрд╝ рддреИрдпрд╛рд░_рдЯреНрд░реЗрди_рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ(рдЙрджрд╛рд╣рд░рдг):
# рд╣рдореЗрдВ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рдЫреЛрдЯрд╛ рдФрд░ рдкреИрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрдиреА рд╣реЛрдЧреА, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рд╕реНрд▓рд╛рдЗрд╕рд┐рдВрдЧ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред
# рдкреНрд░рддреНрдпреЗрдХ рд╕реБрдкрд░ рд▓рдВрдмреЗ рдЯреЗрдХреНрд╕реНрдЯ рдЙрджрд╛рд╣рд░рдг рдХреЛ рдХрдИ рдЗрдирдкреБрдЯ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬрд┐рд╕рдореЗрдВ рдЪреМрд░рд╛рд╣реЗ рд╣реЛрдВрдЧреЗред
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдЙрджрд╛рд╣рд░рдг = рдЯреЛрдХрдирдирд╛рдЗрдЬрд░(
рдЙрджрд╛рд╣рд░рдг["рдкреНрд░рд╢реНрди" рдпрджрд┐ рдкреИрдб_рдСрди_рд╕рд╣реА рд╣реИ рдЕрдиреНрдпрдерд╛ "рд╕рдВрджрд░реНрдн"],
рдЙрджрд╛рд╣рд░рдг["рд╕рдВрджрд░реНрдн" рдпрджрд┐ рдкреИрдб_рдСрди_рд░рд╛рдЗрдЯ рдЕрдиреНрдпрдерд╛ "рдкреНрд░рд╢реНрди"],
рдЯреНрд░рдВрдХреЗрд╢рди = "рдХреЗрд╡рд▓_рд╕реЗрдХрдВрдб" рдпрджрд┐ рдкреИрдб_рдкрд░_рджрд╛рдПрдВ рдЕрдиреНрдпрдерд╛ "рдХреЗрд╡рд▓_рдкрд╣рд▓реЗ",
рдЕрдзрд┐рдХрддрдо_рд▓рдВрдмрд╛рдИ=рдЕрдзрд┐рдХрддрдо_рд▓рдВрдмрд╛рдИ,
рд╕реНрдЯреНрд░рд╛рдЗрдб=doc_рд╕реНрдЯреНрд░рд╛рдЗрдб,
рд╡рд╛рдкрд╕ рдХрд░рдирд╛n_overflowing_tokens=рд╕рддреНрдп,
return_offsets_mapping=рд╕рддреНрдп,
рдкреИрдбрд┐рдВрдЧ='рдЕрдзрд┐рдХрддрдо_рд▓рдВрдмрд╛рдИ',
)

# рд╣рдо рд╕реНрд▓рд╛рдЗрд╕ рдЖрдИрдбреА рдХреЛ рдореВрд▓ рдЖрдИрдбреА рдкрд░ рдореИрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдУрд╡рд░рдлрд╝реНрд▓реЛ_рдЯреВ_рд╕реИрдВрдкрд▓_рдореИрдкрд┐рдВрдЧ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред
# рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ 2 рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ 4 рд╕реНрд▓рд╛рдЗрд╕ рдореЗрдВ рдХрд╛рдЯрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рдВрдмрдВрдзрд┐рдд рдЯреБрдХрдбрд╝реЗ [0, 0, 1, 1] рд╣реЛрддреЗ рд╣реИрдВ, рдкрд╣рд▓реЗ рджреЛ рдЯреБрдХрдбрд╝реЗ рдореВрд▓ рдкрд╣рд▓реЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рдЕрдиреБрд░реВрдк рд╣реЛрддреЗ рд╣реИрдВред
рдирдореВрдирд╛_рдореИрдкрд┐рдВрдЧ = рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг.рдкреЙрдк('рдУрд╡рд░рдлреНрд▓реЛ_рдЯреВ_рд╕реИрдВрдкрд▓_рдореИрдкрд┐рдВрдЧ'')
# рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ рднреА 4 рдЯреБрдХрдбрд╝реЛрдВ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИ
# рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ рдкреИрд░рд╛рдореАрдЯрд░ рд╣рдореЗрдВ рдУ рдкрд░ рдореИрдк рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИрдХрдЪреНрдЪрд╛ рдЗрдирдкреБрдЯред рдЪреВрдВрдХрд┐ рдЙрддреНрддрд░ рдореВрд▓ рдЗрдирдкреБрдЯ рдкрд░ рдЕрдВрдХрд┐рдд рд╣реИ, рдЗрд╕рд╕реЗ рд╣рдореЗрдВ рдЙрддреНрддрд░ рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдФрд░ рдЕрдВрддрд┐рдо рд╕реНрдерд┐рддрд┐ рдвреВрдВрдврдиреЗ рдореЗрдВ рдорджрдж рдорд┐рд▓рддреА рд╣реИред
рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ = рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг.рдкреЙрдк("рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ")

# рдбреЗрдЯрд╛ рдХреЛ рдкреБрдирдГ рд▓реЗрдмрд▓ рдХрд░реЗрдВ
рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдкреНрд░рд╛рд░рдВрдн_рд╕реНрдерд╛рди"] = []
рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["end_positions"] = []

i рдХреЗ рд▓рд┐рдП, рдЧрдгрдирд╛ рдореЗрдВ рдСрдлрд╕реЗрдЯ (рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ):
# рдкреНрд░рддреНрдпреЗрдХ рдЯреБрдХрдбрд╝реЗ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░реЗрдВ
# рдмрд┐рдирд╛ рдЙрддреНрддрд░ рд╡рд╛рд▓реЗ рдирдореВрдиреЛрдВ рдХреЛ рд╕реАрдПрд▓рдПрд╕ рдкрд░ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░реЗрдВ
рдЗрдирдкреБрдЯ_рдЖрдИрдбреА = рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдЗрдирдкреБрдЯ_рдЖрдИрдбреА"][i]
cls_index = рдЗрдирдкреБрдЯ_ids.index(tokenizer.cls_token_id)

# рдкреНрд░рд╢реНрди рдФрд░ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЕрдВрддрд░ рдмрддрд╛рдПрдВ
рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреА = рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг.рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреА(i)

# рдореВрд▓ рдЙрджрд╛рд╣рд░рдг рд╕реВрдЪрдХрд╛рдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
рдирдореВрдирд╛_рд╕реВрдЪрдХрд╛рдВрдХ = рдирдореВрдирд╛_рдореИрдкрд┐рдВрдЧ[i]
рдЙрддреНрддрд░ = рдЙрджрд╛рд╣рд░рдг["рдЙрддреНрддрд░"][sample_index]
# рдпрджрд┐ рдХреЛрдИ рдЙрддреНрддрд░ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЙрддреНрддрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реАрдПрд▓рдПрд╕ рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
рдпрджрд┐ рд▓реЗрди(рдЙрддреНрддрд░["answer_start"]) == 0:
рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдкреНрд░рд╛рд░рдВрдн_рд╕реНрдерд╛рди"] рдЬреЛрдбрд╝реЗрдВ(cls_index)
рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["end_positions"].рдЬреЛрдбрд╝реЗрдВ(cls_index)
рдЕрдиреНрдп:
# рдЙрддреНрддрд░ рдХреА рд╡рд░реНрдг рд╕реНрддрд░реАрдп рдЖрд░рдВрдн/рд╕рдорд╛рдкреНрддрд┐ рд╕реНрдерд┐рддрд┐.
рдкреНрд░рд╛рд░рдВрдн_рдЪрд╛рд░ = рдЙрддреНрддрд░["рдЙрддреНрддрд░_рдПрд╕рддреАрдЦрд╛"][0]
рдЕрдВрдд_рдЪрд╛рд░ = рдкреНрд░рд╛рд░рдВрдн_рдЪрд╛рд░ + рд▓реЗрди(рдЙрддреНрддрд░["рдкрд╛рда"][0])

# рдЯреЛрдХрди рд▓реЗрд╡рд▓ рдЗрдВрдбреЗрдХреНрд╕ рдкреНрд░рд╛рд░рдВрдн рдвреВрдВрдвреЗрдВред
рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ = 0
рдЬрдмрдХрд┐ рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреНрд╕[рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕] != (1 рдпрджрд┐ рдкреИрдб_рдСрди_рд░рд╛рдЗрдЯ рдЕрдиреНрдпрдерд╛ 0):
рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ += 1

# рдЯреЛрдХрди рд▓реЗрд╡рд▓ рдЗрдВрдбреЗрдХреНрд╕ рдХрд╛ рдЕрдВрдд рдвреВрдВрдвреЗрдВред
рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ = рд▓реЗрди(рдЗрдирдкреБрдЯ_рдЖрдИрдбреА) - 1
рдЬрдмрдХрд┐ рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреА[рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕] != (1 рдпрджрд┐ рдкреИрдб_рдСрди_рд░рд╛рдЗрдЯ рдЕрдиреНрдпрдерд╛ 0):
рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ -= 1

# рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЙрддреНрддрд░ рдкрд╛рда рдХреА рд▓рдВрдмрд╛рдИ рд╕реЗ рдЕрдзрд┐рдХ рд╣реИред рдпрджрд┐ рдпрд╣ рдЕрдзрд┐рдХ рд╣реИ, рддреЛ рд╕реАрдПрд▓рдПрд╕ рдЗрдВрдбреЗрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдорд╛рд░реНрдХрд░ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
рдпрджрд┐ рдирд╣реАрдВ (offsets[token_start_indрдкреВрд░реНрд╡][0] <= рд╕реНрдЯрд╛рд░реНрдЯ_рдЪрд╛рд░ рдФрд░ рдСрдлрд╕реЗрдЯреНрд╕[рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕][1] >= рдПрдВрдб_рдЪрд╛рд░):
рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдкреНрд░рд╛рд░рдВрдн_рд╕реНрдерд╛рди"] рдЬреЛрдбрд╝реЗрдВ(cls_index)
рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["end_positions"].рдЬреЛрдбрд╝реЗрдВ(cls_index)
рдЕрдиреНрдп:
# рдпрджрд┐ рдпрд╣ рдЕрдзрд┐рдХ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЙрддреНрддрд░ рдЯреЛрдХрди рдХреА рдЖрд░рдВрдн рдФрд░ рд╕рдорд╛рдкреНрддрд┐ рд╕реНрдерд┐рддрд┐ рдЬреНрдЮрд╛рдд рдХрд░реЗрдВред
# рдиреЛрдЯ: рдпрджрд┐ рдЙрддреНрддрд░ рдЕрдВрддрд┐рдо рд╢рдмреНрдж (рдПрдЬ рдХреЗрд╕) рд╣реИ рддреЛ рд╣рдо рдЕрдВрддрд┐рдо рдСрдлрд╕реЗрдЯ рдХреЗ рдмрд╛рдж рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
рдЬрдмрдХрд┐ рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ <рд▓реЗрди(рдСрдлрд╝рд╕реЗрдЯ) рдФрд░ рдСрдлрд╝рд╕реЗрдЯ[рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕][0] <= рд╕реНрдЯрд╛рд░реНрдЯ_рдЪрд╛рд░:
рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ += 1
рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдкреНрд░рд╛рд░рдВрдн_рд╕реНрдерд╛рди"]редрд╕рдВрд▓рдЧреНрди рдХрд░реЗрдВ(рдЯреЛрдХрди_рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ - 1)
рдЬрдмрдХрд┐ рдСрдлрд╕реЗрдЯреНрд╕[рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕][1] >=рдПрдВрдб_рдЪрд╛рд░:
рдЯреЛрдХрди_рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ -= 1
рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["end_positions"].рдЬреЛрдбрд╝реЗрдВ(рдЯреЛрдХрди_end_index + 1)

рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг рд▓реМрдЯрд╛рдПрдБ
```

рдЙрдкрд░реЛрдХреНрдд рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдПрдХ рдирдореВрдиреЗ рдпрд╛ рдПрдХрд╛рдзрд┐рдХ рдирдореВрдиреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдХрдИ рдирдореВрдиреЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рд▓реМрдЯрд╛рдИ рдЧрдИ рдкрд░рд┐рдгрд╛рдо рд╕реВрдЪреА рдХрдИ рдирдореВрдиреЛрдВ рдХреЗ рдкреВрд░реНрд╡-рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдкрд░рд┐рдгрд╛рдо рд╕реВрдЪреА рд╣реЛрддреА рд╣реИред

```рдЕрдЬрдЧрд░
рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ = рддреИрдпрд╛рд░_рдЯреНрд░реЗрди_рдлреАрдЪрд░реНрд╕(рдбреЗрдЯрд╛рд╕реЗрдЯ['рдЯреНрд░реЗрди'][:5])
#рдкреНрд░рдХреНрд░рд┐рдпрд╛ 5 рдирдореВрдиреЗ
```

рдЖрдЧреЗ рд╕рдм рд╕рд╛рд╕рднреА рдирдореВрдиреЛрдВ рдореЗрдВ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди 'prepare_train_features' рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 'рдореИрдк' рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдПрдордкреАрдПрд▓ рдХреЛ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк (рддреИрдпрд╛рд░_рдЯреНрд░реЗрди_рдлреАрдЪрд░, рдмреИрдЪ = рд╕рд╣реА, рд░рд┐рдореВрд╡_рдХреЙрд▓рдо = рдбреЗрдЯрд╛рд╕реЗрдЯ ["рдЯреНрд░реЗрди"]ред рдХреЙрд▓рдо_рдирд╛рдо)
```

рдЗрд╕рд╕реЗ рднреА рдмреЗрд╣рддрд░, рдЕрдЧрд▓реА рдмрд╛рд░ рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрдиреЗ рдкрд░ рдкреБрдирд░реНрдЧрдгрдирд╛ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд▓реМрдЯрд╛рдпрд╛ рдЧрдпрд╛ рдкрд░рд┐рдгрд╛рдо рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рд▓реЗрдХрд┐рди рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЗрдирдкреБрдЯ рдмрджрд▓ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдХреИрд╢ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ!)рдПрдХреНрд╢рди рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдкрд░рд┐рд╡рд░реНрддрди рд╣реИ, рдпрджрд┐ рдХреЛрдИ рдкрд░рд┐рд╡рд░реНрддрди рд╣реИ, рддреЛ рдХреИрд╢реНрдб рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдЗрдирдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рд░рд╣рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╣реИ рдЬрдм рдЖрдк рдЗрдирдкреБрдЯ рдмрджрд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдХреИрд╢ рд╕рд╛рдлрд╝ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ `load_from_cache_file=False` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдКрдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ `рдмреИрдЪ = True` рдкреИрд░рд╛рдореАрдЯрд░ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреА рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХрд╛рдзрд┐рдХ рдереНрд░реЗрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЗрдирдкреБрдЯ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП iрдПрди рд╕рдорд╛рдирд╛рдВрддрд░.

## рдореЙрдбрд▓ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд░рдирд╛

рд╡рд░реНрддрдорд╛рди рдореЗрдВ, рд╣рдордиреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг/рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдбреЗрдЯрд╛ рдХреЛ рдкреВрд░реНрд╡-рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рдХрд┐рдпрд╛ рд╣реИ, рдФрд░ рдЕрдм рд╣рдо рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдорд╢реАрди рдкреНрд░рд╢реНрди рдЙрддреНрддрд░ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдХрд╛рд░реНрдп рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рд╣рдо рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░, рдореЙрдбрд▓ рдХреЗ рд╕рдорд╛рди рдЗрд╕ рд╡рд░реНрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ `from_pretrained` рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForQuestionAnswering, рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕, рдЯреНрд░реЗрдирд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдореЙрдбрд▓ = AutoModelForQuestionAnswering.from_pretrained(mрдУрдбреЗрд▓_рдЪреЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ)
```

рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ: 100%|тЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИтЦИ|268рдПрдо/268рдПрдо [00:46<00:00, 5.79рдПрдордмреА/рд╕реЗрдХрдВрдб]
DistilBertForQuestionAnswering рдХреЛ рдЖрд░рдВрдн рдХрд░рддреЗ рд╕рдордп рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб рдкрд░ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рдХреБрдЫ рд╡рдЬрд╝рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛: ['vocab_transform.weight', 'vocab_transform.bias', 'vocab_layer_norm.weight', 'vocab_layer_norm.bias', 'vocab_projector.weight', ' vocab_projector.bias']
- рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдЕрдиреНрдп рдХрд╛рд░реНрдп рдкрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ DistilBertForQuestionAnswering рдЖрд░рдВрдн рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддреЛ рдпрд╣ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╣реИрдпрд╣ рдПрдХ рдЕрдиреНрдп рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП BertForPreTraining рдореЙрдбрд▓ рд╕реЗ BertForSequenceClassification рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдирд╛)ред
- рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдореЙрдбрд▓ рдХреЗ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ DistilBertForQuestionAnswering рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЬрд┐рд╕рдХреЗ рдмрд┐рд▓реНрдХреБрд▓ рд╕рдорд╛рди рд╣реЛрдиреЗ рдХреА рдЖрдк рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рдЕрдкреЗрдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИ (BertForSequenceClassification рдореЙрдбрд▓ рд╕реЗ BertForSequenceClassification рдореЙрдбрд▓ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдирд╛)ред
DistilBertForQuestionAnswering рдХреЗ рдХреБрдЫ рд╡реЗрдЯ рдбрд┐рд╕реНрдЯрд┐рд▓рдмрд░реНрдЯ-рдмреЗрд╕-рдЕрдирдХреЗрд╕реНрдб рдкрд░ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗ рдЖрд░рдВрдн рдирд╣реАрдВ рдХрд┐рдП рдЧрдП рдереЗ рдФрд░ рдирдП рдЖрд░рдВрдн рдХрд┐рдП рдЧрдП рд╣реИрдВalized: ['qa_outputs.weight', 'qa_outputs.bias']
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдФрд░ рдЕрдиреБрдорд╛рди рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд╕рдВрднрд╡рддрдГ рдЗрд╕ рдореЙрдбрд▓ рдХреЛ рдбрд╛рдЙрдирд╕реНрдЯреНрд░реАрдо рдХрд╛рд░реНрдп рдкрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░рд╛ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд╛рд░реНрдп рдПрдХ рдорд╢реАрди рдкреНрд░рд╢реНрди рдЙрддреНрддрд░ рджреЗрдиреЗ рд╡рд╛рд▓рд╛ рдХрд╛рд░реНрдп рд╣реИ, рдФрд░ рд╣рдо рдПрдХ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рднрд╛рд╖рд╛ рдореЙрдбрд▓ рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ, рдпрд╣ рд╣рдореЗрдВ рд╕рдВрдХреЗрдд рджреЗрдЧрд╛ рдХрд┐ рдореЙрдбрд▓ рд▓реЛрдб рдХрд░рддреЗ рд╕рдордп рдХреБрдЫ рдмреЗрдЬреЛрдбрд╝ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреИрд░рд╛рдореАрдЯрд░ рд╣рдЯрд╛ рджрд┐рдП рдЧрдП рдереЗ (рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдореБрдЦ) рднрд╛рд╖рд╛ рдореЙрдбрд▓ рдХреЛ рдлреЗрдВрдХ рджрд┐рдпрд╛ рдЧрдпрд╛, рдФрд░ рдорд╢реАрди рдХреЗ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдореБрдЦ рдиреЗ рдкреНрд░рд╢реНрди рдЙрдард╛рдпрд╛рдЙрддреНрддрд░ рджреЗрдирд╛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛)ред

рдЗрди рдмреЗрддрд░рддреАрдм рдврдВрдЧ рд╕реЗ рдЖрд░рдВрдн рдХрд┐рдП рдЧрдП рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдХрд╛рд░рдг, рд╣рдореЗрдВ рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ рдирдП рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░ рдлрд┐рд░ рд╕реЗ рдареАрдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

`рдЯреНрд░реЗрдирд░` рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЙрдкрдХрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ 3 рдФрд░ рддрддреНрд╡реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрд┐рдВрдЧреНрд╕/рдкреИрд░рд╛рдореАрдЯрд░ [`рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреВрдореЗрдВрдЯреНрд╕`](https://huggingface.co/transformers/main_classes/trainer.html# рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░.рдЯреНрд░реЗрдирд┐рдВрдЧрдЖрд░реНрдЧреНрдпреБрдореЗрдВрдЯреНрд╕) рдЗрд╕ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╕реЗрдЯрд┐рдВрдЧ рдореЗрдВ рд╡реЗ рд╕рднреА рдЧреБрдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ, рдЗрд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдирд╛рдо рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдЗрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдореЙрдбрд▓ рдФрд░ рдЕрдиреНрдп рдореЙрдбрд▓ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рд╕рд╣реЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

```рдЕрдЬрдЧрд░
рддрд░реНрдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ(
f"рдЯреЗрд╕реНрдЯ-рд╕реНрдХреНрд╡рд╛рдб",
рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ = "рдпреБрдЧ",
рд╕реАрдЦрдиреЗ рдХреА рджрд░=2e-5, #рд╕реАрдЦрдиреЗ рдХреА рджрд░
рдкреНрд░рддрд┐_рдбрд┐рд╡рд╛рдЗрд╕_рдЯреНрд░реЗрди_рдмреИрдЪ_рдЖрдХрд╛рд░=рдмреИрдЪ_рдЖрдХрд╛рд░,
per_device_eval_batch_size=рдмреИрдЪ_рдЖрдХрд╛рд░,
num_train_epochs=3, # рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдпреБрдЧ
рд╡рдЬрд╝рди_рдХреНрд╖рдп=0.01,
)
```

рдЙрдкрд░реЛрдХреНрдд `evaluation_strategy = "epoch"` рдкреИрд░рд╛рдореАрдЯрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЛрдб рдХреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рд╣рдо рдкреНрд░рддрд┐ рд╡рд░реНрд╖ рдПрдХ рд╕рддреНрдпрд╛рдкрди рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВрдЧреЗред

`рдмрд╛tch_size` рдКрдкрд░ рдЗрд╕ рдиреЛрдЯрдмреБрдХ рд╕реЗ рдкрд╣рд▓реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рд╣рдо рдореЙрдбрд▓ рдореЗрдВ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕реНрдб рдбреЗрдЯрд╛ рдлреАрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП default_data_collater рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ default_data_collater рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ = рдбрд┐рдлрд╝реЙрд▓реНрдЯ_рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░
```

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди, рд╣рдо рдХреЗрд╡рд▓ рдореВрд▓реНрдпрд╛рдВрдХрди рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдиреБрдХрд╕рд╛рди рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдВрдЧреЗред рдореВрд▓реНрдпрд╛рдВрдХрди рдореЙрдбрд▓ рдЕрдЧрд▓реЗ рднрд╛рдЧ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рдПрдЧрд╛ред

рдмрд╕ рдЯреНрд░реЗрдирд░ рдХреЛ рдореЙрдбрд▓, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреИрд░рд╛рдореАрдЯрд░, рдбреЗрдЯрд╛, рдкрд╣рд▓реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдФрд░ рдбреЗрдЯрд╛ рдбрд┐рд▓реАрд╡рд░реА рдЯреВрд▓ default_data_colllator рдкрд╛рд╕ рдХрд░реЗрдВред

```рдЕрдЬрдЧрд░рдПрди
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
рдирдореВрдирд╛,
рддрд░реНрдХ,
рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
eval_dataset=рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"],
рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░=рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░,
рдЯреЛрдХрдирдирд╛рдЗрдЬрд░=рдЯреЛрдХрдирд╛рдЗрдЬрд░,
)
```

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `рдЯреНрд░реЗрди` рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ

```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```

рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХрд╛ рд╕рдордп рдмрд╣реБрдд рд▓рдВрдмрд╛ рд╣реИ, рдпрджрд┐ рдЗрд╕реЗ рд╕реНрдерд╛рдиреАрдп рдореИрдХ рдкрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдкреНрд░рддреНрдпреЗрдХ рдПрдкрдХреЛрд╣ рдХреЛ рдЧрд╛рдпрдм рд╣реЛрдиреЗ рдореЗрдВ рд▓рдЧрднрдЧ 2 рд╕реЗрдХрдВрдб рд▓рдЧрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдмрд╛рдж рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЙрдбрд▓ рдХреЛ рд╕рд╣реЗрдЬреЗрдВред

```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░.рд╕реЗрд╡_рдореЙрдбрд▓("рдЯреЗрд╕реНрдЯ-рд╕реНрдХреНрд╡рд╛рдб-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд")
```

## рдореВрд▓реНрдпрд╛рдВрдХрди

рддрд░реАрдХрд╛рдореВрд▓реНрдпрд╛рдВрдХрди рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реЛрдЧрд╛ред рд╣рдореЗрдВ рдореЙрдбрд▓рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕реНрдб рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рдЙрд╕ рдЯреЗрдХреНрд╕реНрдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬрдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдХреА рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдпрджрд┐ рд╣рдо рдореВрд▓реНрдпрд╛рдВрдХрди рдХреЗ рджреМрд░рд╛рди рдореЙрдбрд▓ рдХреЛ рдПрдХ рдмреИрдЪ рдЦрд┐рд▓рд╛рддреЗ рд╣реИрдВ рддреЛ рдореЙрдбрд▓ рд╕реНрд╡рдпрдВ рдЙрддреНрддрд░ рдХреЗ рдкреНрд░рд╛рд░рдВрдн/рдЕрдВрдд рдореЗрдВ рд▓реЙрдЧрд┐рдЯ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рддрд╛ рд╣реИ , рдЖрдЙрдЯрдкреБрдЯ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ:

```рдЕрдЬрдЧрд░
рдорд╢рд╛рд▓ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЯреНрд░реЗрдирд░.get_eval_dataloader() рдореЗрдВ рдмреИрдЪ рдХреЗ рд▓рд┐рдП:
рддреЛрдбрд╝рдирд╛
рдмреИрдЪ = {k: v.to(trainer.args.device) for k, v in рдмреИрдЪ.рдЖрдЗрдЯрдореНрд╕()}
Torch.no_grad() рдХреЗ рд╕рд╛рде:
рдЖрдЙрдЯрдкреБрдЯ = рдЯреНрд░реЗрдирд░.рдореЙрдбрд▓(**рдмреИрдЪ)
рдЖрдЙрдЯрдкреБрдЯ.рдХреБрдВрдЬрд┐рдпрд╛рдБ()
```

рдЖрдЙрдЯрдкреБрдЯ рдУf рдореЙрдбрд▓ рдПрдХ рддрд╛рдирд╛рд╢рд╛рд╣реА-рдЬреИрд╕реА рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╣рд╛рдирд┐ рд╢рд╛рдорд┐рд▓ рд╣реИ (рдХреНрдпреЛрдВрдХрд┐ рд▓реЗрдмрд▓ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╕рднреА рд╣рд╛рдирд┐), рдЙрддреНрддрд░ рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдЕрдВрдд рд▓реЙрдЧ рдЬрдм рд╣рдо рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдкрд░рд┐рдгрд╛рдо рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рд╣рд╛рдирд┐ рдХреЛ рджреЗрдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ рд▓реЙрдЧрд┐рдЯреНрд╕ рдХреЛ рд╕реАрдзреЗ рджреЗрдЦреЗрдВред

```рдЕрдЬрдЧрд░
рдЖрдЙрдЯрдкреБрдЯ.рд╕реНрдЯрд╛рд░реНрдЯ_рд▓реЙрдЧрд┐рдЯреНрд╕.рд╢реЗрдк, рдЖрдЙрдЯрдкреБрдЯ.рдПрдВрдб_рд▓реЙрдЧрд┐рдЯреНрд╕.рд╢реЗрдк
```

(рдорд╢рд╛рд▓.рдЖрдХрд╛рд░([16, 384]), рдорд╢рд╛рд▓.рдЖрдХрд╛рд░([16,384]))

рдкреНрд░рддреНрдпреЗрдХ рд╕реБрд╡рд┐рдзрд╛ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЯреЛрдХрди рдореЗрдВ рдПрдХ рд▓реЙрдЧрд┐рдЯ рд╣реЛрдЧрд╛ред рдЙрддреНрддрд░ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рд╕рд░рд▓ рддрд░реАрдХрд╛ рд╕реНрдЯрд╛рд░реНрдЯ рд▓реЙрдЧ рдореЗрдВ рд╕рдмрд╕реЗ рдмрдбрд╝реА рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЪрдпрди рдХрд░рдирд╛ рд╣реИрдЙрддреНрддрд░ рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реНрдерд┐рддрд┐, рдФрд░ рдЕрдВрддрд┐рдо рд▓реЙрдЧ рдореЗрдВ рд╕рдмрд╕реЗ рдмрдбрд╝реА рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЙрддреНрддрд░ рдХреА рдЕрдВрддрд┐рдо рд╕реНрдерд┐рддрд┐ рдХреЗ рд░реВрдк рдореЗрдВред

```рдЕрдЬрдЧрд░
рдЖрдЙрдЯрдкреБрдЯ.рд╕реНрдЯрд╛рд░реНрдЯ_рд▓реЙрдЧрд┐рдЯреНрд╕.argmax(dim=-1), рдЖрдЙрдЯрдкреБрдЯ.end_logits.argmax(dim=-1)
```

(рдЯреЗрдВрд╕рд░([46, 57, 78, 43, 118, 15, 72, 35, 15, 34, 73, 41, 80, 91,
156, 35], рдбрд┐рд╡рд╛рдЗрд╕='рдХреНрдпреВрдбрд╛:0'),
рдЯреЗрдВрд╕рд░([47, 58, 81, 55, 118, 110, 75, 37, 110, 36, 76, 53, 83, 94,
158, 35], рдбрд┐рд╡рд╛рдЗрд╕='рдХреНрдпреВрдбрд╛:0'))

рдЙрдкрд░реЛрдХреНрдд рд░рдгрдиреАрддрд┐ рдЕрдзрд┐рдХрд╛рдВрд╢ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЕрдЪреНрдЫреА рд╣реИ, рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрджрд┐ рд╣рдорд╛рд░рд╛ рдЗрдирдкреБрдЯ рд╣рдореЗрдВ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рд╣рдореЗрдВ рдЙрддреНрддрд░ рдирд╣реАрдВ рдорд┐рд▓ рд░рд╣рд╛ рд╣реИ: рдИ рдХреЗ рд▓рд┐рдПрдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрд░рдВрдн рдХреА рд╕реНрдерд┐рддрд┐ рдЕрдВрдд рдХреА рд╕реНрдерд┐рддрд┐ рд╕реЗ рдмрдбрд╝реА рд╣реИ, рдпрд╛ рдЖрд░рдВрдн рдФрд░ рдЕрдВрдд рдХреА рд╕реНрдерд┐рддрд┐ рдкреНрд░рд╢реНрди рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддреА рд╣реИред

рдЗрд╕ рд╕рдордп, рд╕рд░рд▓ рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рд╣рдореЗрдВ рдЕрдкрдиреЗ рдЙрддреНрддрд░ рдХреЗ рд░реВрдк рдореЗрдВ рджреВрд╕рд░реА рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЛ рдЪреБрдирдирд╛ рдЬрд╛рд░реА рд░рдЦрдирд╛ рд╣реЛрдЧрд╛ рдпрджрд┐ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддреА рд╣реИ, рддреЛ рддреАрд╕рд░реА рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЛ рджреЗрдЦреЗрдВ, рдЗрддреНрдпрд╛рджрд┐ред

рдЪреВрдВрдХрд┐ рдЙрдкрд░реЛрдХреНрдд рд╡рд┐рдзрд┐ рд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░реНрдп рдЙрддреНрддрд░ рдвреВрдВрдврдирд╛ рдЖрд╕рд╛рди рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдПрдХ рдЕрдзрд┐рдХ рдЙрдЪрд┐рдд рд╡рд┐рдзрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд╣рдо рдПрдХ рдирдпрд╛ рд╕реНрдХреЛрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдЕрдВрдд рдХреЗ рд▓реЙрдЧ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рд╕рд░реНрд╡реЛрддреНрддрдо `n_best_ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВредрдЖрдХрд╛рд░` рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдЕрдВрдд рдЬреЛрдбрд╝реЗред `n_best_size` рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдЕрдВрдд рдЬреЛрдбрд╝реЗ рд╕реЗ, рд╕рдВрдмрдВрдзрд┐рдд рдЙрддреНрддрд░ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рд╡реИрдз рд╣реИ, рдЕрдВрдд рдореЗрдВ, рдЙрдиреНрд╣реЗрдВ рд╕реНрдХреЛрд░ рдФрд░ рдЙрдЪреНрдЪрддрдо рд╕реНрдХреЛрд░ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХреНрд░рдордмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЙрддреНрддрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЪреБрдирд╛ рдЧрдпрд╛ рд╣реИ.

```рдЕрдЬрдЧрд░
n_best_size = 20
```

```рдЕрдЬрдЧрд░
рдПрдирдкреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реБрдиреНрди рдЖрдпрд╛рдд рдХрд░реЗрдВ

рд╕реНрдЯрд╛рд░реНрдЯ_рд▓реЙрдЧрд┐рдЯреНрд╕ = рдЖрдЙрдЯрдкреБрдЯ.рд╕реНрдЯрд╛рд░реНрдЯ_рд▓реЙрдЧрд┐рдЯреНрд╕[0].рд╕реАрдкреАрдпреВ().рдирдореНрдкреА()
End_logits = рдЖрдЙрдЯрдкреБрдЯ.end_logits[0].cpu().numpy()
# рд╕рд░реНрд╡реЛрддреНрддрдо рдЖрд░рдВрдн рдФрд░ рдЕрдВрдд рд▓реЙрдЧ рд╕реНрдерд┐рддрд┐ рдПрдХрддреНрд░рд┐рдд рдХрд░реЗрдВ:
рдкреНрд░рд╛рд░рдВрдн_рд╕реВрдЪрдХрд╛рдВрдХ = np.argsort(start_logits)[-1 : -n_best_size - 1 : -1].tolist()
End_indexes = np.argsort(end_logits)[-1 : -n_best_size - 1 : -1].tolist()
рд╡реИрдз_рдЙрддреНрддрд░ = []
рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ рдореЗрдВ рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рд▓рд┐рдП:
End_indexes рдореЗрдВ End_index рдХреЗ рд▓рд┐рдП:
рдпрджрд┐ рдкреНрд░рд╛рд░рдВрдн_рд╕реВрдЪрдХрд╛рдВрдХ <= рдЕрдВрдд_рд╕реВрдЪрдХрд╛рдВрдХ: # рдпрджрд┐ рдкреНрд░рд╛рд░рдВрдн рдЫреЛрдЯреА рд╡рд░реНрд╖рд╛ рд╣реИ, рддреЛ рдпрд╣ рдЙрдЪрд┐рдд рд╣реИ
рд╡реИрдз_рдЙрддреНрддрд░.рдЬреЛрдбрд╝реЗрдВ(
{
"рд╕реНрдХреЛрд░": рд╕реНрдЯрд╛рд░реНрдЯ_рд▓реЙрдЧрд┐рдЯреНрд╕[рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕] + рдПрдВрдб_рд▓реЙрдЧрд┐рдЯреНрд╕[рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕],
"рдкрд╛рда":"" # рдЙрддреНрддрд░ рдХреЛ рдЯреЛрдХрди рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдвреВрдВрдврдирд╛ рд╣реЛрдЧрд╛
}
)
```

рдлрд┐рд░ рд╣рдо рд╡реИрдз_рдЙрддреНрддрд░реЛрдВ рдХреЛ рд╕реНрдХреЛрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреНрд░рдордмрджреНрдз рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдкрд╛рддреЗ рд╣реИрдВрд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ред рдЕрдВрддрд┐рдо рдЪрд░рдг рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рд╣реИ рдХрд┐ рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдЕрдВрдд рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдкрд╛рда рдкреНрд░рд╢реНрди рдХреЗ рдмрдЬрд╛рдп рд╕рдВрджрд░реНрдн рдореЗрдВ рд╣реИ рдпрд╛ рдирд╣реАрдВред

рдЗрд╕реЗ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рд╕рддреНрдпрд╛рдкрди рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджреЛ рдЬрд╛рдирдХрд╛рд░реА рдЬреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
- рдЙрд╕ рдЙрджрд╛рд╣рд░рдг рдХреА рдЖрдИрдбреА рдЬрд┐рд╕рдиреЗ рд╕реБрд╡рд┐рдзрд╛ рдЙрддреНрдкрдиреНрди рдХреАред рдЪреВрдВрдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЙрджрд╛рд╣рд░рдг рдХрдИ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рд╕реБрд╡рд┐рдзрд╛/рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рдЯреБрдХрдбрд╝реЗ рдХреЛ рдЙрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЛ рдЬрд╛рдирдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕рд╕реЗ рд╡реЗ рдореЗрд▓ рдЦрд╛рддреЗ рд╣реИрдВред
- рдСрдлрд╕реЗрдЯ рдореИрдкрд┐рдВрдЧ: рдкреНрд░рддреНрдпреЗрдХ рд╕реНрд▓рд╛рдЗрд╕ рдХреЗ рдЯреЛрдХрди рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдореВрд▓ рдкрд╛рда рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдореИрдк рдХрд░реЗрдВрд╡рд░реНрдг рд╕рдмрд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реНрдерд┐рддрд┐.

рдЗрд╕рд▓рд┐рдП рд╣рдордиреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдХреЛ рдкреБрди: рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛, рдпрд╣ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╕рдордп `prepare_train_features` рд╕реЗ рдереЛрдбрд╝рд╛ рдЕрд▓рдЧ рд╣реИред

```рдЕрдЬрдЧрд░

рдбреАрдИрдПрдлрд╝ рддреИрдпрд╛рд░_рдорд╛рдиреНрдпрддрд╛_рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ(рдЙрджрд╛рд╣рд░рдг):
# рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рдЯреНрд░рдВрдХреЗрд╢рди рдФрд░ рд╢рд╛рдпрдж рдкреИрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЯреЛрдХрдирд╛рдЗрдЬрд╝ рдХрд░реЗрдВ, рд▓реЗрдХрд┐рди рдПрдХ рд╕реНрдЯреНрд░рд╛рдЗрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдУрд╡рд░рдлрд╝реНрд▓реЛ рдмрдирд╛рдП рд░рдЦреЗрдВ
# рдПрдХ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдПрдХ рд╕рдВрджрд░реНрдн рд▓рдВрдмрд╛ рд╣реЛрдиреЗ рдкрд░ рдХрдИ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рджреЗрдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рдореЗрдВ рдПрдХ рд╣реИ
# рд╕рдВрджрд░реНрдн рдЬреЛ рдкрд┐рдЫрд▓реЗ рдлрд╝реЗ рдХреЗ рд╕рдВрджрд░реНрдн рдХреЛ рдереЛрдбрд╝рд╛ рдУрд╡рд░рд▓реИрдк рдХрд░рддрд╛ рд╣реИрд╕реНрд╡рднрд╛рд╡.
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдЙрджрд╛рд╣рд░рдг = рдЯреЛрдХрдирдирд╛рдЗрдЬрд░(
рдЙрджрд╛рд╣рд░рдг["рдкреНрд░рд╢реНрди" рдпрджрд┐ рдкреИрдб_рдСрди_рд╕рд╣реА рд╣реИ рдЕрдиреНрдпрдерд╛ "рд╕рдВрджрд░реНрдн"],
рдЙрджрд╛рд╣рд░рдг["рд╕рдВрджрд░реНрдн" рдпрджрд┐ рдкреИрдб_рдСрди_рд░рд╛рдЗрдЯ рдЕрдиреНрдпрдерд╛ "рдкреНрд░рд╢реНрди"],
рдЯреНрд░рдВрдХреЗрд╢рди = "рдХреЗрд╡рд▓_рд╕реЗрдХрдВрдб" рдпрджрд┐ рдкреИрдб_рдкрд░_рджрд╛рдПрдВ рдЕрдиреНрдпрдерд╛ "рдХреЗрд╡рд▓_рдкрд╣рд▓реЗ",
рдЕрдзрд┐рдХрддрдо_рд▓рдВрдмрд╛рдИ=рдЕрдзрд┐рдХрддрдо_рд▓рдВрдмрд╛рдИ,
рд╕реНрдЯреНрд░рд╛рдЗрдб=doc_рд╕реНрдЯреНрд░рд╛рдЗрдб,
return_overflowing_tokens=рд╕рддреНрдп,
return_offsets_mapping=рд╕рддреНрдп,
рдкреИрдбрд┐рдВрдЧ='рдЕрдзрд┐рдХрддрдо_рд▓рдВрдмрд╛рдИ',
)

# рдЪреВрдВрдХрд┐ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣рдореЗрдВ рдХрдИ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рджреЗ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рдЗрд╕рдХрд╛ рд╕рдВрджрд░реНрдн рд▓рдВрдмрд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ рдПрдХ рд╕реБрд╡рд┐рдзрд╛ рд╕реЗ рд▓реЗрдХрд░ рдПрдХ рдорд╛рдирдЪрд┐рддреНрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ
# рдЗрд╕рдХрд╛ рд╕рдВрдЧрдд рдЙрджрд╛рд╣рд░рдг рдпрд╣ рдХреБрдВрдЬреА рд╣рдореЗрдВ рдмрд╕ рдпрд╣реА рджреЗрддреА рд╣реИредрдирдореВрдирд╛_рдореИрдкрд┐рдВрдЧ = рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг.рдкреЙрдк('рдУрд╡рд░рдлреНрд▓реЛ_рдЯреВ_рд╕реИрдВрдкрд▓_рдореИрдкрд┐рдВрдЧ'')

# рд╣рдо example_id рд░рдЦрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдиреЗ рд╣рдореЗрдВ рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рджреА рд╣реИ рдФрд░ рд╣рдо рдСрдлрд╕реЗрдЯ рдореИрдкрд┐рдВрдЧ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдВрдЧреЗред
рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["example_id"] = []

iin рд░реЗрдВрдЬ рдХреЗ рд▓рд┐рдП (len(рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["input_ids"])):
# рдЙрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЗ рдЕрдиреБрд░реВрдк рдЕрдиреБрдХреНрд░рдо рдХреЛ рдкрдХрдбрд╝реЗрдВ (рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╕рдВрджрд░реНрдн рдХреНрдпрд╛ рд╣реИ рдФрд░ рдкреНрд░рд╢реНрди рдХреНрдпрд╛ рд╣реИ)ред
рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреА = рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг.рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреА(i)
context_index = 1 рдпрджрд┐ рдкреИрдб_рдСрди_рд░рд╛рдЗрдЯ рдЕрдиреНрдпрдерд╛ 0

# рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрдИ рд╕реНрдкреИрди рджреЗ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рд╣реИрдкрд╛рда рдХреЗ рдЗрд╕ рд╡рд┐рд╕реНрддрд╛рд░ рд╡рд╛рд▓реЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХред
рдирдореВрдирд╛_рд╕реВрдЪрдХрд╛рдВрдХ = рдирдореВрдирд╛_рдореИрдкрд┐рдВрдЧ[i]
рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдЙрджрд╛рд╣рд░рдг_рдЖрдИрдбреА"].рдЬреЛрдбрд╝реЗрдВ(рдЙрджрд╛рд╣рд░рдг["рдЖрдИрдбреА"][рдирдореВрдирд╛_рд╕реВрдЪрдХрд╛рдВрдХ])# рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ рдХреЛ рдХреЛрдИ рдирд╣реАрдВ рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ рдЬреЛ рд╕рдВрджрд░реНрдн рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдирд╣реАрдВ рд╣реИрдВ рдЗрд╕рд▓рд┐рдП рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ рдХрд┐ рдХреЛрдИ рдЯреЛрдХрди рд╣реИ рдпрд╛ рдирд╣реАрдВ
# рд╕реНрдерд┐рддрд┐ рд╕рдВрджрд░реНрдн рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ.
рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдСрдлрд╝рд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ"][i] = [
(рдУ рдпрджрд┐ рдЕрдиреБрдХреНрд░рдо_рдЖрдИрдбреА[рдХреЗ] == рд╕рдВрджрд░реНрдн_рд╕реВрдЪрдХрд╛рдВрдХ рдЕрдиреНрдп рдХреЛрдИ рдирд╣реАрдВ)
k, o рдХреЗ рд▓рд┐рдП рдЧрдгрдирд╛ рдХрд░реЗрдВ(рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг["рдСрдлрд╝рд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ"][i])
]

рдЯреЛрдХрдирдпреБрдХреНрдд_рдЙрджрд╛рд╣рд░рдг рд▓реМрдЯрд╛рдПрдБ
```

рд▓рд╛рдЧреВ рдХрд░реЗрдВрдкрд╣рд▓реЗ рдХреА рддрд░рд╣ рдкреНрд░рддреНрдпреЗрдХ рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП `prepare_validation_features` рдлрд╝рдВрдХреНрд╢рдиред

```рдЕрдЬрдЧрд░
рд╡реИрд▓рд┐рдбреЗрд╢рди_рдлреАрдЪрд░реНрд╕ = рдбреЗрдЯрд╛рд╕реЗрдЯреНрд╕["рд╡реИрд▓рд┐рдбреЗрд╢рди_рдлреАрдЪрд░реНрд╕"].рдСрди"].рдореИрдк(
рддреИрдпрд╛рд░реА_рд╕рддреНрдпрд╛рдкрди_рд╕реБрд╡рд┐рдзрд╛рдПрдБ,
рдмреИрдЪ = рд╕рддреНрдп,
рд░рд┐рдореВрд╡_рдХреЙрд▓рдо=рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"].рдХреЙрд▓рдо_рдирд╛рдо
)
```

HBox(children=(FloatProgress(value=0.0, max=11.0), HTML(value='')))

рд╕рднреА рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `Trainer.predict` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

```рдЕрдЬрдЧрд░
raw_predictions = trainer.predict(validation_features)
```

рдпрд╣ `рдЯреНрд░реЗрдирд░` рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ *рдЫрд┐рдкрд╛рддрд╛* рд╣реИрдореЙрдбрд▓ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдпрд╣рд╛рдВ `example_id` рдФрд░ `offset_mapping` рд╣реИрдВ, рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛), рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рд╡рд╛рдкрд╕ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
Validation_features.set_format(type=validation_features.format["type"], columns=list(vvalidation_features.features.keys()))
```

рдЬрдм рдЯреЛрдХрди рд╕реНрдерд┐рддрд┐ рдкреНрд░рд╢реНрди рднрд╛рдЧ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИ, рддреЛ `prepare_validation_features` рдлрд╝рдВрдХреНрд╢рди рдСрдлрд╝рд╕реЗрдЯ рдореИрдкрд┐рдВрдЧ рдХреЛ `рдХреЛрдИ рдирд╣реАрдВ` рдкрд░ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЖрд╕рд╛рдиреА рд╕реЗ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЯреЛрдХрди рд╕рдВрджрд░реНрдн рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╣реИ рдпрд╛ рдирд╣реАрдВрдСрдлрд╕реЗрдЯ рдореИрдкрд┐рдВрдЧред рд╣рдо рдмрд╣реБрдд рд▓рдВрдмреЗ рдЙрддреНрддрд░реЛрдВ рдХреЛ рдлреЗрдВрдХрдиреЗ рд╕реЗ рднреА рдмрдЪрддреЗ рд╣реИрдВред

```рдЕрдЬрдЧрд░
рдЕрдзрд┐рдХрддрдо_рдЙрддреНрддрд░_рд▓рдВрдмрд╛рдИ = 30
```

```рдЕрдЬрдЧрд░
рд╕реНрдЯрд╛рд░реНрдЯ_рд▓реЙрдЧрд┐рдЯреНрд╕ = рдЖрдЙрдЯрдкреБрдЯ.рд╕реНрдЯрд╛рд░реНрдЯ_рд▓реЙрдЧрд┐рдЯреНрд╕[0].рд╕реАрдкреАрдпреВ().рдирдореНрдкреА()
End_logits = рдЖрдЙрдЯрдкреБрдЯ.end_logits[0].cpu().numpy()
рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ = рд╕рддреНрдпрд╛рдкрди_рдлреАрдЪрд░реНрд╕[0]["рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ"]
# рдкрд╣рд▓реА рд╡рд┐рд╢реЗрд╖рддрд╛ рдкрд╣рд▓реЗ рдЙрджрд╛рд╣рд░рдг рд╕реЗ рдЖрддреА рд╣реИред рдЕрдзрд┐рдХ рд╕рд╛рдорд╛рдиреНрдп рдорд╛рдорд▓реЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ example_id рд╕реЗ рдорд┐рд▓рд╛рди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА
# рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╕реВрдЪрдХрд╛рдВрдХ
рд╕рдВрджрд░реНрдн = рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"][0]["рд╕рдВрджрд░реНрдн"]

# рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреЗ рдкреНрд░рд╛рд░рдВрдн/рдЕрдВрдд рд▓реЙрдЧреА рдХреЗ рд╕реВрдЪрдХрд╛рдВрдХ рдЗрдХрдЯреНрдард╛ рдХрд░реЗрдВрдЯреАрдПрд╕:
рдкреНрд░рд╛рд░рдВрдн_рд╕реВрдЪрдХрд╛рдВрдХ = np.argsort(start_logits)[-1 : -n_best_size - 1 : -1].tolist()
End_indexes = np.argsort(end_logits)[-1 : -n_best_size - 1 : -1].tolist()
рд╡реИрдз_рдЙрддреНрддрд░ = []
рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ рдореЗрдВ рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рд▓рд┐рдП:
End_indexes рдореЗрдВ End_index рдХреЗ рд▓рд┐рдП:
# рджрд╛рдпрд░реЗ рд╕реЗ рдмрд╛рд╣рд░ рдЙрддреНрддрд░реЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рди рдХрд░реЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╛ рддреЛ рд╕реВрдЪрдХрд╛рдВрдХ рд╕реАрдорд╛ рд╕реЗ рдмрд╛рд╣рд░ рд╣реИрдВ рдпрд╛ рдЕрдиреБрд░реВрдк рд╣реИрдВ
# рдЗрдирдкреБрдЯ_рдЖрдИрдбреА рдХреЗ рдЙрд╕ рднрд╛рдЧ рдХреЗ рд▓рд┐рдП рдЬреЛ рд╕рдВрджрд░реНрдн рдореЗрдВ рдирд╣реАрдВ рд╣реИред
рдЕрдЧрд░ (
рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ >= рд▓реЗрди(рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ)
рдпрд╛ End_index >= len(offset_mapping)
рдпрд╛ рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ[рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕]рдХреЛрдИ рдирд╣реАрдВ рд╣реИ
рдпрд╛ рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ[рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕] рдХреЛрдИ рдирд╣реАрдВ рд╣реИ
):
рдЬрд╛рд░реА рд░рдЦрдирд╛
# рдРрд╕реЗ рдЙрддреНрддрд░реЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рди рдХрд░реЗрдВ рдЬрд┐рдирдХреА рд▓рдВрдмрд╛рдИ рдпрд╛ рддреЛ < 0 рдпрд╛ > max_answer_length рд╣реЛред
рдпрджрд┐ рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ <рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ рдпрд╛ рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ - рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ + 1 > рдЕрдзрд┐рдХрддрдо_рдЙрддреНрддрд░_рд▓рдВрдмрд╛рдИ:
рдЬрд╛рд░реА рд░рдЦрдирд╛
рдпрджрд┐ рдкреНрд░рд╛рд░рдВрдн_рд╕реВрдЪрдХрд╛рдВрдХ <= рдЕрдВрдд_рд╕реВрдЪрдХрд╛рдВрдХ: # рд╣рдореЗрдВ рдЙрддреНрддрд░ рдХреЛ рд╕рдВрджрд░реНрдн рдХреЗ рдЕрдВрджрд░ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕ рдкрд░реАрдХреНрд╖рдг рдХреЛ рдкрд░рд┐рд╖реНрдХреГрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ
рд╕реНрдЯрд╛рд░реНрдЯ_рдЪрд╛рд░ = рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ[рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕][0]
рдПрдВрдб_рдЪрд╛рд░ = рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ[рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕][1]
рд╡реИрдз_рдЙрддреНрддрд░.рдЬреЛрдбрд╝реЗрдВ(
{
"рд╕реНрдХреЛрд░": рд╕реНрдЯрд╛рд░реНрдЯ_рд▓реЙрдЧрд┐рдЯреНрд╕[рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕] + рдПрдВрдб_рд▓реЙрдЧрд┐рдЯреНрд╕[рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕],
"рдЯреЗрдХреНрд╕t": рд╕рдВрджрд░реНрдн[start_char:end_char]
}
)

рд╡реИрдз_рдЙрддреНрддрд░ = рдХреНрд░рдордмрджреНрдз (рдорд╛рдиреНрдп_рдЙрддреНрддрд░, рдХреБрдВрдЬреА=рд▓реИрдореНрдмреНрдбрд╛ x: x["рд╕реНрдХреЛрд░"], рдЙрд▓рдЯрд╛=рд╕рд╣реА)[:n_best_size]
рд╡реИрдз_рдЙрддреНрддрд░
```

[{'рд╕реНрдХреЛрд░': 16.706663, 'рдЯреЗрдХреНрд╕реНрдЯ': 'рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕'},
{'рд╕реНрдХреЛрд░': 14.635585,
'рдкрд╛рда': 'рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕ рдиреЗ рдиреЗрд╢рдирд▓ рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдирдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕ рдХреЛ рд╣рд░рд╛рдпрд╛'},
{'рд╕реНрдХреЛрд░': 13.234194, 'рдкрд╛рда': 'рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕'},
{'рд╕реНрдХреЛрд░': 12.468662, 'рдЯреЗрдХреНрд╕реНрдЯ': 'рдмреНрд░реЛрдВрдХреЛрд╕'},
{'рд╕реНрдХреЛрд░': 11.709289, 'рдкрд╛рда': 'рдбреЗрдирд╡рд░'},
{'рд╕реНрдХреЛрд░': 10.397583,
'рдкрд╛рда': 'рдмреНрд░реЛрдВрдХреЛрд╕ рд╣рд╛рд░ рдЧрдпрд╛рд░рд╛рд╖реНрдЯреНрд░реАрдп рдлреБрдЯрдмреЙрд▓ рд╕рдореНрдореЗрд▓рди (рдПрдирдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕'}, {'рд╕реНрдХреЛрд░': 10.104669,
'рдкрд╛рда': 'рдЕрдореЗрд░рд┐рдХрди рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕'},
{'рд╕реНрдХреЛрд░': 9.721636,
'рдкрд╛рда': 'рдЕрдореЗрд░рд┐рдХрди рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕'},
{'рд╕реНрдХреЛрд░': 9.007437,
'рдкрд╛рда': 'рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕ рдиреЗ рдиреЗрд╢рдирд▓ рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдирдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕ рдХреЛ 24-10 рд╕реЗ рд╣рд░рд╛рдпрд╛'},
{'рд╕реНрдХреЛрд░': 8.834958,
'рдкрд╛рда': 'рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕ рдиреЗ рдиреЗрд╢рдирд▓ рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдирдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдХреИрд░реЛрд▓рд┐рдирд╛ рдХреЛ рд╣рд░рд╛рдпрд╛'},
{'рдПрд╕рдХреЛрд░': 8.38701,
'рдкрд╛рда': 'рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕ рдиреЗ рд░рд╛рд╖реНрдЯреНрд░реАрдп рдлреБрдЯрдмреЙрд▓ рд╕рдореНрдореЗрд▓рди (рдПрдирдПрдлрд╕реА) рдХреЛ рд╣рд░рд╛рдпрд╛'},
{'рд╕реНрдХреЛрд░': 8.143825,
'рдкрд╛рда': 'рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕ рдиреЗ рдиреЗрд╢рдирд▓ рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдирдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕ рдХреЛ 24-10 рд╕реЗ рд╣рд░рд╛рдХрд░ рдЕрдкрдирд╛ рддреАрд╕рд░рд╛ рд╕реБрдкрд░ рдмрд╛рдЙрд▓ рдЦрд┐рддрд╛рдм рд╣рд╛рд╕рд┐рд▓ рдХрд┐рдпрд╛ред'},
{'рд╕реНрдХреЛрд░': 8.03359,
'рдЯреЗрдХреНрд╕реНрдЯ': 'рдЕрдореЗрд░рд┐рдХрди рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕ рдиреЗ рдиреЗрд╢рдирд▓ рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдирдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕ рдХреЛ рд╣рд░рд╛рдпрд╛'},
{'рд╕реНрдХреЛрд░': 7.832466,
'рдкрд╛рда': 'рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕ рдиреЗ рдиреЗрд╢рдирд▓ рдлреБрдЯрдмреЙрд▓ рдХреЙрди рдХреЛ рд╣рд░рд╛рдпрд╛рдлреЗрд░реЗрдВрд╕ (рдПрдирдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕ рдиреЗ 24-10 рд╕реЗ рдЕрдкрдирд╛ рддреАрд╕рд░рд╛ рд╕реБрдкрд░ рдмрд╛рдЙрд▓ рдЦрд┐рддрд╛рдм рдЕрд░реНрдЬрд┐рдд рдХрд┐рдпрд╛ред'},
{'рд╕реНрдХреЛрд░': 8.03359,
'рдЯреЗрдХреНрд╕реНрдЯ': 'рдЕрдореЗрд░рд┐рдХрди рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕ рдиреЗ рдиреЗрд╢рдирд▓ рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдирдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕ рдХреЛ рд╣рд░рд╛рдпрд╛'},рдПрд▓ рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдирдПрдлрд╕реА'},
{'рд╕реНрдХреЛрд░': 7.650557,
'рдЯреЗрдХреНрд╕реНрдЯ': 'рдЕрдореЗрд░рд┐рдХрди рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕ рдиреЗ рдиреЗрд╢рдирд▓ рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдирдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕ рдХреЛ рд╣рд░рд╛рдпрд╛'},
{'рд╕реНрдХреЛрд░': 7.6060467, 'рдкрд╛рда': 'рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕24-10'},
{'рд╕реНрдХреЛрд░': 7.5795317,
'рдкрд╛рда': 'рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕ рдиреЗ рд░рд╛рд╖реНрдЯреНрд░реАрдп рдлреБрдЯрдмреЙрд▓ рд╕рдореНрдореЗрд▓рди рдХреЛ рд╣рд░рд╛рдпрд╛'},
{'рд╕реНрдХреЛрд░': 7.433568, 'рдкрд╛рда': 'рдХреИрд░реЛрд▓рд┐рдирд╛'},
{'рд╕реНрдХреЛрд░': 6.742434,
'рдкрд╛рда': 'рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕ 24-10 рдЕрдкрдирд╛ рддреАрд╕рд░рд╛ рд╕реБрдкрд░ рдмрд╛рдЙрд▓ рдЦрд┐рддрд╛рдм рдЕрд░реНрдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред'},
{'рд╕реНрдХреЛрд░': 6.71136,
'рдкрд╛рда': 'рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕ рдиреЗ рдиреЗрд╢рдирд▓ рдлреБрдЯрдмреЙрд▓ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕ (рдПрдирдПрдлрд╕реА) рдЪреИрдВрдкрд┐рдпрди рдХреИрд░реЛрд▓рд┐рдирд╛ рдкреИрдВрдерд░реНрд╕ 24 рдХреЛ рд╣рд░рд╛рдпрд╛'}]

```рдЕрдЬрдЧрд░
рдЕрдиреБрдорд╛рдирд┐рдд рдЙрддреНрддрд░ рдХреА рддреБрд▓рдирд╛ рд╕рд╣реА рдЙрддреНрддрд░ рд╕реЗ рдХрд░реЗрдВ:
```

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"][0]["рдЙрддреНрддрд░"]
```

{'рдЙрддреНрддрд░_рдкреНрд░рд╛рд░рдВрдн': [177,177, 177],
'рдкрд╛рда': ['рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕', 'рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕', 'рдбреЗрдирд╡рд░ рдмреНрд░реЛрдВрдХреЛрд╕']}

рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдореЙрдбрд▓ рдиреЗ рдпрд╣ рд╕рд╣реА рдХрд┐рдпрд╛!

рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЪреВрдВрдХрд┐ рдкрд╣рд▓реА рд╡рд┐рд╢реЗрд╖рддрд╛ рдкрд╣рд▓реЗ рдЙрджрд╛рд╣рд░рдг рд╕реЗ рдЖрдиреА рдЪрд╛рд╣рд┐рдП, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдЖрд╕рд╛рди рд╣реИред рдЕрдиреНрдп рдЖрд╢рдВрдХрд╛рдУрдВ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдФрд░ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рдмреАрдЪ рдПрдХ рдореИрдкрд┐рдВрдЧ рдорд╛рдирдЪрд┐рддреНрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЛ рдХрдИ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ ,рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рд╕рднреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдореЗрдВ рд╕рднреА рдЙрддреНрддрд░ рдПрдХрддреНрд░ рдХрд░рдиреЗ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рдХреЗ рд╕реВрдЪрдХрд╛рдВрдХ рдФрд░ рдЙрдкрд▓рдмреНрдзрд┐ рдХреЗ рд╕реВрдЪрдХрд╛рдВрдХ рдХреЛ рдореИрдк рдХрд░рддрд╛ рд╣реИures.

```рдЕрдЬрдЧрд░
рдЖрдпрд╛рдд рд╕рдВрдЧреНрд░рд╣

рдЙрджрд╛рд╣рд░рдг = рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"]
рд╕реБрд╡рд┐рдзрд╛рдПрдБ = рд╕рддреНрдпрд╛рдкрди_рд╕реБрд╡рд┐рдзрд╛рдПрдБ

example_id_to_index = {k: i рдХреЗ рд▓рд┐рдП i, k in enumerate(рдЙрджрд╛рд╣рд░рдг["id"])}
рдлреАрдЪрд░реНрд╕_рдкрд░_рдЙрджрд╛рд╣рд░рдг = рд╕рдВрдЧреНрд░рд╣.рдбрд┐рдлреЙрд▓реНрдЯрдбрд┐рдХреНрдЯ (рд╕реВрдЪреА)
i рдХреЗ рд▓рд┐рдП, рдЧрдгрдирд╛ рдореЗрдВ рд╕реБрд╡рд┐рдзрд╛(рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ):
рдлреАрдЪрд░реНрд╕_рдкреНрд░рддрд┐_рдЙрджрд╛рд╣рд░рдг[example_id_to_index[feature["example_id"]]].append(i)
```

рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореВрд▓ рд░реВрдк рд╕реЗ рдкреВрд░реА рд╣реЛ рдЧрдИ рд╣реИред рдЖрдЦрд┐рд░реА рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдЙрд╕ рд╕реНрдерд┐рддрд┐ рдХреЛ рдХреИрд╕реЗ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдП рдЬрд╣рд╛рдВ рдХреЛрдИ рдЙрддреНрддрд░ рдирд╣реАрдВ рд╣реИ (рдЬрдм рд╕реНрдХреНрд╡рд╛рдб_v2=True)редрдХреЗрд╡рд▓ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЙрддреНрддрд░реЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдмрд┐рдирд╛ рдЙрддреНрддрд░реЛрдВ рдХреЗ рдЙрддреНрддрд░реЛрдВ рдХреЛ рднреА рдореИрдк рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдЙрддреНрддрд░реЛрдВ рдХреЗ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рд╕реНрдХреЛрд░ рдПрдХрддреНрд░ рдХрд░реЗрдВ (рдпрджрд┐ рдХрд┐рд╕реА рдЙрджрд╛рд╣рд░рдг рдХреЗ рдирдореВрдиреЗ рдореЗрдВ рдХрдИ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╣реИрдВ рддреЛ рдмрд┐рдирд╛ рдЙрддреНрддрд░ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рдЕрдиреБрд░реВрдк рд╕реАрдПрд▓рд╕реНрдЯреЛрдХреЗрди рдХреА рд╢реБрд░реБрдЖрдд рдФрд░ рдЕрдВрдд)ред , рддреЛ рд╣рдореЗрдВ рдпрд╣ рднреА рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХрдИ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдореЗрдВ рдХреЛрдИ рдЙрддреНрддрд░ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдмрд┐рдирд╛ рдЙрддреНрддрд░ рдХрд╛ рдЕрдВрддрд┐рдо рд╕реНрдХреЛрд░ рд╕рднреА рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдореЗрдВ рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рдХреЛрдИ рдЙрддреНрддрд░ рд╕реНрдХреЛрд░ рдирд╣реАрдВ рд╣реИред

рдЬрдм рддрдХ рдХрд┐ рдХрд┐рд╕реА рднреА рдЙрддреНрддрд░ рдХрд╛ рдЕрдВрддрд┐рдо рд╕реНрдХреЛрд░ рдПрд╕рд╕реАрдУ рд╕реЗ рдЕрдзрд┐рдХ рди рд╣реЛрдЕрдиреНрдп рд╕рднреА рдЙрддреНрддрд░реЛрдВ рдХрд╛ рдЙрддреНрддрд░ рджреЗрдВ, рддреЛ рдкреНрд░рд╢реНрди рдЕрдиреБрддреНрддрд░рд┐рдд рд╣реИред

рд╕рдм рдХреБрдЫ рдПрдХ рд╕рд╛рде рд░рдЦреЗрдВ:

```рдЕрдЬрдЧрд░
tqdm.auto рд╕реЗ tqdm рдЖрдпрд╛рдд рдХрд░реЗрдВ

def postprocess_qa_predictions(рдЙрджрд╛рд╣рд░рдг, рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ, raw_predictions, n_best_size = 20, max_answer_length = 30):
all_start_logits, all_end_logits = raw_predictions
# рдЗрд╕рдХреА рд╕рдВрдмрдВрдзрд┐рдд рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рдирдЪрд┐рддреНрд░ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рдПрдВред
example_id_to_index = {k: i рдХреЗ рд▓рд┐рдП i, k in enumerate(рдЙрджрд╛рд╣рд░рдг["id"])}
рдлреАрдЪрд░реНрд╕_рдкрд░_рдЙрджрд╛рд╣рд░рдг = рд╕рдВрдЧреНрд░рд╣.рдбрд┐рдлреЙрд▓реНрдЯрдбрд┐рдХреНрдЯ (рд╕реВрдЪреА)
i рдХреЗ рд▓рд┐рдП, рдЧрдгрдирд╛ рдореЗрдВ рд╕реБрд╡рд┐рдзрд╛(рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ):
рдлрд╝реЗatures_per_example[example_id_to_index[feature["example_id"]]].append(i)

# рдЬреЛ рд╢рдмреНрджрдХреЛрд╖ рд╣рдореЗрдВ рднрд░рдиреЗ рд╣реИрдВ.
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ = рд╕рдВрдЧреНрд░рд╣.рдСрд░реНрдбрд░реНрдбрдбрд┐рдХреНрдЯ()

#рд▓реЙрдЧрд┐рдВрдЧ.
print(f"рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ {len(examples)} рдЙрджрд╛рд╣рд░рдг рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ {len(features)} рдлреАрдЪрд░реНрд╕ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рд╣реИрдВред")

# рдЖрдЗрдП рд╕рднреА рдЙрджрд╛рд╣рд░рдгреЛрдВ рдкрд░ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ!
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП_index, рдЙрджрд╛рд╣рд░рдг enumerate(tqdm(examples)):# рд╡реЗ рд╡рд░реНрддрдорд╛рди рдЙрджрд╛рд╣рд░рдг рд╕реЗ рдЬреБрдбрд╝реА рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд╕реВрдЪрдХрд╛рдВрдХ рд╣реИрдВред
рдлреАрдЪрд░_рдЗрдВрдбрд┐рд╕реЗрд╕ = рдлреАрдЪрд░реНрд╕_рдкрд░_рдЙрджрд╛рд╣рд░рдг[рдЙрджрд╛рд╣рд░рдг_рд╕реВрдЪрдХрд╛рдВрдХ]

min_null_score =рдХреЛрдИ рдирд╣реАрдВ # рдХреЗрд╡рд▓ рддрднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрджрд┐ рд╕реНрдХреНрд╡рд╛рдб_v2 рд╕рддреНрдп рд╣реИред
рд╡реИрдз_рдЙрддреНрддрд░ = []

рд╕рдВрджрд░реНрдн = рдЙрджрд╛рд╣рд░рдг["рд╕рдВрджрд░реНрдн"]
# рд╡рд░реНрддрдорд╛рди рдЙрджрд╛рд╣рд░рдг рд╕реЗ рдЬреБрдбрд╝реА рд╕рднреА рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реВрдкрд┐рдВрдЧред
рдлреАрдЪрд░_рдЗрдВрдбрд┐рд╕реЗрд╕ рдореЗрдВ рдлреАрдЪрд░_рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рд▓рд┐рдП:
# рд╣рдо рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП рдореЙрдбрд▓ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдХреЛ рдкрдХрдбрд╝рддреЗ рд╣реИрдВред
рдкреНрд░рд╛рд░рдВрдн_рд▓реЙрдЧрд┐рдЯреНрд╕= рд╕рднреА_рд╕реНрдЯрд╛рд░реНрдЯ_рд▓реЙрдЧрд┐рдЯреНрд╕[рдлреАрдЪрд░_рдЗрдВрдбреЗрдХреНрд╕]
End_logits = all_end_logits[feature_index]
# рдпрд╣реА рд╡рд╣ рдЪреАрдЬрд╝ рд╣реИ рдЬреЛ рд╣рдореЗрдВ рдЕрдкрдиреЗ рд▓реЙрдЧрд┐рдЯ рдореЗрдВ рдХреБрдЫ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ рдореВрд▓ рдореЗрдВ рдкрд╛рдареЛрдВ рдХреА рдЕрд╡рдзрд┐ рддрдХ рдореИрдк рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧреА
# рдкреНрд░рд╕рдВрдЧред
рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ = рдлреАрдЪрд░реНрд╕[рдлреАрдЪрд░_рдЗрдВрдбреЗрдХреНрд╕]["рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ"]

# рдиреНрдпреВрдирддрдо рд╢реВрдиреНрдп рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ.
cls_index = рд╕реБрд╡рд┐рдзрд╛рдПрдБ[feature_index]["input_ids"].index(tokenizer.cls_token_id)
рдлреАрдЪрд░_рдирд▓_рд╕реНрдХреЛрд░ = рд╕реНрдЯрд╛рд░реНрдЯ_рд▓реЙрдЧрд┐рдЯреНрд╕[рд╕реАрдПрд▓рдПрд╕_рдЗрдВрдбреЗрдХреНрд╕] + рдПрдВрдб_рд▓реЙрдЧрд┐рдЯреНрд╕[рд╕реАрдПрд▓рдПрд╕_рдЗрдВрдбреЗрдХреНрд╕]
рдпрджрд┐ min_null_score рдХреЛрдИ рдирд╣реАрдВ рд╣реИ рдпрд╛ min_null_score <feature_null_score:
min_null_score = рдлреАрдЪрд░_null_score

# `n_best_size` рдХреЗ рдмрдбрд╝реЗ рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдЕрдВрдд рд▓реЙрдЧ рдХреЗ рд▓рд┐рдП рд╕рднреА рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдкрд░ рдЧреМрд░ рдХрд░реЗрдВред
рдкреНрд░рд╛рд░рдВрдн_рд╕реВрдЪрдХрд╛рдВрдХ = np.argsort(start_logits)[-1 : -n_best_size - 1 : -1].tolist()
End_indexes = np.argsort(end_logits)[-1 : -n_best_size - 1 : -1].рдЯреЛрд▓рд┐рд╕реНрдЯ()
рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ рдореЗрдВ рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рд▓рд┐рдП:
End_indexes рдореЗрдВ End_index рдХреЗ рд▓рд┐рдП:
# рджрд╛рдпрд░реЗ рд╕реЗ рдмрд╛рд╣рд░ рдЙрддреНрддрд░реЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рди рдХрд░реЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╛ рддреЛ рд╕реВрдЪрдХрд╛рдВрдХ рд╕реАрдорд╛ рд╕реЗ рдмрд╛рд╣рд░ рд╣реИрдВ рдпрд╛ рдЕрдиреБрд░реВрдк рд╣реИрдВ
# рдЗрдирдкреБрдЯ_рдЖрдИрдбреА рдХреЗ рдЙрд╕ рднрд╛рдЧ рдХреЗ рд▓рд┐рдП рдЬреЛ рд╕рдВрджрд░реНрдн рдореЗрдВ рдирд╣реАрдВ рд╣реИред
рдЕрдЧрд░ (
рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ >= рд▓реЗрди(рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ)
рдпрд╛ End_index >= len(offset_mapping)
рдпрд╛ рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ[рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕] рдХреЛрдИ рдирд╣реАрдВ рд╣реИ
рдпрд╛ рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ[рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕] рдХреЛрдИ рдирд╣реАрдВ рд╣реИ
):рдЬрд╛рд░реА рд░рдЦрдирд╛
# рдРрд╕реЗ рдЙрддреНрддрд░реЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рди рдХрд░реЗрдВ рдЬрд┐рдирдХреА рд▓рдВрдмрд╛рдИ рдпрд╛ рддреЛ < 0 рдпрд╛ > max_answer_length рд╣реЛредрдпрджрд┐ рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ <рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ рдпрд╛ рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕ - рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕ + 1 > рдЕрдзрд┐рдХрддрдо_рдЙрддреНрддрд░_рд▓рдВрдмрд╛рдИ:
рдЬрд╛рд░реА рд░рдЦрдирд╛
рд╕реНрдЯрд╛рд░реНрдЯ_рдЪрд╛рд░ = рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ[рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕][0]
рдПрдВрдб_рдЪрд╛рд░ = рдСрдлрд╕реЗрдЯ_рдореИрдкрд┐рдВрдЧ[рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕][1]
рд╡реИрдз_рдЙрддреНрддрд░.рдЬреЛрдбрд╝реЗрдВ(
{
"рд╕реНрдХреЛрд░": рд╕реНрдЯрд╛рд░реНрдЯ_рд▓реЙрдЧрд┐рдЯреНрд╕[рд╕реНрдЯрд╛рд░реНрдЯ_рдЗрдВрдбреЗрдХреНрд╕] + рдПрдВрдб_рд▓реЙрдЧрд┐рдЯреНрд╕[рдПрдВрдб_рдЗрдВрдбреЗрдХреНрд╕],
"рдкрд╛рда": рд╕рдВрджрд░реНрдн [рдкреНрд░рд╛рд░рдВрдн_рдЪрд╛рд░: рдЕрдВрдд_рдЪрд╛рд░]
}
)

рдпрджрд┐ len(valid_answers) > 0:
best_answer = рдХреНрд░рдордмрджреНрдз (valid_answers, key=lambda x: x["рд╕реНрдХреЛрд░"], рд░рд┐рд╡рд░реНрд╕=рдЯреНрд░реВ)[0]
рдЕрдиреНрдп:
# рдЕрддреНрдпрдВрдд рджреБрд░реНрд▓рдн рдХрд┐рдирд╛рд░реЗ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рднреА рдЧреИрд░-рд╢реВрдиреНрдп рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдирд╣реАрдВ рд╣реИ, рд╣рдо рдПрдХ рдирдХрд▓реА рдмрдирд╛рддреЗ рд╣реИрдВрдмрдЪрдиреЗ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░реЗрдВ
# рдЕрд╕рдлрд▓рддрд╛ред
best_answer = {"text": "", "рд╕реНрдХреЛрд░": 0.0}

# рдЖрдЗрдП рдЕрдкрдирд╛ рдЕрдВрддрд┐рдо рдЙрддреНрддрд░ рдЪреБрдиреЗрдВ: рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдпрд╛ рд╢реВрдиреНрдп рдЙрддреНрддрд░ (рдХреЗрд╡рд▓ рд╕реНрдХреНрд╡рд╛рдб_v2 рдХреЗ рд▓рд┐рдП)
рдпрджрд┐ рд╕реНрдХреНрд╡рд╛рдб_v2 рдирд╣реАрдВ рд╣реИ:
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ[рдЙрджрд╛рд╣рд░рдг["id"]] = best_answer["text"]
рдЕрдиреНрдп:
рдЙрддреНрддрд░ = best_answer["text"] рдпрджрд┐ best_answer["рд╕реНрдХреЛрд░"] > min_null_score рдЕрдиреНрдпрдерд╛ ""
рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ[рдЙрджрд╛рд╣рд░рдг["рдЖрдИрдбреА"]] = рдЙрддреНрддрд░

рд╡рд╛рдкрд╕реА рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ
```

рдкреЛрд╕реНрдЯрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдореВрд▓ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдкрд░ рд▓рд╛рдЧреВ рдХрд░реЗрдВ:

```рдЕрдЬрдЧрд░

```

```рдЕрдЬрдЧрд░
рдЕрдВрддрд┐рдо_рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ = рдкреЛрд╕реНрдЯрдкреНрд░реЛрд╕реЗрд╕_qa_predictions(рдбреЗрдЯрд╛рд╕реЗрдЯ["рд╕рддреНрдпрд╛рдкрди"], рд╕рддреНрдпрд╛рдкрди_рд╕реБрд╡рд┐рдзрд╛рдПрдБ, raw_predictions.predictions)
```

рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдмрд╛рдж 10570 рдЙрджрд╛рд╣рд░рдг рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдБ 10784 рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рд╣реЛ рдЧрдИрдВред

HBox(children=(FloatProgress(value=0.0, max=10570.0), HTML(value='')))

рдлрд┐рд░ рд╣рдо рдореЗрдЯреНрд░рд┐рдХреНрд╕ рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдореАрдЯреНрд░рд┐рдХ = рд▓реЛрдб_рдореЗрдЯреНрд░рд┐рдХ ("рд╕реНрдХреНрд╡рд╛рдб_v2" рдпрджрд┐ рд╕реНрдХреНрд╡рд╛рдб_v2 рдЕрдиреНрдпрдерд╛ "рд╕реНрдХреНрд╡рд╛рдб")
```

рдлрд┐рд░ рд╣рдо рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдФрд░ рдПрдиреЛрдЯреЗрд╢рди рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВред рдПрдХ рдЙрдЪрд┐рдд рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рд╕реНрдХреНрд╡рд╛рдб2 рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдиреЛрдВ рдФрд░ рдПрдиреЛрдЯреЗрд╢рди рдХреЛ рдкреНрд░рд╛рд░реВрдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ`no_answer_probability` рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдЪреВрдВрдХрд┐ рдХреЛрдИ рдЙрддреНрддрд░ рдирд╣реАрдВ рд╣реИ, рдпрд╣ рд╕реАрдзреЗ рдПрдХ рдЦрд╛рд▓реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкрд░ рд╕реЗрдЯ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдкреИрд░рд╛рдореАрдЯрд░ рдпрд╣рд╛рдВ рд╕реАрдзреЗ 0.0 рдкрд░ рд╕реЗрдЯ рд╣реИ)

```рдЕрдЬрдЧрд░
рдпрджрд┐ рд╕реНрдХреНрд╡рд╛рдб_v2:
рд╕реНрд╡рд░реВрдкрд┐рдд_рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ = [{"id": k, "prediction_text": v, "no_answer_probability": 0.0} for k, v in Predictions.items()]
рдЕрдиреНрдп:
рд╕реНрд╡рд░реВрдкрд┐рдд_рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ = [{"рдЖрдИрдбреА": рдХреЗ, "рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА_рдкрд╛рда": рд╡реА} рдХреЗ рдХреЗ рд▓рд┐рдП, рдЕрдВрддрд┐рдо_рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдореЗрдВ рд╡реАред рдЖрдЗрдЯрдо()]
рд╕рдВрджрд░реНрдн = [{"рдЖрдИрдбреА": рдкреВрд░реНрд╡["рдЖрдИрдбреА"], "рдЙрддреНрддрд░": рдкреВрд░реНрд╡["рдЙрддреНрддрд░"]} рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдкреВрд░реНрд╡ рдХреЗ рд▓рд┐рдП["рд╕рддреНрдпрд╛рдкрди"]]
рдПрдоetric.compute(рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ=рд╕реНрд╡рд░реВрдкрд┐рдд_рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ, рд╕рдВрджрд░реНрдн=рд╕рдВрджрд░реНрдн)
```

{'рд╕рдЯреАрдХ_рдореИрдЪ': 76.74550614947965, 'рдПрдл1': 85.13412652023338}

рдЕрдВрдд рдореЗрдВ, [рдореЙрдбрд▓ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдЬрд╛рдВрдЪреЗрдВ](https://huggingface.co/transformers/model_sharing.html) рдФрд░ рдореЙрдбрд▓ рдХреЛ [ЁЯдЧ рдореЙрдбрд▓ рд╣рдм](https://huggingface.co/models) рдкрд░ рдЕрдкрд▓реЛрдб рдХрд░рдирд╛ рди рднреВрд▓реЗрдВ ) рдлрд┐рд░ рдЖрдк рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╛рдо рд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдареАрдХ рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреА рд╢реБрд░реБрдЖрдд рдХреА рддрд░рд╣ред

```рдЕрдЬрдЧрд░

```