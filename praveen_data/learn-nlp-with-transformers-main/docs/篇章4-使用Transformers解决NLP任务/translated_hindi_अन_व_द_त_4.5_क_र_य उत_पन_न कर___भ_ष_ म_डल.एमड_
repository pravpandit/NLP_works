рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдЬрдкреНрдЯрд░ рдиреЛрдЯрдмреБрдХ [рдЕрдзреНрдпрд╛рдп 4 рдХреЛрдб рдмреЗрд╕](https://github.com/datawhalechina/learn-nlp-with-transformers/tree/main/docs/%E7%AF%87%E7%) рдореЗрдВ рд╣реИ AB%A04-%E4%BD%BF%E7%94%A8Transformers%E8%A7%A3%E5%86%B3NLP%E4%BB%BB%E5%8A%A1).

рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдбреЗрдЯрд╛рд╕реЗрдЯ рдФрд░ рдореЙрдбрд▓ рдХреЛ рддреБрд░рдВрдд рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреЛ рд╕реАрдзреЗ Google рдХреЛрд▓рд╛рдм рдиреЛрдЯрдмреБрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреЛрд▓рдиреЗ рдХреА рдЕрдиреБрд╢рдВрд╕рд╛ рдХреА рдЬрд╛рддреА рд╣реИред
рдпрджрд┐ рдЖрдк рдЗрд╕ рдиреЛрдЯрдмреБрдХ рдХреЛ Google рдХреЛрд▓реИрдм рдореЗрдВ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдФрд░ ЁЯдЧрдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬрд╝ рдХреЛ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрди рдЖрджреЗрд╢ред

```рдЕрдЬрдЧрд░
# ! рдкрд┐рдк рдбреЗрдЯрд╛рд╕реЗрдЯ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ
# -i https://pypi.tona.tsinghua.edu.cn/simple
```

рдпрджрд┐ рдЖрдк рдЗрд╕ рдЬреНрдпреВрдкрд┐рдЯрд░ рдиреЛрдЯрдмреБрдХ рдХреЛ рдЕрдкрдиреА рд╕реНрдерд╛рдиреАрдп рдорд╢реАрди рдкрд░ рдЦреЛрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдХреГрдкрдпрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХреЗ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдЙрдкрд░реЛрдХреНрдд рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рд╕реНрдерд╛рдкрд┐рдд рд╣реИред

рдЖрдк рдЗрд╕ рдЬреНрдпреВрдкрд┐рдЯрд░ рдиреЛрдЯрдмреЛ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрд╝рд╛рдЗрд▓ рдвреВрдВрдврдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрд░реЛрдХреНрдд рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╣рд╛рдВ (https://github.com/huggingface/transformers/tree/master/examples/langage-modeling) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВредрдареАрдХ рд╣реИред рдЖрдк рдХрдИ рдЬреАрдкреАрдпреВ рдпрд╛ рдЯреАрдкреАрдпреВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ рд╡рд┐рддрд░рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рднреА рдареАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

# рднрд╛рд╖рд╛ рдореЙрдбрд▓ рдХреЛ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдХрд░рдирд╛

рд╡рд░реНрддрдорд╛рди рдЬреНрдпреВрдкрд┐рдЯрд░ рдиреЛрдЯрдмреБрдХ рдореЗрдВ, рд╣рдо рдмрддрд╛рдПрдВрдЧреЗ рдХрд┐ рднрд╛рд╖рд╛ рдореЙрдбрд▓ рдХрд╛рд░реНрдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рднреА [ЁЯдЧрдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕](https://github.com/huggingface/transformers) рдореЙрдбрд▓ рдХреЛ рдХреИрд╕реЗ рдареАрдХ рдХрд┐рдпрд╛ рдЬрд╛рдПред

рдпрд╣ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рджреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХрд╡рд░ рдХрд░реЗрдЧрд╛:

+ рдХрд╛рд░рдг рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ (рд╕реАрдПрд▓рдПрдо): рдореЙрдбрд▓ рдХреЛ рд╡рд╛рдХреНрдп рдореЗрдВ рдЕрдЧрд▓реЗ рдЪрд░рд┐рддреНрд░ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдмреАрдИрдЖрд░рдЯреА-рдЬреИрд╕реЗ рдореЙрдб рдХреЗ рдбрд┐рдХреЛрдбрд░ рдФрд░ рдЬреАрдкреАрдЯреА рдХреЗ рд╕рдорд╛рди)рдПрд▓реНрд╕, рдЬрд╣рд╛рдВ рдЕрдХреНрд╖рд░ рдмрд╛рдПрдВ рд╕реЗ рджрд╛рдПрдВ рдЗрдирдкреБрдЯ рд╣реЛрддреЗ рд╣реИрдВ) рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдореЙрдбрд▓ рдзреЛрдЦрд╛ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рдореЙрдбрд▓ рдХреЛ рдмрд╛рдж рдореЗрдВ рдкрд╛рддреНрд░реЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдзреНрдпрд╛рди рдорд╛рд╕реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрдм рдореЙрдбрд▓ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЪрд░рд┐рддреНрд░ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ рд╡рд╛рдХреНрдп рдореЗрдВ i+1, рдпрд╣ рдореБрдЦреМрдЯрд╛ рдЗрд╕реЗ рд╕реНрдерд┐рддрд┐ i рдХреЗ рдмрд╛рдж рд╡рд░реНрдгреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╕реЗ рд░реЛрдХ рджреЗрдЧрд╛ред

![рдЕрдиреБрдорд╛рди рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд╛рд░рдг рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ рдХрд╛рд░реНрдп рдЫрд╡рд┐](./images/causal_рднрд╛рд╖рд╛_modeling.png)

+ рдирдХрд╛рдмрдкреЛрд╢ рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧрдбреА рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ,рдПрдордПрд▓рдПрдо): рдореЙрдбрд▓ рдХреЛ рдХреБрдЫ рд╡рд░реНрдгреЛрдВ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рдЗрдирдкреБрдЯ рдореЗрдВ "рдорд╛рд╕реНрдХ рдХрд┐рдП рдЧрдП" рдереЗ (рдмреАрдИрдЖрд░рдЯреА-рдЬреИрд╕реЗ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХрд╛рд░реНрдп)ред рдЗрд╕ рддрд░рд╣ рд╕реЗ рдореЙрдбрд▓ рдкреВрд░реЗ рд╡рд╛рдХреНрдп рдХреЛ рджреЗрдЦрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдореЙрдбрд▓ "\" рд╕реЗ рдкрд╣рд▓реЗ рдЪрд░рд┐рддреНрд░ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░ рд╕рдХрддрд╛ рд╣реИред [MASK\]" рдорд╛рд░реНрдХрд░ "\[MASK\]" рдорд╛рд░реНрдХрд░ рдХреЗ рдкрд╣рд▓реЗ рдФрд░ рдмрд╛рдж рдХреЗ рд╡рд░реНрдгреЛрдВ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИред

![рд╡рд┐рдЬреЗрдЯ рдЕрдиреБрдорд╛рди рдирдХрд╛рдмрдкреЛрд╢ рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ рдХрд╛рд░реНрдп рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ](рдЫрд╡рд┐рдпрд╛рдВ/рдирдХрд╛рдмрдкреЛрд╢_рднрд╛рд╖рд╛_рдореЙрдбрд▓рд┐рдВрдЧ.рдкреАрдПрдирдЬреА)

рдЖрдЧреЗ, рд╣рдо рдмрддрд╛рдПрдВрдЧреЗ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдХреИрд╕реЗ рд▓реЛрдб рдФрд░ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдП"рдЯреНрд░реЗрдирд░" рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЙрдбрд▓ рдХреЛ рдареАрдХ рдХрд░реЗрдВред

рдмреЗрд╢рдХ, рдЖрдк рдЗрд╕ рдЬреНрдпреВрдкрд┐рдЯрд░ рдиреЛрдЯрдмреБрдХ рдХреЗ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рд╕реАрдзреЗ рд╡рд┐рддрд░рд┐рдд рд╡рд╛рддрд╛рд╡рд░рдг рдпрд╛ рдЯреАрдкреАрдпреВ рдкрд░ рднреА рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ [рдЙрджрд╛рд╣рд░рдг рдлрд╝реЛрд▓реНрдбрд░] (https://github.com/huggingface/transformers/tree/master/) рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг)ред

## рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рдХрд░реЗрдВ

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ, рд╣рдо рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ [рд╡рд┐рдХреАрдЯреЗрдХреНрд╕реНрдЯ 2](https://huggingface.co/datasets/wikitext#data-instances) рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЖрдк рдЗрд╕ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ ЁЯдЧDatasets рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдбреЗрдЯрд╛рд╕реЗрдЯ = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ ('рд╡рд┐рдХреАрдЯреЗрдХреНрд╕реНрдЯ', 'рд╡рд┐рдХреАрдЯреЗрдХреНрд╕реНрдЯ-2-рд░реЙ-v1')
```

рдбреЗрдЯрд╛рд╕реЗрдЯ рд╡рд┐рдХреАрдЯреЗрдХреНрд╕реНрдЯ рдХрд╛ рдкреБрди: рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ (/Users/niepig/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/1.0.0/aa5e094000ec7afeb74c3be92c88313cd6f132d564c7effd961c10fd47c76f20)

рдпрджрд┐ рдЖрдкрдХреЛ рдирд┐рдореНрди рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ:

![рдЕрдиреБрд░реЛрдз рддреНрд░реБрдЯрд┐](images/request_error.png)

рд╕рдорд╛рдзрд╛рди:

MAC рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛: ```/etc/hosts``` рдлрд╝рд╛рдЗрд▓ raw.githubusercontent.com``` рдореЗрдВ рдПрдХ рдкрдВрдХреНрддрд┐ ```199.232.68.133 рдЬреЛрдбрд╝реЗрдВ``

рд╡рд┐рдВрдбреЛрдЬрд╝ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛: ```C:\Windowsws\System32\drive рдореЗрдВrs\etc\hosts``` рдПрдХ рдкрдВрдХреНрддрд┐ рдЬреЛрдбрд╝реЗрдВ ```199.232.68.133 raw.githubusercontent.com```

рдЖрдк рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрд░реЛрдХреНрдд рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЛ [рд╣рдм](https://huggingface.co/datasets) рдкрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЙрдкрд▓рдмреНрдз рдХрд┐рд╕реА рднреА рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЕрдкрдиреА рдЦреБрдж рдХреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдмрд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реЗрд▓ рдХреЛ рдЕрдирдХрдореНрдореЗрдВрдЯ рдХрд░реЗрдВ рдФрд░ рдкрде рдХреЛ рдЙрд╕ рдкрде рд╕реЗ рдмрджрд▓реЗрдВ рдЬреЛ рдЖрдЧреЗ рд▓реЗ рдЬрд╛рдПрдЧрд╛ рдЖрдкрдХреА рдлрд╛рдЗрд▓:

```рдЕрдЬрдЧрд░
# рдбреЗрдЯрд╛рд╕реЗрдЯ = рд▓реЛрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ ("рдЯреЗрдХреНрд╕реНрдЯ", рдбреЗрдЯрд╛_рдлрд╝рд╛рдЗрд▓реНрд╕ = {"рдЯреНрд░реЗрди": path_to_train.txt, "рд╕рддреНрдпрд╛рдкрди": path_to_validation.txt}
```

рдЖрдк рд╕реАрдПрд╕рд╡реА рдпрд╛ рдЬреЗрдПрд╕рдУрдПрди рдлрд╛рдЗрд▓реЛрдВ рд╕реЗ рднреА рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [рдкреВрд░реНрдг рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://huggingface.co/docs/datasets/loading_datasets.html#from-local-files) рджреЗрдЦреЗрдВред

рдбреЗрдЯрд╛ рд╕реЗрдЯ рдореЗрдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рддрддреНрд╡ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рдПрдХ рдХреБрдВрдЬреА рдХрд╛ рдЪрдпрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдлрд┐рд░ рдПрдХ рдЗрдВрдбреЗрдХреНрд╕ рджреЗрдирд╛ рд╣реЛрдЧрд╛:

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ["рдкрд╛рда", рдбреЗрдЯрд╛_рдлрд╝рд╛рдЗрд▓реЗрдВ={"рдЯреНрд░реЗрди": path_to_train.txt, "рд╕рддреНрдпрд╛рдкрди": path_to_validation.txt}
```рдЗрди''][10]
```

{'рдЯреЗрдХреНрд╕реНрдЯ': 'рдЧреЗрдо рдХреА рдпреБрджреНрдз рдкреНрд░рдгрд╛рд▓реА, рдмреНрд▓рд┐рдЯреНрдЬрд╝ рдкреНрд░рдгрд╛рд▓реА, рд╕реАрдзреЗ рд╡рд▓реНрдХрд┐рд░рд╛ рдХреНрд░реЙрдирд┐рдХрд▓реНрд╕ рд╕реЗ рд▓реА рдЧрдИ рд╣реИред рдорд┐рд╢рди рдХреЗ рджреМрд░рд╛рди, рдЦрд┐рд▓рд╛рдбрд╝реА рдкреНрд░рддреНрдпреЗрдХ рдпреВ рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВрдпреБрджреНрдзрдХреНрд╖реЗрддреНрд░ рдорд╛рдирдЪрд┐рддреНрд░ рдХреЗ рд╢реАрд░реНрд╖ @-@ рдиреАрдЪреЗ рдкрд░рд┐рдкреНрд░реЗрдХреНрд╖реНрдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП: рдПрдХ рдмрд╛рд░ рдПрдХ рдкрд╛рддреНрд░ рдХрд╛ рдЪрдпрди рд╣реЛ рдЬрд╛рдиреЗ рдкрд░, рдЦрд┐рд▓рд╛рдбрд╝реА рдЙрд╕ рдкрд╛рддреНрд░ рдХреЛ рддреАрд╕рд░реЗ @-@ рд╡реНрдпрдХреНрддрд┐ рдореЗрдВ рдпреБрджреНрдзрдХреНрд╖реЗрддреНрд░ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рдкрд╛рддреНрд░ рдкреНрд░рддрд┐ @-@ рдореЛрдбрд╝ рдкрд░ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдХрд╛рд░реНрдп рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдкрд╛рддреНрд░ рдРрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдиреНрдп рдкрд╛рддреНрд░реЛрдВ рдХреА рдХреАрдордд рдкрд░ рдХрдИ рдореЛрдбрд╝ рджрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рд┐рддреНрд░ рдХреЗ рдкрд╛рд╕ рдЙрдирдХреЗ рдПрдХреНрд╢рди рдЧреЗрдЬ рджреНрд╡рд╛рд░рд╛ рд╕реАрдорд┐рдд рдЧрддрд┐ рдХрд╛ рдПрдХ рдХреНрд╖реЗрддреНрд░ рдФрд░ рджреВрд░реА рд╣реЛрддреА рд╣реИред рдЧреЗрдордкреНрд▓реЗ рдХреЗ рджреМрд░рд╛рди, рдпрджрд┐ рдХреБрдЫ рд╣реЛ рддреЛ, рдиреМ рд╡рд░реНрдгреЛрдВ рддрдХ рдХреЛ рд╕реМрдВрдкрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИрдЙрдирдХреЗ рд╕рд╛рде рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдЙрдирдХреЗ рд╕реНрд╡рд╛рд╕реНрдереНрдп рдмрд┐рдВрджреБ (рдПрдЪрдкреА) рдХрдо рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ рдпрд╛ рджреБрд╢реНрдорди рдХреЗ рд╣рдорд▓реЛрдВ рд╕реЗ рдирд╖реНрдЯ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рд┐рддреНрд░ рдореЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ "рдХреНрд╖рдорддрд╛рдПрдВ" рд╣реЛрддреА рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рд┐рддреНрд░ рдХреЗ рд▓рд┐рдП рдЕрджреНрд╡рд┐рддреАрдп рдХреМрд╢рд▓ рдЙрдиреНрд╣реЗрдВ "рд╡реНрдпрдХреНрддрд┐рдЧрдд рдХреНрд╖рдорддрд╛" рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЬрдиреНрдордЬрд╛рдд рдХреМрд╢рд▓ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рддрдм рддрдХ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рд░рд╣рддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдЕрдиреНрдпрдерд╛ рдХрд╣рд╛рдиреА рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдд рди рд╣реЛ рдФрд░ рдХрд┐рд╕реА рдкрд╛рддреНрд░ рдХреА рд╕рд╣рд╛рдпрддрд╛ рдпрд╛ рдмрд╛рдзрд╛ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ "рдпреБрджреНрдз рдХреНрд╖рдорддрд╛рдПрдБ", рдЬреЛ рдкреВрд░реЗ рдЦреЗрд▓ рдореЗрдВ рд╡рд┐рдХрд╕рд┐рдд рд╣реЛрддреА рд╣реИрдВ рдФрд░ рд╣рдореЗрд╢рд╛ рдПрдХ рдкрд╛рддреНрд░ рдХреЛ рдпреБрджреНрдз рдХреНрд╖рдорддрд╛рдПрдБ рд╕реАрдЦрдиреЗ рдХрд╛ рд╡рд░рджрд╛рди рджреЗрддреА рд╣реИрдВрдПрдЪ рдЪрд░рд┐рддреНрд░ рдореЗрдВ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп "рдорд╛рд╕реНрдЯрд░реНрд╕ рдЯреЗрдмрд▓" рд╣реИ, рдПрдХ рдЧреНрд░рд┐рдб @-@ рдЖрдзрд╛рд░рд┐рдд рдХреМрд╢рд▓ рддрд╛рд▓рд┐рдХрд╛ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рднрд┐рдиреНрди рдХреМрд╢рд▓ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдиреЗ рдФрд░ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдкрд╛рддреНрд░реЛрдВ рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рдХреНрд╖рдорддрд╛рдПрдВ рднреА рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдпреБрджреНрдз рдХреЗ рдореИрджрд╛рди рдкрд░ рдЕрд╕реНрдерд╛рдпреА рдмрдврд╝рд╛рд╡рд╛ рджреЗрддреА рд╣реИрдВ: рдХрд░реНрдЯ "рдбрд╛рдпрд░реЗрдХреНрдЯ рдХрдорд╛рдВрдб" рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдФрд░ рдЕрдкрдиреЗ рдПрдХреНрд╢рди рдкреЙрдЗрдВрдЯ рдЧреЗрдЬ рдХреЛ рдЦрд╝рд░рд╛рдм рдХрд┐рдП рдмрд┐рдирд╛ рдпреБрджреНрдз рдХреЗ рдореИрджрд╛рди рдореЗрдВ рдШреВрдореЗрдВ, рдЪрд░рд┐рддреНрд░ рд░реАрд▓рд╛ рдЕрдкрдиреЗ "рд╡рд▓реНрдХрд┐рд░рд┐рдпрд╛ рдлреЙрд░реНрдо" рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрдЬреЗрдп рдмрди рд╕рдХрддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЗрдореНрдХрд╛ рдЕрдкрдиреЗ рднрд╛рд░реА рд╣рдерд┐рдпрд╛рд░ рд╕реЗ рдХрдИ рджреБрд╢реНрдорди рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдирд┐рд╢рд╛рдирд╛ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред

рдЬрд▓реНрджреА рд╕реЗрдбреЗрдЯрд╛ рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЛ рд╕рдордЭреЗрдВ, рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдлрд╝рдВрдХреНрд╢рди рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдХреБрдЫ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдЪреБрдиреЗ рдЧрдП рдЙрджрд╛рд╣рд░рдг рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛ред

```рдЕрдЬрдЧрд░
рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдХреНрд▓рд╛рд╕рд▓реЗрдмрд▓ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдкрд╛рдВрдбрд╛ рдХреЛ рдкреАрдбреА рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ
IPython.display рд╕реЗ рдЖрдпрд╛рдд рдбрд┐рд╕реНрдкреНрд▓реЗ, HTML

def show_random_elements(рдбреЗрдЯрд╛рд╕реЗрдЯ, num_examples=10):
assert num_examples <= len(рдбреЗрдЯрд╛рд╕реЗрдЯ), "рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдореМрдЬреВрдж рддрддреНрд╡реЛрдВ рд╕реЗ рдЕрдзрд┐рдХ рддрддреНрд╡ рдирд╣реАрдВ рдЪреБрди рд╕рдХрддреЗред"
рдЪреБрдирддрд╛ рд╣реИ = []
рд░реЗрдВрдЬ рдореЗрдВ _ рдХреЗ рд▓рд┐рдП (num_examples):
рдкрд┐рдХ = рд░реИрдВрдбрдо.рд░реИрдВрдбрд┐рдВрдЯ(0, рд▓реЗрди(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
рдЪрдпрди рдХрд░рддреЗ рд╕рдордп:
рдЙрдард╛рдУ = рд░реИрдВрдбреЛm.randint(0, len(рдбреЗрдЯрд╛рд╕реЗрдЯ)-1)
рдЪреБрдирддрд╛ рд╣реИ.рдЬреЛрдбрд╝реЗрдВ(рдЪреБрдиреЗрдВ)

рдбреАрдПрдл = рдкреАрдбреА.рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо(рдбреЗрдЯрд╛рд╕реЗрдЯ[рдЪреБрдирддрд╛ рд╣реИ])
рдХреЙрд▓рдо рдХреЗ рд▓рд┐рдП, dataset.features.items() рдЯрд╛рдЗрдк рдХрд░реЗрдВ:
рдпрджрд┐ isinstance(рдкреНрд░рдХрд╛рд░, рдХреНрд▓рд╛рд╕рд▓реЗрдмрд▓):
рдбреАрдПрдл[рдХреЙрд▓рдо] = рдбреАрдПрдл[рдХреЙрд▓рдо].рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдо(рд▓реИрдореНрдмреНрдбрд╛ рдЖрдИ: рдЯрд╛рдЗрдк.рдирд╛рдо[рдЖрдИ])
рдкреНрд░рджрд░реНрд╢рди(HTML(df.to_html()))
```

```рдЕрдЬрдЧрд░
show_random_elements(рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"])
```

<рддрд╛рд▓рд┐рдХрд╛ рд╕реАрдорд╛ = "1" рд╡рд░реНрдЧ = "рдбреЗрдЯрд╛рдлрд╝реНрд░реЗрдо">
<рд╕рд┐рд░>
<tr рд╢реИрд▓реА = "рдкрд╛рда-рд╕рдВрд░реЗрдЦрдг: рджрд╛рдПрдВ;">
<рде></рде>
<th>рдкрд╛рда</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3 рдорд╛рд░реНрдЪ 1967 рдХреЛ рд╕рдВрд╕рдж рдиреЗ рдЪрд╛рд░ рдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛рдЯреНрд░реЙрдирд╣реИрдо рдФрд░ рдмреЛрдбреЛ рдХреЗ рдмреАрдЪ рд╣реЗрд▓рдЧрд▓реИрдВрдб рддрдЯ рдХреЗ рд╕рд╛рде рд╢реЙрд░реНрдЯ рдЯреЗрдХ @-@рдСрдл рдФрд░ рд▓реИрдВрдбрд┐рдВрдЧ рд╣рд╡рд╛рдИ рдЕрдбреНрдбреЗред рдмреНрд░реИрдереЗрдВрд╕ рдиреЗ рдбреА рд╣реИрд╡рд┐рд▓реИрдВрдб рдХрдирд╛рдбрд╛ рдбреАрдПрдЪрд╕реА @-@ 6 рдЯреНрд╡рд┐рди рдУрдЯрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдСрд░реНрдбрд░ рджрд┐рдпрд╛ рдФрд░ рдХрдВрдкрдиреА рдмреНрд░реИрдереЗрдВрд╕ рдПрд╕рдЯреАрдУрдПрд▓ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдИ рд╕рдмреНрд╕рд┐рдбреА, рд▓реЗрдХрд┐рди рд░рд┐рдпрд╛рдпрдд рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рдФрд░ рд╡рд┐рдбреЗрд░реЛ рдХреЛ рд╕рдмреНрд╕рд┐рдбреА рджреА рдЧрдИ, рдЬреЛ рд╕рдореБрджреНрд░реА рд╡рд┐рдорд╛рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╛рд░реНрдЧреЛрдВ рдХрд╛ рд╕рдВрдЪрд╛рд▓рди рдХрд░ рд░рд╣рд╛ рдерд╛
</tr>
<tr>
<th>1</th>
<td></td>
</tr>
<tr>
<th>2</th>
<td>рд░рд╛рд╡ рд░рдореЗрд╢ рдХреЛ рдПрдХ рддрд╛рдВрддреНрд░рд┐рдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЪреБрдирд╛ рдЧрдпрд╛ рдерд╛рд╡рд░реНрддрдорд╛рди рдпреБрдЧ рдореЗрдВ рдЧрд┐рд▓ рдХреЗ рдЪрд░рд┐рддреНрд░ рдХреА рдорджрдж рдХрд░рддрд╛ рд╣реИред рдореБрдореИрде рдЦрд╛рди рдХреЛ рдПрдХ рдЕрдиреНрдп рдЖрдЗрдЯрдо рдирдВрдмрд░ рдХреЗ рд▓рд┐рдП рдЪреБрдирд╛ рдЧрдпрд╛ рдерд╛, рдЬреЛ рдШрд░рд╛рдирд╛ рдореЛрдЧреБрдбреБ (1992) рдХреЗ рд╣рд┐рдЯ рдЧреАрдд "рдмрдВрдЧрд╛рд░реВ рдХреЛрдбрд┐рдкреЗрдЯреНрдЯрд╛" рдХрд╛ рд░реАрдорд┐рдХреНрд╕ рд╕рдВрд╕реНрдХрд░рдг рдерд╛; рдШрд░рд╛рдирд╛ рдореЛрдЧреБрдбреБ рдХрд╛ рд╕рдВрдЧреАрдд рднреА рдПрдо. рдПрдо. рдЪрд┐рд░рдВрдЬреАрд╡реА рджреНрд╡рд╛рд░рд╛ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рд░рд╛рдЬрдиреАрддрд┐ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХреЗ рдмрд╛рдж рдордЧрдзреАрд░рд╛ рдЙрдирдХреА рдкрд╣рд▓реА рдлрд┐рд▓реНрдо рдереА, рдЬрдм рд░рд╛рдЬрд╛рдореМрд▓реА рдиреЗ рдПрдХ рдХреИрдорд┐рдпреЛ рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рд╕реБрдЭрд╛рдпрд╛, рддреЛ рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЪрд┐рд░рдВрдЬреАрд╡реА рдирд┐рд░реНрджреЗрд╢рдХ рдХреЗ рд╕реБрдирд╛рдиреЗ рддрдХ рдЭрд┐рдЭрдХ рд░рд╣реЗ рдереЗредd рд╕рдВрдкреВрд░реНрдг рдЕрдиреБрдХреНрд░рдо рдФрд░ рдЧреАрдд рдХрд╛ рдорд╣рддреНрд╡
</tr>
<tr>
<рде>3</рде>
<td></td>
</tr>
<tr>
<рде>4</рде>
<td></td>
</tr>
<tr>
<th>5</th>
<td>= = = рдХреБрд▓ рдиреЙрдирд╕реНрдЯреЙрдк рдПрдХреНрд╢рди рдХреБрд╢реНрддреА (2015 - рд╡рд░реНрддрдорд╛рди) = = = \n</td>
</tr>
<tr>
<th>6</th>
<td>рдбреЗрд▓реА рдЯреЗрд▓реАрдЧреНрд░рд╛рдл рдиреЗ рджреГрд╢реНрдп рдЙрдкрдиреНрдпрд╛рд╕ рдХреЛ 2011 рдХреЗ рдЕрдкрдиреЗ рд╡реАрдбрд┐рдпреЛ рдЧреЗрдо рдкреБрд░рд╕реНрдХрд╛рд░реЛрдВ рдореЗрдВ "рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда рд╕реНрдХреНрд░рд┐рдкреНрдЯ" рдХрд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рджрд┐рдпрд╛, рдЬрд┐рд╕рдореЗрдВ рдХрд╣рд╛ рдЧрдпрд╛ рдХрд┐ "рд▓рд╡' рдореЗрдВ рдПрдХ рд╣рд╛рдИ рд╕реНрдХреВрд▓ рд╢рд┐рдХреНрд╖рдХ рдХреА рдЕрдкрдиреЗ рдЫрд╛рддреНрд░ рдХреА рдЪрд┐рдВрддрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реНрддрд░рд┐рдд рдХрдерд╛ рд╕рдмрд╕реЗ рдореБрдЦреНрдпрдзрд╛рд░рд╛ рд╡реАрдбрд┐рдпреЛ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЦреЗрд▓рд╣рд┐рдореНрдордд рдирд╣реАрдВ рд╣реЛрдЧреА
</tr>
<tr>
<рде>7</рде>
<td></td>
</tr>
<tr>
<th>8</th>
<td></td>
</tr>
<tr>
<th>9</th><td></td>
</tr>
</tbody>
</рддрд╛рд▓рд┐рдХрд╛>

рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдХреБрдЫ рдкрд╛рда рд╡рд┐рдХрд┐рдкреАрдбрд┐рдпрд╛ рд▓реЗрдЦреЛрдВ рдХреЗ рдкреВрд░реНрдг рдкреИрд░рд╛рдЧреНрд░рд╛рдл рд╣реИрдВ, рдЬрдмрдХрд┐ рдЕрдиреНрдп рдХреЗрд╡рд▓ рд╢реАрд░реНрд╖рдХ рдпрд╛ рдЦрд╛рд▓реА рдкрдВрдХреНрддрд┐рдпрд╛рдБ рд╣реИрдВред

## рдХрд╛рд░рдгрд╛рддреНрдордХ рднрд╛рд╖рд╛ рдореЙрдбрд▓рд┐рдВрдЧ (рд╕реАрдПрд▓рдПрдо)

рдХреЙрдЬрд╝рд▓ рд▓реИрдВрдЧреНрд╡реЗрдЬ рдореЙрдбрд▓рд┐рдВрдЧ (рд╕реАрдПрд▓рдПрдо) рдХреЗ рд▓рд┐рдП, рд╣рдо рдкрд╣рд▓реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рд╕рднреА рдЯреЗрдХреНрд╕реНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЯреЛрдХрдирд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЙрдиреНрд╣реЗрдВ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рдлрд┐рд░, рд╣рдо рдЙрдиреНрд╣реЗрдВ рдЗрд╕ рддрд░рд╣ рд╕реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЕрдиреБрдХреНрд░рдо рд▓рдВрдмрд╛рдИ рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВрдЧреЗ, рдореЙрдбрд▓ рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдкрд╛рда рдХрд╛ рдирд┐рд░рдВрддрд░ рднрд╛рдЧ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧрд╛:

```
рдкрд╛рда 1
```
рдпрд╛
```
рдЯреЗрдХреНрд╕реНрдЯ1 рдЕрдВрдд [рдмреАрдУрдПрд╕_рдЯреЛрдХрди] рдЯреЗрдХреНрд╕реНрдЯ2 рдкреНрд░рд╛рд░рдВрдн
```
рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдХреНрдпрд╛ рд╡реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдХрдИ рдореВрд▓ рдкрд╛рдареЛрдВ рдХреЛ рдлреИрд▓рд╛рддреЗ рд╣реИрдВ, рд▓реЗрдмрд▓ рдЗрдирдкреБрдЯ рдХреЗ рд╕рдорд╛рди рд╣реЛрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдмрд╛рдИрдВ рдУрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛ рдЬрд╛рдПрдВрдЧреЗред

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдо [`distilgpt2`](https://huggingface.co/distilgpt2) рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЖрдк рдпрд╣рд╛рдВ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рд╕реА рднреА рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рднреА рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдореЙрдбрд▓_рдЪреЗрдХрдкреЙрдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рдЬреАрдкреАрдЯреА2"
```

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рдЯреА рдХреЛ рдЯреЛрдХрдирд╛рдЗрдЬрд╝ рдХрд░реЗрдВрд╢рдмреНрджрд╛рд╡рд▓реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рд╣рдореЗрдВ рдПрдХ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдпрд╣ рд╕рдм рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рд╡рд░реНрдЧ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ рдСрдЯреЛрдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░ рдЖрдпрд╛рдд рдХрд░реЗрдВ

рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(model_checkpoint, use_fast=True)

```

рдЕрдм рд╣рдо рд╕рднреА рдЯреЗрдХреНрд╕реНрдЯ рдкрд░ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдбреЗрдЯрд╛рд╕реЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реЗ рдореИрдк рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдЯреЗрдХреНрд╕реНрдЯ рдкрд░ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдбреАрдИрдПрдлрд╝ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝_рдлрд╝рдВрдХреНрд╢рди(рдЙрджрд╛рд╣рд░рдг):
рд╡рд╛рдкрд╕реА рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░(рдЙрджрд╛рд╣рд░рдг["рдкрд╛рда"])
```

рдлрд┐рд░ рд╣рдо рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЛ рддреЗрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ```рдмреИрдЪ=рдЯреНрд░реВ``` рдФрд░ ```4``` рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдЯреЛрдХрди рдкрд░ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВред рд╣рдореЗрдВ ```рдЯреЗрдХреНрд╕реНрдЯ``` рдХреЙрд▓рдо рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдмрд╛рдж рдореЗрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕реЗ рддреНрдпрд╛рдЧ рджреЗрддреЗ рд╣реИрдВред

```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк (рдЯреЛрдХрдирд╛рдЗрдЬ_рдлрдВрдХреНрд╢рди, рдмреИрдЪреЗрдб = рдЯреНрд░реВ, num_proc = 4, рд░рд┐рдореВрд╡_рдХреЙрд▓рдо = ["рдЯреЗрдХреНрд╕реНрдЯ"])
```

рдпрджрд┐ рдЕрдм рд╣рдо рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рдПрдХ рддрддреНрд╡ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рдореЙрдбрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рдЗрдирдкреБрдЯ_рдЖрдИрдбреА рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдпреБрдХреНрдд_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"][1]```

{'рдзреНрдпрд╛рди_рдорд╛рд╕реНрдХ': [1, 1, 1, 1, 1, 1, 1, 1, 1],
'рдЗрдирдкреБрдЯ_рдЖрдИрдбреА': [796, 569, 18354, 7496, 17740, 6711, 796, 220, 198]}

рдЕрдЧрд▓рд╛ рдЪрд░рдг рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдХрдард┐рди рд╣реИ: рд╣рдореЗрдВ рд╕рднреА рдкрд╛рдареЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рдЬреЛрдбрд╝рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдлрд┐рд░ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ `рдмреНрд▓реЙрдХ_рд╕рд╛рдЗрдЬрд╝` рдХреЗ рдмреНрд▓реЙрдХ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╡рд┐рдХрд▓реНрдк `рдмреИрдЪ' рдХреЗ рд╕рд╛рде рдлрд┐рд░ рд╕реЗ `рдореИрдк' рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ =True'ред рдпрд╣ рд╡рд┐рдХрд▓реНрдк рд╣рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдЙрджрд╛рд╣рд░рдг рд▓реМрдЯрд╛рдХрд░ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдмрджрд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИрдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рдПрдХ рдмреИрдЪ рд╕реЗред

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдореЙрдбрд▓ рдХреЛ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЖрдкрдХреА рд╡реАрдбрд┐рдпреЛ рдореЗрдореЛрд░реА рдХреЛ рд╡рд┐рд╕реНрдлреЛрдЯ рд╕реЗ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ 128 рдкрд░ рд╕реЗрдЯ рдХреА рдЧрдИ рд╣реИред

```рдЕрдЬрдЧрд░
# рдмреНрд▓реЙрдХ_рдЖрдХрд╛рд░ = рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░.рдореЙрдбрд▓_рдореИрдХреНрд╕_рд▓реЗрдВрде
рдмреНрд▓реЙрдХ_рдЖрдХрд╛рд░ = 128
```

рдлрд┐рд░ рд╣рдо рдЕрдкрдиреЗ рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рд╕рдореВрд╣реАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рд▓рд┐рдЦрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
def рд╕рдореВрд╣_рдкрд╛рда(рдЙрджрд╛рд╣рд░рдг):
# рд╕рднреА рдкрд╛рдареЛрдВ рдХреЛ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд░реЗрдВ
concatenated_examples = {k: sum(examples[k], []) for k in example.keys()}
total_length = len(concatenated_examples[list(examples.keys())[0]])
# рд╣рдо рд╢реЗрд╖ рдХреЗ рдЕрдиреБрд░реВрдк рднрд╛рдЧ рдХреЛ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрджрд┐ рдореЙрдбрд▓ рдЗрд╕рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдкреИрдбрд┐рдВрдЧ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рдЖрдк рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рдЗрд╕ рднрд╛рдЧ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
рдХреБрд▓_рд▓рдВрдмрд╛рдИ = (рдХреБрд▓_рд▓рдВрдмрд╛рдИ // рдмреНрд▓реЙрдХ_рдЖрдХрд╛рд░) * рдмреНрд▓реЙрдХ_рдЖрдХрд╛рд░
# max_len рджреНрд╡рд╛рд░рд╛ рд╡рд┐рднрд╛рдЬрд┐рдд.
рдкрд░рд┐рдгрд╛рдо = {
k: [рдЯреА[рдЖрдИ: рдЖрдИ + рдмреНрд▓реЙрдХ_рд╕рд╛рдЗрдЬ] рдлреЙрд░ рдЖрдИ рдЗрди рд░реЗрдВрдЬ(0, рдЯреЛрдЯрд▓_рд▓реЗрдВрде, рдмреНрд▓реЙрдХ_рд╕рд╛рдЗрдЬ)]
concatenated_examples.items() рдореЗрдВ k, t рдХреЗ рд▓рд┐рдП
}
рдкрд░рд┐рдгрд╛рдо["рд▓реЗрдмрд▓"] = рдкрд░рд┐рдгрд╛рдо["input_ids"].copy()
рд╡рд╛рдкрд╕реА рдкрд░рд┐рдгрд╛рдо
```

рдкрд╣рд▓реЗ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдордиреЗ рд▓реЗрдмрд▓ рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ рдХреЙрдкреА рдХрд┐рдпрд╛ рд╣реИред

рдпрд╣ рдмреЗрдХрд╛ рд╣реИЁЯдЧ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рдореЙрдбрд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рджрд╛рдИрдВ рдУрд░ рд╢рд┐рдлреНрдЯ рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдЗрд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред

рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, `рдореИрдк` рд╡рд┐рдзрд┐ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 1,000 рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХрд╛ рдПрдХ рдмреИрдЪ рднреЗрдЬреЗрдЧреА, рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдВ, рд╣рдо рд╢реЗрд╖ рдХреЛ рд╣рдЯрд╛ рджреЗрдВрдЧреЗ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ 1,000 рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рд╕рдВрдпреЛрдЬрд┐рдд рдЯреЛрдХрди рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ `рдмреНрд▓реЙрдХ_рд╕рд╛рдЗрдЬрд╝` рдХрд╛ рдЧреБрдгрдХ рдмрдирд╛ рджреЗрдВрдЧреЗред рдЖрдк рдЙрдЪреНрдЪ рдмреИрдЪ рдЖрдХрд╛рд░ рдкрд╛рд╕ рдХрд░рдХреЗ рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреЛ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдзреАрдореА рдЧрддрд┐ рд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрдЧрд╛)редрдкреВрд░реНрд╡рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ:

```рдЕрдЬрдЧрд░
lm_datasets = рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк(
рд╕рдореВрд╣_рдкрд╛рда,
рдмреИрдЪ = рд╕рддреНрдп,
рдмреИрдЪ_рдЖрдХрд╛рд░=1000,
num_proc=4,
)```

рдЕрдм рд╣рдо рдЬрд╛рдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдбреЗрдЯрд╛рд╕реЗрдЯ рдмрджрд▓ рдЧрдпрд╛ рд╣реИ: рдЕрдм рдирдореВрдиреЛрдВ рдореЗрдВ рд╡рд░реНрдгреЛрдВ рдХреЗ `рдмреНрд▓реЙрдХ_рд╕рд╛рдЗрдЬрд╝` рд▓рдЧрд╛рддрд╛рд░ рдмреНрд▓реЙрдХ рд╣реИрдВ, рдЬреЛ рд╕рдВрднрд╡рддрдГ рдХрдИ рдореВрд▓ рдкрд╛рдареЛрдВ рддрдХ рдлреИрд▓реЗ рд╣реБрдП рд╣реИрдВред

```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░.рдбрд┐рдХреЛрдб(lm_datasets["рдЯреНрд░реЗрди"][1]["input_ids"])
```

' рдЧреЗрдо "рдиреЗрдорд▓реЗрд╕" рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рджреВрд╕рд░реЗ рдпреВрд░реЛрдкрд┐рдпрди рдпреБрджреНрдз рдХреЗ рджреМрд░рд╛рди рдЧреИрд▓рд┐рдпрд╛ рд░рд╛рд╖реНрдЯреНрд░ рдХреА рд╕реЗрд╡рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдПрдХ рджрдВрдбрд╛рддреНрдордХ рд╕реИрдиреНрдп рдЗрдХрд╛рдИ рд╣реИ, рдЬреЛ рд╕реЗрдХрдВрдб рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддреА рд╣реИредрд░рд┐рдЯ рдмреНрд▓реИрдХ рдСрдкрд░реЗрд╢рдВрд╕ рдФрд░ рдЗрдВрдкреАрд░рд┐рдпрд▓ рдпреВрдирд┐рдЯ "рдХреИрд▓рд╛рдорд╛рдЯреА рд░реЗрд╡реЗрди" рдХреЗ рдЦрд┐рд▓рд╛рдл рдЦрдбрд╝реЗ рд╣реИрдВред \n рдЧреЗрдо рдХрд╛ рд╡рд┐рдХрд╛рд╕ 2010 рдореЗрдВ рд╢реБрд░реВ рд╣реБрдЖ, рдЬрд┐рд╕рдореЗрдВ рд╡рд╛рд▓реНрдХрд┐рд░рд┐рдпрд╛ рдХреНрд░реЙрдирд┐рдХрд▓реНрд╕ II рдкрд░ рдХрд┐рдП рдЧрдП рдХрд╛рдо рдХрд╛ рдПрдХ рдмрдбрд╝рд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╢рд╛рдорд┐рд▓ рдерд╛, рдЬрдмрдХрд┐ рдЗрд╕рдиреЗ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреА рдорд╛рдирдХ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рднреА рдмрд░рдХрд░рд╛рд░ рд░рдЦрд╛ рдХрдИ рд╕рдорд╛рдпреЛрдЬрди рдХрд┐рдП рдЧрдП, рдЬреИрд╕реЗ рдХрд┐ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рдирд╡рд╛рдЧрдВрддреБрдХреЛрдВ рдХреЗ рд▓рд┐рдП рдЦреЗрд▓ рдХреЛ рдФрд░ рдЕрдзрд┐рдХ рдХреНрд╖рдорд╛рд╢реАрд▓ рдмрдирд╛рдирд╛, рдЪрд░рд┐рддреНрд░ рдбрд┐рдЬрд╛рдЗрдирд░ рд░рд╛рдпрддрд╛ рд╣реЛрдиреНрдЬреМ рдФрд░ рд╕рдВрдЧреАрддрдХрд╛рд░ рд╣рд┐рддреЛрд╢реА рд╕рд╛рдХрд┐рдореЛрдЯреЛ рджреЛрдиреЛрдВ рд╡рд╛рд▓реНрдХрд┐рд░рд┐рдпрд╛ рдХреНрд░реЙрдирд┐рдХрд▓реНрд╕ II рдХреЗ рдирд┐рд░реНрджреЗрд╢рдХ рддрд╛рдХреЗрд╢реА рдХреЗ рд╕рд╛рде рдкрд┐рдЫрд▓реА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рд╕реЗ рд▓реМрдЯ рдЖрдПредрдУрдЬрд╝'

рдЕрдм рдЬрдм рдбреЗрдЯрд╛ рд╕рд╛рдл рд╣реЛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╣рдо рдЕрдкрдиреЗ рдЯреНрд░реЗрдирд░ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдо рдПрдХ рдореЙрдбрд▓ рдмрдирд╛рдПрдВрдЧреЗ:

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForCausalLM рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдореЙрдбрд▓ = AutoModelForCausalLM.from_pretrained(model_checkpoint)
```

рдЯреЙрд░реНрдЪ рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ

```рдЕрдЬрдЧрд░

рдЖрдпрд╛рдд рдЖрдпрд╛рддlib.util
#importimportlib_metadata
a = рдЖрдпрд╛рддlib.util.find_spec("рдорд╢рд╛рд▓") рдХреЛрдИ рдирд╣реАрдВ рд╣реИ
рдкреНрд░рд┐рдВрдЯ(рдП)
# _рдорд╢рд╛рд▓_рд╕рдВрд╕реНрдХрд░рдг = рдЖрдпрд╛рддрд▓рд┐рдм_рдореЗрдЯрд╛рдбреЗрдЯрд╛.рд╕рдВрд╕реНрдХрд░рдг("рдорд╢рд╛рд▓")
# рдкреНрд░рд┐рдВрдЯ(_рдорд╢рд╛рд▓_рд╕рдВрд╕реНрдХрд░рдг)
```

рд╕рддреНрдп

рдФрд░ рдХреБрдЫ `рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ`:

```рдЕрдЬрдЧрд░
рдкрд░рд┐рд╡рд░реНрддрди рд╕реЗрд╡реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдХ, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ
```

```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧ = рдкреНрд░рд╢рд┐рдХреНрд╖рдг рддрд░реНрдХ(
"рдкрд░реАрдХреНрд╖рдг-рд╕реАрдПрд▓рдПрдо",
рдореВрд▓реНрдпрд╛рдВрдХрди_рд░рдгрдиреАрддрд┐ = "рдпреБрдЧ",
рд╕реАрдЦрдиреЗ рдХреА рджрд░=2e-5,
рд╡рдЬрд╝рди_рдХреНрд╖рдп=0.01,
)
```

рд╣рдо рдпрд╣ рд╕рдм `рдЯреНрд░реЗрдирд░` рд╡рд░реНрдЧ рдХреЛ рд╕реМрдВрдкрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
рдореЙрдбрд▓=рдореЙрдбрд▓,
рддрд░реНрдХ=рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧ,
рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдПрд▓рдПрдо_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
eval_dataset=lm_datasets["рд╕рддреНрдпрд╛рдкрди"],
)
```

рддрдм рд╣рдо рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```

0%||31/7002 [04:16<14:27:52, 7.47 рд╕реЗрдХрдВрдб/рдЗрдЯ]

рдПрдХ рдмрд╛рд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рдиреЗ рдкрд░, рдбрдмреНрд▓реНрдпреВрдИ рд╣рдорд╛рд░реЗ рдореЙрдбрд▓ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдкрд░ рдЗрд╕рдХреА рдЙрд▓рдЭрди рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ:

```рдЕрдЬрдЧрд░
рдЧрдгрд┐рдд рдЖрдпрд╛рдд рдХрд░реЗрдВ
eval_results = рдЯреНрд░реЗрдирд░.рдореВрд▓реНрдпрд╛рдВрдХрди()
рдкреНрд░рд┐рдВрдЯ(f"рдкрд░реЗрдкреНрд▓реЗрдХреНрд╕рд┐рдЯреА: {math.exp(eval_results['eval_los']):.2f}")
```

## рдорд╛рд╕реНрдХ рд▓реИрдВрдЧреНрд╡реЗрдЬ рдореЙрдбрд▓ рдореЙрдбрд▓рд┐рдВрдЧ, рдПрдордПрд▓рдПрдо)

рд╣рдо рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдЪрд░рдг рдХреЗ рд╕рд╛рде рдкрд╣рд▓реЗ рдХреА рддрд░рд╣ рд╣реА рдбреЗрдЯрд╛рд╕реЗрдЯ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ:

рд╣рдо рдХреБрдЫ рд╡рд░реНрдгреЛрдВ рдХреЛ рдмреЗрддрд░рддреАрдм рдврдВрдЧ рд╕реЗ "MASK" рдХрд░реЗрдВрдЧреЗ (рдЙрдиреНрд╣реЗрдВ "[MASK]" рд╕реЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВрдЧреЗ) рдФрд░ рд▓реЗрдмрд▓ рдХреЛ рдХреЗрд╡рд▓ "[MASK]" рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд▓реЗрдмрд▓ рдкрд░ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВрдЧреЗ (рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рд╡рд░реНрдг рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ)рдЖрд░рдПрд╕ рдЬреЛ "рдорд╛рд╕реНрдХрдб" рдирд╣реАрдВ рд╣реИрдВ)ред

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдо [`distilroberta-base`](https://huggingface.co/distilroberta-base) рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЖрдк [рдпрд╣рд╛рдВ](https://huggingface.co) рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рд╕реА рднреА рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ /рдореЙрдбрд▓?рдлрд╝рд┐рд▓реНрдЯрд░=рдХрд╛рд░рдг-рдПрд▓рдПрдо):

```рдЕрдЬрдЧрд░
рдореЙрдбрд▓_рдЪреЗрдХрдкреЙрдЗрдВрдЯ = "рдбрд┐рд╕реНрдЯрд┐рд▓рд░реЛрдмрд░реНрдЯрд╛-рдмреЗрд╕"
```

рд╣рдо рдкрд╣рд▓реЗ рдХреА рддрд░рд╣ рд╣реА рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдлрд╝рдВрдХреНрд╢рди рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдореЗрдВ рдмрд╕ рдЕрдкрдиреЗ рджреНрд╡рд╛рд░рд╛ рдЪреБрдиреЗ рдЧрдП рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:

```рдЕрдЬрдЧрд░
рдЯреЛрдХрдирдирд╛рдЗрдЬрд╝рд░ = AutoTokenizer.from_pretrained(model_checkpoint, рдЙрдкрдпреЛрдЧ_рддреЗрдЬрд╝=рд╕рддреНрдп)
рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ = рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк (рдЯреЛрдХрдирд╛рдЗрдЬ_рдлрдВрдХреНрд╢рди, рдмреИрдЪ = рдЯреНрд░реВ, num_proc = 4, рд░рд┐рдореВрд╡_рдХреЙрд▓рдо = ["рдЯреЗрдХреНрд╕реНрдЯ"])````

рдкрд╣рд▓реЗ рдХреА рддрд░рд╣, рд╣рдо рдкрд╛рдареЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рд╕рдореВрд╣рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд▓рдВрдмрд╛рдИ `рдмреНрд▓реЙрдХ_рд╕рд╛рдЗрдЬрд╝` рдХреЗ рдирдореВрдиреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдпрджрд┐ рдЖрдкрдХреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╡рд╛рдХреНрдп рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕ рдЪрд░рдг рдХреЛ рдЫреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред

```рдЕрдЬрдЧрд░
lm_datasets = рдЯреЛрдХрдирдирд╛рдЗрдЬреНрдб_рдбреЗрдЯрд╛рд╕реЗрдЯ.рдореИрдк(
рд╕рдореВрд╣_рдкрд╛рда,
рдмреИрдЪ = рд╕рддреНрдп,
рдмреИрдЪ_рдЖрдХрд╛рд░=1000,
num_proc=4,
)
```

рдмрд╛рдХреА рд╕рдм рдХреБрдЫ рд╡реИрд╕рд╛ рд╣реА рд╣реИ рдЬреИрд╕рд╛ рд╣рдордиреЗ рдкрд╣рд▓реЗ рдХрд┐рдпрд╛ рдерд╛, рджреЛ рдЕрдкрд╡рд╛рджреЛрдВ рдХреЛ рдЫреЛрдбрд╝рдХрд░, рдкрд╣рд▓реЗ рд╣рдо рдПрдХ рдРрд╕реЗ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдлрд┐рдЯ рдмреИрдарддрд╛ рд╣реИрдирдХрд╛рдмрдкреЛрд╢ рднрд╛рд╖рд╛ рдореЙрдбрд▓:

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╕реЗ AutoModelForMaskedLM рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдореЙрдбрд▓ = AutoModelForMaskedLM.from_pretrained(model_checkpoint)
```

рджреВрд╕рд░рд╛, рд╣рдо рдПрдХ рд╡рд┐рд╢реЗрд╖ рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рд╣реИ рдЬреЛ рдирдореВрдиреЗ рд▓реЗрдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЯреЗрдВрд╕рд░ рдореЗрдВ рдмреИрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред

рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдЦрд╛рд╕ рдирд╣реАрдВ рдерд╛, рдЗрд╕рд▓рд┐рдП рд╣рдордиреЗ рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдерд╛ред рдпрд╣рд╛рдВ рд╣рдо рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ "MASK" рдХрд░ рд░рд╣реЗ рд╣реИрдВред

рд╣рдо рдЗрд╕реЗ рдкреНрд░реАрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЪрд░рдг (`рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░`) рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВрд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдореЗрдВ, рд╡рд░реНрдгреЛрдВ рдХреЛ рд╣рдореЗрд╢рд╛ рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдорд╛рд╕реНрдХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ рдореЗрдВ рдЗрд╕ рдЪрд░рдг рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдХреЗ, рд╣рдо рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╣рд░ рдмрд╛рд░ рдбреЗрдЯрд╛ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рджреМрд░рд╛рди рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдорд╛рд╕реНрдХрд┐рдВрдЧ рдПрдХ рдирдП рддрд░реАрдХреЗ рд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИред

рдорд╛рд╕реНрдХрд┐рдВрдЧ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, `рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░реНрд╕` рдорд╛рд╕реНрдХ рдХрд┐рдП рдЧрдП рднрд╛рд╖рд╛ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП `рдбреЗрдЯрд╛рдХреЛрд▓реЗрдЯрд░рдлреЙрд░рд▓реИрдВрдЧреНрд╡реЗрдЬрдореЙрдбрд▓рд┐рдВрдЧ` рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рд╣рдо рдорд╛рд╕реНрдХрд┐рдВрдЧ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```рдЕрдЬрдЧрд░
рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рд╕реЗ DataCollatorForрднрд╛рд╖рд╛рдореЙрдбрд▓рд┐рдВрдЧ рдЖрдпрд╛рдд рдХрд░реЗрдВ
рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░ = рдбреЗрдЯрд╛рдХреЛрд▓реЗрдЯрд░рдлреЙрд░рд▓реИрдВрдЧреНрд╡реЗрдЬрдореЙрдбрд▓рд┐рдВрдЧ(рдЯреЛрдХрдирд╛рдЗрдЬрд╝рд░=рдЯреВрдХреЗрдирд┐рдЬрд╝рд░, рдПрдордПрд▓рдПрдо_рд╕рдВрднрд╛рд╡рдирд╛=0.15)
```

рдлрд┐рд░ рд╣рдореЗрдВ рд╕рдм рдХреБрдЫ рдкреНрд░рд╢рд┐рдХреНрд╖рдХ рдХреЛ рд╕реМрдВрдкрдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рд╢реБрд░реВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:

```рдЕрдЬрдЧрд░
рдкреНрд░рд╢рд┐рдХреНрд╖рдХ = рдкреНрд░рд╢рд┐рдХреНрд╖рдХ(
рдореЙрдбрд▓=рдореЙрдбрд▓,
рддрд░реНрдХ=рдкреНрд░рд╢рд┐рдХреНрд╖рдг_рдЖрд░реНрдЧ,
рдЯреНрд░реЗрди_рдбреЗрдЯрд╛рд╕реЗрдЯ=рдПрд▓рдПрдо_рдбреЗрдЯрд╛рд╕реЗрдЯ["рдЯреНрд░реЗрди"],
eval_dataset=lm_datasets["рд╕рддреНрдпрд╛рдкрди"],
рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░=рдбреЗрдЯрд╛_рдХреЛрд▓реЗрдЯрд░,
)
```

```рдЕрдЬрдЧрд░
рдЯреНрд░реЗрдирд░.рдЯреНрд░реЗрди()
```

рдкрд╣рд▓реЗ рдХреА рддрд░рд╣, рд╣рдо рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдкрд░ рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╕реАрдПрд▓рдПрдо рдЙрджреНрджреЗрд╢реНрдп рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЙрд▓рдЭрди рдмрд╣реБрдд рдХрдо рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдордПрд▓рдПрдо рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдЫрд┐рдкреЗ рд╣реБрдП рдкрд╣рд▓реВ рдкрд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИрдмрд╛рдХреА рдЯреЛрдХрди рддрдХ рдкрд╣реБрдВрдЪ рд░рдЦрддреЗ рд╣реБрдП рдУрдХреЗрдиреНрд╕ (рдпрд╣рд╛рдВ рдХреБрд▓ рдХрд╛ 15%)ред

рдЗрд╕рд▓рд┐рдП, рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдпрд╣ рдПрдХ рдЖрд╕рд╛рди рдХрд╛рдо рд╣реИред

```рдЕрдЬрдЧрд░
eval_results = рдЯреНрд░реЗрдирд░.рдореВрд▓реНрдпрд╛рдВрдХрди()
рдкреНрд░рд┐рдВрдЯ(f"рдкрд░реЗрдкреНрд▓реЗрдХреНрд╕рд┐рдЯреА: {math.exp(eval_results['eval_los']):.2f}")
```

```рдЕрдЬрдЧрд░
рдЕрдкрдиреЗ рдореЙрдбрд▓ рдХреЛ [ЁЯдЧрдореЙрдбрд▓ рд╣рдм](https://huggingface.co/models) рдкрд░ [рдЕрдкрд▓реЛрдб](https://huggingface.co/transformers/model_sharing.html) рдХрд░рдирд╛ рди рднреВрд▓реЗрдВред
```