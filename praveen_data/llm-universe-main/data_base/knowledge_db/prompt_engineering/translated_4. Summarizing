# Chapter 4 Text Summarization

In the busy information age, Xiao Ming is an enthusiastic developer who faces the challenge of processing a large amount of text information. He needs to find key information for his project by studying countless literature, but time is far from enough. When he was overwhelmed, he discovered the text summarization function of the large language model (LLM).

This function is like a lighthouse for Xiao Ming, illuminating his way to deal with the ocean of information. The powerful ability of LLM lies in its ability to simplify complex text information and extract key ideas, which is undoubtedly a great help to him. He no longer needs to spend a lot of time reading all the documents, but only needs to summarize them with LLM to quickly get the information he needs.

By programming and calling the API interface, Xiao Ming successfully implemented this text summary function. He exclaimed: "It's like a magic that turns the endless ocean of information into a clear source of information." Xiao Ming's experience shows the great advantages of the LLM text summarization function: **saving time**, **improving efficiency**, and **accurately obtaining information**. This is what we will introduce in this chapter. Let's explore how to use programming and calling API interfaces to master this powerful tool.

## 1. Summarizing a single text

Take the task of summarizing product reviews as an example: for e-commerce platforms, there are often a large number of product reviews on the website, which reflect the thoughts of all customers. If we have aTools can be used to summarize these massive and lengthy reviews, so that more reviews can be quickly browsed, and customers' preferences can be understood, thereby guiding platforms and merchants to provide better services.

Next, we provide an online product review as an example, which may come from an online shopping platform, such as Amazon, Taobao, JD.com, etc. The reviewer reviewed a panda doll, including factors such as the quality, size, price and logistics speed of the product, as well as his daughter's love for the product.

```python
prod_review = """
This panda doll is a birthday gift for my daughter. She likes it very much and takes it everywhere.
The doll is soft, super cute, and has a kind facial expression. But compared to the price,
it is a bit small. I feel that I can buy a bigger one for the same price elsewhere.
The courier arrived a day earlier than expected, so I played with it myself before giving it to my daughter.
"""
```

### 1.1 Limit the length of the output text

We first try to limit the length of the text to 30 words.

```python
from tool import get_completion

prompt = f"""
Your task is to generate a short summary of a product review from an e-commerce website.

Please summarize the review text between three backticks, up to 30 words.

Review: ```{prod_review}```"""

response = get_completion(prompt)
print(response)
```

The panda doll is soft and cute, my daughter likes it, but it is a little small. The courier arrived one day ahead of schedule.

We can see that the language model gave us a result that meets the requirements.

Note: In the previous section, we mentioned that the language model relies on the word segmenter when calculating and judging the length of the text, and the word segmenter does not have perfect accuracy in character statistics.

### 1.2 Set the key perspective focus

In some cases, we will focus on different business scenarios for different texts. For example, in the product review text, the logistics department may focus more on the timeliness of transportation, the merchant may focus more on the price and product quality, and the platform may focus more on the overall user experience.

We can emphasize our emphasis on a specific perspective by enhancing the input prompt (Prompt).

#### 1.2.1 Focus on courier service

```python
prompt = f"""
Your task is to generate a short summary of a product review from an e-commerce website.

Please summarize the review text between the three backticks, up to 30 words, and focus on the delivery service.

Comment: ```{prod_review}```
"""

response = get_completion(prompt)print(response)
```

The express arrived ahead of time, the doll is cute but a little small.

From the output results, we can see that the text starts with "The express arrived ahead of time", which reflects the emphasis on express efficiency.

#### 1.2.2 Focus on price and quality

```python
prompt = f"""
Your task is to generate a short summary of a product review from an e-commerce website.

Please summarize the review text between three backticks, up to 30 words, and focus on product price and quality.

Comment: ```{prod_review}```
"""

response = get_completion(prompt)
print(response)
```

Cute panda doll, good quality but a little small, the price is slightly higher. The express arrived ahead of time.

From the output results, we can see that the text starts with "Cute panda doll, good quality but a little small, the price is slightly higher", which reflects the emphasis on product price and quality.

### 1.3 Extraction of key information

In Section 1.2, although we did make the text summary more focused on a specific aspect by adding a prompt that focuses on key angles, we can find that some other information is also retained in the results. For example, the summary that focuses on price and quality still retains "the express delivery arrived ahead of schedule".If we only want to extract information from a certain angle and filter out all other information, we can ask LLM to perform **text extraction** instead of summarization.

Let's extract information from the text together!

```python
prompt = f"""
Your task is to extract relevant information from product reviews on e-commerce websites.

Please extract product shipping related information from the review text between the following three backticks, up to 30 words.

Comment: ```{prod_review}```
"""

response = get_completion(prompt)
print(response)
```

Product transportation related information: Express delivery arrived one day in advance.

## 2. Summarize multiple texts at the same time

In actual workflows, we often have to deal with a large number of review texts. The following example collects multiple user reviews in a list, and uses the ```for``` loop and the text summary (Summarize) prompt to summarize the reviews to less than 20 words and print them in order. Of course, in actual production, for review texts of different sizes, in addition to using the ```for``` loop, you may also need to consider integrating comments, distributing, and other methods to improve computing efficiency. You can useCreate a dashboard to summarize a large number of user reviews and make it easy for you or others to quickly browse and click to view the original review. This way, you can effectively grasp all the customer's thoughts.

```python
review_1 = prod_review

# Review of a floor lamp
review_2 = """
I needed a nice bedroom lamp that not only has extra storage functions, but also is not too expensive.
The delivery speed was very fast, and it arrived in just two days.
However, during the shipping process, the pull cord of the lamp had problems, but the company was happy to send a new one.
The new cord was also delivered quickly, in just a few days.
Assembly was very easy. However, I later discovered that a part was missing, so I contacted customer service and they sent me the missing part quickly!
To me, this is a great company that cares about its customers and products.
"""

# Review of an electric toothbrush
review_3 = """
My dental hygienist recommended an electric toothbrush so I bought this.
So far, the battery life is pretty good.
After the initial charge, I left it plugged in for the first week to condition the battery.
I have been using it every morning and night for the past 3 weeks and the battery has held its charge.
However, the brush head is too small. I have seen baby toothbrushes with larger heads than this one.
I wish the brush head was bigger, with bristles of varying lengths,
which would allow for better cleaning between teeth, which this toothbrush doesn't do.
Overall, if you can get this toothbrush for around $50, it's a pretty good deal.
The manufacturer's replacement heads are pretty expensive, but you can buy generic heads for a much more reasonable price.
This toothbrush makes me feel like I'm going to the dentist every day, and my teeth feel super clean!
"""

# Review of a blender
review_4 = """
During November, this 17-piece set was on seasonal sale for about $49, which was about 50% off.
But for some reason (let's call it price hikes), by the second week of December, all the prices had gone up,
and the same set was now between $70-89. The 11-piece set also went up about $10 from $29.
It looks pretty good, but if you look closely at the base, the part where the blades lock doesn't look as nice as previous years' versions.
However, I plan to use it very carefully
(e.g. I will grind hard foods like beans, ice, rice, etc. in the blender first before grinding them to the desired particle size,
and then switch to the whisk blade to get a finer flour if I need to make a more delicate/less pulpy food).
When making smoothies, I will chop the fruits and vegetables I will use into fine pieces and freeze them
(If using spinach, I will lightly cook the spinach first and then freeze it until useIf I'm making sorbet, I use a small to medium food processor) so you don't add too much ice.
About a year later, the motor started making strange noises. I called customer service, but the warranty had expired,
so I had to buy another one. It's worth noting that the overall quality of this type of product has declined over the past few years,
so they rely partly on brand recognition and consumer loyalty to maintain sales. I received my new blender in about two days.
"""

reviews = [review_1, review_2, review_3, review_4]

```

```python
for i in range(len(reviews)):
prompt = f"""
Your task is to extract relevant information from product reviews on an e-commerce website.

Please summarize the review text between the three backticks, up to 20 words.

Comment text: ```{reviews[i]}```
"""
response = get_completion(prompt)
print(f"Comment{i+1}: ", response, "\n")

```

Comment 1: The panda doll is a birthday giftGood product, my daughter likes it, soft and cute, with a kind facial expression. A little small for the price, the courier arrived a day early. 

Review 2: Nice bedroom lamp, storage function, fast delivery, lamp cord problem, quickly resolved, easy assembly, cares about customers and products. 

Review 3: This electric toothbrush has good battery life, but the toothbrush head is too small, the price is reasonable, and the cleaning effect is good. 

Review 4: The review mentioned a 17-piece set of products that were sold at a discount in November, but the price increased in December. The reviewer mentioned the appearance and use of the product, and mentioned the problem of product quality decline. Finally, the reviewer mentioned that they purchased another blender. 

## 3. English version **1.1 Single text summary** ```python prod_review = """ Got this panda plush toy for my daughter's birthday, \ who loves it and takes it everywhere. It's soft and \ super cute, and its face has a friendly look. It's \ a bit small for what I paid though. I think there \ might be other options that are bigger for the \ same price. It arrived a day earlier than expected, \ so I got to play with it myself before I gave it \ to her. """ ``` ```python prompt = f""" Your task is to generate a short summary of a product \ review from an ecommerce site. Summarize the review below, delimited by triple backticks, in at most 30 words. Review: ```{ prod_review}``` """ response = get_completion(prompt) print(response) ```` This panda plush toy is loved by the reviewer's daughter, but they feel it is a bit small for the price. **1.2 Set the key angle to focus** 1.2.1 Focus on the express service```python prompt = f""" Your task is to generate a short summary of a product \ review from an ecommerce site to give feedback to the \ Shipping deparmtment. Summarize the review below, delimited by triple backticks, in at most 30 words, and focusing on any aspects \ that mention shipping and delivery of the product. Review: ``{prod_review}``` """ response = get_completion(prompt) print(response) ``` The customer is happy with the product but suggests offering larger options for the same price. They were pleased with the early delivery. 1.2.2 Focus on price and quality```python prompt = f""" Your task is to generate a short summary of a product \ review from an ecommerce site to give feedback to the \ pricing deparmtment, responsible for determining the \ price of the product. Summarize the review below, delimited by triple backticks, in at most 30 words, and focusing on any aspects \ that are relevant to the price and perceived value. Review: ```{prod_review}``` """ response = get_completion(prompt) print(response) ``` The customer loves the panda plush toy for its softness and cuteness, but feels it is overpriced compared to other options available. **1.3 Key information extraction** ```python prompt = f""" Your task is to extract relevant information from \ a product review from an ecommerce site to give \ feedback to the Shipping department. From the review below, delimited by triple quotes \ extract the information relevant to shipping and \ delivery. Limit to 30 words. Review: ```{prod_review}``` """ response = get_completion(prompt) print(response) `` ` The shipping department should take note that the product arrived a day earlier than expected. **2.1 Summarize multiple pieces of text at the same time** ```python review_1 = prod_review # review for a standing lamp review_2 = """ Needed a nice lamp for my bedroom, and this one \ had additional storage and not toohigh of a price \ point. Got it fast - arrived in 2 days. The string \ to the lamp broke during the transit and the company \ happily sent over a new one. Came within a few days \ as well. It was easy to put together. Then I had a missing part, so I contacted their support and they very quickly got me the missing piece! Seems to me to be a great company that cares about their customers and products. """ # review for an electric toothbrush review_3 = """ My dental hygienist recommendedan electric toothbrush, which is why I got this. The battery life seems to be pretty impressive so far. After initial charging and leaving the charger plugged in for the first week to condition the battery, I've unplugged the charger and \ been using it for twice daily brushing for the last \ 3 weeks all on the same charge. But the toothbrush head \ is too small. I've seen baby toothbrushes bigger than \ this one. I wish the head was bigger with different \ length bristles to get between teeth better because \ this one doesn't. Overall if you can get this one \ around the $50 mark, it's a good deal. The manufacturer's \ replacements heads are pretty expensive, but you can \ get generic ones that're more reasonable priced. This \ toothbrush makes me feel like I've been to the dentist \ every day. My teeth feel sparkly clean! """ # review for a blender review_4 = """ So, they still had the 17 piece system on seasonal \ sale for around $49 in the month of November, about \ halfoff, but for some reason (call it price gouging) \ around the second week of December the prices all went \ up to about anywhere from between $70-$89 for the same \ system. And the 11 piece system went up around $10 or \ so in price also from the earlier sale price of $29. So it looks okay, but if you look at the base, the part where the blade locks into place doesn't look as good as in previous editions from a few years ago, but I \ plan to be very gentle with it (example, I crush \ veryhard items like beans, ice, rice, etc. in the blender first then pulverize them in the serving size I want in the blender then switch to the whipping blade for a finer flour, and use the cross cutting blade first when making smoothies, then use the flat blade if I need them finer/less pulpy). Special tip when making smoothies, finely cut and freeze the fruits and vegetables (if using spinach-lightly stew soften the spinach then freeze until ready for use-and if making \ sorbet,\ I called customer service but the warranty expired already, so I had to buy another one. FYI: The overall quality has gone done in these types of products, so they are kind of counting on brand recognition and consumer loyalty to maintain sales . Got it in about \ two days. """ reviews = [review_1, review_2, review_3, review_4] ``` ```python for i in range(len(reviews)): prompt = f""" Your task is to generate a short summary of a product \ review from an ecommerce site. Summarize the review below, delimited by triple \ backticks in at most 20 words. Review: ``{reviews[i]}`` """ response = get_completion(prompt) print(i, response, "\ n") ``` 0 Soft and cute panda plush toy loved by daughter, but small for the price. Arrived early. 1 Great lamp with storage, fast delivery, excellent customer service, and easy assembly. Highly recommended. 2 Impressive battery life, but toothbrush head is too small. Good deal if bought around $50. 3 The reviewer found the price increase after the sale disappointing and noticed a decrease in quality over time.